---
title: 設定-CsCertificate での、AV および OAuth 証明書の使用
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Staging AV and OAuth certificates using -Roll in Set-CsCertificate
ms:assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ660292(v=OCS.15)
ms:contentKeyID: 49354387
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 583ab13e50cac7c7a8b345a2ea2cf4c4e1e38d7f
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/04/2020
ms.locfileid: "41764433"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="staging-av-and-oauth-certificates-in-lync-server-2013-using--roll-in-set-cscertificate"></a><span data-ttu-id="2ef0e-102">Lync Server 2013 での、AV および OAuth 証明書の使用-セットアップ-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="2ef0e-102">Staging AV and OAuth certificates in Lync Server 2013 using -Roll in Set-CsCertificate</span></span>

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

<span data-ttu-id="2ef0e-103">_**最終更新日:** 2012-11-13_</span><span class="sxs-lookup"><span data-stu-id="2ef0e-103">_**Topic Last Modified:** 2012-11-13_</span></span>

<span data-ttu-id="2ef0e-104">音声/ビデオ (A/V) 通信は、Microsoft Lync Server 2013 の主要コンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-104">Audio/Video (A/V) communications is a key component of Microsoft Lync Server 2013.</span></span> <span data-ttu-id="2ef0e-105">アプリケーション共有、音声会議、ビデオ会議などの機能は、A/v Edge サービスに割り当てられている証明書、特に A/V 認証サービスに依存しています。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-105">Features such as application sharing and audio and video conferencing rely on the certificates assigned to the A/V Edge service, specifically the A/V Authentication service.</span></span>

<div>


> [!IMPORTANT]
> <OL>
> <LI>
> <P><span data-ttu-id="2ef0e-106">この新機能は、A/V Edge サービスと<EM>Oauthtokenissuer</EM>証明書で動作するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-106">This new feature is designed to work for the A/V Edge service and the <EM>OAuthTokenIssuer</EM> certificate.</span></span> <span data-ttu-id="2ef0e-107">その他の種類の証明書は、A/V Edge サービスと OAuth 証明書の種類と共にプロビジョニングできますが、A/V Edge サービス証明書の共存動作の恩恵を受けることはできません。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-107">Other certificate types can be provisioned along with the A/V Edge service and OAuth certificate type, but will not benefit from the coexistence behavior that the A/V Edge service certificate will.</span></span></P>
> <LI>
> <P><span data-ttu-id="2ef0e-108">Microsoft Lync Server 2013 証明書を管理するために使用される Lync Server 管理シェル PowerShell コマンドレットは、 <EM>Audiovideoauthentication</EM>証明書の種類としての A/V Edge サービス証明書と、Type <EM>Oauthtokenissuer</EM>としての oauthserver certificate を指します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-108">The Lync Server Management Shell PowerShell cmdlets used to manage Microsoft Lync Server 2013 certificates refers to the A/V Edge service certificate as the <EM>AudioVideoAuthentication</EM> certificate type and the OAuthServer certificate as type <EM>OAuthTokenIssuer</EM>.</span></span> <span data-ttu-id="2ef0e-109">このトピックのこれ以降の説明では証明書を一意に識別するために、同じ識別子の種類を使用して <EM>AudioVideoAuthentication</EM> および <EM>OAuthTokenIssuer</EM> と呼びます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-109">For the rest of this topic and to uniquely identify the certificates, they will be referred to by the same identifier type, <EM>AudioVideoAuthentication</EM> and <EM>OAuthTokenIssuer</EM>.</span></span></P></LI></OL>



</div>

<span data-ttu-id="2ef0e-110">A/V 認証サービスは、クライアントや他の A/V コンシューマーによって使用されるトークンの発行を担当します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-110">The A/V Authentication service is responsible for issuing tokens that are used by clients and other A/V consumers.</span></span> <span data-ttu-id="2ef0e-111">トークンは証明書の属性から生成され、証明書の有効期限が切れたときに、新しい証明書によって生成された新しいトークンに接続を切断して、もう一度参加するための要件があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-111">The tokens are generated from attributes on the certificate, and when the certificate expires, loss of connection and requirement to rejoin with a new token generated by the new certificate will result.</span></span> <span data-ttu-id="2ef0e-112">Lync Server 2013 の新機能により、古い証明書を前もって古いものから事前にステージングし、両方の証明書を一定期間有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-112">A new feature in Lync Server 2013 will alleviate this problem – the ability to stage a new certificate in advance of the old one expiring and allowing both certificates to continue to function for a period of time.</span></span> <span data-ttu-id="2ef0e-113">この機能では、Set-CsCertificate Lync Server Management Shell コマンドレットの更新された機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-113">This feature uses updated functionality in the Set-CsCertificate Lync Server Management Shell cmdlet.</span></span> <span data-ttu-id="2ef0e-114">新しいパラメーター– Roll は既存のパラメーター– EffectiveDate を使用して、新しい AudioVideoAuthentication 証明書を証明書ストアに配置します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-114">The new parameter –Roll, with the existing parameter –EffectiveDate, will place the new AudioVideoAuthentication certificate in the certificate store.</span></span> <span data-ttu-id="2ef0e-115">以前の AudioVideoAuthentication 証明書は、確認のために発行されたトークンのまま残ります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-115">The older AudioVideoAuthentication certificate will still remain for issued tokens to be validated against.</span></span> <span data-ttu-id="2ef0e-116">新しい AudioVideoAuthentication 証明書を所定の場所に配置すると、次の一連のイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-116">Beginning with putting the new AudioVideoAuthentication certificate in place, the following series of events will occur:</span></span>

<div>


> [!TIP]
> <span data-ttu-id="2ef0e-117">Lync Server Management Shell コマンドレットを使用して、証明書を管理するために、エッジサーバー上の各目的に対して個別の証明書を要求できます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-117">Using the Lync Server Management Shell cmdlets for managing certificates, you can request separate and distinct certificates for each purpose on the Edge Server.</span></span> <span data-ttu-id="2ef0e-118">Lync Server 展開ウィザードの [証明書] ウィザードを使用すると、証明書を作成できますが、通常は、エッジサーバーで使用されるすべての証明書を1つの証明書に結合する<STRONG>既定</STRONG>の種類があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-118">Using the Certificate Wizard in the Lync Server Deployment Wizard assists you in creating certificates, but is typically of the <STRONG>default</STRONG> type which couples all certificate uses for the Edge Server onto a single certificate.</span></span> <span data-ttu-id="2ef0e-119">ローリング証明書機能を使用する場合は、AudioVideoAuthentication 証明書を他の証明書の用途から切り離すことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-119">The recommended practice if you are going to use the rolling certificate feature is to decouple the AudioVideoAuthentication certificate from the other certificate purposes.</span></span> <span data-ttu-id="2ef0e-120">既定の種類の証明書をプロビジョニングおよびステージングすることもできますが、結合された証明書の AudioVideoAuthentication 部分のみがステージングによる恩恵を受けます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-120">You can provision and stage a certificate of the Default type, but only the AudioVideoAuthentication portion of the combined certificate will benefit from the staging.</span></span> <span data-ttu-id="2ef0e-121">ユーザー (たとえば、証明書の有効期限が切れたときのインスタントメッセージの会話) では、アクセスエッジサービスに関連付けられた新しい証明書を使用するためにログアウトしてもう一度ログインする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-121">A user involved in (for example) an instant messaging conversation when the certificate expires will need to log out and log back in to make use of the new certificate associated with the Access Edge service.</span></span> <span data-ttu-id="2ef0e-122">Web 会議エッジサービスを使って Web 会議に参加しているユーザーに対しても同様の動作が発生します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-122">Similar behavior will occur for a user involved in a Web conference using the Web Conferencing Edge service.</span></span> <span data-ttu-id="2ef0e-123">OAuthTokenIssuer 証明書は、すべてのサーバーの間で共有される特定の種類の証明書です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-123">The OAuthTokenIssuer certificate is a specific type that is shared across all servers.</span></span> <span data-ttu-id="2ef0e-124">証明書を1か所で作成して管理すると、その証明書は、他のすべてのサーバーの中央管理ストアに保存されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-124">You create and manage the certificate in one place and the certificate is stored in the Central Management store for all other servers.</span></span>



</div>

<span data-ttu-id="2ef0e-p106">Set-CsCertificate コマンドレットを使用するとき、および現在の証明書の有効期限が切れる前にこのコマンドレットを使用して証明書をステージングするときのオプションと要件を十分に理解するには、さらに詳しい説明が必要です。重要なのは -Roll パラメーターですが、このパラメーターの用途は実質的に 1 つです。これをパラメーターとして定義する場合は、-Type で定義された、影響を受ける証明書に関する情報 (たとえば AudioVideoAuthentication や OAuthTokenIssuer) と、-EffectiveDate で定義された、証明書が有効になる時期に関する情報を Set-CsCertificate に指定します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-p106">Additional detail is needed to fully understand your options and requirements when using the Set-CsCertificate cmdlet and using it to stage certificates prior to the current certificate expiring. The –Roll parameter is important, but essentially single purpose. If you define it as a parameter, you are telling Set-CsCertificate that you will be providing information about the certificate that will be affected defined by –Type (for example AudioVideoAuthentication and OAuthTokenIssuer), when the certificate will become effective defined by –EffectiveDate.</span></span>

<span data-ttu-id="2ef0e-128">**-ロール:**–ロールパラメーターは必須であり、同時に指定する必要がある依存関係がある必要があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-128">**-Roll:** The –Roll parameter is required and has dependencies that must be supplied along with it.</span></span> <span data-ttu-id="2ef0e-129">どの証明書が影響を受け、どのように適用されるかを完全に定義するための必須パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-129">Required parameters to fully define which certificates will be affected and how they will be applied:</span></span>

<span data-ttu-id="2ef0e-130">**-EffectiveDate:** パラメーター– EffectiveDate は、新しい証明書が現在の証明書で相互に相互にアクティブになるタイミングを定義します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-130">**-EffectiveDate:** The parameter –EffectiveDate defines when the new certificate will become co-active with the current certificate.</span></span> <span data-ttu-id="2ef0e-131">– EffectiveDate は、現在の証明書の有効期限が近づいているか、または長い時間が経過している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-131">The –EffectiveDate can be close to the expiry time of the current certificate, or it can be a longer period of time.</span></span> <span data-ttu-id="2ef0e-132">AudioVideoAuthentication certificate の推奨最小– EffectiveDate は8時間で、AudioVideoAuthentication certificate を使って発行される AV Edge サービストークンの既定のトークンの有効期間です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-132">A recommended minimum –EffectiveDate for the AudioVideoAuthentication certificate would be 8 hours, which is the default token lifetime for AV Edge service tokens issued using the AudioVideoAuthentication certificate.</span></span>

<span data-ttu-id="2ef0e-p109">OAuthTokenIssuer 証明書をステージングするときは、証明書が有効になるまでのリード タイムの要件が異なります。OAuthTokenIssuer 証明書のリード タイムは、現在の証明書の有効期限が切れる 24 時間以上前に設定する必要があります。共存のリード タイムが長いのは、OAuthTokenIssuer 証明書に依存する他のサーバーの役割 (たとえば Exchange Server) で、証明書によって作成された認証と暗号化キー材料の保有期間が長いためです。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-p109">When staging OAuthTokenIssuer certificates, there are different requirements for the lead time before the certificate can become effective. The minimum time that the OAuthTokenIssuer certificate should have for its lead time is 24 hours before the expiration time of the current certificate. The extended lead time for the coexistence is because of other server roles that are dependent on the OAuthTokenIssuer certificate (Exchange Server, for example) which has a longer retention time for certificate created authentication and encryption key materials.</span></span>

<span data-ttu-id="2ef0e-136">**-拇印:** 拇印は、その証明書に固有の証明書の属性です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-136">**-Thumbprint:** The thumbprint is an attribute on the certificate that is unique to that certificate.</span></span> <span data-ttu-id="2ef0e-137">-Thumbprint パラメーターを使用して、Set-CsCertificate コマンドレットの処理によって影響を受ける証明書を識別します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-137">The –Thumbprint parameter is used to identify the certificate that will be affected by the actions of the Set-CsCertificate cmdlet.</span></span>

<span data-ttu-id="2ef0e-138">**-Type:**–型パラメーターは、1つの証明書の使用の種類を受け付けることができます。または、証明書の使用の種類のコンマ区切りリストを指定します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-138">**-Type:** The –Type parameter can accept a single certificate usage type or a comma separated list of certificate usage types.</span></span> <span data-ttu-id="2ef0e-139">証明書の種類は、コマンドレットに対して識別するものであり、証明書の目的はサーバーに対して指定されています。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-139">The certificate types are those that identify to the cmdlet and to the server what the purpose of the certificate is.</span></span> <span data-ttu-id="2ef0e-140">たとえば、「AudioVideoAuthentication」と入力すると、A/V Edge サービスと AV 認証サービスが使用されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-140">For example, type AudioVideoAuthentication is for use by the A/V Edge service and the AV Authentication service.</span></span> <span data-ttu-id="2ef0e-141">異なる種類の証明書を同時にステージングおよびプロビジョニングすることにした場合は、証明書に必要な最も長い最小のリードタイムを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-141">If you decide to stage and provision certificates of a different type at the same time, you must consider the longest required minimum effective lead time for the certificates.</span></span> <span data-ttu-id="2ef0e-142">たとえば、AudioVideoAuthentication と OAuthTokenIssuer の証明書をステージする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-142">For example, you need to stage certificates of type AudioVideoAuthentication and OAuthTokenIssuer.</span></span> <span data-ttu-id="2ef0e-143">少なくとも EffectiveDate は、この2つの証明書の大部分である必要があります。この例では、最小のリード時間が24時間である OAuthTokenIssuer です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-143">Your minimum –EffectiveDate must be the greater of the two certificates, in this case the OAuthTokenIssuer, which has a minimum lead time of 24 hours.</span></span> <span data-ttu-id="2ef0e-144">オーディオビデオ認証証明書のステージが24時間の間にない場合は、要件により多くの EffectiveDate と個別にステージを整理します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-144">If you do not want to stage the AudioVideoAuthentication certificate with a lead time of 24 hours, stage it separately with an EffectiveDate that is more to your requirements.</span></span>

<div>

## <a name="to-update-or-renew-an-av-edge-service-certificate-with-a-roll-and--effectivedate-parameters"></a><span data-ttu-id="2ef0e-145">–ロールと-EffectiveDate のパラメーターを使用して A/V エッジサービス証明書を更新または更新するには</span><span class="sxs-lookup"><span data-stu-id="2ef0e-145">To update or renew an A/V Edge service certificate with a –Roll and -EffectiveDate parameters</span></span>

1.  <span data-ttu-id="2ef0e-146">Administrators グループのメンバーとして、ローカル コンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-146">Log on to the local computer as a member of the Administrators group.</span></span>

2.  <span data-ttu-id="2ef0e-147">A/V Edge サービス上の既存の証明書のエクスポート可能な秘密キーを使って、更新または新しい AudioVideoAuthentication 証明書を要求します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-147">Request a renewal or new AudioVideoAuthentication certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>

3.  <span data-ttu-id="2ef0e-148">新しい AudioVideoAuthentication 証明書を、エッジサーバーとプール内の他のすべてのエッジサーバーにインポートします (プールが展開されている場合)。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-148">Import the new AudioVideoAuthentication certificate to the Edge Server and all other Edge Server in your pool (if you have a pool deployed).</span></span>

4.  <span data-ttu-id="2ef0e-149">インポートした証明書を Set-CsCertificate コマンドレットで構成し、-Roll パラメーターを -EffectiveDate パラメーターと共に使用します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-149">Configure the imported certificate with the Set-CsCertificate cmdlet and use the –Roll parameter with the –EffectiveDate parameter.</span></span> <span data-ttu-id="2ef0e-150">有効日は、現在の証明書の有効期限 (14:00:00 または 2:00:00 PM) からトークン存続時間 (既定では 8 時間) を引いた値で定義します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-150">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus token lifetime (by default eight hours).</span></span> <span data-ttu-id="2ef0e-151">これにより、証明書がアクティブに設定されている必要があり、– \<EffectiveDate\>STRING: "7/22/2012 6:00:00 AM" のようになります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-151">This gives us a time that the certificate must be set to active, and is the –EffectiveDate \<string\>: “7/22/2012 6:00:00 AM”.</span></span>
    
    <div>
    

    > [!IMPORTANT]
    > <span data-ttu-id="2ef0e-152">エッジプールの場合、すべてのクライアントとコンシューマーのトークンが新しい証明書を使用して更新される前に、古い証明書の EffectiveDate パラメーターで定義された日付と時刻で、すべての AudioVideoAuthentication 証明書を展開してプロビジョニングする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-152">For an Edge pool, you must have all AudioVideoAuthentication certificates deployed and provisioned by the date and time defined by the –EffectiveDate parameter of the first certificate deployed to avoid possible A/V communications disruption due to the older certificate expiring before all client and consumer tokens have been renewed using the new certificate.</span></span>

    
    </div>
    
    <span data-ttu-id="2ef0e-153">-Roll および -EffectiveTime パラメーターを使用する Set-CsCertificate コマンドは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-153">The Set-CsCertificate command with the –Roll and –EffectiveTime parameter:</span></span>
    
        Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint <thumb print of new certificate> -Roll -EffectiveDate <date and time for certificate to become active>
    
    <span data-ttu-id="2ef0e-154">Set-CsCertificate コマンドの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-154">An example Set-CsCertificate command:</span></span>
    
        Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2012 6:00:00 AM"
    
    <div>
    

    > [!IMPORTANT]
    > <span data-ttu-id="2ef0e-p113">EffectiveDate は、サーバーの地域と言語の設定に合った形式にする必要があります。この例で使用している地域と言語の設定は英語 (米国) です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-p113">The EffectiveDate must be formatted to match your server’s region and language settings. The example uses the US English Region and Language settings</span></span>

    
    </div>

<span data-ttu-id="2ef0e-157">コンシューマーが使用中の AudioVideoAuthentication を検証するための既存の証明書をそのまま使用しながら、同時に AudioVideoAuthentication の新しいトークンを発行するための新しい証明書をステージングできるように Set-CsCertificate、-Roll、および -EffectiveDate が使用するプロセスを詳しく理解するには、時系列の図を使う方法が効果的です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-157">To further understand the process that Set-CsCertificate, -Roll, and –EffectiveDate use to stage a new certificate for issuing new AudioVideoAuthentication tokens while still using an existing certificate to validate AudioVideoAuthentication that are in use by consumers, a visual timeline is an effective means of understanding the process.</span></span>

<span data-ttu-id="2ef0e-158">次の例では、管理者は、A/V Edge サービス証明書が07/22/2012 の 2:00:00 PM に有効期限切れになっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-158">In the following example, the administrator determines that the A/V Edge service certificate is due to expire at 2:00:00 PM on 07/22/2012.</span></span> <span data-ttu-id="2ef0e-159">彼は、新しい証明書を要求して受け取り、その証明書を自分のプールの各エッジサーバーにインポートします。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-159">He requests and receives a new certificate and imports it to each Edge Server in his pool.</span></span> <span data-ttu-id="2ef0e-160">07/22/2012 の午前2時は、[ロール]、[拇印] が新しい証明書の拇印文字列と同じであり、-EffectiveTime が 07/22/2012 6:00:00 AM に設定されている Get-CsCertificate の実行を開始します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-160">At 2 AM on 07/22/2012, he begins running Get-CsCertificate with –Roll, -Thumbprint equal to the thumbprint string of the new certificate, and –EffectiveTime set to 07/22/2012 6:00:00 AM.</span></span> <span data-ttu-id="2ef0e-161">各エッジサーバーでこのコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-161">He runs this command on each Edge Server.</span></span>

<span data-ttu-id="2ef0e-162">![Roll および EffectiveDate パラメーターの使用](images/JJ660292.21d51a76-0d03-4ed7-a37e-a7c14940265f(OCS.15).jpg "Roll および EffectiveDate パラメーターの使用")</span><span class="sxs-lookup"><span data-stu-id="2ef0e-162">![Using the Roll and the EffectiveDate parameters.](images/JJ660292.21d51a76-0d03-4ed7-a37e-a7c14940265f(OCS.15).jpg "Using the Roll and the EffectiveDate parameters.")</span></span>

<span data-ttu-id="2ef0e-163">有効時間 (7/22/2012 6:00:00 AM) に達すると、新しい証明書によってすべての新しいトークンが発行されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-163">When the effective time is reached (7/22/2012 6:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="2ef0e-164">トークンを検証する場合、トークンはまず新しい証明書に照らして検証されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-164">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="2ef0e-165">検証が失敗した場合は、古い証明書が試されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-165">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="2ef0e-166">新しい証明書を試してから古い証明書にフォールバックするこのプロセスは、古い証明書の有効期限まで続きます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-166">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="2ef0e-167">古い証明書の有効期限が切れた後 (7/22/2012 2:00:00 PM)、トークンは新しい証明書でのみ検証されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-167">Once the old certificate has expired (7/22/2012 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="2ef0e-168">古い証明書は、次のように Remove-CsCertificate コマンドレットに -Previous パラメーターを指定して安全に削除できます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-168">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the –Previous parameter.</span></span>

    Remove-CsCertificate -Type AudioVideoAuthentication -Previous

</div>

<div>

## <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a-roll-and--effectivedate-parameters"></a><span data-ttu-id="2ef0e-169">–ロールと-EffectiveDate のパラメーターを使用して OAuthTokenIssuer 証明書を更新または更新するには</span><span class="sxs-lookup"><span data-stu-id="2ef0e-169">To update or renew an OAuthTokenIssuer certificate with a –Roll and -EffectiveDate parameters</span></span>

1.  <span data-ttu-id="2ef0e-170">Administrators グループのメンバーとして、ローカル コンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-170">Log on to the local computer as a member of the Administrators group.</span></span>

2.  <span data-ttu-id="2ef0e-171">A/V Edge サービス上の既存の証明書のエクスポート可能な秘密キーを使用して、更新または新しい OAuthTokenIssuer 証明書を要求します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-171">Request a renewal or new OAuthTokenIssuer certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>

3.  <span data-ttu-id="2ef0e-172">新しい OAuthTokenIssuer 証明書を、プールのフロントエンドサーバーにインポートします (プールが展開されている場合)。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-172">Import the new OAuthTokenIssuer certificate to a Front End Server in your pool (if you have a pool deployed).</span></span> <span data-ttu-id="2ef0e-173">OAuthTokenIssuer 証明書はグローバルにレプリケートされるので、展開内の任意のサーバーで更新と書き換えを行うだけで十分です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-173">The OAuthTokenIssuer certificate is replicated globally and only needs to be updated and renewed at any server in your deployment.</span></span> <span data-ttu-id="2ef0e-174">フロントエンドサーバーは例として使用されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-174">The Front End Server is used as an example.</span></span>

4.  <span data-ttu-id="2ef0e-p117">インポートした証明書を Set-CsCertificate コマンドレットで構成し、-Roll パラメーターを -EffectiveDate パラメーターと共に使用します。有効日は、現在の証明書の有効期限 (14:00:00 または 2:00:00 PM) から少なくとも 24 時間を引いた値で定義します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-p117">Configure the imported certificate with the Set-CsCertificate cmdlet and use the –Roll parameter with the –EffectiveDate parameter. The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus a minimum of 24 hours.</span></span>
    
    <span data-ttu-id="2ef0e-177">-Roll および -EffectiveTime パラメーターを使用する Set-CsCertificate コマンドは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-177">The Set-CsCertificate command with the –Roll and –EffectiveTime parameter:</span></span>
    
        Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb print of new certificate> -Roll -EffectiveDate <date and time for certificate to become active>
    
    <span data-ttu-id="2ef0e-178">Set-CsCertificate コマンドの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-178">An example Set-CsCertificate command:</span></span>
    
        Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2012 1:00:00 PM"
    
    <div>
    

    > [!IMPORTANT]
    > <span data-ttu-id="2ef0e-p118">EffectiveDate は、サーバーの地域と言語の設定に合った形式にする必要があります。この例で使用している地域と言語の設定は英語 (米国) です。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-p118">The EffectiveDate must be formatted to match your server’s region and language settings. The example uses the US English Region and Language settings</span></span>

    
    </div>

<span data-ttu-id="2ef0e-181">有効時間 (7/21/2012 1:00:00 AM) に達すると、新しい証明書によってすべての新しいトークンが発行されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-181">When the effective time is reached (7/21/2012 1:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="2ef0e-182">トークンを検証する場合、トークンはまず新しい証明書に照らして検証されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-182">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="2ef0e-183">検証が失敗した場合は、古い証明書が試されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-183">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="2ef0e-184">新しい証明書を試してから古い証明書にフォールバックするこのプロセスは、古い証明書の有効期限まで続きます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-184">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="2ef0e-185">古い証明書の有効期限が切れた後 (7/22/2012 2:00:00 PM)、トークンは新しい証明書でのみ検証されます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-185">Once the old certificate has expired (7/22/2012 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="2ef0e-186">古い証明書は、次のように Remove-CsCertificate コマンドレットに -Previous パラメーターを指定して安全に削除できます。</span><span class="sxs-lookup"><span data-stu-id="2ef0e-186">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the –Previous parameter.</span></span>

    Remove-CsCertificate -Type OAuthTokenIssuer -Previous

</div>

<div>

## <a name="see-also"></a><span data-ttu-id="2ef0e-187">関連項目</span><span class="sxs-lookup"><span data-stu-id="2ef0e-187">See Also</span></span>


[<span data-ttu-id="2ef0e-188">Lync Server 2013 でエッジ サーバー証明書を計画する</span><span class="sxs-lookup"><span data-stu-id="2ef0e-188">Plan for Edge Server certificates in Lync Server 2013</span></span>](lync-server-2013-plan-for-edge-server-certificates.md)  
[<span data-ttu-id="2ef0e-189">Lync Server 2013 でのサーバー間認証 (OAuth) とパートナーアプリケーションの管理</span><span class="sxs-lookup"><span data-stu-id="2ef0e-189">Managing server-to-server authentication (OAuth) and partner applications in Lync Server 2013</span></span>](lync-server-2013-managing-server-to-server-authentication-oauth-and-partner-applications.md)  


[<span data-ttu-id="2ef0e-190">Lync Server 2013 用のエッジ証明書のセットアップ</span><span class="sxs-lookup"><span data-stu-id="2ef0e-190">Set up Edge certificates for Lync Server 2013</span></span>](lync-server-2013-set-up-edge-certificates.md)  
<span data-ttu-id="2ef0e-191">[設定-CsCertificate](https://technet.microsoft.com/en-us/library/Gg398518(v=OCS.15))</span><span class="sxs-lookup"><span data-stu-id="2ef0e-191">[Set-CsCertificate](https://technet.microsoft.com/en-us/library/Gg398518(v=OCS.15))</span></span>  
<span data-ttu-id="2ef0e-192">[CsCertificate の削除](https://technet.microsoft.com/en-us/library/Gg412895(v=OCS.15))</span><span class="sxs-lookup"><span data-stu-id="2ef0e-192">[Remove-CsCertificate](https://technet.microsoft.com/en-us/library/Gg412895(v=OCS.15))</span></span>  
  

</div>

</div>

<span> </span>

</div>

</div>

</div>

