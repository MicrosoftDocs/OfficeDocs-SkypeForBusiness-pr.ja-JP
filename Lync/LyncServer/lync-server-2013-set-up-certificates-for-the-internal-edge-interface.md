---
title: 'Lync Server 2013: 内部エッジ インターフェイス用の証明書の設定'
TOCTitle: 内部エッジ インターフェイス用の証明書の設定
ms:assetid: a1963cc9-87c5-4935-86c0-6bedc6afd0ac
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Gg412750(v=OCS.15)
ms:contentKeyID: 48273135
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013 での内部エッジ インターフェイス用の証明書の設定

 

_**トピックの最終更新日:** 2013-11-07_


> [!IMPORTANT]
> 証明書ウィザードを実行する場合、使用する証明書テンプレートの種類に対して適切なアクセス許可が割り当てられたグループのメンバーであるアカウントを使用してログインしていることを確認してください。既定では、 Lync Server 2013 証明書要求では、Web サーバー証明書テンプレートが使用されます。RTCUniversalServerAdmins グループのメンバーであるアカウントおよびこのテンプレートを使用して証明書を要求する場合、そのテンプレートを使用するために必要な登録アクセス許可がそのグループに割り当てられていることを確認してください。



各エッジ サーバーの内部インターフェイスには、1 つの証明書が必要となります。内部インターフェイス用の証明書は、内部のエンタープライズ証明機関 (CA) またはパブリック CA が発行できます。組織に内部 CA が展開されている場合は、内部 CA を使用して内部インターフェイス用の証明書を発行することにより、パブリック証明書を使用する場合の費用を削減できます。内部の Windows Server 2008 CA または Windows Server 2008 R2 CA を使用して、これらの証明書を作成できます。

この証明書およびその他の証明書の要件の詳細については、「[Lync Server 2013 における外部ユーザー アクセスに対する証明書要件](lync-server-2013-certificate-requirements-for-external-user-access.md)」を参照してください。

サイトのエッジで、内部インターフェイス用の証明書をセットアップするには、このセクションの手順を使用して、次の操作を行います。

1.  内部インターフェイス用の CA 証明書チェーンを各エッジ サーバーにダウンロードします。

2.  各エッジ サーバーで、内部インターフェイス用の CA 証明書チェーンをインポートします。

3.  1 台のエッジ サーバー (最初のエッジ サーバー) で、内部インターフェイス用に証明書要求を作成します。

4.  最初のエッジ サーバーで、内部インターフェイス用の証明書をインポートします。

5.  このサイトの (またはこのロード バランサーの背後に展開されている) 他のエッジ サーバーで証明書をインポートします。

6.  すべてのエッジ サーバーの内部インターフェイスに証明書を割り当てます。

エッジ サーバーが展開されている複数のサイト (つまり、複数サイトのエッジ トポロジ) がある場合、または別のロード バランサーの背後に展開されている別のエッジ サーバーのセットがある場合は、エッジ サーバーがある各サイト、および別のロード バランサーの背後に展開されているエッジ サーバーの各セットに対して、これらのステップを実行する必要があります。

> [!NOTE]  
> ここでは、Windows Server 2008 CA、Windows Server 2008 R2 CA、Windows Server 2012 CA、または Windows Server 2012 R2 CA を使用して、各エッジ サーバー用の証明書を作成する手順について説明します。他の CA を使用する場合の手順については、その CA のマニュアルを参照してください。既定では、すべての認証済みユーザーが、証明書を要求するための適切なユーザー権限を持っています。<br />
> ここでは、エッジ サーバーの展開プロセスの一部として、エッジ サーバー上で証明書要求を作成する手順について説明します。フロントエンド サーバーを使用して証明書要求を作成することはできます。これは、エッジ サーバーの展開を開始する前の、計画および展開プロセスの早い段階で証明書要求を実行する場合に使用できます。これを行うには、要求する証明書がエクスポート可能な秘密キーで定義されていることを確認する必要があります。<br />
> ここでは、証明書に .cer ファイルおよび .p7b ファイルを使用する手順について説明します。別の種類のファイルを使用する場合は、必要に応じてこの手順を変更してください。


## certsrv Web サイトを使用して内部インターフェイス用の CA 証明書チェーンをダウンロードするには

1.  **Administrators** グループのメンバーとして、内部ネットワークの (つまりエッジ サーバーではない) Lync Server 2013 サーバーにログオンします。

2.  \[**スタート**\] をクリックしてから \[**ファイル名を指定して実行**\] をクリックし、コマンド プロンプトで次のように入力してコマンドを実行します。
    
        https://<name of your Issuing CA Server>/certsrv
    
    次に例を示します。
    
        https://ca01.contoso.net/certsrv
    
    > [!NOTE]
    > Windows Server 2008 または Windows Server 2008 R2 エンタープライズ CA を使用している場合は、http ではなく、https を使用する必要があります。


3.  発行元の CA の certsrv Web ページで、\[**タスクの選択**\] の \[**CA 証明書、証明書チェーン、または CRL のダウンロード**\] をクリックします。

4.  \[**CA 証明書、証明書チェーン、または CRL のダウンロード**\] の \[**CA 証明書チェーンのダウンロード**\] をクリックします。

5.  \[**ファイルのダウンロード**\] ダイアログ ボックスで \[**保存**\] をクリックします。

6.  .p7b ファイルをサーバーのハード ディスク ドライブに保存し、各エッジ サーバーのフォルダーにコピーします。
    
    > [!NOTE]
    > .p7b ファイルには、証明書パスにあるすべての証明書が含まれています。証明のパスを表示するには、サーバー証明書を開き、証明書のパスをクリックします。


## MMC を使用して内部インターフェイス用の CA 証明書チェーンをエクスポートするには

1.  Microsoft 管理コンソール (MMC) を使用して、ドメインに参加している任意のコンピューターから CA のルート証明書をエクスポートできます。\[**スタート**\] ボタン、\[**ファイル名を指定して実行**\] の順にクリックし、「**MMC**」と入力します。

2.  MMC コンソールで、\[**ファイル**\] をクリックし、\[**Add/Remove**\] (追加/削除) をクリックします。

3.  \[**スナップインの追加と削除**\] ダイアログの一覧で、\[**証明書**\] を選択し、\[**追加**\] をクリックします。メッセージが表示されたら、\[**コンピューター アカウント**\] を選択します。\[**コンピューターの選択**\] ダイアログで、\[**ローカル コンピューター**\] を選択します。\[**完了**\] をクリックします。\[**OK**\] をクリックします。

4.  \[**証明書 (ローカル コンピューター)**\] を展開します。\[**信頼されたルート証明機関**\] を展開し、\[**証明書**\] を選択します。

5.  使用している CA によって発行されたルート証明書をクリックします。その証明書を右クリックし、\[**すべてのタスク**\] を選択して、\[**エクスポート**\] を選択します。 **証明書のエクスポート ウィザード**が開きます。

6.  **証明書のエクスポート ウィザード**で、\[**次へ**\] をクリックします。

7.  \[**エクスポート ファイルの形式**\] ダイアログで、エクスポートする形式を選択します。\[**Cryptographic Message Syntax Standard - PKCS \#7 証明書 (.P7B)**\] を選択することをお勧めします。\[**Cryptographic Message Syntax Standard - PKCS \#7 証明書 (.P7B)**\] を選択した場合は、\[**証明のパスにある証明書を可能であればすべて含む**\] チェック ボックスをオンにして、ルート CA 証明書とすべての中間 CA 証明書を含む証明書チェーンをエクスポートします。\[**次へ**\] をクリックします。

8.  \[**エクスポートするファイル**\] ダイアログのファイル名のエントリに、エクスポートする証明書のパスとファイル名を入力します (既定の拡張子は .p7b)。または、\[**参照**\] をクリックして、エクスポートする証明書を配置するディレクトリを選択し、エクスポートする証明書の名前を指定します。\[**保存**\] をクリックします。\[**次へ**\] をクリックします。

9.  操作の概要を確認し、\[**完了**\] をクリックして証明書のエクスポートを完了します。エクスポートが正常に完了したら、\[**OK**\] をクリックします。

## 内部インターフェイス用の CA 証明書チェーンをインポートするには

1.  各エッジ サーバーで、Microsoft 管理コンソール (MMC) を開きます。MMC を開くには、\[**スタート**\] をクリックし、\[**ファイル名を指定して実行**\] をクリックします。次に、\[**名前**\] ボックスに「**mmc** 」と入力し、\[**OK**\] をクリックします。

2.  \[**ファイル**\] メニューの \[**スナップインの追加と削除**\] をクリックし、\[**追加**\] をクリックします。

3.  \[**スタンドアロン スナップインの追加**\] ボックスで、\[**証明書**\] をクリックし、\[**追加**\] をクリックします。

4.  \[**証明書スナップイン**\] ダイアログ ボックスの \[**コンピューター アカウント**\] をクリックし、\[**次へ**\] をクリックします。

5.  \[**コンピューターの選択**\] ダイアログ ボックスで、\[**ローカル コンピューター: (このコンソールを実行しているコンピューター)**\] チェック ボックスがオンになっていることを確認して、\[**完了**\] をクリックします。

6.  \[**閉じる**\] をクリックし、\[**OK**\] をクリックします。

7.  コンソール ツリーで、\[**証明書 (ローカル コンピューター)**\] を展開し、\[**信頼されたルート証明機関**\] を右クリックし、\[**すべてのタスク**\] をポイントして、\[**インポート**\] をクリックします。

8.  ウィザードの \[**インポートするファイル**\] で、証明書のファイル名 (前の手順で、内部インターフェイス用の CA 証明書チェーンをダウンロードしたときに指定した名前) を指定します。

9.  各エッジ サーバーでこの手順を繰り返します。

## 内部インターフェイスの証明書要求を作成するには

1.  いずれかのエッジ サーバーで、展開ウィザードを起動し、\[**手順 3: 証明書の要求、インストール、または割り当て**\] の横にある \[**実行**\] をクリックします。
    
    > [!NOTE]  
    > プールの 1 つの場所に複数のエッジ サーバーが展開されている場合には、いずれかのエッジ サーバー上で証明書ウィザードを実行できます。<br />
    > 手順 3. を初めて実行すると、ボタンの表示が [<strong>再実行</strong>] に変わり、必要なすべての証明書の要求、インストール、および割り当てが完了するまで、タスクが正常に完了したことを示す緑のチェック マークは表示されません。


2.  \[**利用可能な証明書タスク**\] ページで、\[**新しい証明書要求を作成する**\] をクリックします。

3.  \[**証明書要求**\] ページで \[**次へ**\] をクリックします。

4.  \[**要求を後で送信または今すぐ送信**\] ページで、\[**要求を準備して後で送信する**\] をクリックします。

5.  \[**証明書要求ファイル**\] ページで、要求の保存先の完全なパスとファイル名 ( **c:\\cert\_internal\_edge.cer** など) を入力します。

6.  \[**代替証明書テンプレートの指定**\] ページで、既定の WebServer テンプレート以外のテンプレートを使用するには、\[**選択した証明機関に別の証明書テンプレートを使用する**\] チェック ボックスをオンにします。

7.  \[**名前およびセキュリティの設定**\] ページで、次の操作を行います。
    
      - \[**フレンドリ名**\] で、証明書の表示名 (Internal Edge など) を入力します。
    
      - \[**ビット長**\] で、ビット長を指定します (通常は既定値の \[**2048**\])。
        
        > [!NOTE]  
        > ビット長は長いほどセキュリティが高くなりますが、処理速度に悪影響を及ぼします。
    
      - 証明書のエクスポートを可能にする必要がある場合は、\[**証明書の秘密キーをエクスポート可能としてマークする**\] チェック ボックスをオンにします。

8.  \[**組織情報**\] ページで、組織の名前と組織単位 (OU) (部や課など) を入力します。

9.  \[**地理情報**\] ページで、場所情報を指定します。

10. \[**サブジェクト名/サブジェクト代替名**\] ページに、ウィザードによって自動的に設定される情報が表示されます。

11. \[**追加のサブジェクト代替名の構成**\] ページで、必要な追加のサブジェクトの別名を指定します。

12. \[**要求の概要\]** ページで、要求の生成に使用される証明書情報を確認します。

13. コマンドが完了したら、次の操作を行います。
    
      - 証明書要求のログを表示するには、\[**ログの表示**\] をクリックします。
    
      - 証明書要求を完了するには、\[**次へ**\] をクリックします。

14. \[**証明書要求ファイル**\] ページで、次の操作を行います。
    
      - 生成した証明書の署名要求 (CSR) ファイルを表示するには、\[**表示**\] をクリックします。
    
      - ウィザードを閉じるには、\[**完了**\] をクリックします。

15. 電子メールまたはご使用のエンタープライズ CA の組織でサポートされている他の方法で、このファイルを CA に送信し、応答ファイルを受信したら、新しい証明書をこのコンピューターにコピーし、インポートできるようにします。

## 内部インターフェイス用の証明書をインポートするには

1.  証明書要求を作成したエッジ サーバーに、ローカルの Administrators グループのメンバーとしてログオンします。

2.  展開ウィザードで、\[**手順 3: 証明書の要求、インストール、または割り当て**\] の横にある \[**再実行**\] をクリックします。
    
    手順 3. を初めて実行すると、ボタンの表示が \[**再実行**\] に変わりますが、必要なすべての証明書の要求、インストール、および割り当てが完了するまで、タスクが正常に完了したことを示す緑のチェック マークは表示されません。

3.  \[**利用可能な証明書タスク**\] ページで、\[**.P7b, .pfx、または .cer ファイルから証明書をインポートする**\] をクリックします。

4.  \[**証明書のインポート**\] ページで、このエッジ サーバーの内部インターフェイス用に要求して受信した証明書の完全なパスおよびファイル名を入力します (または、\[**参照**\] をクリックし、ファイルを探して選択します)。

5.  プールの他のメンバーに対して秘密キーが含まれた証明書をインポートする場合は、\[**証明書ファイルは証明書の秘密キーを含む**\] チェック ボックスをオンにしてパスワードを指定します。

## プール内のエッジ サーバー用の証明書と秘密キーをエクスポートするには

1.  証明書をインポートしたのと同じエッジ サーバーに、Administrators グループのメンバーとしてログオンします。

2.  \[**スタート**\] ボタン、\[**ファイル名を指定して実行**\] の順にクリックし、「**MMC** 」と入力します。

3.  MMC コンソールで、\[**ファイル**\] をクリックし、\[**スナップインの追加と削除**\] をクリックします。

4.  \[スナップインの追加と削除\] ページで、\[**証明書**\] をクリックし、\[**追加**\] をクリックします。

5.  \[証明書スナップイン\] ダイアログ ボックスで、\[**コンピューター アカウント**\] を選択します。\[**次へ**\] をクリックします。\[コンピューターの選択\] で、\[**ローカル コンピューター: (このコンソールを実行しているコンピューター)**\] を選択します。\[**完了**\] をクリックします。\[**OK**\] をクリックして MMC コンソールの構成を完了します。

6.  \[**証明書 (ローカル コンピューター)**\] をダブルクリックして証明書ストアを展開します。\[**個人**\] をダブルクリックし、\[**証明書**\] をダブルクリックします。
    

    > [!IMPORTANT]
    > ローカル コンピューターの個人の証明書ストアに証明書がない場合は、インポートした証明書に秘密キーが関連付けられていません。要求とインポートの手順を再確認してください。問題が解決しない場合は、証明機関の管理者またはプロバイダーに問い合わせてください。



7.  ローカル コンピューターの個人の証明書ストアで、エクスポートする証明書を右クリックします。\[**すべてのタスク**\] をクリックし、\[**エクスポート**\] をクリックします。

8.  証明書のエクスポート ウィザードで、\[**次へ**\] をクリックします。\[**はい、秘密キーをエクスポートします**\] を選択します。\[**次へ**\] をクリックします。
    
    > [!NOTE]
    > [<strong>はい、秘密キーをエクスポートします</strong>] が無効になっていて選択できない場合、この証明書に関連付けられている秘密キーはエクスポート可能になっていません。エクスポートを続行するには、その前に証明書を再度要求して、証明書の秘密キーをエクスポート可能としてマークする必要があります。証明機関の管理者またはプロバイダーに問い合わせてください。


9.  \[エクスポート ファイルの形式\] ダイアログ ボックスで、\[**Personal Information Exchange - PKCS \#12 (.PFX)**\] を選択し、以下の項目をオンにします。
    
      - 可能であれば、証明書パスにあるすべての証明書を含める
    
      - すべての拡張プロパティをエクスポートする
        

        > [!WARNING]
        > エッジ サーバーから証明書をエクスポートするとき、[<STRONG>正しくエクスポートされたときは秘密キーを削除する</STRONG>] をオンにしないでください。このオプションをオンにすると、このエッジ サーバーに証明書と秘密キーをインポートすることが必要になります。

    
    \[**次へ**\] をクリックして続行します。

10. 秘密キーを保護するためのパスワードを割り当てる場合は、秘密キーのパスワードを入力します。確認のために再度パスワードを入力します。\[**次へ**\] をクリックします。

11. エクスポートする証明書のパスとファイル名を入力し、ファイル拡張子に .pfx を指定します。このパスは、プール内の他のすべてのエッジ サーバーからアクセスできるパスにするか、USB フラッシュ ドライブなどリムーバブル メディアを使用して転送可能にする必要があります。\[**次へ**\] をクリックします。

12. \[証明書のエクスポート ウィザードの完了\] ダイアログ ボックスで概要を確認します。\[**完了**\] をクリックします。

13. エクスポートの成功を示すダイアログ ボックスが表示されたら、\[**OK**\] をクリックします。

14. 「[Lync Server 2013 外部エッジ インターフェイスの証明書の設定](lync-server-2013-set-up-certificates-for-the-external-edge-interface.md)」に記載された手順に従って、エクスポートした証明書ファイルを他のエッジ サーバーにインポートします。

## エッジ サーバーに内部証明書を割り当てるには

1.  各エッジ サーバーの展開ウィザードで、\[**手順 3: 証明書の要求、インストール、または割り当て**\] の横にある \[**再実行**\] をクリックします。

2.  \[**利用可能な証明書タスク**\] ページで、\[**既存の証明書を割り当てる**\] をクリックします。

3.  \[**証明書の割り当て**\] ページで、一覧から \[**エッジ内部**\] を選択します。

4.  \[**証明書ストア**\] ページで、内部エッジに対してインポートする証明書を選択します (前の手順を参照)。

5.  \[**証明書割り当ての概要**\] ページで設定を確認し、\[**次へ**\] をクリックして証明書を割り当てます。

6.  ウィザードの完了ページで \[**完了**\] をクリックします。

7.  この手順を使用して内部エッジの証明書を割り当てたら、各サーバーで証明書スナップインを開き、\[**証明書 (ローカル コンピューター)**\]、\[**個人**\] を順に展開して、\[**証明書**\] をクリックします。次に、詳細ウィンドウで、内部エッジの証明書が一覧にあることを確認します。

8.  展開に複数のエッジ サーバーが含まれる場合は、各エッジ サーバーでこの手順を繰り返します。

