---
title: 'Lync Server 2013: 内部エッジ インターフェイス用の証明書の設定'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Set up certificates for the internal edge interface
ms:assetid: a1963cc9-87c5-4935-86c0-6bedc6afd0ac
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg412750(v=OCS.15)
ms:contentKeyID: 48184949
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: ea6e462bdc629308493799c857ecb6b2434dc268
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/04/2020
ms.locfileid: "41732267"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="set-up-certificates-for-the-internal-edge-interface-in-lync-server-2013"></a>Lync Server 2013 での内部エッジ インターフェイス用の証明書の設定

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**最終更新日:** 2013-11-07_

<div>


> [!IMPORTANT]  
> 証明書ウィザードを実行するときは、使用する証明書テンプレートの種類に対して適切な権限が割り当てられているグループのメンバーであるアカウントを使用してログインしていることを確認します。 既定では、Lync Server 2013 証明書の要求では、Web サーバー証明書テンプレートが使用されます。 RTCUniversalServerAdmins グループのメンバーであるアカウントを使用して、このテンプレートを使用して証明書を要求する場合は、そのテンプレートを使用するために必要な登録権限がグループに割り当てられていることを確認します。



</div>

各エッジサーバーの内部インターフェイスには1つの証明書が必要です。 内部インターフェイスの証明書は、社内のエンタープライズ証明機関 (CA) またはパブリック CA によって発行できます。 組織で内部 CA が展開されている場合は、内部 CA を使って内部インターフェイスの証明書を発行することによって、公開証明書を使用する経費を節約できます。 内部の Windows Server 2008 CA または Windows Server 2008 R2 CA を使って、これらの証明書を作成することができます。

このような証明書の要件の詳細については、「 [Lync Server 2013 の外部ユーザーアクセスの証明書の要件](lync-server-2013-certificate-requirements-for-external-user-access.md)」を参照してください。

サイトで内部エッジインターフェイスで証明書を設定するには、このセクションの手順を使用して、次の操作を行います。

1.  各エッジサーバーに、内部インターフェイス用の CA 認定チェーンをダウンロードします。

2.  各エッジサーバー上で、内部インターフェイスの CA 認定チェーンをインポートします。

3.  1台のエッジサーバー上で、最初のエッジサーバーと呼ばれる内部インターフェイスの証明書要求を作成します。

4.  第1エッジサーバー上の内部インターフェイスの証明書をインポートします。

5.  このサイトの他のエッジサーバー (またはこのロードバランサーの背後に展開されたもの) に証明書をインポートします。

6.  各エッジサーバーの内部インターフェイス用の証明書を割り当てます。

エッジサーバー (複数サイトエッジトポロジ) を持つ複数のサイトがある場合、または別のロードバランサーの背後に展開されているエッジサーバーのセットを個別に使用している場合は、エッジサーバーを持つサイトとエッジサーバーのセットごとに、次の手順に従う必要があります。別のロードバランサーの背後に展開されます。

<div>


> [!NOTE]  
> このセクションの手順は、Windows Server&nbsp;2008 Ca、windows server&nbsp;2008&nbsp;R2 ca、windows Server 2012 CA、または windows server 2012 R2 Ca を使用して、エッジサーバーごとに証明書を作成する方法について説明します。 その他の CA のステップバイステップガイドについては、その CA のマニュアルを参照してください。 既定では、認証されたすべてのユーザーは、証明書を要求するための適切なユーザー権利を持っています。<BR>このセクションの手順は、エッジサーバー展開プロセスの一部としてエッジサーバー上で証明書要求を作成することに基づいています。 フロントエンドサーバーを使用して証明書要求を作成することができます。 この操作を行うと、エッジサーバーの展開を開始する前に、計画および展開プロセスの早い段階で証明書の要求を完了することができます。 これを行うには、要求する証明書が、エクスポート可能な秘密キーを使って定義されていることを確認する必要があります。<BR>このセクションの手順では、証明書の .cer ファイルと. p7b ファイルの使い方について説明します。 別の種類のファイルを使用する場合は、必要に応じて次の手順を変更します。



</div>

<div>

## <a name="to-download-the-ca-certification-chain-for-the-internal-interface-using-certsrv-web-site"></a>Certsrv Web サイトを使用して内部インターフェイスの CA 証明チェーンをダウンロードするには

1.  内部ネットワーク (エッジサーバーではなく) の Lync Server 2013 サーバーに、**管理者**グループのメンバーとしてログオンします。

2.  [**スタート**] ボタンをクリックし、[**実行**] をクリックして、次のように入力して、コマンドプロンプトで次のコマンドを実行します。
    
        https://<name of your Issuing CA Server>/certsrv
    
    次に例を示します。
    
        https://ca01.contoso.net/certsrv
    
    <div>
    

    > [!NOTE]  
    > Windows Server 2008 または Windows Server 2008 R2 enterprise CA を使用している場合は、http ではなく https を使用する必要があります。

    
    </div>

3.  発行元の CA の certsrv Web ページで、[**タスクの選択**] の [**CA 証明書、証明書チェーン、または CRL のダウンロード**] をクリックします。

4.  **Ca 証明書、証明書チェーン、または CRL をダウンロードする**には、[ **ca 証明書チェーンのダウンロード**] をクリックします。

5.  [**ファイルのダウンロード**] ダイアログボックスで、[**保存**] をクリックします。

6.  サーバー上のハードディスクドライブに. p7b ファイルを保存して、各エッジサーバー上のフォルダーにコピーします。
    
    <div>
    

    > [!NOTE]  
    > . P7b ファイルには、証明パス内のすべての証明書が含まれます。 証明のパスを表示するには、サーバー証明書を開き、証明のパスをクリックします。

    
    </div>

</div>

<div>

## <a name="to-export-the-ca-certification-chain-for-the-internal-interface-using-mmc"></a>MMC を使用して内部インターフェイスの CA 証明チェーンをエクスポートするには

1.  Microsoft 管理コンソール (MMC) を使って、任意のドメインに参加しているコンピューターから CA ルート証明書をエクスポートすることができます。 [**スタート**] をクリックし、[**実行**] をクリックして、「 **MMC**」と入力します。

2.  MMC コンソールで、[**ファイル**] をクリックし、[**追加と削除**] をクリックします。

3.  [スナップインの**追加または削除**] ダイアログボックスで、[**証明書**] を選択し、[**追加**] をクリックします。 メッセージが表示されたら、[**コンピューターアカウント**] を選択します。 [**コンピューターの選択**] ダイアログで、[**ローカル コンピューター**] を選択します。 [**完了**] をクリックします。 **[OK]** をクリックします。

4.  [**証明書 (ローカルコンピューター)**] を展開します。 [**信頼されたルート証明機関**] を展開し、[**証明書**] を選択します。

5.  使用している CA によって発行されたルート証明書をクリックします。 証明書を右クリックし、[**すべてのタスク**] を選択して、[**エクスポート**] を選択します。 **証明書のエクスポートウィザード**が開きます。

6.  **証明書のエクスポート ウィザード**で、[**次へ**] をクリックします。

7.  [**エクスポートファイルの形式**] ダイアログボックスで、エクスポート先の形式を選択します。 **暗号化メッセージ構文標準– PKCS \#7 証明書 () をお勧めします。P7B)**。 **暗号化メッセージ構文標準– PKCS \#7 証明書 (.P7B)** で、[証明の**パスにすべての証明書を含める**] チェックボックスをオンにして、ルート ca 証明書や中間 CA 証明書などの証明書チェーンをエクスポートします。 [ **次へ**] をクリックします。

8.  [**エクスポートするファイル**] ダイアログボックスの [ファイル名] エントリに、エクスポートされた証明書のパスとファイル名 (既定の拡張子は. p7b) を入力します。 必要に応じて [**参照**] をクリックし、エクスポートされた証明書を配置するディレクトリを見つけて、エクスポートされた証明書の名前を指定します。 **[保存]** をクリックします。 [ **次へ**] をクリックします。

9.  操作の概要を確認し、[**完了**] をクリックして、証明書のエクスポートを完了します。 エクスポートが正常に完了したら、[**OK**] をクリックします。

</div>

<div>

## <a name="to-import-the-ca-certification-chain-for-the-internal-interface"></a>内部インターフェイスの CA 証明チェーンをインポートするには

1.  各エッジサーバーで、[**スタート**] をクリックし、[**実行**] をクリックして、[**開く**] ボックスに「 **MMC** 」と入力し、[ **OK]** をクリックして、Microsoft 管理コンソール (MMC) を開きます。

2.  [**ファイル**] メニューで、[スナップインの**追加と削除**] をクリックし、[**追加**] をクリックします。

3.  [**スタンドアロンスナップ**インの追加] ボックスで、[**証明書**] をクリックし、[**追加**] をクリックします。

4.  [**証明書スナップイン**] ダイアログ ボックスの [**コンピューター アカウント**] をクリックし、[**次へ**] をクリックします。

5.  **[コンピューターの選択**] ダイアログボックスで、[**ローカルコンピューター (このコンソールが実行されているコンピューター)** ] チェックボックスがオンになっていることを確認して、[**完了**] をクリックします。

6.  [**閉じる**] をクリックし、[ **OK**] をクリックします。

7.  コンソールツリーで、[**証明書 (ローカルコンピューター)**] を展開し、[**信頼されたルート証明機関**] を右クリックし、[**すべてのタスク**] をポイントして、[**インポート**] をクリックします。

8.  ウィザードの [**インポートするファイル**] で、証明書のファイル名を指定します (これは、前の手順で、内部インターフェイスの CA 認定チェーンをダウンロードしたときに指定した名前です)。

9.  各エッジサーバーに対してこの手順を繰り返します。

</div>

<div>

## <a name="to-create-the-certificate-request-for-the-internal-interface"></a>内部インターフェイスの証明書の要求を作成するには

1.  エッジサーバーのいずれかで、展開ウィザードを開始し、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [**実行**] をクリックします。
    
    <div>
    

    > [!NOTE]  
    > プール内の1つの場所に複数のエッジサーバーがある場合は、いずれかのエッジサーバーで証明書ウィザードを実行することができます。<BR>手順3を初めて実行した後は、ボタンが<STRONG>もう一度実行</STRONG>され、すべての証明書が要求、インストール、割り当てられるまで、タスクが正常に完了したことを示す緑色のチェックマークが表示されません。

    
    </div>

2.  [**利用可能な証明書タスク**] ページで、[**新しい証明書要求を作成する**] をクリックします。

3.  [**証明書の要求**] ページで、[**次へ**] をクリックします。

4.  [**要求を後で送信または今すぐ送信**] ページで、[**要求を準備して後で送信する**] をクリックします。

5.  [**証明書の要求ファイル**] ページで、要求の保存先の完全なパスとファイル名を入力します (たとえば、 **c\_:\_\\cert の内部エッジ. .cer**)。

6.  [**代替証明書テンプレートの指定**] ページで、既定の web サーバテンプレート以外のテンプレートを使用するには、[**選択した証明機関に別の証明書テンプレートを使用**する] チェックボックスをオンにします。

7.  [**名前とセキュリティの設定**] ページで、次の操作を行います。
    
      - [**フレンドリ名**] に、証明書の表示名 (内部エッジなど) を入力します。
    
      - **ビット長**では、ビット長 (通常は**2048**の既定値) を指定します。
        
        <div>
        

        > [!NOTE]  
        > ビット長を高くするとセキュリティが向上しますが、速度に悪影響を及ぼす可能性があります。

        
        </div>
    
      - 証明書をエクスポート可能にする必要がある場合は、[**証明書の秘密キーをエクスポート可能としてマーク**する] チェックボックスをオンにします。

8.  [**組織の情報**] ページで、組織の名前と組織単位 (OU) を入力します (たとえば、部門または部門)。

9.  [**地理情報**] ページで、場所情報を指定します。

10. [ **Subject Name/Subject name** ] ページには、ウィザードによって自動的に入力される情報が表示されます。

11. [**追加のサブジェクト代替名の構成**] ページで、必要なその他のサブジェクトの代替名を指定します。

12. [**要求の概要**] ページで、要求を生成するために使用される証明書情報を確認します。

13. コマンドが完了したら、次の操作を行います。
    
      - 証明書要求のログを表示するには、[**ログの表示**] をクリックします。
    
      - 証明書の要求を完了するには、[**次へ**] をクリックします。

14. [**証明書要求ファイル**] ページで、次の操作を行います。
    
      - 生成された証明書署名要求 (CSR) ファイルを表示するには、[**表示**] をクリックします。
    
      - ウィザードを閉じるには、[**完了**] をクリックします。

15. このファイルを CA (企業の組織でサポートされているメールまたはその他の方法で) に送信し、応答ファイルを受信したら、新しい証明書をこのコンピューターにコピーして、インポートできるようにします。

</div>

<div>

## <a name="to-import-the-certificate-for-the-internal-interface"></a>内部インターフェイスの証明書をインポートするには

1.  ローカル管理者グループのメンバーとして証明書要求を作成したエッジサーバーにログオンします。

2.  展開ウィザードで、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [実行] を**もう一度**クリックします。
    
    手順3を初めて実行した後は、ボタンが**もう一度実行**されますが、必須の証明書が要求、インストール、割り当てられるまで緑のチェックマークは表示されません。

3.  [**利用可能な証明書タスク**] ページで、[ **a から証明書をインポートする] をクリックします。P7b、.pfx、.cer のいずれかのファイル**。

4.  [**証明書のインポート**] ページで、このエッジサーバーの内部インターフェイスに対して要求された証明書の完全パスとファイル名を入力します (または、[**参照**] をクリックして、ファイルを見つけて選択します)。

5.  プールの他のメンバーの証明書をインポートする場合は、秘密キーを含む証明書を [**証明書ファイルを含む**] チェックボックスをオンにして、パスワードを指定します。

</div>

<div>

## <a name="to-export-the-certificate-with-the-private-key-for-edge-servers-in-a-pool"></a>プール内のエッジサーバーの秘密キーを使って証明書をエクスポートするには

1.  証明書をインポートしたのと同じエッジサーバーに、管理者グループのメンバーとしてログオンします。

2.  [**スタート**] をクリックし、[**実行**] をクリックして、「 **MMC**」と入力します。

3.  MMC コンソールで、[**ファイル**] をクリックし、[**スナップインの追加と削除**] をクリックします。

4.  [スナップインの追加または削除] ページで、[**証明書**] をクリックし、[**追加**] をクリックします。

5.  [証明書] スナップインダイアログボックスで、[**コンピューターアカウント**] を選択します。 [ **次へ**] をクリックします。 [コンピューターの選択] で、[**ローカルコンピューター] (このコンソールが実行されているコンピューター)** を選択します。 [**完了**] をクリックします。 [ **OK** ] をクリックして、MMC コンソールの構成を完了します。

6.  [**証明書 (ローカルコンピューター)** ] をダブルクリックして、証明書ストアを展開します。 [**個人用**] をダブルクリックし、[**証明書**] をダブルクリックします。
    
    <div>
    

    > [!IMPORTANT]  
    > ローカルコンピューターの証明書の個人用ストアに証明書がない場合は、インポートされた証明書に関連付けられた秘密キーがありません。 要求とインポートの手順を確認します。 問題が解決しない場合は、証明機関の管理者またはプロバイダーにお問い合わせください。

    
    </div>

7.  ローカルコンピューターの証明書の個人用ストアで、エクスポートする証明書を右クリックします。 [**すべてのタスク**] をクリックし、[**エクスポート**] をクリックします。

8.  証明書のエクスポートウィザードで、[**次へ**] をクリックします。 [**はい、秘密キーをエクスポートします**] を選択します。 [**次へ**] をクリックします。
    
    <div>
    

    > [!NOTE]  
    > <STRONG>[はい、秘密キーをエクスポート</STRONG>します] を選択できない場合は、この証明書に関連付けられている秘密キーがエクスポート対象としてマークされていません。 エクスポートを続行する前に、証明書が秘密キーのエクスポートを許可するようにマークされていることを確認して、証明書をもう一度要求する必要があります。 証明機関の管理者またはプロバイダーにお問い合わせください。

    
    </div>

9.  [エクスポートファイルの形式] ダイアログボックスで、[ **Personal Information\#Exchange – PKCS 12 ()] を選びます。PFX)** を選び、次のように選択します。
    
      - 可能であれば証明のパスにすべての証明書を含める
    
      - すべての拡張プロパティをエクスポートする
        
        <div>
        

        > [!WARNING]  
        > エッジサーバーから証明書をエクスポートするときに、<STRONG>エクスポートが正常に完了した場合は、[秘密キーの削除</STRONG>] を選択しないでください。 このオプションを選択すると、証明書と秘密キーをこのエッジサーバーにインポートする必要があります。

        
        </div>
    
    [**次へ**] をクリックして続行します。

10. 秘密キーを保護するためにパスワードを割り当てる場合は、秘密キーのパスワードを入力します。 確認のためにパスワードを再入力します。 [ **次へ**] をクリックします。

11. エクスポートする証明書のパスとファイル名を入力し、ファイル拡張子に .pfx を指定します。 パスは、プール内の他のすべてのエッジサーバーからアクセス可能であるか、またはリムーバブルメディア (USB フラッシュドライブなど) を使用して転送できるものである必要があります。 [ **次へ**] をクリックします。

12. [証明書のエクスポートウィザードを完了します] ダイアログボックスの概要を確認します。 [**完了**] をクリックします。

13. エクスポートの成功を示すダイアログ ボックスが表示されたら、[**OK**] をクリックします。

14. 「 [Lync 2013 Server の外部エッジインターフェイスの証明書を設定](lync-server-2013-set-up-certificates-for-the-external-edge-interface.md)する」の手順に従って、エクスポートされた証明書ファイルを他のエッジサーバーにインポートします。

</div>

<div>

## <a name="to-assign-the-internal-certificate-on-the-edge-servers"></a>エッジサーバーで内部証明書を割り当てるには

1.  各エッジサーバーの展開ウィザードで、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [実行] を**もう一度**クリックします。

2.  [**利用可能な証明書タスク**] ページで、[**既存の証明書を割り当てる**] をクリックします。

3.  [**証明書の割り当て**] ページで、一覧から [**エッジ内部**] を選択します。

4.  [**証明書ストア**] ページで、(前の手順で) 内部境界にインポートした証明書を選びます。

5.  [**証明書の割り当ての概要**] ページで、設定を確認し、[**次へ**] をクリックして証明書を割り当てます。

6.  ウィザードの完了ページで [**完了**] をクリックします。

7.  この手順を使用して内部エッジ証明書を割り当てると、各サーバーで証明書スナップインを開き、[**証明書 (ローカルコンピューター)**]、[**個人用**]、[**証明書**] の順に展開して、内部エッジ証明書が一覧表示されている詳細ウィンドウで確認します。

8.  展開に複数のエッジサーバーが含まれている場合は、各エッジサーバーに対してこの手順を繰り返します。

</div>

</div>

<span> </span>

</div>

</div>

</div>

