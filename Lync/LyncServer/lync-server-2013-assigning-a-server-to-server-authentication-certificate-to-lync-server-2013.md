---
title: サーバー間の認証証明書の Microsoft Lync Server 2013 への割り当て
TOCTitle: サーバー間の認証証明書の Microsoft Lync Server 2013 への割り当て
ms:assetid: c7413954-2504-47f4-a073-44548aff1c0c
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/JJ205253(v=OCS.15)
ms:contentKeyID: 48273556
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# サーバー間の認証証明書の Microsoft Lync Server 2013 への割り当て

 

_**トピックの最終更新日:** 2013-10-24_

サーバー対サーバーの認証の証明書が Microsoft Lync Server 2013 に割り当てられているかどうかを判別するには、Lync Server 2013 管理シェルから次のコマンドを実行します。

    Get-CsCertificate -Type OAuthTokenIssuer

証明書情報が返されない場合、サーバー対サーバーの認証を使用するためには、その前にトークン発行元の証明書を割り当てる必要があります。一般に、Lync Server 2013 の証明書はユーザーの OAuthTokenIssuer 証明書として使用できます。たとえば、Lync Server 2013 の既定の証明書は OAuthTokenIssuer 証明書としても使用できます (OAUthTokenIssuer 証明書は、Subject フィールドにユーザーの SIP ドメイン名を含む Web サーバー証明書にもなります)。サーバー対サーバーの認証に使用する証明書に関する 2 つの主な要件は次のとおりです。1) すべてのフロントエンド サーバーで同じ証明書を OAuthTokenIssuer 証明書として構成する必要があります。2) 証明書は最低 2048 ビットでなければなりません。

サーバー対サーバーの認証に使用できる証明書がない場合は、新しい証明書をインポートして、その証明書をサーバー対サーバーの認証に使用します。新しい証明書を要求して取得した後で、フロントエンド サーバーのどれかにログオンし、次のような Windows PowerShell コマンドを使用して証明書をインポートして割り当てます。

    Import-CsCertificate -Identity global -Type OAuthTokenIssuer -Path C:\Certificates\ServerToServerAuth.pfx  -Password "P@ssw0rd"

前述のコマンドの Path パラメーターは、証明書ファイルへの完全なパスを表し、Password パラメーターは、その証明書に割り当てられたパスワードを表します。この手順は、1 回だけ実行します。Lync Server のレプリケーション サービスが自動的に作成する一連のスケジュールされたタスクによって、証明書が復号化されてすべてのフロントエンド サーバーに展開されます。

または、既存の証明書をサーバー対サーバーの認証の証明書として使用することもできます (前述したように、既定の証明書をサーバー対サーバーの認証の証明書として使用できます)。次の 2 つの Windows PowerShell コマンドを実行すると、既定の証明書の Thumbprint プロパティの値が取得され、その値を使用して、既定の証明書がサーバー対サーバーの認証の証明書として設定されます。

    $x = (Get-CsCertificate -Type Default).Thumbprint
    Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x

1 つ目のコマンドでは、取得された証明書がグローバルなサーバー対サーバーの認証の証明書として機能するように構成されます。つまり、その証明書はすべてのフロントエンド サーバーにレプリケートされ、使用されます。この場合も、このコマンドはいずれかのフロントエンド サーバーで 1 回だけ実行します。すべてのフロントエンド サーバーで同じ証明書を使用する必要がありますが、各フロントエンド サーバーで OAuthTokenIssuer 証明書を構成する必要はありません。そうではなく、証明書を 1 回構成し、Lync Server のレプリケーション サーバーに各サーバーに対して証明書をコピーさせます。

Set-CsCertificate コマンドレットは、当該の証明書を取得して、即座にその証明書を現在の OAuthTokenIssuer 証明書として機能するように構成します (Lync Server 2013 は 1 つの証明書の種類について、現在の証明書と以前の証明書という 2 つのコピーを保持します)。新しい証明書を即座に OAuthTokenIssuer 証明書として使用開始するには、Set-CsCertificate コマンドレットを使用してください。

Set-CsCertificate コマンドレットを使用して、新しい証明書を "ロール" することもできます。証明書の "ロール" とは、指定した時点から新しい証明書を現在の OAuthTokenIssuer 証明書にするように構成することを意味します。たとえば、次のコマンドを実行すると、既定の証明書が取得してから、2012 年 7 月 1 日付けでその証明書が現在の OAuthTokenIssuer 証明書になるように構成します。

    $x = (Get-CsCertificate -Type Default).Thumbprint
    Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x -EffectiveDate "7/1/2012" -Roll

2012 年 7 月 1 日になると、新しい証明書が現在の OAuthTokenIssuer 証明書として構成され、"古い" OAuthTokenIssuer 証明書は以前の証明書として構成されます。

Windows PowerShell を使用したくない場合は、証明書 MMC コンソールを使用して 1 台のフロントエンド サーバーから証明書をエクスポートしてから、同じ証明書を他のすべてのフロントエンド サーバーにインポートします。これを行う場合は、証明書とともに秘密キーを必ずエクスポートしてください。


> [!TIP]
> この場合、この手順を各フロントエンド サーバーで実行する必要があります。この方法で証明書のエクスポートとインポートを行う場合、Lync Server 2013 は各フロントエンド サーバーにその証明書をレプリケートしません。



すべてのフロントエンド サーバーに証明書がインポートされたら、Windows PowerShell ではなく Lync Server 展開ウィザードを使用して証明書を割り当てることができます。展開ウィザードを使用して証明書を割り当てるには、展開ウィザードがインストールされているコンピューターで以下の手順を実行します。

1.  \[スタート\]、\[すべてのプログラム\]、\[**Microsoft Lync Server 2013**\]、\[**Lync Server 展開ウィザード**\] の順にクリックします。

2.  展開ウィザードで、\[**Lync Server システムのインストールまたは更新**\] をクリックします。

3.  \[Microsoft Lync Server 2013\] ページで、\[**ステップ 3: 証明書の要求、インストール、または割り当て**\] の見出しの下にある \[**実行**\] ボタンをクリックします (注: そのコンピューターに証明書をインストールしたことがある場合は、\[**実行**\] ボタンのラベルは \[**再実行**\] になります)。

4.  証明書ウィザードで、**OAuthTokenIssuer** 証明書を選択してから \[**割り当て**\] をクリックします。

5.  証明書の割り当てウィザードの \[**証明書の割り当て**\] ページで、\[**次へ**\] をクリックします。

6.  \[**証明書ストア**\] ページで、サーバー対サーバーの認証に使用する証明書を選択して \[**次へ**\] をクリックします。

7.  \[証明書の割り当ての概要\] ページで、\[**次へ**\] をクリックします。

8.  \[コマンドを実行しています\] ページで、\[**完了**\] をクリックします。

9.  証明書ウィザードと展開ウィザードを閉じます。

