---
title: Lync Server 2013 の XMPP ゲートウェイの構成
TOCTitle: Lync Server 2013 の XMPP ゲートウェイの構成
ms:assetid: c70282e0-b502-47e2-a0be-a32eb1faf99d
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/JJ721881(v=OCS.15)
ms:contentKeyID: 49887139
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013 の XMPP ゲートウェイの構成

 

_**トピックの最終更新日:** 2013-10-28_

XMPP ゲートウェイに移行するための最後の手順は、 Lync Server 2013 エッジ サーバーの証明書の構成、 Lync Server 2013 XMPP ゲートウェイの展開、および XMPP ゲートウェイの DNS レコードの更新です。これらの手順は、XMPP ゲートウェイのダウン タイムを最小限に抑えるために、並行して実行します。これらの手順を実行する前に、すべてのユーザーを Microsoft Lync Server 2013 展開に移動する必要があります。


> [!IMPORTANT]
> XMPP フェデレーションは、存続可能ブランチ アプライアンスに所属するユーザーに対してサポートされません。このことは、プレゼンス情報の表示と IM メッセージの交換の両方に当てはまります。



## Lync Server 2013 エッジ サーバーで XMPP ゲートウェイの証明書を構成する

1.  エッジ サーバーで、展開ウィザードの \[**手順 3: 証明書の要求、インストール、または割り当て**\] の横にある \[**再実行**\] をクリックします。
    

    > [!TIP]
    > エッジ サーバーを初めて展開する場合は、[再実行] ではなく [実行] と表示されます。



2.  \[**利用可能な証明書タスク**\] ページで、\[**新しい証明書要求を作成する**\] をクリックします。

3.  \[**証明書の要求**\] ページで、\[**外部エッジ証明書**\] をクリックします。

4.  \[**証明書要求の送信方法**\] ページで、\[**要求を準備して後で送信する**\] チェック ボックスをオンにします。

5.  \[**証明書要求ファイル**\] ページで、要求を保存するファイルの完全なパスと名前を入力します (c:\\cert\_exernal\_edge.cer など)。

6.  \[**別の証明書テンプレートの指定**\] ページで、既定の WebServer テンプレート以外のテンプレートを使用するには、\[**選択した証明機関に別の証明書テンプレートを使用する**\] チェック ボックスをオンにします。

7.  \[**名前およびセキュリティの設定**\] ページで、次の操作を行います。
    
    1.  \[**フレンドリ名**\] に、証明書の表示名を入力します。
    
    2.  \[**ビット長**\] で、ビット長を指定します (通常は既定値の 2048)。
    
    3.  \[**証明書の秘密キーをエクスポート可能としてマークする**\] チェック ボックスがオンになっていることを確認します。

8.  \[**組織情報**\] ページで、組織の名前と組織単位 (部や課など) を入力します。

9.  \[**地理情報**\] ページで、場所情報を指定します。

10. \[**サブジェクト名/サブジェクト代替名**\] ページに、ウィザードによって自動的に設定される情報が表示されます。追加のサブジェクトの別名が必要な場合、次の 2 つの手順で指定します。

11. \[**サブジェクト代替名 (SAN) の SIP ドメイン設定**\] ページで、ドメインのチェック ボックスをオンにして、サブジェクトの別名の一覧に sip. \<SIP ドメイン\> エントリを追加します。

12. \[**追加のサブジェクト代替名の構成**\] ページで、必要な追加のサブジェクトの別名を指定します。
    

    > [!TIP]
    > XMPP プロキシがインストールされている場合は、既定でドメイン名 (contoso.com など) が SAN エントリに設定されています。別のエントリが必要な場合は、この手順で追加します。



13. \[**要求の概要**\] ページで、要求を生成するために使用する証明書情報を確認します。

14. コマンドの実行が完了したら、ログを表示するか、または \[**次へ**\] をクリックして続行します。

15. \[**証明書要求ファイル**\] ページで、\[**表示**\] をクリックして生成済みの証明書の署名要求 (CSR) ファイルを表示するか、または \[**完了**\] をクリックして証明書ウィザードを終了します。

16. 要求ファイルをコピーして、公的証明機関に送信します。

17. パブリック証明書の受信、インポート、および割り当てを行った後、エッジ サーバー サービスを停止して再起動する必要があります。これは、Lync Server 管理コンソールで次のコマンドを入力して行います。
    
        Stop-CsWindowsService

       &nbsp;
    
        Start-CsWindowsService

## 新しい Lync Server 2013 XMPP ゲートウェイを構成する

1.  Lync Server コントロール パネルを開きます。

2.  左側のナビゲーション バーで \[**フェデレーションと外部アクセス**\]、\[**XMPP フェデレーション パートナー**\] の順にクリックします。

3.  新しい構成を作成するには、\[**新規**\] をクリックします。

4.  以下の設定を定義します。

5.  \[**プライマリ ドメイン**\]    (必須)。プライマリ ドメインは、XMPP パートナーの基本ドメインです。たとえば、XMPP パートナーのドメイン名として **fabrikam.com** と入力します。これは必須のエントリです。

6.  \[**説明**\]   説明は、この特定の構成を識別するメモやその他の情報です。このエントリは省略可能です。

7.  \[**追加のドメイン**\]   追加のドメインは、許可された XMPP 通信の一部として含める必要がある、XMPP パートナーのドメインの一部です。たとえば、プライマリ ドメインが **fabrikam.com** である場合、XMPP を使用して通信する fabrikam.com 下の他のすべてのドメインをリストする必要があります。

8.  \[**パートナーの種類**\]    **パートナーの種類**は必須の設定です。どの連絡先を追加できるのかを説明し、適用するために、次のうちの 1 つを選択する必要があります。選択可能な値は次の通りです。
    
      - \[**フェデレーション**\]   パートナーの種類「**フェデレーション**」は、 Lync Server 展開と XMPP パートナーの間の高い信頼レベルを表します。このパートナーの種類は、同じ社内での XMPP サーバーのフェデレーションの場合や、確立されたビジネス関係がある場合に推奨されます。フェデレーション パートナーの XMPP の連絡先は、次のことを実行できます。
        
        1.  Lync ユーザーからの明示的な承認なしで Lync の連絡先を追加し、そのプレゼンスを表示する。
        
        2.  Lync ユーザーが連絡先リストに追加しているかどうかに関係なく、Lync の連絡先にインスタント メッセージを送信する。
        
        3.  Lync ユーザーの状態メモを表示する。
    
      - \[**公開確認済み**\]     **Public verified** (確認済みパブリック) パートナーは、信頼されておりそのユーザーの ID を確認できるパブリック XMPP プロバイダーです。確認済みのパブリック ネットワーク内の XMPP の連絡先は、Lync ユーザーからの明示的な承認なしで Lync の連絡先を追加し、そのプレゼンスの表示およびインスタント メッセージの送信を行うことができます。確認済みのパブリック ネットワーク内の XMPP の連絡先は、Lync ユーザーの状態メモを表示することはできません。この設定は推奨されません。
    
      - \[**公開未確認**\]    **Public unverified** (未確認パブリック) パートナーは、パブリック XMPP プロバイダーですが、信頼されていないためそのユーザーの ID を確認できません。未確認のパブリック ネットワーク上の XMPP ユーザーは、Lync が連絡先リストに追加することによって明示的に許可しない限り、Lync ユーザーとやり取りすることはできません。未確認のパブリック ネットワーク上の XMPP ユーザーは、Lync ユーザーの状態メモを表示することはできません。この設定は、Google Talk などのパブリック XMPP プロバイダーとのフェデレーションに推奨されます。

9.  \[**接続の種類:**\] さまざまなルールとダイヤルバック設定を定義します。
    
      - \[**TLS ネゴシエーション**\]   TLS ネゴシエーション ルールを定義します。XMPP サービスでは、TLS を必須にするか、TLS を任意にするか、または TLS をサポートしないと定義することができます。\[任意\] を選択すると、ネゴシエーションを必須とする決定についての要件は XMPP サービスに委ねられます。有効ではない構成および既知のエラーである構成を含め、SASL、TLS、およびダイヤルバックのネゴシエーションに関して選択可能なすべての設定と詳細を表示するには、「[Lync Server 2013 の XMPP フェデレーション パートナーのネゴシエーション設定](lync-server-2013-negotiation-settings-for-xmpp-federated-partners.md)」を参照してください。
        
          - \[**必須**\]   この XMPP サービスで TLS ネゴシエーションを必須にします。
        
          - \[**任意**\]   この XMPP サービスでは、TLS にはネゴシエーションが必須であることを示します。
        
          - \[**サポートなし**\]   この XMPP サービスでは TLS をサポートしません。
    
      - \[**SASL ネゴシエーション**\]   SASL ネゴシエーション ルールを定義します。XMPP サービスでは、SASL を必須にするか、SASL を任意にするか、または SASL をサポートしないと定義することができます。\[任意\] を選択すると、ネゴシエーションを必須とする決定についての要件はパートナー XMPP サービスに委ねられます。
        
          - \[**必須**\]   この XMPP サービスで SASL ネゴシエーションを必須にします。
        
          - \[**任意**\]   この XMPP サービスでは、SASL にはネゴシエーションが必須であることを示します。
        
          - \[**サポートなし**\]   この XMPP サービスでは SASL をサポートしません。
    
      - \[**ダイヤルアウト電話会議ネゴシエーションのサポート**\] サーバー ダイヤルバック ネゴシエーションのサポート プロセスは、ドメイン ネーム システム (DNS) および権限を持っているサーバーを使用して、有効な XMPP パートナーからの要求を確認します。これを行うために、発信元サーバーは、生成されたダイヤルバック キーを含む特定の種類のメッセージを作成し、DNS で受信側サーバーを参照します。発信元サーバーは、その結果として得られた受信側と思われる DNS 参照に対して、XML ストリームでキーを送信します。受信側サーバーは、XML ストリームを介してキーを受信すると、発信元に対しては応答せず、権限を持っている既知のサーバーにキーを送信します。権限を持っているサーバーが、キーが有効かどうかを確認します。有効でない場合、受信側サーバーは発信元サーバーに応答しません。キーが有効な場合、受信側サーバーは発信元サーバーに対し、ID とキーが有効であり会話を開始できることを通知します。
        
        **ダイヤルバック ネゴシエーション**には 2 つの有効な状態があります。
        
          - \[**True**\]   XMPP サーバーは、発信元サーバーから要求を受け取った場合にダイヤルバック ネゴシエーションを使用するように構成されています。
        
          - \[**False**\]   XMPP サーバーはダイヤルバック ネゴシエーションを使用するように構成されておらず、発信元サーバーから要求を受け取った場合は無視されます。

10. \[**確定**\] をクリックして、サイトまたはユーザー ポリシーへの変更を保存します。

## Lync Server 2013 XMPP ゲートウェイの DNS レコードを更新する

1.  XMPP フェデレーションの DNS を構成するには、次の SRV レコードを外部 DNS:\_xmpp-server.\_tcp.\<ドメイン名\> に追加します。この SRV レコードは、ポート値 2569 でエッジ サーバーのアクセス エッジ FQDN を解決します。

