---
title: 'Lync Server 2013: Lync Server のパフォーマンスの監視'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Monitoring Lync Server 2013 performance
ms:assetid: 2acfd720-6120-4816-a2d4-30476bd5cd0e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn720910(v=OCS.15)
ms:contentKeyID: 63969592
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: ee7fbb69583a62ac50548bdae11a1a5681398e98
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/15/2020
ms.locfileid: "42048070"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="monitoring-lync-server-2013-performance"></a>Lync Server 2013 のパフォーマンスの監視

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**トピックの最終更新日:** 2014-05-15_

Lync Server 2013 のパフォーマンスは、ユーザープロファイル、システムのアーキテクチャ、ソフトウェア、ハードウェアコンポーネント、ゲートウェイやテレフォニー機器、ネットワーク接続とパフォーマンス、Windows などのサードパーティの統合ポイントなど、さまざまな要因の影響を受けます。Windows オペレーティングシステムの機能に加えて、Active Directory サービスの構成とパフォーマンス。

Lync Server 2013 の展開の中核となるのは、実装されているサーバーソフトウェアとハードウェアです。 一例として、フロントエンドサーバーは、予想される (短期的な) ユーザー負荷に対処するのに十分なハードウェアリソースを備えている必要があります。 サービスを1万ユーザーに提供するためにそれぞれのフロントエンドサーバーが必要な場合は、適切に構成されたサーバーが予想される負荷要件を満たしている必要があります。最終的には、エンドユーザーの最高のパフォーマンスを実現するために役立ちます。

そのため、サーバーのパフォーマンスを監視することは、実装されたサーバーインフラストラクチャに、日常のピーク時の負荷要件に適したハードウェアリソースがあるかどうかを測定することが非常に重要です。 監視サーバーのパフォーマンスは、エンドユーザーの操作が影響を受ける前に、管理者が是正措置を適用できるシステムのボトルネックを特定するのに便利です。 パフォーマンスデータは、長期の容量計画に使用する必要があります。

[System Center Operations Manager を使用した Lync Server 2013 の監視](lync-server-2013-monitoring-lync-server-with-system-center-operations-manager.md)では、すべてのパフォーマンスオブジェクトとカウンターの詳細情報がリンクされていますが、以下のパフォーマンスカウンターを使用すると、管理者はシステムのパフォーマンスを簡単に確認できます。

  - フロントエンドサーバーのシステム全体の正常性を追跡するには、まずプロセッサ\\の% processor Time をチェックすることをお勧めします。 値は常に80% 未満である必要があります。

  - フロントエンドプールで使用されるバックエンド SQL Server データベースソフトウェアインスタンスのパフォーマンスを追跡するには、次のパフォーマンスカウンターを監視します。
    
    LC: USrv –00– DBStore\\usrv –002– Queue Latency (ミリ秒)
    
    LC: USrv –00– DBStore\\usrv – 0 04-「ストアドプロシージャ待機時間 (ミリ秒)」
    
    正常なサーバーが安定した状態\<で、100ミリ秒の待ち時間の値を表示する必要があります。 遅延が12秒に達したときに調整メカニズムによって処理されます。これは、フロントエンドサーバーがバックエンドに対する要求の調整を開始することを意味します。 これにより、クライアントは 503 Server のビジー状態のエラーメッセージの受信を開始します。

  - フロントエンドサーバーで処理時間を追跡するには、次のカウンターを監視します。
    
    LC: SIP-07-Load Management\\sip-000-受信メッセージを保持する時間の平均
    
    これはフロントエンドサーバー上の別の調整メカニズムなので、この時点では、フロントエンドの処理時間が長くなります。 平均処理時間が6秒を超えている場合、サーバーは調整モードに入り、クライアント接続ごとに1つの未処理のトランザクションのみが許可されます。

  - SQL バックエンドサーバーでメモリの問題を追跡するには、次のカウンターを監視します。
    
    SQL Server バッファーマネージャー\\のページ寿命の予測
    
    最小値 (3600 秒未満) (高遅延書き込み/秒およびチェックポイントページ/秒) は、メモリの負荷を示します。

<div>

## <a name="additional-counters-to-view"></a>表示する追加カウンター

フロントエンドサーバーからの全体的な状態に関する適切な指標として、いくつかの主要なカウンターがあります。 これは包括的なリストではなく、根本原因を特定することを目的としたものではありません。 これらのカウンターを使用すると、サーバーの正常性を簡単に確認できます。 プール内の各サーバーでこれらのカウンターを確認することをお勧めします。 サーバーが正常な状態になっている場合、これらのカウンターの値を理解しておくことが重要です。 ユーザーの作業が低下したときに変更された内容を理解するには、ベースラインが必要です。

フロントエンドサーバーは、システム内の他の場所に存在するボトルネックによって発生する可能性のある問題を示すことができます。 これは、システム全体の正常性を確認するときに、最適な開始点となることを意味します。

最初に確認する必要がある2つのカウンターは次のとおりです。

LC: USrv-00-DBStore\\usrv-002-キュー待機時間 (ミリ秒)

LC: USrv-00-DBStore\\usrv-004-ストアドプロシージャ待機時間 (ミリ秒)

Queue latency カウンターは、要求がバックエンドに対してキューにかかった時間を表し、ストアドプロシージャの待機時間は、バックエンドが要求を処理するのにかかった時間を表します。 何らかの理由で、バックエンドのディスク、メモリ、ネットワーク、およびプロセッサが問題になっている場合、キューの待機時間カウンターは高くなります。

また、フロントエンドとバックエンドの間のネットワークの待ち時間が多い場合にも高いことがあります。 そのため、許容できるキューの遅延は何ですか。

フロントエンドサーバーは、12秒以内にバックエンドサーバーへの要求の調整を開始します。 これは、サーバーがビジー状態–503エラーをクライアントに返し始め始めることを意味します。 正常なサーバーでは、安定した状態では100ミリ秒未満の DBStore キューの待ち時間が発生していますが、サーバーがオンラインになり、ユーザーがすべて同時にログインしている間は、このカウンターが非常に大きくなり、ヒット数が複数になっている可能性があります。

負荷分散された構成では、複数のフロントエンドサーバーでプールが展開されており、"最小数の接続" 用に構成されたロードバランサーを使用している場合があります。 この場合、1台のフロントエンドサーバーを再起動すると、再接続を試行するすべてのユーザーが、他のプールメンバーと比較して接続数が少なくなるため、再起動されたサーバーがポイントされます。 この間、それぞれのフロントエンドサーバーが過負荷になることがありますが、他のプールメンバーは過負荷になっているとは限りません。

ユーザーがサーバーに同時に接続することがないため、パフォーマンスへの影響を軽減するために、時間の経過とともにメンテナンスを実行することをお勧めします。

前の2つのパフォーマンスカウンターが高い場合は、SQL バックエンドサーバーがボトルネックとなる可能性が高くなります。 確認する次のコンポーネントは次のとおりです。

  - SQL Server CPU が高すぎませんか? たとえば、80% より大きいかどうかを確認します。

  - ディスク待機時間は長くなりますか?

理想的には、RTC データベースと RTCDYN データベースの両方をメモリに格納するのに十分な RAM を用意しています。 その後、サーバーがディスクにアクセスする唯一の理由は、ログファイルに書き込み、データベースにフラッシュすることです。 テストでは、10万ユーザーの展開に 12 GB の RAM があれば十分であることが示されています。 これは、RTC および RTCDYN データベースのサイズ合計が 12 GB 未満であることを前提としています。 データベースがこれより大きい場合は、追加のメモリが必要になることがあります。

Sql server バッファーマネージャーページの寿命のパフォーマンスカウンターを調べることによって、SQL Server が追加の RAM を必要とするかどうかを判断できます。 3600未満の値は、メモリの負荷を示します。 SQL Server はデータベースへの書き込みのみを行う必要があるため、十分なメモリがある場合は、データベースドライブに対する読み取りがほとんどないことを確認する必要があります。

サーバーの処理時間が長くなった場合に開始する Lync Server 2013 のフロントエンドサーバーには、追加の調整メカニズムがあります。 DBStore の待機時間調整は、SQL Server の待機時間が長い場合にのみ有効になります。 このような調整が有効になる1つの例として、フロントエンドサーバーが CPU にバインドされている場合が挙げられます。

サーバー上で、サーバー上の平均処理時間 **(LC: sip\\-07-負荷管理 sip** -2) が6秒を超えた場合、サーバーは調整モードに入り、クライアント接続ごとに1つの未処理のトランザクションのみをユーザーに提供します。 処理時間が3秒になると、サーバーは調整モードから切断され、クライアント接続ごとに最大20個の未処理トランザクションをユーザーに提供します。 特定の接続上のトランザクションの数が上記のしきい値を超えた場合、接続はフロー制御としてマークされます。 その結果、サーバーは、サーバー上で受信を送信しません。 **LC: SIP-01-\\ピアフロー制御接続**カウンターがインクリメントされます。 接続がフロー制御された状態が1分を超えると、サーバーはそれを閉じます。 これは遅延します。 接続を確認する機会があれば、それが長時間に制限されているかどうかを判断し、それが1分を超える場合はそれを閉じます。

これらは2つの調整メカニズムであり、サーバーが実行している調整がある場合は、それを要約したパフォーマンスカウンターが1つあります。

**LC: SIP-04-応答\\sip-053-ローカル503応答/秒**

  - 前のカウンターの "Local" という用語は、ローカルに生成された応答を意味します。

  - 503コードは、サーバーを使用できないことに対応します。これは、正常なサーバー上に503コードが表示されないようにする必要があります。 サーバーがオンラインになるまでの期間中に、一部の503コードが表示されることがあります。 すべてのユーザーが再度サインインして、サーバーが安定した状態に戻ると、503コードを追加する必要はありません。

**LC: SIP-04-応答\\sip-074-ローカル504応答/秒**

このパフォーマンスカウンターは、他のサーバーとの接続の問題を示し、接続中に接続または遅延が発生したことを示します。 504エラーが表示される場合は、次のパフォーマンスカウンターをチェックする必要があります。

**LC: SIP-01-ピア\\sip-017-未完了の送信**

このカウンターは、キューに入っている発信された要求と応答の数を示します。 このカウンターが大きい場合、問題はローカルサーバーではない可能性が高くなります。 ネットワーク待機時間の問題がある場合は、このカウンターが大きいことに注意してください。 また、ローカルネットワークアダプターに関する問題を示している場合もありますが、リモートサーバー上の問題が原因である可能性が高くなります。 このカウンターは、通信しようとしているプールが過負荷になっている場合に、ディレクターサーバーにとって高い可能性が高くなります。 このカウンターのキーは、合計だけでなく、インスタンスを検索することです。

</div>

</div>

<span> </span>

</div>

</div>

</div>

