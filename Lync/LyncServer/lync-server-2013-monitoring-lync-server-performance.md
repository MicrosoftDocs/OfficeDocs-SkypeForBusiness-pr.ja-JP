---
title: 'Lync Server 2013: Lync Server のパフォーマンスを監視する'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Monitoring Lync Server 2013 performance
ms:assetid: 2acfd720-6120-4816-a2d4-30476bd5cd0e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn720910(v=OCS.15)
ms:contentKeyID: 63969592
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: f7859ea116e4ae63a5777e816c37893f11cf1c39
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/04/2020
ms.locfileid: "41756841"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="monitoring-lync-server-2013-performance"></a>Lync Server 2013 のパフォーマンスを監視する

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**最終更新日:** 2014-05-15_

Lync Server 2013 のパフォーマンスは、ユーザープロファイル、システムアーキテクチャ、ソフトウェア、ハードウェアコンポーネント、ゲートウェイやテレフォニー機器などのサードパーティの統合ポイント、ネットワーク接続とパフォーマンス、Windows など、さまざまな要因によって影響を受けます。Windows オペレーティングシステムの機能に加えて、Active Directory サービスの構成とパフォーマンス。

Lync Server 2013 の展開の中核となるのは、サーバーソフトウェアとハードウェアが実装されていることです。 例として、フロントエンドサーバーは、予想される (短期的な) ユーザーロードに対処するために十分なハードウェアリソースを持っている必要があります。 1万ユーザーにサービスを提供するためにそれぞれのフロントエンドサーバーが必要である場合、適切に構成されたサーバーは、期待される負荷要件を満たしていることを前提として、最終的に最高のエンドユーザーエクスペリエンスを実現する必要があります。

このため、実装されたサーバーインフラストラクチャが、日常的な負荷のピーク要件に適したハードウェアリソースを備えているかどうかを測定することが、サーバーのパフォーマンスの監視に非常に重要です。 サーバーのパフォーマンスを監視することにより、エンドユーザーエクスペリエンスが影響を受ける前に、管理者が是正措置を適用できるシステムボトルネックを特定することができます。 長期的なキャパシティ計画には、パフォーマンスデータを使用する必要があります。

記録されるすべてのパフォーマンスオブジェクトとカウンターの詳細については、「 [Lync Server 2013 を System Center Operations Manager で監視](lync-server-2013-monitoring-lync-server-with-system-center-operations-manager.md)する」にリンクされていますが、次のいくつかのパフォーマンスカウンターを使って、管理者がシステムのパフォーマンスを簡単に確認することができます。

  - フロントエンドサーバーの全体的なシステム正常性を追跡するために、まずプロセッサ\\の% プロセッサ時間を確認することをお勧めします。 値は常に80% 未満である必要があります。

  - フロントエンドプールによって使用されるバックエンド SQL Server データベースソフトウェアインスタンスのパフォーマンスを追跡するには、次のパフォーマンスカウンターを監視します。
    
    LC: USrv –00– DBStore\\usrv –002–キューの待機時間 (ミリ秒)
    
    LC: USrv –00– DBStore\\usrv – 0 04 –ストアドプロシージャ待ち時間 (ミリ秒)
    
    安定した状態の正常なサーバー \<には、100ミリ秒の値が表示されている必要があります。 スロットルメカニズムは、待機時間が12秒に達すると、フロントエンドサーバーがバックエンドの要求の調整を開始することを意味します。 これにより、クライアントは503サーバーがビジー状態のエラーメッセージの受信を開始します。

  - フロントエンドサーバーでの処理時間を追跡するには、次のカウンターを監視します。
    
    LC: SIP-07-読み込み管理\\sip-000-平均受信メッセージに時間を保持
    
    これは、フロントエンドサーバー上の別の調整メカニズムであり、フロントエンドの処理時間が長くなったときに開始されます。 平均処理時間が6秒以上の場合、サーバーは調整モードになり、クライアント接続ごとに1つの未処理のトランザクションのみを許可します。

  - SQL バックエンドサーバーでメモリの問題を追跡するには、次のカウンターを監視します。
    
    SQL Server のバッファー\\マネージャーページの予測期間
    
    低価額は、3600秒未満 (待機時間の高い書き込み/秒とチェックポイントページ/秒) で、メモリの圧迫を示しています。

<div>

## <a name="additional-counters-to-view"></a>表示する追加カウンター

フロントエンドサーバーからの全体的な正常性に関する適切な指標として、いくつかの主要なカウンターがあります。 これは包括的なリストではなく、根本原因を特定することを目的としていません。 これらのカウンターを使って、サーバーの正常性に関するクイックチェックを実行できます。 これらのカウンターは、プール内の各サーバーで確認することをお勧めします。 サーバーが正常に動作している場合は、これらのカウンター値を理解しておくことが重要です。 ベースラインは、ユーザーエクスペリエンスが低下したときに何が変更されたかを理解するために必要です。

フロントエンドサーバーは、システムの他の場所にあるボトルネックによって発生する可能性のある問題を示すことができます。 これは、システムの正常性を確認するのに最適な場所です。

最初に確認する2つの追加カウンターは次のとおりです。

LC: USrv-00-DBStore\\usrv-002-キューの待機時間 (ミリ秒)

LC: USrv-00-DBStore\\usrv-004-ストアドプロシージャ待ち時間 (ミリ秒)

Queue latency カウンターは、要求がキューでバックエンドに費やした時間を表し、"ストアドプロシージャ待機時間" は、バックエンドが要求を処理するのにかかった時間を表します。 何らかの理由で、バックエンドのディスク、メモリ、ネットワーク、プロセッサが問題となっている場合は、キューの待機時間カウンターは高くなります。

また、フロントエンドとバックエンドの間に高いネットワーク待ち時間がある場合にも高い可能性があります。 許容されるキューの待ち時間はどのようなものですか?

フロントエンドサーバーは、12秒以内にバックエンドサーバーへの要求の調整を開始します。 これは、サーバーがビジー状態になることを意味します–503エラーはクライアントに返されます。 正常なサーバーは、安定した状態で100ミリ秒未満の DBStore キューの待ち時間を超えないようにする必要があります。ただし、サーバーがオンラインになり、ユーザーが同時にログインしている場合は、そのカウンターは非常に大きくなる可能性があります。

複数のフロントエンドサーバーと、"最小接続数" に構成されているロードバランサーを使用して展開されたプールを持つ負荷分散構成がある場合があります。 この場合、1つのフロントエンドサーバーが再起動されると、再接続しようとしているすべてのユーザーが、他のプールメンバーと比べて接続数が少なくなります。 このとき、他のプールメンバーではなく、各フロントエンドサーバーが過負荷になることがあります。

ユーザーが同時にサーバーに接続していないため、パフォーマンスへの影響を抑えるために、時間の経過と共にメンテナンスを実行することをお勧めします。

上記の2つのパフォーマンスカウンターが大きい場合は、SQL バックエンドサーバーである可能性が最も高いと考えられます。 確認する次のコンポーネントは、次のようになります。

  - SQL Server の CPU が高すぎませんか? たとえば、80パーセントより大きいかどうかを確認します。

  - ディスク待ち時間は高ですか?

理想的には、RTC と RTCDYN の両方のデータベースをメモリに保持するための十分な RAM があります。 その後、サーバーがディスクにアクセスする理由は、ログファイルに書き込みを行い、データベースにフラッシュすることだけです。 このテストでは、10万のユーザー展開には 12 GB の RAM が十分であることが示されています。 これは、RTC と RTCDYN データベースの合計サイズが 12 GB 未満であることを前提としています。 データベースがそれよりも大きい場合は、メモリを追加する必要があります。

Sql Server バッファーマネージャーのページ寿命の予測のパフォーマンスカウンターを確認すると、SQL Server で追加の RAM が必要かどうかを判断できます。 3600より小さい値は、メモリの負荷を示します。 また、SQL Server はデータベースへの書き込みのみを行う必要があるため、十分なメモリがある場合は、データベースドライブに対する読み取りはほとんど必要ありません。

サーバーの処理時間が長い場合は、Lync Server 2013 フロントエンドサーバーに追加の調整メカニズムが用意されています。 DBStore の待機時間の調整は、SQL Server への待機時間が長い場合にのみ有効になります。 このような調整が有効になる1つの例は、フロントエンドサーバーが CPU にバインドされている場合です。

平均処理時間 **(LC: sip-07-[読み込み管理\\sip-000-、受信メッセージの平均時間**を超えています]) が6秒を超えると、サーバーは調整モードになり、クライアント接続ごとに1つの未処理トランザクションのみが提供されます。 処理時間が3秒に低下すると、サーバーは調整モードを終了し、クライアント接続あたり最大20個の未処理トランザクションをユーザーに提供します。 特定の接続のトランザクション数が上記のしきい値を超えている場合、接続はフロー制御としてマークされます。 結果としてサーバーでは、受信は何も送信されず、 **LC: SIP-01\\-ピアフロー制御接続**カウンターがインクリメントされます。 接続がフロー制御された状態の1分以上続く場合は、サーバーによって閉じられます。 これは、それほど簡単ではありません。 接続を確認する機会がある場合は、時間がかかりすぎているかどうかを判断し、1分以上ある場合はそれを閉じます。

これらは2つの調整メカニズムであり、サーバーが実行している調整がある場合はそれを要約する1つのパフォーマンスカウンターがあります。

**LC: SIP-04-応答\\SIP-053-ローカル503応答/秒**

  - 前のカウンターの "Local" という用語は、ローカルで生成された応答を指します。

  - 503コードは、使用できないサーバー (正常なサーバーに503コードが表示されない) に対応しています。 サーバーがオンラインになるまでの期間中に、503コードが表示されることがあります。 すべてのユーザーが再びサインインしたときに、サーバーが安定した状態に戻ると、追加の503コードは表示されません。

**LC: SIP-04-応答\\SIP-074-ローカル504応答/秒**

このパフォーマンスカウンターは、他のサーバーとの接続の問題を示し、接続中の接続の失敗や遅延を示します。 504エラーが表示される場合は、次のパフォーマンスカウンターをチェックする必要があります。

**LC: SIP-01-ピア\\SIP-017-未処理の送信**

このカウンターは、キューに入れられた発信要求と返信の数を示します。 このカウンターが大きい場合、問題はローカルサーバーではない可能性が高いと考えられます。 ネットワーク待ち時間の問題がある場合は、このカウンターを高くすることができます。 また、ローカルネットワークアダプターで問題が発生している可能性もありますが、リモートサーバー上の問題が原因である可能性が高くなります。 このカウンターは、通信しようとしているプールが過負荷状態になっているときに、ディレクターサーバーで高い可能性が高いと考えられます。 このカウンターのキーは、合計だけでなく、インスタンスを確認することです。

</div>

</div>

<span> </span>

</div>

</div>

</div>

