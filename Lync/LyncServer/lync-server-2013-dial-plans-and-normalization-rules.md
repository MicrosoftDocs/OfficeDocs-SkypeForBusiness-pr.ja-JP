---
title: 'Lync Server 2013: ダイヤル プランと正規化ルール'
TOCTitle: ダイヤル プランと正規化ルール
ms:assetid: fde45195-6eb4-403c-9094-57df7fc0bd2a
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Gg413082(v=OCS.15)
ms:contentKeyID: 48274207
ms.date: 12/10/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013 のダイヤル プランと正規化ルール

 

_**トピックの最終更新日:** 2016-12-08_

ダイヤル プランとは、電話番号の承認と通話のルーティングを目的として、特定の場所、個々のユーザー、または連絡先オブジェクトの電話番号を 1 つの標準形式 (E.164) に変換する正規化ルールのセットに名前を付けたものです。

正規化ルールは、さまざまな形式で表現された電話番号を指定された各場所、ユーザー、または連絡先オブジェクトにルーティングする方法を定義します。ダイヤル元の場所および電話をかける人や連絡先オブジェクトによって、同じダイヤル文字列が異なる方法で解釈および変換される場合があります。

## ダイヤル プランのスコープ

ダイヤル プランの *スコープ* によって、ダイヤル プランを適用できる階層レベルが決まります。 Lync Server では、ユーザーを特定のユーザーごとのダイヤル プランに割り当てることができます。ユーザーのダイヤル プランが割り当てられていない場合は、レジストラー プールのダイヤル プランが適用されます。レジストラー プールのダイヤル プランがない場合は、サイトのダイヤル プランが適用されます。ユーザーに適用可能な他のダイヤル プランがない場合は、最後にグローバル ダイヤル プランが適用されます。

ユーザーが Lync Server にログオンしている場合、クライアントはインバンド プロビジョニング設定によってダイヤル プランのスコープ レベルを取得します。管理者として、 Lync Server コントロール パネルを使用してダイヤル プランのスコープ レベルの管理および割り当てを行うことができます。

> [!NOTE]
> サービス レベルの公衆交換電話網 (PSTN) ゲートウェイのダイヤル プランは、特定のゲートウェイからの着信に適用されます。


ダイヤル プランのスコープ レベルは、次のように定義されます。

  - **ユーザー ダイヤル プラン :** 個々のユーザー、グループ、または連絡先オブジェクトに割り当てることができます。音声アプリケーションは、user-default に設定された電話コンテキストのコールを受信したとき、ユーザーごとのダイヤル プランを参照できます。連絡先オブジェクトは、ダイヤル プラン割り当ての際には個々のユーザーとして扱われます。

  - **プール ダイヤル プラン :** トポロジ内の PSTN ゲートウェイまたはレジストラーのサービス レベルで作成できます。プール ダイヤル プランを定義するには、ダイヤル プランを適用する特定のサービス (PSTN ゲートウェイまたはレジストラー プール) を指定する必要があります。

  - **サイト ダイヤル プラン :** プール ダイヤル プランまたはユーザー ダイヤル プランに割り当てられているユーザー、グループ、または連絡先オブジェクトを除くサイト全体に作成できます。サイト ダイヤル プランを定義するには、ダイヤル プランを適用するサイトを指定する必要があります。

  - **グローバル ダイヤル プラン :** 製品と一緒にインストールされる既定のダイヤル プランです。グローバル ダイヤル プランは、編集することはできますが削除はできません。特定のスコープでダイヤル プランの構成および割り当てを行わない場合は、展開内の エンタープライズ VoIP のすべてのユーザー、グループ、および連絡先オブジェクトに対して、このダイヤル プランが適用されます。

## ダイヤル プランの計画

ダイヤル プランを計画するには、次の手順を実行します。

  - 組織内のオフィスがあるすべてのロケールをリストアップします。
    
    このリストは、すべてを網羅した最新の情報である必要があります。また、組織の変化に合わせて改訂する必要があります。多数の小規模なブランチ オフィスを持つ大規模な多国籍企業の場合は、この作業に時間がかかる可能性があります。

  - 各サイトにおける有効な番号パターンを特定します。
    
    ダイヤル プランの計画で最も時間がかかるのは、それぞれのサイトの有効な番号パターンを特定することです。あるダイヤル プラン用に記述した正規化ルールを他のダイヤル プランにコピーできる場合があります (特に、対応しているサイトが同じ国/地域または大陸にある場合)。これ以外の場合でも、あるダイヤル プランの番号を少し変更すれば他のダイヤル プランに十分使用できる場合があります。

  - ダイヤル プランの名前付けのための、組織全体のスキームを開発します。
    
    標準の名前付けスキームを採用することで、組織間の一貫性を保ち、メンテナンスと更新を簡単に行うことができます。

  - 1 つの場所で複数のダイヤル プランが必要かどうかを判断します。
    
    組織が複数の場所で単一のダイヤル プランを使用する場合でも、構内交換機 (PBX) から移行して既存の内線番号を引き続き使用する必要がある エンタープライズ VoIP ユーザー向けに、ダイヤル プランを別に作成することが必要な場合があります。

  - ユーザーごとのダイヤル プランが必要かどうかを決定します。たとえば、ブランチ サイトに中央サイトで登録されているユーザーや、 存続可能ブランチ アプライアンスに登録されているユーザーがいる場合、ユーザーごとのダイヤル プランと正規化ルールで、そのようなユーザーの特殊なダイヤル シナリオに対応できます。詳細については、「[Lync Server 2013 のブランチ サイトの復元要件](lync-server-2013-branch-site-resiliency-requirements.md)」を参照してください。

  - ダイヤル プランのスコープを決定します (このトピック内で前述)。

ダイヤル プランを作成するには、必要に応じて Lync Server コントロール パネルまたは Lync Server 管理シェルを使用して、次のフィールドに値を指定します。

## 名前および簡単な名前

ユーザー ダイヤル プランの場合、ダイヤル プランの割り当て先のユーザー、グループ、または連絡先オブジェクトを識別する説明的な名前を指定する必要があります。サイト ダイヤル プランの場合、"名前" フィールドにサイト名が事前に入力されており、変更することはできません。プール ダイヤル プランの場合、\[名前\] ボックスに PSTN ゲートウェイまたはフロントエンド プールの完全修飾ドメイン名 (FQDN) が事前に入力されており、変更することはできません。

ダイヤル プランの *簡単な名前* には、ダイヤル プラン名を使用した文字列が事前に入力されています。\[簡単な名前\] フィールドは編集することができ、よりわかりやすいダイヤル プランの名前付け規則を作成できるようになっています。 *簡単な名前* の値を空にすることはできず、一意である必要があります。組織全体の名前付け規則を開発し、この規則をすべてのサイトとユーザーで一貫して使用することをお勧めします。

## 説明

対応するダイヤル プランが適用される地理的な場所の、一般的でわかりやすい名前を入力することをお勧めします。たとえば、ダイヤル プランの名前が London.Contoso.com である場合、説明を London とすることをお勧めします。

## ダイヤルイン会議の地域

ダイヤルイン会議を展開している場合、ダイヤルイン会議の地域を指定し、ダイヤルイン会議のアクセス番号をダイヤル プランと関連付ける必要があります。

## 外部アクセス プレフィックス

外線に接続するのに先頭に 1 つ以上の数字 (9 など) を追加する必要がある場合に、最大 4 文字 (\#、\*、および 0 ～ 9) の外部アクセス プレフィックスを指定できます。

> [!NOTE]
> 外部アクセス プレフィックスを指定する場合に、プレフィックスに対応するために追加の正規化ルールを作成する必要はありません。


## 正規化ルール

正規化ルールは、さまざまな形式で表現された電話番号を指定の場所にルーティングする方法を定義します。同じ電話番号文字列が、その番号がダイヤルされたロケールに応じて、異なる方法で解釈および変換されることがあります。正規化ルールは通話のルーティングに不可欠です。これは、ユーザーが連絡先リストに電話番号を入力する際にさまざまな形式を使用する可能性があるためです。

ユーザーがダイヤルした電話番号を正規化することによって、形式の一貫性を確保できます。これは、次の処理に役立ちます。

  - ダイヤルされた番号と受信者の SIP-URI のマッチング

  - 発信者へのダイヤル承認ルールの適用

次の番号フィールドでは、正規化ルールの考慮が必要になる可能性があります。

  - ダイヤル プラン

  - 国番号

  - 市外局番

  - 内線番号の長さ

  - サイトのプレフィックス

## 正規化ルールの作成

正規化ルールは .NET Framework の正規表現を使用して番号一致パターンを指定します。サーバーはこのパターンを使用して、逆引き番号検索を実行する際にダイヤル文字列を E.164 形式に変換します。表現を手動で入力するか、照合する先頭の数字とダイヤル文字列の長さを入力して Lync Server コントロール パネルに対応する正規表現を生成させることで、 Lync Server コントロール パネルで正規化ルールを作成します。いずれの方法でも、終了時にテスト番号を入力して正規化ルールが予想どおりに動作することを確認できます。

.NET Framework の正規表現の使用の詳細については、「.NET Framework の正規表現」( [http://go.microsoft.com/fwlink/?linkid=140927\&clcid=0x411](http://go.microsoft.com/fwlink/?linkid=140927%26clcid=0x411)) を参照してください。

## 正規化ルールの例

次の表は, .NET Framework 正規表現で記述された正規化ルールの例です。ここに示すのは単なる例であり、ご自分の正規化ルールをこのとおりに作成する必要はありません。

### 表 1. .NET Framework 正規表現を使用した正規化ルール

<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th>ルール名</th>
<th>説明</th>
<th>番号のパターン</th>
<th>変換</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>4digitExtension</p></td>
<td><p>4 桁の内線番号を変換します。</p></td>
<td><p>^(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>0100 が +14255550100 に変換されます。</p></td>
</tr>
<tr class="even">
<td><p>5digitExtension</p></td>
<td><p>5 桁の内線番号を変換します。</p></td>
<td><p>^5(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>50100 が +14255550100 に変換されます。</p></td>
</tr>
<tr class="odd">
<td><p>7digitcallingRedmond</p></td>
<td><p>7 桁の番号を Redmond の電話番号に変換します。</p></td>
<td><p>^(\d{7})$</p></td>
<td><p>+1425$1</p></td>
<td><p>5550100 が +14255550100 に変換されます。</p></td>
</tr>
<tr class="even">
<td><p>7digitcallingDallas</p></td>
<td><p>7 桁の番号を Dallas の電話番号に変換します。</p></td>
<td><p>^(\d{7})$</p></td>
<td><p>+1972$1</p></td>
<td><p>5550100 が +19725550100 に変換されます。</p></td>
</tr>
<tr class="odd">
<td><p>10digitcallingUS</p></td>
<td><p>米国の 10 桁の番号を変換します。</p></td>
<td><p>^(\d{10})$</p></td>
<td><p>+1$1</p></td>
<td><p>2065550100 が +12065550100 に変換されます。</p></td>
</tr>
<tr class="even">
<td><p>LDCallingUS</p></td>
<td><p>米国の長距離プレフィックス付きの番号を変換します。</p></td>
<td><p>^1(\d{10})$</p></td>
<td><p>+$1</p></td>
<td><p>12145550100 が +2145550100 に変換されます。</p></td>
</tr>
<tr class="odd">
<td><p>IntlCallingUS</p></td>
<td><p>米国の国際プレフィックス付きの番号を変換します。</p></td>
<td><p>^011(\d*)$</p></td>
<td><p>+$1</p></td>
<td><p>01191445550100 が +91445550100 に変換されます。</p></td>
</tr>
<tr class="even">
<td><p>RedmondOperator</p></td>
<td><p>0 を Redmond のオペレーター呼び出し番号に変換します。</p></td>
<td><p>^0$</p></td>
<td><p>+14255550100</p></td>
<td><p>0 が +14255550100 に変換されます。</p></td>
</tr>
<tr class="odd">
<td><p>RedmondSitePrefix</p></td>
<td><p>ネットワーク内プレフィックス (6) および Redmond のサイト コード (222) 付きの番号を変換します。</p></td>
<td><p>^6222(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>62220100 が +14255550100 に変換されます。</p></td>
</tr>
<tr class="even">
<td><p>NYSitePrefix</p></td>
<td><p>ネットワーク内プレフィックス (6) および NY のサイト コード (333) 付きの番号を変換します。</p></td>
<td><p>^6333(\d{4})$</p></td>
<td><p>+1202555$1</p></td>
<td><p>63330100 が +12025550100 に変換されます。</p></td>
</tr>
<tr class="odd">
<td><p>DallasSitePrefix</p></td>
<td><p>ネットワーク内プレフィックス (6) および Dallas のサイト コード (444) 付きの番号を変換します。</p></td>
<td><p>^6444(\d{4})$</p></td>
<td><p>+1972555$1</p></td>
<td><p>64440100 が +19725550100 に変換されます。</p></td>
</tr>
</tbody>
</table>


以下の表は、Redmond (Washington、米国) の場所のダイヤル プランの例です。これは、前の表に示す正規化ルールに基づいています。

### 表 2. 表 1 の正規化ルールに基づく Redmond のダイヤル プラン

<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>Redmond.forestFQDN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>5digitExtension</p></td>
</tr>
<tr class="even">
<td><p>7digitcallingRedmond</p></td>
</tr>
<tr class="odd">
<td><p>10digitcallingUS</p></td>
</tr>
<tr class="even">
<td><p>IntlCallingUS</p></td>
</tr>
<tr class="odd">
<td><p>RedmondSitePrefix</p></td>
</tr>
<tr class="even">
<td><p>NYSitePrefix</p></td>
</tr>
<tr class="odd">
<td><p>DallasSitePrefix</p></td>
</tr>
<tr class="even">
<td><p>RedmondOperator</p></td>
</tr>
</tbody>
</table>


> [!NOTE]
> 前の表に記載した正規化ルールの名前にはスペースが含まれていませんが、これは任意に設定できます。たとえば、この表の最初の名前は、「5 digit extension」または「5-digit Extension」のどちらで記述しても問題ありません。

