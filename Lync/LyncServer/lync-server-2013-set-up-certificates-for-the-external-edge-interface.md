---
title: 'Lync Server 2013: 外部エッジ インターフェイスの証明書の設定'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
TOCTitle: Set up certificates for the external edge interface
ms:assetid: 5d78182c-88d8-4483-95ad-74b17f2d5fac
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg398409(v=OCS.15)
ms:contentKeyID: 48184287
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: b2cb33a91d6609f9109e6416f5688d1b2ddfb9ed
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/11/2019
ms.locfileid: "34822119"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="set-up-certificates-for-the-external-edge-interface-for-lync-server-2013"></a>Lync Server 2013 外部エッジ インターフェイスの証明書の設定

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**最終更新日:** 2012-09-08_

<div>


> [!IMPORTANT]  
> 証明書ウィザードを実行するときは、使用する証明書テンプレートの種類に対して適切な権限が割り当てられているグループのメンバーであるアカウントを使用してログインしていることを確認します。 既定では、Lync Server の証明書の要求では、Web サーバー証明書テンプレートが使用されます。 RTCUniversalServerAdmins グループのメンバーであるアカウントを使用して、このテンプレートを使用して証明書を要求する場合は、そのテンプレートを使用するために必要な登録権限がグループに割り当てられていることを確認します。



</div>

各エッジサーバーでは、境界ネットワークとインターネット間のインターフェイスに対して公開証明書が必要です。また、証明書のサブジェクトの代替名には、アクセスエッジサービスと Web 会議エッジサービスの外部名が含まれている必要があります。修飾ドメイン名 (Fqdn)。

このような証明書の要件の詳細については、「 [Lync Server 2013 の外部ユーザーアクセスの証明書の要件](lync-server-2013-certificate-requirements-for-external-user-access.md)」を参照してください。

ユニファイドコミュニケーション証明書の特定の要件に準拠し、Microsoft と提携して Lync Server 2013 証明書ウィザードで動作する証明書を提供する公開証明機関 (Ca) の一覧については、「」を参照してください。Microsoft サポート技術情報の記事929395、「Exchange Server および通信サーバーのユニファイドコミュニケーション証明書パートナー [http://go.microsoft.com/fwlink/p/?linkId=202834](http://go.microsoft.com/fwlink/p/?linkid=202834)」の「」をご覧ください。

<div>

## <a name="configuring-certificates-on-the-external-interfaces"></a>外部インターフェイスで証明書を構成する

サイトの外部エッジインターフェイスで証明書を設定するには、このセクションの手順を使用して、次の操作を行います。

  - エッジサーバーの外部インターフェイスの証明書要求を作成します。

  - 公開 CA に要求を送信します。

  - 各エッジサーバーの外部インターフェイスの証明書をインポートします。

  - 各エッジサーバーの外部インターフェイスの証明書を割り当てます。

  - 展開に複数のエッジサーバーが含まれている場合は、証明書と秘密キーをエクスポートして、他のエッジサーバーにコピーします。 次に、各エッジサーバーについてインポートし、前に説明したように割り当てます。 各エッジサーバーについて、この手順を繰り返します。

パブリック証明機関 (CA) からパブリック証明書を直接要求することができます (パブリック CA の web サイトなど)。 このセクションの手順では、ほとんどの証明書タスクに対して証明書ウィザードを使用します。 パブリック CA から直接証明書を要求するように選択した場合、証明書の要求、トランスポート、インポート、および証明書チェーンのインポートに必要な各手順を変更する必要があります。

外部 CA から証明書を要求する場合は、提供された資格情報にその CA から証明書を要求する権限が必要です。 各 CA には、証明書の要求、発行、管理、または読み取りを許可する資格情報 (具体的なユーザー名とグループ名) を定義するセキュリティポリシーがあります。

Microsoft 管理コンソール (MMC) を使って証明書チェーンと証明書をインポートする場合は、そのコンピューターの証明書ストアに証明書をインポートする必要があります。 ユーザーまたはサービスの証明書ストアにインポートした場合、Lync Server 2013 の証明書ウィザードでは、この証明書を割り当てることはできません。

<div>

## <a name="to-create-the-certificate-request-for-the-external-interface-of-the-edge-server"></a>エッジサーバーの外部インターフェイスの証明書の要求を作成するには

1.  エッジサーバーの展開ウィザードで、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [実行] を**もう一度**クリックします。
    
    <div>
    

    > [!NOTE]  
    > 組織で AOL とのパブリックインスタントメッセージング (IM) 接続をサポートしたい場合は、Lync Server Deployment ウィザードを使って証明書を要求することはできません。 代わりに、このトピックで後述する「AOL でのパブリック IM 接続をサポートするための外部インターフェイスの証明書要求を作成するには」の手順を実行します。<BR>プール内の1つの場所に複数のエッジサーバーがある場合は、いずれかのエッジサーバーで Lync Server 2013 証明書ウィザードを実行することができます。

    
    </div>

2.  [**利用可能な証明書タスク**] ページで、[**新しい証明書要求を作成する**] をクリックします。

3.  [**証明書の要求**] ページで、[**外部境界の証明書**] をクリックします。

4.  [**遅延または即時要求**] ページで、[**今すぐ要求を準備するが、後で送信**する] チェックボックスをオンにします。

5.  [**証明書要求ファイル**] ページで、要求を保存するファイルの完全パスとファイル名を入力します (たとえば、c:\\cert\_外部\_edge)。

6.  [**代替証明書テンプレートの指定**] ページで、既定の web サーバテンプレート以外のテンプレートを使用するには、[**選択された証明機関に別の証明書テンプレートを使用**する] チェックボックスをオンにします。

7.  [**名前とセキュリティの設定**] ページで、次の操作を行います。
    
      - [**フレンドリ名**] に、証明書の表示名を入力します。
    
      - **ビット長**では、ビット長 (通常は**2048**の既定値) を指定します。
    
      - [**証明書の秘密キーをエクスポート可能としてマーク**する] チェックボックスがオンになっていることを確認します。

8.  [**組織の情報**] ページで、組織の名前と組織単位 (たとえば、部門や部署) を入力します。

9.  [**地理情報**] ページで、場所情報を指定します。

10. [ **Subject Name/Subject name** ] ページには、ウィザードによって自動的に入力される情報が表示されます。 追加の件名の代替名が必要な場合は、次の2つの手順で指定します。

11. [**サブジェクト代替名 (san)] ページの Sip ドメイン設定**で、[Domain] チェックボックスをオンにして sip を追加します。\<[\>件名の代替名] ボックスの一覧に sipdomain エントリを入力します。

12. [**追加のサブジェクト代替名の構成**] ページで、必要なその他のサブジェクトの代替名を指定します。

13. [**要求の概要**] ページで、要求の生成に使用する証明書情報を確認します。

14. コマンドの実行が完了したら、次の操作を行います。
    
      - 証明書要求のログを表示するには、[**ログの表示**] をクリックします。
    
      - 証明書の要求を完了するには、[**次へ**] をクリックします。

15. [**証明書要求ファイル**] ページで、次の操作を行います。
    
      - 生成された証明書署名要求 (CSR) ファイルを表示するには、[**表示**] をクリックします。
    
      - ウィザードを閉じるには、[**完了**] をクリックします。

16. 公開 CA に送信できる場所に出力ファイルをコピーします。

</div>

<div>

## <a name="to-create-a-certificate-request-for-the-external-interface-of-the-edge-server-to-support-public-im-connectivity-with-aol"></a>AOL とのパブリック IM 接続をサポートするために、エッジサーバーの外部インターフェイスの証明書要求を作成するには

1.  必要なテンプレートが CA で利用できるようになったら、エッジサーバーから次の Windows PowerShell コマンドレットを使用して証明書を要求します。
    
        Request-CsCertificate -New -Type AccessEdgeExternal  -Output C:\ <certfilename.txt or certfilename.csr>  -ClientEku $true -Template <template name>
    
    Lync Server 2013 で提供されるテンプレートの既定の証明書名は、Web サーバーです。 既定のテンプレート\<とは\>異なるテンプレートを使用する必要がある場合は、テンプレート名のみを指定します。
    
    <div>
    

    > [!NOTE]  
    > 組織で AOL とのパブリック IM 接続をサポートしたい場合は、証明書ウィザードの代わりに Windows PowerShell を使用して、アクセスエッジサービスの外部境界に証明書を割り当てるように要求する必要があります。 これは、証明書ウィザードで証明書を要求するために使用される Lync Server 2013 Web サーバーテンプレートがクライアント EKU 構成をサポートしていないためです。 Windows PowerShell を使用して証明書を作成する前に、CA 管理者がクライアント EKU をサポートする新しいテンプレートを作成して展開する必要があります。

    
    </div>

</div>

<div>

## <a name="to-submit-a-request-to-a-public-certification-authority"></a>公開証明機関に要求を送信するには

1.  出力ファイルを開きます。

2.  証明書署名リクエスト (CSR) の内容をコピーして貼り付けます。

3.  メッセージが表示されたら、次のように指定します。
    
      - **Microsoft**をサーバープラットフォームとしてお選びください。
    
      - バージョンとしての**IIS** 。
    
      - 使用の種類としての**Web サーバー** 。
    
      - 返信形式としての**PKCS7** 。

4.  公開 CA が自分の情報を確認したら、証明書に必要なテキストを含むメールメッセージを受信します。

5.  メールメッセージからテキストをコピーし、ローカルコンピューターのテキストファイル (.txt) にコンテンツを保存します。

</div>

<div>

## <a name="to-import-the-certificate-for-the-external-interface-of-the-edge-server"></a>エッジサーバーの外部インターフェイスの証明書をインポートするには

1.  証明書要求を作成したのと同じエッジサーバーに、管理者グループのメンバーとしてログオンします。

2.  展開ウィザードの [**エッジサーバーの展開**] ページで、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [実行] を**もう一度**クリックします。

3.  [**利用可能な証明書タスク**] ページで、[ **. p7b、.pfx、または .cer ファイルから証明書をインポートする**] をクリックします。

4.  [**証明書のインポート**] ページで、[**参照**] をクリックして、エッジサーバーの外部インターフェイスに対して要求した証明書を見つけて選択します (または、完全なパスとファイル名を入力します)。 証明書に秘密キーが含まれている場合は、[**証明書ファイルに証明書の秘密キーが含まれ**ています] を選び、秘密キーのパスワードを入力します。 [ **次へ**] をクリックします。

5.  [**証明書の概要のインポート**] ページで、概要を確認し、[**次へ**] をクリックします。

6.  **コマンドの実行**時に、インポートの結果を確認し、必要に応じて [**ログの表示**] をクリックし、[**完了**] をクリックして証明書のインポートを完了します。

7.  エッジサーバープールを構成している場合は、このトピックで後述する「プール内のエッジサーバーの秘密キーで証明書をエクスポートする」の手順に従って、秘密キーを持つ証明書をエクスポートします。 エクスポートされた証明書ファイルを他のエッジサーバーにコピーし、各エッジサーバー上のコンピューターストアにインポートします。

</div>

<div>

## <a name="to-export-the-certificate-with-the-private-key-for-edge-servers-in-a-pool"></a>プール内のエッジサーバーの秘密キーを使って証明書をエクスポートするには

1.  証明書をインポートしたのと同じエッジサーバーに、管理者グループのメンバーとしてログオンします。

2.  [**スタート**] をクリックし、[**実行**] をクリックして、「 **MMC**」と入力します。

3.  Microsoft 管理コンソール (MMC) コンソールで、[**ファイル**] をクリックし、[スナップインの**追加と削除**] をクリックします。

4.  [**スナップインの追加と削除**] で [**証明書**] をクリックし、[**追加**] をクリックします。

5.  [**証明書**] ダイアログボックスで、[**コンピューターアカウント**]、[**次へ**] の順にクリックし、[**ローカルコンピューター] (このコンソールが実行されているコンピューター)** を選択し、[**完了**] をクリックし、[ **OK** ] をクリックします。 **** MMC コンソールの構成を完了します。

6.  [**証明書 (ローカルコンピューター)** ] をダブルクリックして、証明書ストアを展開し、[**個人用**] をダブルクリックして、[**証明書**] をダブルクリックします。
    
    <div>
    

    > [!IMPORTANT]  
    > ローカルコンピューターの証明書の個人用ストアに証明書がない場合は、インポートされた証明書に関連付けられた秘密キーがありません。 要求とインポートの手順を確認します。 問題が解決しない場合は、証明機関の管理者またはプロバイダーにお問い合わせください。

    
    </div>

7.  **ローカルコンピューターの証明書の個人用ストア**で、エクスポートする証明書を右クリックし、[**すべてのタスク**] をクリックして、[**エクスポート**] をクリックします。

8.  証明書のエクスポートウィザードで、[**次へ**] をクリックし、[**はい、秘密キーをエクスポート**します] をクリックして、[**次へ**] をクリックします。
    
    <div>
    

    > [!NOTE]  
    > <STRONG>[はい、秘密キーをエクスポート</STRONG>します] を選択できない場合は、この証明書に関連付けられている秘密キーがエクスポート対象としてマークされていません。 エクスポートを続行する前に、証明書が秘密キーのエクスポートを許可するようにマークされていることを確認して、証明書をもう一度要求する必要があります。 証明機関の管理者またはプロバイダーにお問い合わせください。

    
    </div>

9.  [エクスポートファイルの形式] ダイアログボックスで、[ **Personal Information\#Exchange – PKCS 12 ()] を選びます。PFX)** を選び、次のように選択します。
    
      - 可能であれば証明のパスにすべての証明書を含める
    
      - すべての拡張プロパティをエクスポートする
        
        <div>
        

        > [!WARNING]  
        > エッジサーバーから証明書をエクスポートするときに、<STRONG>エクスポートが正常に完了した場合は、[秘密キーの削除</STRONG>] を選択しないでください。 このオプションを選択すると、証明書と秘密キーをこのエッジサーバーにインポートする必要があります。

        
        </div>

10. [ **次へ**] をクリックします。

11. 秘密キーのパスワードを入力し、確認のためにもう一度パスワードを入力して、[**次へ**] をクリックします。

12. エクスポートする証明書のパスとファイル名を入力し、ファイル拡張子に .pfx を指定します。 パスは、プール内の他のすべてのエッジサーバーからアクセス可能であるか、またはリムーバブルメディア (USB フラッシュドライブなど) を使用して転送できるものである必要があります。 [ **次へ**] をクリックします。

13. 「**証明書のエクスポートウィザードの完了**」の概要を確認し、[**完了**] をクリックします。

14. [エクスポートの成功] ダイアログボックスで、[ **OK**] をクリックします。

15. このトピックの前半にある「エッジサーバーの外部インターフェイス用の証明書をインポートする」の手順に従って、エクスポートされた証明書ファイルを他のエッジサーバーにインポートします。

</div>

<div>

## <a name="to-assign-the-certificate-for-the-external-interface-of-the-edge-server"></a>エッジサーバーの外部インターフェイスの証明書を割り当てるには

1.  各エッジサーバーの展開ウィザードで、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [実行] を**もう一度**クリックします。

2.  [**利用可能な証明書タスク**] ページで、[**既存の証明書を割り当てる**] をクリックします。

3.  [**証明書の割り当て**] ページで、[**外部境界の証明書**] をクリックし、[**高度な証明書の使用法**] チェックボックスをオンにします。

4.  [**証明書の使用状況の詳細設定**] ページで、すべての使用状況に対して証明書を割り当てるためのすべてのチェックボックスをオンにします。

5.  [**証明書ストア**] ページで、エッジサーバーの外部インターフェイスに対して要求およびインポートされた公開証明書を選びます。
    
    <div>
    

    > [!NOTE]  
    > 要求およびインポートされた証明書が一覧にない場合は、トラブルシューティングの方法の1つとして、証明書のサブジェクト名とサブジェクトの代替名が証明書のすべての要件を満たしていることを確認します。証明書と証明書チェーン上記の手順を使用する代わりに、証明書が適切な証明書ストア (ユーザーまたはサービス証明書ストアではなく、コンピューターの証明書ストア) に含まれていることを確認します。

    
    </div>

6.  [**証明書の割り当ての概要**] ページで、設定を確認し、[**次へ**] をクリックして証明書を割り当てます。

7.  ウィザードの完了ページで [**完了**] をクリックします。

8.  この手順を実行してエッジ証明書を割り当てると、各サーバーで証明書スナップインを開き、[**証明書 (ローカルコンピューター)**]、[**個人**]、[**証明書**] の順に展開して、[詳細] ウィンドウで、証明書が表示されます。

9.  展開に複数のエッジサーバーが含まれている場合は、各エッジサーバーに対してこの手順を繰り返します。

</div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

