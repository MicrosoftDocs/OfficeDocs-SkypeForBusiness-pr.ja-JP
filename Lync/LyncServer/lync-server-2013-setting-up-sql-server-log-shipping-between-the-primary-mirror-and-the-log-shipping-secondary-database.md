---
title: 'Lync Server 2013: プライマリ ミラーとログ配布セカンダリ データベース間での SQL Server ログ配布のセットアップ'
TOCTitle: プライマリ ミラーとログ配布セカンダリ データベース間での SQL Server ログ配布のセットアップ
ms:assetid: 4e8e9ce9-4301-47f2-a0c3-669afeb53295
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/JJ204887(v=OCS.15)
ms:contentKeyID: 48272044
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013 でのプライマリ ミラーとログ配布セカンダリ データベース間での SQL Server ログ配布のセットアップ

 

_**トピックの最終更新日:** 2013-02-21_

プライマリの 常設チャット データベースがミラー データベースにフェールオーバーする場合にログ配布を続行するには、次の手順を実行します。

1.  プライマリの 常設チャット データベースを手動でミラーにフェールオーバーします。これは、Lync Server 管理シェルおよび **Invoke-CsDatabaseFailover** コマンドレットを使用して行います。詳細については、「[Lync Server 2013 でのバックエンド サーバーの高可用性を実現するための SQL ミラーリングの展開](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)」の Lync Server 管理シェル コマンドレットの使用についての説明を参照してください。

2.  SQL Server Management Studio を使用して、プライマリの 常設チャット サーバーのミラー インスタンスに接続します。

3.  SQL Server エージェントが動作している状態にします。

4.  mgc データベースを右クリックし、\[**プロパティ**\] をクリックします。

5.  \[**ページの選択**\] で、\[**トランザクション ログの配布**\] をクリックします。

6.  \[**ログ配布構成のプライマリ データベースとして有効にする**\] チェック ボックスをオンにします。

7.  \[**トランザクション ログのバックアップ**\] で、\[**バックアップの設定**\] をクリックします。

8.  \[**バックアップ フォルダーのネットワーク パスを指定する**\] ボックスに、トランザクション ログのバックアップ フォルダーとして作成した共有場所へのネットワーク パスを入力します。

9.  バックアップ フォルダーがプライマリ サーバーに存在する場合は、\[**バックアップ フォルダーがプライマリ サーバーに存在する場合は、バックアップ フォルダーのローカル パスを入力 (例: c:\\backup)**\] ボックスにバックアップ フォルダーのローカル パスを入力します (バックアップ フォルダーがプライマリ サーバーに存在しない場合は、このボックスを空のままにします)。
    

    > [!IMPORTANT]
    > プライマリ サーバーの SQL Server サービス アカウントがローカル システム アカウントで動作している場合は、プライマリ サーバーにバックアップ フォルダーを作成して、そのフォルダーのローカル パスを指定する必要があります。



10. \[**次の期間を経過したファイルを削除する**\] パラメーターと \[**バックアップが次の期間内に行われない場合は警告する**\] パラメーターを構成します。

11. \[**バックアップ ジョブ**\] の \[**スケジュール**\] ボックスに一覧表示されるバックアップ スケジュールを確認してください。インストールのスケジュールをカスタマイズするには、\[**スケジュール**\] をクリックし、必要に応じて SQL Server エージェントのスケジュールを調整します。
    

    > [!IMPORTANT]
    > プライマリ データベースと同じ設定を使用します。



12. \[**圧縮**\] で、\[**既定のサーバー設定を使用する**\] をクリックして、\[**OK**\] をクリックします。

13. \[**セカンダリ サーバー インスタンスとデータベース**\] で、\[**追加**\] をクリックします。

14. \[**接続**\] をクリックして、セカンダリ サーバーとして構成した SQL Server のインスタンスに接続します。

15. \[**セカンダリ データベース**\] ボックスで、一覧から \[**mgc**\] データベースを選択します。

16. \[**セカンダリ データベースの初期化**\] タブで、\[**いいえ、セカンダリ データベースは初期化されています**\] オプションをクリックします。

17. \[**ファイルのコピー**\] タブの \[**ファイルのコピー先フォルダー**\] に、トランザクション ログのバックアップをコピーするフォルダーのパスを入力して、\[**OK**\] をクリックします。多くの場合、このフォルダーは、セカンダリ サーバー上にあります。

18. \[**スクリプトの構成**\] ドロップダウン リストを開き、\[**スクリプト構成を新規クエリ ウィンドウに保存**\] をクリックします。

19. \[**データベースのプロパティ**\] に表示された新規クエリ ウィンドウで \[**OK**\] をクリックして、構成プロセスを開始します。

20. クエリの前半 ("-- \*\*\*\*\*\* 終了: プライマリ \[サーバー名\] で実行されるスクリプト \*\*\*\*\*\*" の行まで。手順 18. を参照) を選択および実行します。
    

    > [!IMPORTANT]
    > SQL Server Management Studio では、SQL Server ログ配布構成において複数のプライマリ データベースがサポートされていないため、このスクリプトを手動で実行する必要があります。



21. \[**キャンセル**\] をクリックして、ログ配布構成パネルを閉じ、(フェールオーバー時に) プライマリ データベースとミラー化されたデータベース両方でログ配布を適切に実装する実用的なセットアップを確立します。

22. プライマリの 常設チャット データベースをプライマリに手動でフェールバックします。これは、Lync Server 管理シェルおよび **Invoke-CsDatabaseFailover** コマンドレットを使用して行います。詳細については、「[Lync Server 2013 でのバックエンド サーバーの高可用性を実現するための SQL ミラーリングの展開](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)」の Lync Server 管理シェル コマンドレットの使用についての説明を参照してください。

## 関連項目

#### 概念

[Lync Server 2013 でのバックエンド サーバーの高可用性を実現するための SQL ミラーリングの展開](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)  
[Lync Server 2013 でのバックエンド サーバーの高可用性を実現するための SQL ミラーリングの展開](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)

