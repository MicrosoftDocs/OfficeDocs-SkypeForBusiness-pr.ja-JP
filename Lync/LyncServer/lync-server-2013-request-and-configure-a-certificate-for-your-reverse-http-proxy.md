---
title: 'Lync Server 2013: リバース HTTP プロキシ用の証明書の要求と構成'
TOCTitle: リバース HTTP プロキシ用の証明書の要求と構成
ms:assetid: 4b70991e-5f10-40a3-b069-0b227c3a3a0a
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Gg429704(v=OCS.15)
ms:contentKeyID: 48272005
ms.date: 12/10/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013 でのリバース HTTP プロキシ用の証明書の要求と構成

 

_**トピックの最終更新日:** 2016-12-08_

Microsoft Lync Server 2013 を実行する内部サーバーに対してサーバー証明書を発行した CA インフラストラクチャでは、Microsoft Forefront Threat Management Gateway 2010 または IIS ARR を実行するサーバーにルート証明機関 (CA) の証明書をインストールする必要があります。

また、リバース プロキシ サーバーに Web サーバーのパブリック証明書をインストールする必要があります。この証明書のサブジェクトの別名には、リモート アクセスが有効なユーザーに所属する各プールの公開済みの外部完全修飾ドメイン名 (FQDN)、およびエッジ インフラストラクチャ内で使用されるすべてのディレクターまたはディレクター プールの外部 FQDN が含まれます。またサブジェクトの別名には、次の表のように、簡単な会議 URL、簡単なダイヤルイン URL が含まれる必要があります。また、モバイル アプリケーションを展開し、自動検出を使用する予定の場合は、外部自動検出サービス URL も含まれる必要があります。


<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>値</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>サブジェクト名</p></td>
<td><p>プールの FQDN</p></td>
<td><p>webext.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>サブジェクト名の別名</p></td>
<td><p>プールの FQDN</p></td>
<td><p>webext.contoso.com</p>
<div>

> [!IMPORTANT]
> サブジェクト名は、サブジェクトの別名にも存在する必要があります。


</div></td>
</tr>
<tr class="odd">
<td><p>サブジェクト名の別名</p></td>
<td><p>オプションの ディレクター Web サービス (ディレクター が展開されている場合)</p></td>
<td><p>webdirext.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>サブジェクト名の別名</p></td>

> [!NOTE]
> すべての簡単な会議 URL は、サブジェクトの別名に含まれる必要があります。 各 SIP ドメインに、アクティブになっている簡単な会議 URL が 1 つ以上含まれている必要があります。

</div></td>
<td><p>meet.contoso.com</p></td>
</tr>
<tr class="odd">
<td><p>サブジェクト名の別名</p></td>
<td><p>簡単なダイヤルイン URL</p></td>
<td><p>dialin.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>サブジェクト名の別名</p></td>
<td><p>Office Web Apps サーバー</p></td>
<td><p>officewebapps01.contoso.com</p></td>
</tr>
<tr class="odd">
<td><p>サブジェクト名の別名</p></td>
<td><p>外部自動検出サービス URL</p></td>
<td><p>lyncdiscover.contoso.com</p>

> [!NOTE]
> Microsoft Exchange Server も使用している場合は、Exchange 自動検出および Web サービス URL のリバース プロキシ ルールも構成する必要があります。

</div></td>
</tr>
</tbody>
</table>



> [!NOTE]
> 内部展開が複数の Standard Edition サーバーまたはフロントエンド プールで構成されている場合は、外部 Web ファームの FQDN ごとに Web 公開ルールを構成する必要があります。また、それぞれが証明書と Web リスナーを持つようにするか、またはすべてのプールが使用する名前がサブジェクトの別名に含まれる証明書を取得し、これを Web リスナーに割り当てて、複数の Web 公開ルールで共有する必要があります。


## 証明書要求を作成する

リバース プロキシで、証明書要求を作成します。別のコンピューターで要求を作成しますが、署名された証明書をパブリック証明機関から受け取った後で秘密キーと共にエクスポートし、リバース プロキシにインポートする必要があります。


> [!NOTE]
> 証明書要求または証明書署名要求 (CSR) は、信頼されたパブリック証明機関 (CA) に対する、要求元コンピューターの公開キーの検証および署名の要求です。証明書の生成時には、公開キーと秘密キーが作成されます。公開キーのみが共有および署名されます。名前からわかるように、公開キーはあらゆるパブリックな要求に使用できます。情報を安全に交換してコンピューターの ID を検証する必要があるクライアント、サーバー、その他の要求元が公開キーを使用します。秘密キーは安全性が確保されており、そのキーの組を作成したコンピューターのみが秘密キーを使用して、公開キーで暗号化されたメッセージを復号化します。秘密キーは他の目的にも使用できます。リバース プロキシで使用する場合、第一の目的はデータの暗号化です。第二の目的は証明書キー レベルでの証明書の認証であり、要求元がコンピューターの公開キーを持っていること、または、ユーザーが公開キーを持っているコンピューターが実際にそのコンピューターであることの検証にのみ使用されます。


> [!TIP]
> エッジ サーバーの証明書とリバース プロキシの証明書を同時に計画すると、2 つの証明書の要件が非常によく似ていることがわかります。 エッジ サーバーの証明書を構成および要求するときは、エッジ サーバーとリバース プロキシのサブジェクトの別名を結合します。証明書と秘密キーをエクスポートし、エクスポートしたファイルをリバース プロキシにコピーした後で証明書/キーの組をインポートし、その後の手順の必要に応じて割り当てる場合、リバース プロキシに同じ証明書を使用できます。 エッジ サーバーの証明書要件については「&nbsp; <A href="lync-server-2013-plan-for-edge-server-certificates.md">Lync Server 2013 でエッジ サーバー証明書を計画する</A>」を、リバース プロキシの証明書要件については「<A href="lync-server-2013-certificate-summary-reverse-proxy.md">証明書の概要 - Lync Server 2013 リバース プロキシ</A>」を参照してください。証明書は、必ずエクスポート可能な秘密キーを使用して作成します。エクスポート可能な秘密キーを使用して証明書と証明書要求を作成することは、プールされた エッジ サーバーでは必須なため、一般的に行われています。[ <STRONG>秘密キーをエクスポート可能にする</STRONG> ] フラグは、エッジ サーバーの Lync Server 展開ウィザードの証明書ウィザードで設定できます。パブリック証明機関から返された証明書要求を受け取ったら、証明書と秘密キーをエクスポートします。証明書と秘密キーをエクスポートする方法の詳細については、「<A href="lync-server-2013-set-up-certificates-for-the-external-edge-interface.md">Lync Server 2013 外部エッジ インターフェイスの証明書の設定</A>」の「プール内のエッジ サーバー用の証明書と秘密キーをエクスポートするには」を参照してください。証明書の拡張子は <STRONG>.pfx</STRONG> にする必要があります。



証明書と秘密キーの割り当て先のコンピューターで証明書署名要求を生成するには、次の操作を行います。

**証明書署名要求を作成する**

1.  Microsoft 管理コンソール (MMC) を開いて証明書スナップインを追加し、\[ **コンピューター** \] を選択して \[ **個人用** \] を展開します。 Microsoft 管理コンソール (MMC) で証明書コンソールを作成する方法の詳細については、[http://go.microsoft.com/fwlink/?LinkId=282616](http://go.microsoft.com/fwlink/?linkid=282616) を参照してください。

2.  \[ **証明書** \] を右クリックし、\[ **すべてのタスク** \]、\[ **詳細設定操作** \]、\[ **カスタム要求の作成** \] の順にクリックします。

3.  \[ **証明書の登録** \] ページで \[ **次へ** \] をクリックします。

4.  \[ **証明書の登録ポリシーの選択** \] ページで、\[ **カスタム要求** \] の下の \[ **登録ポリシーなしで続行する** \] を選択し、\[ **次へ** \] をクリックします。

5.  \[ **カスタム要求** \] ページの \[ **テンプレート** \] で、\[ **(テンプレートなし) レガシ キー** \] を選択します。証明書プロバイダーから特に指示がない限り、\[ **既定の拡張機能の抑制** \] はオフのままにします。\[ **要求の形式** \] で \[ **PKCS \#10** \] を選択し、\[ **次へ** \] をクリックします。

6.  \[ **証明書の情報** \] ページで \[ **詳細** \] をクリックし、\[ **プロパティ** \] をクリックします。

7.  \[**証明書のプロパティ**\] ページの \[**全般** \] タブで、\[ **フレンドリ名** \] フィールドにこの証明書の名前を入力します。必要に応じて、\[**説明** \] フィールドに説明を入力します。通常、このフレンドリ名と説明は管理者が証明書の目的を示すために使用します (「**Lync Server のリバース プロキシ リスナー**」など)。

8.  \[ **サブジェクト** \] タブを選択します。\[ **サブジェクト名** \] の \[ **種類** \] で、\[ **共通名** \] をサブジェクト名の種類として選択します。\[ **値** \] で、リバース プロキシに使用するサブジェクト名を入力し、\[ **追加** \] をクリックします。このトピックの表の例では、サブジェクト名 webext.contoso.com を \[サブジェクト名\] の \[値\] フィールドに入力します。

9.  \[ **サブジェクト** \] タブの \[ **別名** \] で、\[ **種類** \] のドロップダウンから \[ **DNS** \] を選択します。証明書に必要な、定義するそれぞれのサブジェクトの別名について完全修飾ドメイン名を入力し、\[ **追加** \] をクリックします。たとえば、表では meet.contoso.com、dialin.contoso.com、lyncdiscover.contoso.com という 3 つのサブジェクトの別名があります。\[ **値** \] フィールドに「meet.contoso.com」と入力し、\[ **追加** \] をクリックします。定義する必要があるサブジェクトの別名ごとに、この手順を繰り返します。

10. \[ **証明書のプロパティ** \] ページで、\[ **拡張機能** \] タブをクリックします。このページの \[ **キー使用法** \] で暗号化キーの目的を定義し、\[ **拡張キー使用法 (アプリケーション ポリシー)** \] で拡張キーの使用法を定義します。

11. \[ **キー使用法** \] の矢印をクリックして \[ **利用可能なオプション** \] を表示します。\[利用可能なオプション\] で、\[ **デジタル署名** \] をクリックし、\[ **追加** \] をクリックします。\[ **キーの暗号化** \] をクリックし、\[ **追加** \] をクリックします。\[ **重要なキー使用法として登録する** \] のチェック ボックスがオフになっている場合はオンにします。

12. \[ **拡張キー使用法 (アプリケーション ポリシー)** \] の矢印をクリックして \[ **利用可能なオプション** \] を表示します。\[利用可能なオプション\] で、\[ **サーバー認証** \] をクリックし、\[ **追加** \] をクリックします。\[ **クライアント認証** \] をクリックし、\[ **追加** \] をクリックします。\[ **重要な拡張キー使用法として登録する** \] のチェック ボックスがオンになっている場合はオフにします。キー使用法のチェック ボックス (オンにする必要があります) とは反対に、拡張キー使用法のチェック ボックスは必ずオフにしてください。

13. \[ **証明書のプロパティ** \] ページで、\[ **秘密キー** \] タブをクリックします。\[ **キーのオプション** \] の矢印をクリックします。\[ **キーのサイズ** \] で、ドロップダウンから \[ **2048** \] を選択します。この証明書が対象とするリバース プロキシとは別のコンピューターでこのキーの組と CSR を生成する場合は、\[ **秘密キーをエクスポート可能にする** \] を選択します。
    
    <table>
    <thead>
    <tr class="header">
    <th><img src="images/Gg398321.security(OCS.15).gif" title="security" alt="security" />セキュリティ 注:</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td>一般に、[ <strong>秘密キーをエクスポート可能にする</strong> ] は、ファーム内に複数のリバース プロキシがあり、ファーム内の各マシンに証明書と秘密キーをコピーする場合に選択することをお勧めします。エクスポート可能な秘密キーの使用を許可する場合は、キーの生成対象の証明書とコンピューターに細心の注意を払ってください。秘密キーが侵害されると、証明書を使用できなくなるだけでなく、コンピューターが外部アクセスやその他のセキュリティの脆弱性にさらされるおそれがあります。</td>
    </tr>
    </tbody>
    </table>


14. \[ **秘密キー** \] タブで、\[ **キーの種類** \] の矢印をクリックします。\[ **交換** \] オプションを選択します。

15. \[ **OK** \] をクリックして、設定した \[ **証明書のプロパティ** \] を保存します。

16. \[ **証明書の登録** \] ページで \[ **次へ** \] をクリックします。

17. \[ **オフライン要求を保存する場所を指定してください。** \] ページで、証明書署名要求を保存する \[ **ファイル名** \] と \[ **ファイル形式** \] の指定を求められます。

18. \[ **ファイル名** \] 入力フィールドに要求のパスとファイル名を入力するか、\[ **参照** \] を選択して要求のファイルの場所を選択し、ファイル名を入力します。

19. \[ **ファイル形式** \] で、\[ **Base 64** \] または \[ **バイナリ** \] をクリックします。証明書ベンダーから特に指示がない限り、\[ **Base 64** \] を選択します。

20. 前の手順で保存した要求ファイルを見つけ、パブリック証明機関に送信します。
    

    > [!IMPORTANT]
    > Microsoft では、統合コミュニケーション向けの要件を満たすパブリック CA を指定しています。一覧については、次のサポート技術情報の記事を参照してください。 <A href="http://go.microsoft.com/fwlink/?linkid=282625">http://go.microsoft.com/fwlink/?LinkId=282625</A>


