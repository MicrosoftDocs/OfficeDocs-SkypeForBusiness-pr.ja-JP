---
title: Skype for Business Server の統計情報マネージャーのアップグレード
ms.reviewer: ''
ms.author: kenwith
author: kenwith
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 71f5d0a0-ca81-4ac1-b590-8f854504f21f
description: '概要: は、Skype のビジネス サーバーの統計情報マネージャーをアップグレードする方法の詳細については、このトピックを読みます。'
ms.openlocfilehash: 8ff7eeb9c0abbd0482248f9b69db4013edda6495
ms.sourcegitcommit: 111bf6255fa877b3fce70fa8166e8ec5a6643434
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32198455"
---
# <a name="upgrade-statistics-manager-for-skype-for-business-server"></a>Skype for Business Server の統計情報マネージャーのアップグレード
 
**の概要:** Skype のビジネス サーバーの統計情報マネージャーをアップグレードする方法の詳細については、このトピックを参照してください。
  
Skype のビジネス サーバーの統計マネージャーの既存のインストールをアップグレードする方法について説明-Skype をビジネスのサーバーの稼働状態とパフォーマンスのデータをリアルタイムに表示できるようにする強力なツールです。 数秒ごとに数百のサーバーのパフォーマンス データをポーリングでき、その結果をすぐに統計情報 マネージャーのウェブ サイト上に表示することができます。 
  
統計マネージャーおよびリリース 2.0 の新機能に関する詳細については、 [Skype のビジネス サーバー統計マネージャーを計画](plan.md)し、 [Skype のビジネス サーバーの統計マネージャーの展開](deploy.md)を参照してください。
  
アップグレードには、以下の 2 つの異なる方法があります。
  
- **自動アップグレード**。 このメソッドでは、自動化されたスクリプトを使用します。 最も簡単な方法し、すべてのアップグレード シナリオに適用する必要があります。
    
- **手動アップグレード**。 このメソッドは、自動アップグレードに失敗した場合は例外的なバックアップ計画として提供されます。
    
## <a name="prerequisites"></a>前提条件

アップグレードする前に、以下の情報を用意する必要があります。
  
- アクティブなリスナーの証明書の拇印
    
- リスナー サービスのパスワード (リスナーおよび各エージェントのインストール時に入力)
    
- Web サイトの SSL 証明書の構成
    
## <a name="automated-upgrade"></a>自動アップグレード

このスクリプトでは、使用している現在の証明書情報およびリスナー パスワードが収集され、製品の古いバージョンをアンインストールした後、製品の新しいバージョンがインストールされます。 サーバーにインストールされている Redis インスタンスは関与しないため、キャッシュに格納されているデータはすべてアップグレードの間も保持されます。
  
1. リスナーのコンピューターで 1 つのフォルダーには、エージェント、リスナー、および更新プログラム StatsMan.ps1 のスクリプトと web サイトの新しいバージョンの MSI ファイルを配置します。
    
2. 管理用の PowerShell ウィンドウを開きます。 リスナーのコンポーネントを、以下の手順でアップグレードします。
    
   ```
   .\Update-StatsMan.ps1 -Service Listener
   ```

> [!NOTE]
> 統計マネージャーのサービスのパスワードは、インストーラーに渡されると、コマンド ・ ラインでクリア テキストで表示されます。 必要に応じて、使用しているディスプレイの画面を隠すようにしてください。 
  
1. スクリプトの実行中に、製品の古いバージョンをアンインストールするかどうかを確認するメッセージが表示されます。 「Yes (はい)」と答えます。
    
2. リスナー サービスが実行中の場合、継続する前にこのアプリケーションを閉じるかどうか確認するメッセージが表示されます。 (統計マネージャー リスナー サービスが停止されます) を終了するアプリケーションを許可します。
    
3. インストール プロセスを継続します。 サービス パスワードと証明書の拇印があらかじめ入力されていることに注意してください。 入力されていない場合は、継続する前に保存した値を追加します。
    
4. 管理用の PowerShell ウィンドウを開きます。 Web サイト コンポーネントを、以下の手順でアップグレードします。
    
   ```
   .\Update-StatsMan.ps1 -Service Website
   ```

5. スクリプトの実行中に、製品の古いバージョンをアンインストールするかどうかを確認するメッセージが表示されます。 「Yes (はい)」と答えます。
    
6. エージェント サービスが実行中の場合、継続する前にこのアプリケーションを閉じるかどうか確認するメッセージが表示されます。 このアプリケーションを閉じることを許可します (StatsMan エージェント サービスが停止します)。
    
7. インストール プロセスを継続します。 サービス パスワードと証明書の拇印があらかじめ入力されていることに注意してください。 入力されていない場合は、継続する前に保存した値を追加します。
    
8. 管理用の PowerShell ウィンドウを開きます。 エージェント コンポーネントを、以下の手順でアップグレードします。
    
   ```
   .\Update-StatsMan.ps1 -Service Agent
   ```

9. スクリプトの実行中に、製品の古いバージョンをアンインストールするかどうかを確認するメッセージが表示されます。 「Yes (はい)」と答えます。
    
10. インストール プロセスを継続します。 Web サイトのポートがあらかじめ入力されていることに注意してください。 入力されていない場合は、継続する前に保存した値を追加します。
    
11. ブラウザーを使用して、Web サイトが期待したとおりに機能することを確認します。
    
> [!NOTE]
> エージェントのアップグレードでは、-NoPrompt スイッチを使用できます。 このスイッチを使用すると、アンインストール プロセスやインストール プロセスでのメッセージの確認が省略でき、PSExec などのツールを使用して大量のサーバーのアップグレードをリモートで実行できます。 
  
### <a name="manual-upgrade"></a>手動アップグレード

何らかの理由で自動アップグレードが失敗する場合、いつでも手動アップグレードを以下の手順で実行できます。
  
1. 	リスナーのコンピューターで、リスナー、Web サイト、およびエージェント (このエージェントがこのサーバーにインストールされている場合) を [プログラムと機能] コントロール パネルを使用してアンインストールします。 
    
    > [!NOTE]
    >   アップグレード プロセスを通して Redis のキャッシュ内のデータを維持できるように、Redis をインストールしたままにしておきます。
  
2. 	上記の手順で値の保存の確認メッセージが表示されたときに保存した値を含め、コンポーネントの新しいバージョンをインストールします。コンポーネントのインストールの詳細については、「[Statistics Manager の展開](deploy.md#BKMK_Deploy)」を参照してください。

    
## <a name="for-more-information"></a>関連情報
<a name="BKMK_Fixed"> </a>

詳細については、以下を参照してください。
  
- [Skype for Business Server の統計情報マネージャーの計画](plan.md)
    
- [Skype for Business Server の Statistics Manager の展開](deploy.md)
    
- [Skype for Business Server の Statistics Manager のトラブルシューティング](troubleshoot.md)
