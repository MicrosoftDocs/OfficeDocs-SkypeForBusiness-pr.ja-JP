---
title: Skype for Business Server 2015 ストレスとパフォーマンス ツールの使用
ms.reviewer: ''
ms.author: serdars
author: SerdarSoysal
ms.date: 2/13/2018
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
ms.assetid: 93f42230-24a2-418d-9770-bf4670a9d78f
description: Skype for Business Server 2015 ストレスとパフォーマンス ツールを実行するには、ユーザー、連絡先、およびユーザー プロファイルの両方を管理し、実行するためのツールを構成してから、ツールによって生成された出力または結果を確認できる必要があります。
ms.openlocfilehash: 300da4109ddbdbf06f6dcfbe241cc45c83ec82ca
ms.sourcegitcommit: 296862e02b548f0212c9c70504e65b467d459cc3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/25/2022
ms.locfileid: "65675729"
---
# <a name="using-the-skype-for-business-server-2015-stress-and-performance-tool"></a>Skype for Business Server 2015 ストレスとパフォーマンス ツールの使用
 
Skype for Business Server 2015 ストレスとパフォーマンス ツールを実行するには、ユーザー、連絡先、およびユーザー プロファイルの両方を管理し、実行するためのツールを構成してから、ツールによって生成された出力または結果を確認できる必要があります。
  
Skype for Business Server 2015 Stress and Performance Tool の実行には 4 つの領域があります (実行可能ファイルはLyncPerfTool.exe)。
  
- [ユーザーと連絡先を作成する](using-the-tool.md#BKMK_CreateUsersAndContacts)
    
- [ユーザー プロファイルを構成する](using-the-tool.md#BKMK_UserProfile)
    
- [LyncPerfTool を実行する](using-the-tool.md#BKMK_RunTool)
    
- [結果の解釈](using-the-tool.md#BKMK_Interpret)
    
## <a name="create-users-and-contacts"></a>ユーザーと連絡先を作成する
<a name="BKMK_CreateUsersAndContacts"> </a>

Skype for Business Server 2015 (SB 2015) ユーザー プロビジョニング ツール (UserProvisioningTool.exe) を使用して、ストレステストとパフォーマンス テストのユーザーと連絡先を作成する必要があります。
  
これは、トピックを読む際に役立つ可能性がある有用な用語の一覧です。
  
- **組織単位** - Active Directory Domain Services (AD DS) 組織単位 (OU)。
    
- **フェデレーション/クロス プール** - 他のインスタント メッセージング (IM) サービスのユーザーと通信できるユーザー。
    
- **配布リスト** - または DLs。 これらは、AD DS ユーザーの一覧を含む AD DS 内のオブジェクトです。 これらは、複数のユーザーグループ間のコミュニケーションを促進するために使用されます。
    
- **場所情報サービス** - 2015 Skype for Business Server サービス。電話ごとに有効にし、構成すると、拡張 911 (E911) サービスの物理的な場所を取得できます。
    
- **米国の電話番号** - 逆引き番号参照 (RNL) での着信および発信呼び出しのルーティングに使用される SIP URI に加えて、ユーザーに割り当てられた番号を電話します。
    
### <a name="create-users-and-contacts-by-using-userprovisioningtoolexe"></a>UserProvisioningTool.exeを使用してユーザーと連絡先を作成する

> [!NOTE]
> 開始する前に、このツールを実行するために Domain Admins セキュリティ グループのメンバーとしてログインしていることを確認してください。 Active Directory ユーザーを作成するため、これを行う必要があります。 
  
Skype for Business Server ユーザー プロビジョニング ツールを使用して、読み込みシミュレーション用のユーザーと連絡先を作成する必要があります。
  
**Skype for Business Server ユーザー プロビジョニング ツール** は、**Skype for Business Serverストレスおよびパフォーマンス ツール パッケージと共に** インストールされます。 パッケージ インストーラー (CapacityPlanningTool.msi) が、テストするフロントエンド サーバーまたはStandard Edition サーバーで実行されていることを確認します。
  
Skype for Business Server ユーザー プロビジョニング ツールを開始するには、ファイル UserProvisioningTool.exe (%InstalledDirectory%LyncStressAndPerfTool\LyncStress にあります) をフロント エンド サーバーまたはStandard Edition サーバーで実行します。
  
> [!IMPORTANT]
> 多数のユーザー (たとえば、10,000 人以上) を作成する場合は、UserProvisioningTool.exeを実行します。 これは、ツールが  *新しい*  AD ユーザーを作成して構成するため、これを行う必要があります。
  
ユーザー プロビジョニング ツールが開いたら、[構成] をクリックし、[構成の読み込み] を選択します。 
  
ユーザーと連絡先の構成を開始するには、パッケージに含まれる既定のファイル ("SampleData.xml" と呼ばれる) を読み込みます。 これにより、デプロイに関連するように変更する必要があるサンプル データがフィールドに事前入力されます。
  
カスタマイズした設定が既に含まれている構成済みの XML ファイルがある場合は、代わりにそのファイルを読み込むことができます。 以下のセクションで説明するように、ユーザー プロビジョニング ツールのフィールドに入力します。
  
### <a name="to-configure-server-options"></a>サーバー オプションを構成するには:

1. [**フロントエンド プールの FQDN**] フィールドに、Standard Edition サーバーの完全修飾ドメイン名 (FQDN) またはユーザーをホストするフロントエンド プールを入力します。
    
2. [ **ユーザー名プレフィックス** ] フィールドに、テスト目的 ("TestUser" など) でユーザー名を作成するために使用するプレフィックスを入力します。
    
3. [ **パスワード** ] フィールドに、すべてのテスト ユーザー アカウントで使用するパスワードを入力します。
    
4. [ **アカウント ドメイン]** フィールドに、現在の AD ドメインのドメイン名 (テスト ユーザーを作成するドメイン) を入力します。
    
5. [ **組織単位]** フィールドに、これらのテスト ユーザーを作成する AD ドメインの名前を入力します。 (OU がまだ存在しない場合は、自動的に作成されます)。
    
6. **[電話エリア コード**] フィールドに、すべてのテスト ユーザー アカウントで使用する 3 桁のエリア コードを入力します。 選択した市外局番が AD の他のユーザーの市外局番と競合しないことを確認します。
    
7. エンタープライズ VoIPのテスト ユーザーを有効にする場合は、[**音声が有効]** チェック ボックスをオンにします。
    
8. [ **ユーザー数** ] フィールドで、作成するテスト ユーザーの合計数を指定します。
    
9. **[スタート インデックス**] フィールドで、ユーザー名プレフィックスのサフィックスとして使用する開始番号を指定します (たとえば、プレフィックスが "TestUser" で、次の例では最初の名前は "0" で終わる)。
    
     ![ユーザー作成タブを示すユーザー プロビジョニング ツール。](../../media/591d8280-8979-4a8c-83bc-af126e87bf29.png)
  
#### <a name="create-users-button"></a>[ユーザーの作成] ボタン

[ **ユーザーの作成** ] ボタンをクリックすると、入力した入力パラメーターが検証されます。 検証エラーがある場合は、修正を求めるメッセージが表示されます。 または、すべての値が正しい場合、ユーザーは AD (指定した OU) に表示されます。 ツールが実行されると、ツールの下部に進行状況バーが表示されます。 進行状況バーがアクティブな間は、アプリケーションを閉じないでください。
  
ユーザーの作成には時間がかかるので、それに応じて計画を立ててください。 このプロセスには、数人のユーザーが数分から数時間、多数のユーザーに対して数時間かかる場合があります。
  
テスト環境で AD ドメイン コントローラーにアクセスできない場合でも、作成対象として指定した範囲内のユーザーの 1 人としてログインすることで、ユーザーの作成を検証できます。 プレフィックスとサフィックスを、ユーザー名として@sipDomainと共に必ず使用してください。 例を次に  <em>示します。TestUser20@contoso.net</em>  .
  
> [!NOTE]
> ユーザーが既に存在する場合は、[ユーザーの作成] ボタンをクリックすると、構成が変更されて更新されます。 
  
#### <a name="delete-users-button"></a>[ユーザーの削除] ボタン

[ **ユーザーの削除** ] ボタンをクリックすると、タブの入力パラメーターが検証されます。 検証エラーがある場合は、修正を求めるメッセージが表示され、入力値が正しい場合は、指定したテスト ユーザーが無効になり、Active Directory から削除されます。 ここでも、このタブの下部に進行状況バーが表示され、進行状況バーがアクティブな間はアプリケーションを閉じることはできません。
  
> [!NOTE]
> 米国形式の電話番号のみがサポートされています。 電話番号は常にユーザーに割り当てられ、UserProvisioningTool.exeによって作成されたすべてのユーザーは既定でエンタープライズ VoIPに対して有効になっています。 会議の自動応答や UC-PSTN 通話など、電話番号を使用するすべてのシナリオでは、この電話番号を使用して通話を適切にルーティングします。 このため、  *すべてのユーザー*  に *一意の電話番号*  が必要です。
  
> [!NOTE]
> **ユーザーを 2 回作成する必要がある場合は、別のエリア コードを使用するか、Disable-CsUser コマンドレットを使用して以前のユーザーが無効になっている場合を除き、コマンドは失敗します。**
  
> [!IMPORTANT]
> 連絡先を作成する前に、まずユーザー のレプリケーションを完了する必要があります ([ユーザー] タブから行います)。 
  
> [!IMPORTANT]
> ユーザーを作成したばかりの場合は、Skype for Business Serverレプリケーションが完了し、データベース内のユーザー アカウントに入力されるまで待つ必要があります。 **ユーザーがレプリケートを完了していない場合は、エラーが表示されます。** Skype for Business Server 2015 フロントエンド サービスが開始された場合、または指定した合計数の最後のユーザーで Get-CsUser コマンドレットを正常に実行した場合、ユーザーがレプリケートを完了した時点がわかります。
  
#### <a name="contacts-creation-tab"></a>[連絡先の作成] タブ

このタブでは、テスト用のユーザーの連絡先の詳細を指定できます。
  
![[コンテンツの作成] タブを示すユーザー プロビジョニング ツール。](../../media/dfb7fdf1-fb97-4e8e-8608-c4995f95dd5b.png)
  
### <a name="to-configure-users-contacts-do-the-following"></a>ユーザーの連絡先を構成するには、次の操作を行います。

1. [ **ユーザーあたりの平均連絡先** 数] フィールドに、各ユーザーの連絡先リストに入力する連絡先の平均数を入力します。
    
2. すべてのユーザーに対して同数の連絡先を作成する場合は、[ **固定** ] チェック ボックスをオンにします。 ユーザーに対して作成された連絡先の数を変更する場合は、そのチェック ボックスをオフにします。
    
3. [ **ユーザーあたりの平均連絡先グループ数]** フィールドに、ユーザーごとの連絡先グループの数を入力します。 この数は、 **ユーザーあたりの平均連絡先** 数より小さくする必要があります。
    
4. [ **フェデレーション/クロス プール連絡先の割合** ] フィールドで、0 ~ 100 の数値を指定します。 この割合の連絡先は、フェデレーション ユーザーと共に作成されます。
    
5. [ **フェデレーション/クロス プール ユーザー プレフィックス** ] フィールドで、ローカル ユーザーの連絡先リストに追加されるフェデレーション ユーザーのユーザー名を指定します。
    
6. [ **フェデレーション/クロス プール ユーザー SIP ドメイン]** フィールドで、フェデレーション ユーザーの SIP ドメイン名を指定します。
    
7. [ **ユーザー作成** ] タブで、情報が正しいことを確認します。 連絡先は、[ユーザー作成] タブの値から作成されます。
    
8. [ **連絡先の作成** ] をクリックして、連絡先の作成を開始します。 このプロセスには数分かかる場合があります。 完了すると、"操作が正常に完了しました" というメッセージが表示されるダイアログ ボックスが表示されます。 [ユーザー作成] タブから作成されたユーザーとしてログオンすることで、作成された連絡先を検証できます。
    
    > [!NOTE]
    > 連絡先が作成されると、このツールはターゲット プール内のすべてのフロント エンド サーバーを再起動します。 この操作によって作成された連絡先の数によっては、フロントエンド サーバーの起動に最大 2 時間かかる場合があります。 
  
#### <a name="distribution-list"></a>配布リスト

Skype for Business Server 2015 ストレスとパフォーマンス ツールは、Skype for Business 2015 クライアントの配布リスト (DL) 拡張機能をシミュレートできます。 ユーザー プロビジョニング ツールで DL 展開を有効にしない場合は、この手順をスキップできます。
  
![[配布リストの作成] タブを示すユーザー プロビジョニング ツール。](../../media/4b689306-70c4-4569-9842-15c73f038eb6.png)
  
[配布リスト] タブでは、ストレスとパフォーマンス ツールが配布リストの展開機能に使用する DLs を作成できます。 DLs を作成する前に、ForestPrep の実行を含め、Skype for Business Server 2015 をデプロイする必要があります。 これが行われない場合、DL 属性は AD スキーマに存在しないため、ツールは DL を作成できません。
  
### <a name="to-configure-distribution-lists"></a>配布リストを構成するには:

1. [ **配布リストの数** ] フィールドで、作成する DLs の合計数を指定します (ここでは、ユーザー数の 2 倍の値を使用することをお勧めします)。
    
2. [ **配布リスト プレフィックス]** フィールドに、作成するすべての DLs に含まれるプレフィックス ( *testDL*  など) を入力します。 つまり、100 個の DL で、DL 名は testDL0、testDL1、testDL99 までのようになります。
    
3. [ **Dist. List の最小メンバー] フィールドに** 、各 DL に入力する最小ユーザー数を入力します。
    
4. [ **Dist の最大メンバー** 数] フィールドに、各 DL に追加するユーザーの最大数を入力します。
    
#### <a name="create-distribution-lists-button"></a>[配布リストの作成] ボタン

[配布リストの作成] ボタンをクリックすると、ツールは Active Directory にクエリを実行して、プレフィックスと番号に一致する配布リストが既に存在するかどうかを確認します。 このツールは、まだ存在しないすべての DL を作成します。 これらの新しく作成された配布リストにメンバーを追加する場合は、[ユーザー作成] タブで指定した範囲からユーザーを選択します。
  
#### <a name="location-info-service-config-tab"></a>[Location Info Service Config] タブ

Skype for Business Server 2015 ストレスとパフォーマンス ツールでは、位置情報サービスのダミー構成ファイルを生成することもできます。 通常、位置情報サービスはサーバーに大きなパフォーマンスの影響を与えません。 
  
![[場所情報サービス構成] タブを示すユーザー プロビジョニング ツール。](../../media/227662a2-e0c3-4e34-ab54-5f1459344f30.png)
  
この機能をテストする場合は、フォームに値を入力し、[LIS 構成ファイルの生成] ボタンをクリックすると、次の.CSVファイルが作成されます。
  
- LIS_Subnet.csv
    
- LIS_Switches.csv
    
- LIS_Ports.csv
    
- LIS_WAP.csv
    
これらのファイルを LIS データベースにインポートするには、次の PowerShell コマンドレットを使用します。
  
- Set-CsLisSubnet
    
- Set-CsLisSwitch
    
- Set-CsLisPort
    
- Set-CsWirelessAccessPoint
    
## <a name="configure-user-profile"></a>ユーザー プロファイルを構成する
<a name="BKMK_UserProfile"> </a>

ユーザーが作成されたら (ユーザー作成ツールを使用して) Skype for Business Server 2015 Load Configuration ツール (UserProfileGenerator.exe) を使用してユーザー プロファイルを構成できます。
  
### <a name="running-the-skype-for-business-server-2015-load-configuration-tool"></a>Skype for Business Server 2015 の構成の読み込みツールの実行

構成の読み込みツール (UserProfileGenerator.exe) を起動し、タブに入力します。 このツールは、シミュレーションを実行するために必要なクライアント コンピューターごとにディレクトリを作成します。 各クライアント ディレクトリには、Skype for Business Server 2015 ストレスとパフォーマンス ツール (LyncPerfTool.exe) を開始するためのスクリプトが付属しています。 以下のセクションでは、Skype for Business Server 2015 Load Configuration ツールの各タブのフィールドに入力する方法の例を示します。
  
> [!IMPORTANT]
> 構成の読み込みツール (UserProfileGenerator.exe) で使用されるユーザー固有の値は、プールの Skype for Business Server 2015 ユーザー作成ツール (UserProvisioningTool.exe) で指定された値と一致する必要があります。 
  
#### <a name="common-configuration-tab"></a>[共通構成] タブ

[構成の読み込み] ツールの [ **共通** 構成] タブを次に示します。 次の手順で説明するように、[共通構成] タブのフィールドに入力します。
  
![[共通構成] タブを示す [ユーザー プロビジョニング] タブ。](../../media/c25df343-3550-47fb-88e0-29194338fee2.png)
  
1. [ **使用可能なマシンの数** ] フィールドに、ストレスとパフォーマンス ツール (LyncPerfTool.exe) の実行に使用するコンピューターの数を入力します。 シミュレートする 4500 人のユーザーごとに 1 台のコンピューターを用意することをお勧めしますが、負荷レベルを減らすか、ツールの使用可能な機能のサブセットのみを使用すると、その数が異なる場合があります ([全般シナリオ] タブで [読み込みレベル] が設定されています)。
    
2. [ **ユーザー名のプレフィックス]** フィールドに、すべてのユーザーのユーザー名フィールドのプレフィックスを入力します。 Uniform Resource Identifier (URI) にログインするには、 *UserPrefix[User Start Index....(ユーザー数-1)]@User ドメイン*  (たとえば、myUser009@Contoso.com)。
    
3. [ **すべてのユーザーのパスワード]** フィールドに、ユーザーの作成時に使用するパスワードを入力します。 このフィールドを空のままにすると、ユーザー名がパスワードとして設定されます。
    
4. [ **ユーザーの開始インデックス** ] フィールドに、構成する最初のユーザーのインデックスを入力します。 読み込みの種類やレベルごとに異なる範囲を構成できますが、構成する範囲ごとに 1 回、構成の読み込みツール (UserProfileGenerator.exe) を実行する必要があります。
    
5. [ **ユーザー数** ] フィールドに、構成するユーザーの合計数を入力します。
    
6. [ **ユーザー ドメイン]** フィールドに、SIP URI に使用するドメインを入力します。 これは、Skype for Business Server 2015 フロントエンド サーバーまたはStandard Edition サーバーにログオンする各ユーザーの SIP URI を作成するために使用され、アカウント ドメインとは異なる場合があります。
    
7. [ **アカウント ドメイン]** フィールドに、AD DS ドメインログオンを入力します。
    
8. **[MPOP の割合** (複数のプレゼンスの割合)] フィールドで、複数のマシンまたはデバイスからログオンしているユーザーの割合 (10%) の値を指定します。
    
9. [ **1 秒あたりのサインイン数 (インスタンスあたり)] フィールドに** 同時エンドポイントの最大数を入力します。 これはユーザーのログインの最大数であり、推奨されるレートは 1 秒あたり 2 以下です (<=2)。
    
10. **[アクセス プロキシ] または [プールの FQDN**] フィールドに、クライアントを接続するサーバーの完全修飾ドメイン名 (FQDN) を入力します。 ユーザーが外部でログオンしている場合は、アクセス プロキシを入力する必要があります。 ユーザーが内部の場合は、Enterprise プールまたはStandard Edition サーバーの FQDN を指定します。
    
11. [ **ポート** ] フィールドに、ユーザーが SIP に使用するポートを入力します (既定値は 5061 です)。
    
12. **[外部ネットワーク サーバーの設定**] フィールドで、アクセス プロキシまたはプールの FQDN を指定し、もう一度 **ポート** を指定します。 これらの設定は、外部エンドポイントの読み込みシミュレーションにのみ使用されます。
    
#### <a name="general-scenarios-tab"></a>[一般的なシナリオ] タブ

![[一般的なシナリオ] タブを示す構成ツールを読み込みます。](../../media/45792e57-4322-4c20-956f-fe480b0de1a7.png)
  
実行するか無効のままにするかを決定することで、提供される一般的なシナリオごとに負荷レベルとパラメーターを構成できます。 一般的なオプションを次に示します。
  
> [!NOTE]
> ローカル インフォメーション サービス以外のすべてのフィールドの読み込みレベルの値は **無効**、 **低**、 **中**、 **高**、または **カスタム** です。 [無効] 以外の設定を選択すると、クライアントごとに構成が生成されます。 サーバーでサポートされる最大負荷が高くなります。medium は高負荷の 60% です。low は 30% です。 
  
- **インスタント メッセージング -** これには、ピアツーピアと会議が含まれます。読み込みレベルに適切な値を選択します。
    
- **電話会議 -** 電話会議 *専用* の読み込みレベルを選択します。 ピアツーピア呼び出しについては、 **音声シナリオ** セクションで少し後ほど取り組みます。 **[詳細設定**] タブを開いて MultiView を有効にします。
    
- **アプリケーション共有 -** アプリケーション共有の読み込みレベルを選択します。
    
- **データ コラボレーション -** データ会議を含むデータ コラボレーションの読み込みレベルを選択します。
    
- **配布リストの展開 -** [ **詳細設定** ] ボタンをクリックし、ユーザー作成ツール (UserProvisioningTool.exe) の [DL] タブで構成されているのと同じ値をフィールドに入力します。 読み込みレベルを選択します。
    
- **アドレス帳 Web クエリ -** これは、アドレス帳ファイルのダウンロードではなく、アドレス帳参照サービスです。 アドレス帳ファイルのダウンロードに対してこれを有効にする場合は、[ **詳細設定** ] ボタンをクリックし、[ **EnableABSDownload] を** [True] に設定します。 読み込みレベルの値を指定します。
    
- **応答グループ サービス -** [ **詳細設定** ] ボタンをクリックし、応答グループ サービス エージェントをプロビジョニングしたときに既に作成した応答グループの URI を指定します。 少なくとも 1 つの応答グループを選択する必要があります。 詳細を使用するには、応答グループをセミコロンで区切ります。 **RGSUriSuffixStartIndex** と **RGSUriSuffixEndIndex を** 実際の値に更新します。 読み込みレベルを選択します。
    
- **位置情報サービス -** [有効] または [無効] のいずれかの読み込みレベルを選択します。
    
> [!NOTE]
> 各シナリオの横には [詳細設定] ボタンと、既定の設定のバリエーションを有効にする一連のチェック ボックスがあります。 
  
- *アドホック* を選択すると、ツールは 1 時間を通して作成される会議のシミュレーションを生成できます。
    
- *Large Conf* を選択すると、大規模な会議シナリオがシミュレートされます。
    
-  *外部*  は、外部ユーザーもシミュレートするようにツールに指示します。
    
これらのボタンとチェック ボックスは、各シナリオに固有の追加の値であり、ストレスおよびパフォーマンス ツールの動作を変更し、カスタマイズを可能にします。
  
[全般シナリオ] タブ ([位置情報サービス] を除く) の各シナリオについて、読み込みレベルの値が **[カスタム**] の場合、[詳細設定] ダイアログ ボックスの対応するフィールドを使用して会話率が計算されます。 フィールド名はシナリオによって異なる場合がありますが、フィールドの説明は次のように表示されます。  *注: この数値は、ドロップダウン メニューから [カスタム] が選択されている場合にのみ使用*  されます。
  
**値 High**、**Medium**、**Low** は、すべてのシナリオのバランスであるユーザー モデルに沿って、モダリティごとの会話率を変更します。 予想される使用量の違いにより、モダリティごとの読み込みレベルを変更する必要がある場合は、カスタム会話レートを使用します。
  
#### <a name="voice-scenarios-tab"></a>[音声シナリオ] タブ

これは、すべての音声関連シナリオの構成用のタブです。
  
![[構成の読み込み] ツールの [音声シナリオ] タブ。](../../media/042e406f-5156-4095-a4eb-6298f24bb51f.png)
  
選択肢は以下のとおりです。
  
- **VoIP -** [ **詳細設定** ] ボタンをクリックし、PhoneAreaCode フィールドと LocationProfile (ダイヤル プラン) フィールドの値を追加します。 また、読み込みレベルの値も指定します。 VoIP または UC/PSTN ゲートウェイが有効になっている負荷レベルを選択した場合、外部通話をシミュレートするために、公衆交換電話ネットワーク (PSTN) からユニファイド コミュニケーション (UC) 構成ファイルが生成されます。
    
- **UC/PSTN ゲートウェイ -** [読み込みレベル] の値を選択する必要があります。[無効] 以外を選択した場合は、[ **詳細設定** ] ボタンをクリックして PSTN エリア コードの値を指定する必要もあります。 仲介サーバーと PSTN の下にある [ **追加]** をクリックします。 エリア コードに対してルートが構成されていることを確認します。
    
    > [!TIP]
    > Skype for Business コントロール パネルまたはSkype for Business管理シェルのいずれかを使用して、音声ルートの構成を確認できます。 
  
- **会議アテンダント -** 読み込みレベルの値を指定します。 無効以外の値を指定すると、[ **電話番号** ] フィールドが有効になります。 使用する自動応答の電話番号を入力します。 [ **詳細設定]** をクリックし、 **LocationProfile** フィールドの値を指定します。
    
- **コール パーク サービス -** ここでは、負荷レベルを指定します。
    
- **仲介サーバーと PSTN -** 使用する各仲介サーバーには、独自の PSTN シミュレーターが必要です。 シミュレーターに使用するクライアントを決定したら、構成した PSTN シミュレーターでそのコンピューターに通話をルーティングするように仲介サーバーを構成します。 [ **追加]** ボタンをクリックして、仲介サーバーの値を構成します。
    
    > [!NOTE]
    > 各シナリオの横に [詳細設定] ボタンがあります。 高度なダイアログ ボックスには、ストレスおよびパフォーマンス ツールの動作を変更し、カスタマイズを有効にする各シナリオに固有の設定が含まれています。 > [音声シナリオ] タブの各シナリオで、[読み込みレベル] の値が **[カスタム**] の場合、[詳細設定] ダイアログ ボックスの対応するフィールドを使用して会話率が計算されます。 フィールド名はシナリオによって異なる場合がありますが、フィールドの説明は次のように表示されます。  *注: この数値は、ドロップダウン メニューから [カスタム] が選択されている場合にのみ使用*  されます。
  
#### <a name="web-app-tab"></a>[Web アプリ] タブ

![[構成ツールの読み込み] タブの [Web アプリ] タブ。](../../media/505b54ef-8140-4dec-a43e-08091f592b34.png)
  
Web アプリは、フロント エンド サーバーにインストールされているユニファイド コミュニケーション Web API (UCWA) サーバーを介した会議シナリオをサポートします。 [Web アプリ] タブを使用して、すべての Web アプリ関連のシナリオを構成します。 オプションは、次のとおりです。
  
- **一般的な Web アプリ 設定 -** [**その他の設定**] ボタンをクリックし、**ReachTargetServerUrl** をフロントエンド プール VIP のディレクトリ プール仮想 IP (VIP) に設定します。
    
- **アプリケーション共有 -** [読み込みレベル] の値を選択します。
    
- **データ コラボレーション -** [読み込みレベル] の値を選択します。
    
- **インスタント メッセージング -** [読み込みレベル] の値を選択します。
    
- **音声会議 -** [読み込みレベル] の値を選択します。
    
> [!NOTE]
> 各シナリオの横に **[詳細設定]** ボタンがあります。 高度なダイアログには、ストレスとパフォーマンス ツールの動作を変更し、カスタマイズを有効にする各シナリオに固有の値が含まれています。> 読み込みレベルが **カスタム** の場合は、既定の代わりに **ConversationsPerHour** フィールドに指定された値が使用されます。
  
#### <a name="mobility-tab"></a>[モビリティ] タブ

このタブを使用して、モビリティ関連のすべてのシナリオを構成します。
  
![[構成の読み込み] ツールの [モビリティ] タブ。](../../media/30af39c2-50ea-476a-8a56-ce2ddf08517e.png)
  
ここでのオプションは次のとおりです。
  
- **一般的なモビリティ 設定 -** **[その他の設定**] をクリックし、フィールド UcwaTargetServerUrl をディレクター プール仮想 IP (VIP) またはフロントエンド プール VIP に設定します。
    
- **プレゼンスと P2P インスタント メッセージング/オーディオ -** モビリティ シミュレーションを有効にするには、[読み込みレベル] の値を選択します。
    
> [!NOTE]
> 各シナリオの横に **[詳細設定]** ボタンがあります。 高度なダイアログには、ストレスとパフォーマンス ツールの動作を変更し、カスタマイズを有効にする各シナリオに固有の値が含まれています。> 各モビリティ シナリオでは、読み込みレベルが **カスタム** の場合は、既定の代わりに **ConversationsPerHour** フィールドに指定された値が使用されます。
  
#### <a name="summary-tab"></a>[概要] タブ

[概要] タブには、各シナリオで使用するユーザーが示されます。
  
![[構成の読み込み] ツールの [概要] タブ。](../../media/436fb3f2-d73e-402d-bc6e-e8a6740819d2.png)
  
[概要] タブには、各シナリオで使用するユーザーが示されます。 
  
ユーザー番号範囲を手動で構成するには、[ **カスタム ユーザー範囲の生成を有効にする** ] チェック ボックスをオンにし、カスタマイズするユーザー範囲を含むテーブル内のシナリオをダブルクリックします。
  
**(RunClient.bat) サインイン速度に** 対応するように、生成されたバッチ ファイルに遅延を含めるために、開始時にサインイン遅延を追加します。 これは、多数のユーザーにサインインするときにサーバーの過負荷を防ぐのに役立ちます。
  
[ **ファイルの生成** ] をクリックし、構成を生成するフォルダーを選択します。 ファイルが正常に作成されると、ダイアログ ボックスが表示されます。
  
!["正常に生成された構成ファイルを読み込む" メッセージ ボックス。 [OK] をクリックするだけです。](../../media/c3c1d4a0-cb44-4837-8124-03354f5d9d8c.png)
  
## <a name="run-lyncperftool"></a>LyncPerfTool を実行する
<a name="BKMK_RunTool"> </a>

Skype for Business Server 2015 ストレスとパフォーマンス ツール (LyncPerfTool.exe) を実行する前に、ユーザー、連絡先、シナリオを作成する必要があります。 ツールを使用してこれらのアクションを実行する方法の詳細については、この記事の「[ユーザーと連絡先の作成と](using-the-tool.md#BKMK_CreateUsersAndContacts)[ユーザー プロファイルの構成」](using-the-tool.md#BKMK_UserProfile)を参照してください。 これらのツールを実行すると、必要なパラメーターを含むバッチ ファイルの一部として、ストレスおよびパフォーマンス ツールで実行されるファイルも生成されます。
  
### <a name="running-the-skype-for-business-server-2015-stress-and-performance-tool"></a>Skype for Business Server 2015 ストレスとパフォーマンス ツールの実行

構成の読み込みツール (UserProfileGenerator.exe) では、パフォーマンス カウンターを登録し、XML 構成ファイルを読み込むことで、ストレスとパフォーマンス ツール (LyncPerfTool.exe) を実行できるバッチ ファイルを作成します。 バッチ ファイルは、構成ファイルごとに LyncPerfTool.exe の 1 つのインスタンスを実行します。 バッチ ファイルを実行するには、次の手順に従います。
  
### <a name="run-the-stress-and-performance-test"></a>ストレステストとパフォーマンス テストを実行する

1. 構成フォルダーとファイルを含むフォルダーを、各クライアント コンピューター上のLyncPerfTool.exeがあるディレクトリにコピーします。 (たとえば、1.28_13.16.16 という名前のフォルダーに構成ファイルを生成した場合は、そのフォルダーをLyncPerfTool.exeが含まれるフォルダーにコピーします。 各クライアントでこれを行います)。)
    
2. クライアント フォルダーに移動し、 **RunClient** バッチ スクリプトを実行します。 Windows エクスプローラーでバッチ ファイルをダブルクリックすると、そのクライアントのすべての構成ファイルが実行されます。 次の構文を使用して、クライアント フォルダーからスクリプトを実行することもできます。
    
   ```console
   RunClient0.bat "C:\Program Files\Skype for Business Server 2015\LyncStressAndPerfTool\LyncStress" 
   ```

ストレスとパフォーマンス ツールを直接実行するには、コマンド プロンプトを開き、コマンド ラインで次のコマンドを入力します (初めて実行する場合は、このトピックの後半のメモに示すように、パフォーマンス カウンター  `regsvr32 /i /n /s LyncPerfToolPerf.dll`を登録してください)。
  
```console
LyncPerfTool.exe /file:IM_client0.xml
```

ツールに構成ファイル内の値を表示させるには、前の  `/displayfile` コマンドにパラメーターを含めて、次のようになります。
  
```console
LyncPerfTool.exe /file:IM_client0.xml /displayfile
```

プロセスを  *終了*  するには、Ctrl キーを押しながら C キーを押します。
  
> [!NOTE]
> ストレスとパフォーマンス ツールを直接実行する前に、次のコマンドを使用してパフォーマンス カウンターを登録する必要があります。  `regsvr32 /i /n /s LyncPerfToolPerf.dll`
  
> [!NOTE]
> 開始するストレスとパフォーマンス ツールのすべてのインスタンスは、ユーザーのサインインをすぐに開始します (通常は 1 秒あたり 1 人のユーザーの割合)。 
  
プールの最大ユーザー サインイン率は、1 秒あたり約 12 です。 つまり、ユーザーがまだサインインしている間は、同時に 12 個を超えるLyncPerfTool.exe インスタンスを開始しないでください。 1 秒あたり 1000 人のユーザーが完全にサインインするまでに約 20 分かかります。
  
## <a name="interpreting-the-results"></a>結果の解釈
<a name="BKMK_Interpret"> </a>

Skype for Business Server 2015 ストレスとパフォーマンス ツールには、クライアントが何をしているか、問題が発生しているかどうかを理解するのに役立つ多くのカウンターがあります。
  
### <a name="client-counters"></a>クライアント カウンター

実行中のLyncPerfTool.exeの各インスタンスには、カウンターの個別のインスタンスがあります。 各インスタンスには、そのプロセス ID によって名前が付けられます。 クライアントがオーバーロードされている場合は、他の問題が発生する可能性があります。 これらの問題を防ぐには、次の手順に従います。
  
- クライアント コンピューターの CPU とメモリの使用状況を監視します。 CPU が一貫して 90% を超えていれば、ユーザー数を減らします。
    
- メモリフットプリントが高い場合、ページ ファイルの領域が不足し始めると、問題が発生する可能性があります。 コミット料金がコンピューターの制限に達しないことを確認します。 メモリ制限に達している場合は、ページ ファイル のサイズを大きくするか、ユーザーの数を減らすことを検討してください。
    
主要なパフォーマンス カウンターの一覧を次に示します。
  
**一般的な情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|時間 (分単位)  <br/> |プロセスが開始されてからの時間。  <br/> |
|アクティブ なエンドポイント  <br/> |現在サーバーに接続されているエンドポイントの数。  <br/> |
|失敗したログオン  <br/> |エンドポイント サインイン エラーの合計数。  <br/> |
|ログオン試行  <br/> |エンドポイント サインイン試行の合計数。  <br/> |
|切断されたエンドポイント  <br/> |切断されたエンドポイントの合計数。  <br/> |
   
**プレゼンス情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|SetPresence 呼び出し  <br/> |プレゼンス変更試行の合計数。 さまざまな種類のプレゼンス変更については、SetPresence (プレゼンスの種類) 呼び出しのパフォーマンス カウンターを参照してください。  <br/> |
|SetPresence の NNN 応答  <br/> |サーバーから受信した nnn 応答コードの合計数。  <br/> |
|GetPresence 呼び出し  <br/> |プレゼンスの取得要求試行の合計数。  <br/> |
|GetPresence の NNN 応答  <br/> |サーバーから受信した nnn 応答コードの合計数。  <br/> |
   
**アドレス帳サービス情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|ABS Full/Delta ファイルのダウンロード試行  <br/> |試行された完全または差分ファイルのダウンロード要求の合計数。  <br/> |
|ABS Full/Delta ファイルのダウンロードが成功しました  <br/> |試行された完全または差分ファイルのダウンロード要求の合計数。  <br/> |
|アドレス帳 Web クエリ サービス関連カウンター  <br/> |アドレス帳ファイルのダウンロードに関連するカウンター。  <br/> |
|ABS WS 呼び出しが試行されました  <br/> |試行されたアドレス帳 Web クエリ サービス要求の合計数。  <br/> |
|ABS WS 呼び出しが成功しました  <br/> |成功した応答コードを返したアドレス帳 Web クエリ サービス要求の合計数。  <br/> |
|ABS WS 呼び出しに失敗しました  <br/> |エラー応答コードを返したアドレス帳 Web クエリ サービス要求の合計数。  <br/> |
   
> [!NOTE]
> このカテゴリには、アドレス帳サービス (ABS) ファイルのダウンロードとアドレス帳 Web クエリ サービス要求の監視に使用されるカウンターが含まれます。 
  
**配布リスト (DL) 情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|試行された呼び出し  <br/> |配布リスト展開 (DLX) Web サービス要求の試行回数の合計。  <br/> |
|成功した呼び出し  <br/> |成功した応答コードを返した DLX Web サービス要求の合計数。  <br/> |
|呼び出しが失敗しました  <br/> |エラー応答コードを返した DLX Web サービス要求の合計数。  <br/> |
   

  
> [!NOTE]
> 次に示すパフォーマンス カウンターは、仲介サーバー、A/V 会議サーバー、エッジ サーバー、応答グループ アプリケーション、会議自動応答の呼び出しを含む、すべての Voice over IP (VoIP) 呼び出しのレポート番号です。これらのシナリオが有効になっている場合。 
  
**VoIP の基本情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|アクティブな呼び出し  <br/> |現在進行中の着信/発信音声通話の合計数。  <br/> |
|終了した呼び出し  <br/> |既に終了している着信/発信音声通話の合計数。  <br/> |
|拒否された呼び出し  <br/> |着信音声通話の合計数が拒否されました。  <br/> |
|着信/発信の呼び出しが試行されました  <br/> |試行された着信/発信音声通話の合計数。  <br/> |
|確立された着信/発信呼び出し  <br/> |確立された着信/発信音声通話の合計数。  <br/> |
|着信 NNN の呼び出し  <br/> |サーバーから受信した nnn 応答コードの合計数。  <br/> |
|VoIP 合格率 (%)  <br/> |確立された呼び出しの合計数/試行された呼び出しの合計数。  <br/> |
   
**応答グループ サービスの通話情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|アクティブな呼び出し  <br/> |応答グループ アプリケーションへのアクティブな呼び出しの合計数。  <br/> |
|試行された呼び出し  <br/> |試行された呼び出しの合計数。  <br/> |
   
**インスタント メッセージング (IM) 通話情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|アクティブな呼び出し  <br/> |進行中の着信/発信インスタント メッセージング呼び出しの合計数。  <br/> |
|終了した呼び出し  <br/> |既に終了している着信/発信インスタント メッセージング呼び出しの合計数。  <br/> |
|着信 NNN の呼び出し  <br/> |サーバーから受信した nnn 応答コードの合計数。  <br/> |
|受信/送信された IM メッセージ  <br/> |すべてのセッションで送受信されたメッセージの合計数。  <br/> |
|着信/発信の呼び出しが試行されました  <br/> |試行された着信/発信インスタント メッセージング呼び出しの合計数。  <br/> |
|確立された着信/発信呼び出し  <br/> |確立された受信/発信インスタント メッセージ呼び出しの合計数。  <br/> |
   
**アプリ共有通話情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|アクティブな呼び出し  <br/> |進行中の着信/発信アプリケーション共有呼び出しの合計数。  <br/> |
|終了した呼び出し  <br/> |既に終了している着信/発信アプリケーション共有呼び出しの合計数。  <br/> |
|着信 NNN の呼び出し  <br/> |サーバーから受信した nnn 応答コードの合計数。  <br/> |
|着信/発信の呼び出しが試行されました  <br/> |試行された着信/発信アプリケーション共有呼び出しの合計数。  <br/> |
|確立された着信/発信呼び出し  <br/> |確立された着信/発信アプリケーション共有呼び出しの合計数。  <br/> |
   
**CAA 呼び出し情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|アクティブな呼び出し  <br/> |現在進行中の公衆交換電話網 (PSTN) 通話の合計数。  <br/> |
|終了した呼び出し  <br/> |既に終了している着信/発信 PSTN 通話の合計数。  <br/> |
|着信/発信の呼び出しが試行されました  <br/> |試行された着信/発信 PSTN 通話の合計数。  <br/> |
|確立された着信/発信呼び出し  <br/> |確立された着信/発信 PSTN 通話の合計数。  <br/> |
   
**会議情報**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|Active Instant Messaging Conferences  <br/> |進行中のインスタント メッセージング会議の合計数。  <br/> |
|アクティブなオーディオ/ビデオ会議  <br/> |進行中のオーディオ/ビデオ (A/V) 会議の合計数。  <br/> |
|アクティブなアプリケーション共有会議  <br/> |進行中のアプリケーション共有会議の合計数。  <br/> |
|参加者の数  <br/> |現在会議に接続している参加者の合計数。  <br/> |
|会議スケジュールの失敗  <br/> |会議をスケジュールしようとしている間の失敗の合計数。  <br/> |
|会議の失敗に参加する  <br/> |会議に接続しようとしている間の失敗の合計数。  <br/> |
   
**UCWA クライアント カウンター**

|**パフォーマンス カウンター**|**説明**|
|:-----|:-----|
|成功した IMMCU 結合の合計数  <br/> |参加したインスタント メッセージング会議の合計数。  <br/> |
|成功した DMCU 結合の合計数  <br/> |参加した A/V 会議の合計数。  <br/> |
   

