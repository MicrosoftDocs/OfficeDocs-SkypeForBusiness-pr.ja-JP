---
title: Skype for Business Server のエッジ サーバーのシステム要件
ms.reviewer: ''
ms.author: v-cichur
author: cichur
audience: ITPro
ms.topic: conceptual
manager: serdars
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: ed53a566-0504-46f9-81a7-116a637833af
description: '概要: Skype for Business Server のエッジ サーバーのシステム要件について説明します。'
ms.openlocfilehash: d5003a265a53c3603892133077a961f54c974401
ms.sourcegitcommit: 01087be29daa3abce7d3b03a55ba5ef8db4ca161
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/23/2021
ms.locfileid: "51112743"
---
# <a name="edge-server-system-requirements-in-skype-for-business-server"></a>Skype for Business Server のエッジ サーバーのシステム要件
 
**概要:** Skype for Business Server のエッジ サーバーのシステム要件について説明します。
  
Skype for Business Server Edge Server の展開に関しては、環境自体にあるサーバーまたはサーバーに対して行う必要があるだけでなく、環境構造を計画する必要があります。 トポロジ、DNS、証明書、その他のインフラストラクチャに関する懸念事項の詳細については、環境要件のドキュメントを参照してください。
  
## <a name="components"></a>コンポーネント

エッジ サーバー環境について説明する場合、大部分は境界ネットワークに展開されているコンポーネントを参照しています (つまり、ワークグループまたは Skype for Business Server ドメイン構造の外部にあるドメインです)。
  
これらのコンポーネントは、Edge を正常に展開するために注意する必要があるコンポーネントです。
  
- [エッジ サーバー](system-requirements.md#EdgeServers)
    
- [リバース プロキシ](system-requirements.md#ReverseProxies)
    
- [ファイアウォール](system-requirements.md#Firewalls)
    
- [ディレクター](system-requirements.md#Directors) (これらはオプションで、含まれている場合は内部ネットワークに保存されます)
    
- [ロード バランサー](system-requirements.md#LoadBalancers) (DNS 負荷分散またはハードウェア ロード バランサー (HLB) を使用できますが、1 つのエッジ サーバーの場合、これは必要ない)
    
以下の各詳細について説明します。
  
### <a name="edge-servers"></a>エッジ サーバー
<a name="EdgeServers"> </a>

これらは、境界環境に展開されている Skype for Business サーバーです。 その役割は、内部 Skype for Business Server 展開によって提供されるサービスの外部ユーザーに対してネットワーク トラフィックを送受信する役割です。 これを正常に行うには、各エッジ サーバーが実行されます。
  
- **Access Edge Service**: 送信セッション開始プロトコル (SIP) トラフィックと受信セッション開始プロトコル (SIP) トラフィックの両方に 1 つの信頼できる接続ポイントを提供します。
    
- **Web 会議エッジ サービス**: 外部ユーザーが、内部の Skype for Business Server 環境でホストされている会議に参加できます。
    
- **音声ビデオ エッジ サービス**: 音声、ビデオ、アプリケーション共有、およびファイル転送を外部ユーザーが利用できます。
    
- **XMPP プロキシ サービス**: 構成済みの XMPP フェデレーション パートナーとの間で、拡張可能なメッセージングおよびプレゼンス プロトコル (XMPP) メッセージを受け入れて送信します。
    
承認された外部ユーザーは、エッジ サーバーを使用して内部 Skype for Business Server 展開に接続できますが、それ以外の場合は、内部ネットワークへのその他のアクセス権を誰にも提供しません。
  
> [!NOTE]
> エッジ サーバーは、有効な Skype for Business クライアントおよび他のエッジ サーバー (フェデレーション シナリオ) の接続を提供するために展開されます。 他のエンド ポイント クライアントまたはサーバーの種類から接続できません。 XMPP ゲートウェイ サーバーは、構成済みの XMPP パートナーとの接続を許可できます。 しかし、繰り返しますが、これらは動作する唯一のクライアントとフェデレーションの種類です。 

> [!NOTE]
> XMPP ゲートウェイとプロキシは、Skype for Business Server 2015 で使用できますが、Skype for Business Server 2019 ではサポートされなくなりました。 詳細 [については、「XMPP フェデレーションの移行](../../../SfBServer2019/migration/migrating-xmpp-federation.md) 」を参照してください。
  
### <a name="reverse-proxies"></a>リバース プロキシ
<a name="ReverseProxies"> </a>

リバース プロキシ (RP) サーバーには Skype for Business Server の役割は含めませんが、エッジ サーバー展開の重要なコンポーネントです。 リバース プロキシを使用すると、外部ユーザーは次の機能を使用できます。
  
- 簡単な URL を使用して会議やダイヤルイン会議に接続できます。
    
- 会議コンテンツをダウンロードします。
    
- 配布グループを展開します。
    
- クライアント証明書ベース認証のユーザー ベースの証明書を取得する
    
- アドレス帳サーバーからファイルをダウンロードするか、アドレス帳 Web クエリ サービスにクエリを送信します。
    
- クライアントおよびデバイス ソフトウェアの更新プログラムを取得します。
    
モバイル デバイスの場合:
  
- これにより、モビリティ サービスを提供するフロントエンド サーバーを自動的に検出できます。
    
- Microsoft 365 または 365 からモバイル Officeプッシュ通知を有効にします。
    
現在のリバース プロキシの推奨事項は、[Skype for Business のテレフォニー [インフラストラクチャ] ページで確認](../../../SfbPartnerCertification/certification/infra-gateways.md) できます。 そのため、リバース プロキシは次の条件を使用します。
  
- パブリック証明書を介して環境に導入されたトランスポート層セキュリティ (TLS) を使用して、次の公開された外部 Web サービスに接続できる必要があります。
    
  - ディレクターまたはディレクター プール
    
  - フロントエンド サーバーまたはフロントエンド プール
    
- 必要に応じて、暗号化用の証明書を使用して内部 Web サイトを公開したり、暗号化されていない手段で公開したりできる必要があります。
    
- 完全修飾ドメイン名 (FQDN) を使用して内部ホスト型 Web サイトを外部に公開できる必要があります。
    
- ホストされる Web サイトのすべてのコンテンツを公開できる必要があります。 既定では、ほとんどの Web サーバーで認識される _ ディレクティブを使用して、「すべてのコンテンツを Web サーバーに公開する」という **/\\** 意味で使用できます。 また、ディレクティブ (_*/Uwca/ ***など) を変更できます。これは「仮想ディレクトリ Ucwa の下のすべてのコンテンツを発行する」を \\ 意味します。
    
- 公開された Web サイトからコンテンツを要求するクライアントとの TLS 接続を必要とする必要があります。
    
- サブジェクトの代替名 (SAN) エントリを持つ証明書を受け入れる必要があります。
    
- 外部 Web サービス FQDN が解決するリスナーまたはインターフェイスへの証明書のバインドを許可できる必要があります。 リスナーの構成は、インターフェイスの方が望ましいです。 多くのリスナーは、1 つのインターフェイスで構成できます。
    
- ホスト ヘッダー処理の構成を許可する必要があります。 多くの場合、要求元のクライアントによって送信される元のホスト ヘッダーは、リバース プロキシによって変更されるのではなく、透過的に渡す必要があります。
    
- 1 つの外部定義ポート (TCP 443 など) から別の定義ポート (TCP 4443 など) への TLS トラフィックのブリッジを許可する必要があります。 リバース プロキシは、受信時にパケットを復号化し、送信時にパケットを再暗号化する場合があります。
    
- あるポート (TCP 80 など) から別のポート (TCP 8080 など) への暗号化されていない TCP トラフィックのブリッジを許可する必要があります。
    
- NTLM 認証、認証なし、パススルー認証の構成を許可する必要があります。
    
リバース プロキシでこの一覧のすべてのニーズに対応できる場合は、行くのが良い必要がありますが、上記のリンクにある推奨事項に注意してください。
  
### <a name="firewalls"></a>ファイアウォール
<a name="Firewalls"> </a>

エッジ展開を外部ファイアウォールの背後に配置する必要がありますが、エッジ環境と内部環境の間に 2 つのファイアウォール、1 つの外部ファイアウォール、1 つの内部ファイアウォールを使用することをお勧めします。 シナリオのすべてのドキュメントには、2 つのファイアウォールがあります。 2 つのファイアウォールは、あるネットワーク エッジから別のネットワーク エッジへの厳密なルーティングを保証し、内部ネットワークのファイアウォール保護を倍増するためにお勧めします。
  
### <a name="directors"></a>ディレクター
<a name="Directors"> </a>

これはオプションの役割です。 これは、単一のサーバーまたはディレクターの役割を実行するサーバーのプールです。 これは、内部の Skype for Business Server 環境で見つかった役割です。
  
ディレクターは、Skype for Business Server 内部サーバー宛てのエッジ サーバーから受信 SIP トラフィックを受信する内部ネクスト ホップ サーバーです。 受信要求を事前認証し、ユーザーのホーム プールまたはサーバーにリダイレクトします。 この事前認証を使用すると、未確認のユーザー アカウント要求を削除できます。
  
なぜそれが重要なのでしょうか? ディレクターにとって重要な機能は、サービス拒否 (DoS) 攻撃などの悪意のあるトラフィックから Standard Edition サーバーとフロントエンド サーバーまたはフロントエンド プールを保護する機能です。 ネットワークに無効な外部トラフィックが殺到した場合、トラフィックはディレクターで停止します。
  
### <a name="load-balancers"></a>ロード バランサー
<a name="LoadBalancers"> </a>

Skype for Business Server の拡張統合エッジ トポロジは、新しい展開の DNS 負荷分散用に最適化され、これをお勧めします。 高可用性が必要な場合は、特定の状況に応じてハードウェア ロード バランサーを使用することをお勧めします。
  
- Exchange 2013 より前の Exchange **UM** を使用するリモート ユーザーの Exchange UM。
    
> [!IMPORTANT]
> ロード バランサーを混在できない点に注意してください。 Skype for Business Server 環境では、すべてのインターフェイスで DNS または HLB を使用する必要があります。 
  
> [!NOTE]
> Skype for Business Server では、ダイレクト サーバーリターン (DSR) NAT はサポートされていません。 
  
#### <a name="hardware-load-balancer-requirements-for-edge-servers-edge-servers-running-the-av-edge-service"></a>A/V Edge サービスを実行するエッジ サーバーエッジ サーバーのハードウェア ロード バランサー要件

A/V Edge サービスを実行しているエッジ サーバーの要件は次のとおりです。
  
- 内部ポートと外部ポート 443 の両方で TCP ナグリングをオフにします (ナグリングは、複数の小さなパケットを 1 つの大きなパケットに結合して、より効率的な送信を行うプロセスです)。
    
- 外部ポート範囲 50000 ~ 59999 の TCP ナグリングをオフにします。
    
- 内部ファイアウォールまたは外部ファイアウォールで NAT を使用しない。
    
- エッジ内部インターフェイスは、エッジ サーバーの外部インターフェイスとは異なるネットワーク上に必要であり、その間のルーティングを無効にする必要があります。
    
- A/V Edge サービスを実行しているエッジ サーバーの外部インターフェイスでは、パブリックに送信可能な IP アドレスを使用し、エッジ外部 IP アドレスに NAT またはポート変換を使用する必要はありません。
    
#### <a name="hlb-requirements"></a>HLB の要件

Skype for Business Server には、Cookie ベースのアフィニティ要件が多く存在しません。 そのため、Skype for Business Server 環境で Lync Server 2010 フロントエンド サーバーまたはフロント エンド プールを使用する場合を超え、Cookie ベースの永続性を使用する必要はありません **(これは** Skype for Business Server 2015 固有の場合)。 Lync Server 2010 に推奨される構成方法では、Cookie ベースのアフィニティが必要になります。
  
> [!NOTE]
> HLB に対して Cookie ベースのアフィニティを有効にした場合、環境に必要ない場合でも問題はありません。 
  
環境で Cookie **ベースの** アフィニティが必要ない場合は、次の条件を実行します。
  
- ポート 443 のリバース プロキシ発行ルールで、[ホスト ヘッダーの転送] を True **に****設定します**。 これにより、元の URL が確実に転送されます。
    
Cookie ベースのアフィニティ **が** 必要な展開の場合は、次の手順を実行します。
  
- ポート 443 のリバース プロキシ発行ルールで、[ホスト ヘッダーの転送] を True **に****設定します**。 これにより、元の URL が確実に転送されます。
    
- ハードウェア ロード バランサー Cookie **に** httpOnly のマークを付けなさる必要があります。
    
- ハードウェア ロード バランサー Cookie **に有効期限** が設定されていない必要があります。
    
- ハードウェア ロード バランサー **Cookie** には **MS-WSMAN** という名前を付けます (これは、Web サービスが期待する値であり、変更できません)。
    
- 同じ TCP接続の以前の HTTP 応答が Cookie を取得したかどうかに関係なく、受信 HTTP 要求に Cookie が含めなかった HTTP 応答ごとに、ハードウェア ロード バランサー Cookie を設定する必要があります。 ハードウェア ロード バランサーが Cookie 挿入を TCP 接続ごとに 1 回だけ最適化する場合は、その最適化 **を使用** する必要があります。
    
> [!NOTE]
> HLB 構成では、ソース アフィニティと 20 分間の TCP セッションの有効期間を使用するのが一般的です。これは、クライアントの使用状況やアプリケーションの操作によってセッション状態が維持されるので、Skype for Business Server とそのクライアントでは問題ありません。 
  
モバイル デバイスを展開する場合、HLB は TCP セッション内で個々の要求を負荷分散できる必要があります (実際には、ターゲット IP アドレスに基づいて個々の要求を負荷分散できる必要があります)。
  
> [!IMPORTANT]
> F5 HLB には OneConnect という機能があります。 これにより、TCP 接続内の各要求が個別に負荷分散されます。 モバイル デバイスを展開する場合は、HLB ベンダーが同じ機能をサポートします。 最新の iOS モバイル アプリでは、TLS バージョン 1.2 が必要です。 詳細を知る必要がある場合は、F5 はこのための特定の設定を提供します。 
  
(省略可能) ディレクターおよび (必須) フロントエンド プール Web サービスの HLB 要件を次に示します。
  
- 内部 Web サービスの VIP については、HLB Source_addr永続性 (内部ポート 80,443) を設定します。 Skype for Business Server の場合、Source_addrは、セッション状態を維持するために、1 つの IP アドレスから送信される複数の接続が常に 1 つのサーバーに送信されます。
    
- 1800 秒の TCP アイドル タイムアウトを使用します。
    
- リバース プロキシとネクスト ホップ プールの HLB の間のファイアウォールで、リバース プロキシから HLB への https: ポート 4443 のトラフィックを許可するルールを作成します。 HLB は、ポート 80、443、および 4443 でリッスンするように構成する必要があります。
    
#### <a name="summary-of-hlb-affinity-requirements"></a>HLB アフィニティ要件の概要

|**クライアント/ユーザーの場所**|**外部 Web サービスの FQDN のアフィニティ要件**|**内部 Web サービス FQSN アフィニティ要件**|
|:-----|:-----|:-----|
|Skype for Business Web App (内部ユーザーと外部ユーザー)  <br/> モバイル デバイス (内部ユーザーと外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (外部ユーザーのみ)  <br/> モバイル デバイス (内部ユーザーと外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (内部ユーザーのみ)  <br/> モバイル デバイス (展開しない)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
   
#### <a name="port-monitoring-for-hlbs"></a>HLB のポート監視

ハードウェア ロード バランサーでポート監視を定義して、ハードウェアまたは通信の障害により、特定のサービスが利用できなくなったかどうかを判断します。 たとえば、フロント エンド サーバー またはフロント エンド プールに障害が発生してフロント エンド サーバー サービス (RTCSRV) が停止した場合、HLB 監視によって Web サービス上のトラフィックの受信も停止する必要があります。 HLB の外部インターフェイスに対して次の監視を行う場合は、HLB でポート監視を実装する必要があります。
  
|**仮想 IP/ポート**|**ノード ポート**|**ノード コンピューター/モニター**|**保存プロファイル**|**注**|
|:-----|:-----|:-----|:-----|:-----|
|\<pool\>web_mco_443_vs  <br/> 443  <br/> |4443  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTPS  <br/> |
|\<pool\>web_mco_80_vs  <br/> 80  <br/> |8080  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTP  <br/> |
   
## <a name="hardware-and-software-requirements"></a>ハードウェア要件とソフトウェア要件

[Skype for Business Server 2015](../../plan-your-deployment/requirements-for-your-environment/server-requirements.md)の全体的なサーバー要件と Skype for Business Server [2019](../../../SfBServer2019/plan/system-requirements.md)のシステム要件に関するドキュメントでは、エッジ サーバーのハードウェア要件とソフトウェア要件について説明しました。
  
## <a name="collocation"></a>Collocation

「Topology [Basics for Skype for Business Server」](../../plan-your-deployment/topology-basics/topology-basics.md) のドキュメントで、エッジ サーバーのコロケーションについて説明しました。
