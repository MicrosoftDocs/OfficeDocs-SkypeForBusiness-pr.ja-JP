---
title: Skype for Business Server での Edge Server システム要件
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
audience: ITPro
ms.topic: conceptual
manager: serdars
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: ed53a566-0504-46f9-81a7-116a637833af
description: '概要: Skype for Business Server の Edge Server のシステム要件について説明します。'
ms.openlocfilehash: 01a5cce8dd1ccb85d322b6c66615d022c8d6c2df
ms.sourcegitcommit: ab47ff88f51a96aaf8bc99a6303e114d41ca5c2f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/20/2019
ms.locfileid: "34277147"
---
# <a name="edge-server-system-requirements-in-skype-for-business-server"></a>Skype for Business Server での Edge Server システム要件
 
**概要:** Skype for Business Server の Edge Server のシステム要件について説明します。
  
Skype for Business Server Edge Server の展開については、環境内のサーバーまたはサーバーに対して必要なことと、環境構造の計画について説明します。 トポロジ、DNS、証明書、およびその他のインフラストラクチャに関する考慮事項の詳細については、環境の要件のドキュメントを参照してください。
  
## <a name="components"></a>Components

エッジサーバー環境について話し合うときは、境界ネットワークに展開されているコンポーネント (ワークグループ内か、または Skype for Business Server ドメイン構造の外部のドメイン) を参照しています。
  
以下に示すコンポーネントは、エッジの展開を成功させるために留意する必要があるコンポーネントです。
  
- [Edge Servers](system-requirements.md#EdgeServers)
    
- [Reverse proxies](system-requirements.md#ReverseProxies)
    
- [Firewalls](system-requirements.md#Firewalls)
    
- [Directors](system-requirements.md#Directors) (オプションで、含まれる場合は内部ネットワーク上に存在します)
    
- [ロードバランサー](system-requirements.md#LoadBalancers)(DNS の負荷分散またはハードウェアロードバランサー (HLB) を使用できますが、1台のエッジサーバーの場合、これは必要ありません)。
    
上記の各コンポーネントに関する詳細を以下に示します。
  
### <a name="edge-servers"></a>エッジ サーバー
<a name="EdgeServers"> </a>

これらは、境界環境に展開された Skype for Business サーバーです。 自分の Skype for Business Server の展開によって提供されているサービスについて、外部ユーザーへのネットワークトラフィックを送受信します。 この操作を正常に実行するには、各エッジサーバーが実行されます。
  
- **Access Edge サービス**: 送受信セッション開始プロトコル (SIP) トラフィックの単一の信頼できる接続ポイントを提供します。
    
- [ **Web 会議エッジサービス**: 外部ユーザーが、社内の Skype For business Server 環境でホストされている会議に参加できるようにします。
    
- **A/V Edge サービス**: 外部ユーザーがオーディオ、ビデオ、アプリケーション共有、ファイル転送を利用できるようにします。
    
- **Xmpp プロキシサービス**: 構成済みの Xmpp フェデレーションパートナーとの間での拡張可能なメッセージングとプレゼンスプロトコル (xmpp) メッセージを受け入れて送信します。
    
承認された外部ユーザーは、Edge サーバーを使用して、内部の Skype for Business Server 展開に接続できますが、それ以外の場合は、社内ネットワークへの他のアクセスは一切提供されません。
  
> [!NOTE]
> エッジサーバーは、有効になっている Skype for Business クライアントおよび他のエッジサーバー (フェデレーションシナリオ) への接続を提供するために展開されます。 他のエンド ポイント クライアントやサーバーの種類からは接続できません。 XMPP ゲートウェイ サーバーにより、構成済みの XMPP パートナーとの接続を実現できます。 ただしこの場合も、フェデレーション シナリオで有効なものだけが、実際に機能するクライアントとフェデレーションの種類です。 

> [!NOTE]
> XMPP ゲートウェイとプロキシは、Skype for Business Server 2015 で使用できますが、Skype for Business Server 2019 ではサポートされなくなりました。 詳細については、「 [XMPP フェデレーションを移行](../../../SfBServer2019/migration/migrating-xmpp-federation.md)する」を参照してください。
  
### <a name="reverse-proxies"></a>リバース プロキシ
<a name="ReverseProxies"> </a>

リバースプロキシ (RP) サーバーには、Skype for Business Server の役割はありませんが、エッジサーバーの展開に不可欠なコンポーネントです。 リバースプロキシを使用すると、外部ユーザーは次のことを行うことができます。
  
- 簡易 URL を使用して会議またはダイヤルイン会議に接続する。
    
- 会議コンテンツをダウンロードする。
    
- 配布グループを拡張する。
    
- クライアント証明書ベースの認証用のユーザーベースの証明書を取得する。
    
- アドレス帳サーバーから、またはアドレス帳 Web クエリサービスにクエリを送信するために、ファイルをダウンロードします。
    
- クライアントおよびデバイス ソフトウェアの更新プログラムを取得する。
    
また、モバイル デバイスに関しては以下の操作が可能になります。
  
- これにより、モビリティサービスを提供するフロントエンドサーバーを自動的に検出できます。
    
- Office 365 からモバイルデバイスへのプッシュ通知を有効にします。
    
現在のリバースプロキシの推奨事項は、「 [Skype For business のテレフォニーインフラストラクチャ](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways)」ページに記載されています。 リバースプロキシ:
  
- 以下から構成される公開済みの外部 Web サービスに接続するために、公開証明書を介して、環境に導入されているトランスポート層セキュリティ (TLS) を使用できる必要があります。
    
  - ディレクターまたはディレクタープール
    
  - フロントエンドサーバーまたはフロントエンドプール
    
- 暗号化用の証明書を使用するか、必要に応じて暗号化されない方法で内部 Web サイトを公開できる必要があります。
    
- 完全修飾ドメイン名 (FQDN) を使用して、内部的にホストされている Web サイトを外部に公開できる必要があります。
    
- ホストされた web サイトのすべてのコンテンツを公開できる必要があります。 既定では、ほとんどの web ** /** サーバーによって認識される * ディレクティブを使うことができます。これは、web サーバー上のすべてのコンテンツを公開することを意味します。 また、ディレクティブ (* */Uwca/\\* * など) を変更することもできます。これは、「仮想ディレクトリのすべてのコンテンツを公開する」という意味です。
    
- 公開された Web サイトのコンテンツを要求するクライアントで TLS 接続を要求する必要があります。
    
- サブジェクトの別名 (SAN) エントリを持つ証明書を受け入れる必要があります。
    
- 外部 Web サービスの FQDN が解決されるリスナーまたはインターフェイスに対して証明書をバインドできる必要があります。インターフェイスの構成よりリスナーの構成をお勧めします。多くのリスナーは、単一のインターフェイスで構成できます。
    
- ホスト ヘッダー処理の構成を許可する必要があります。 通常、要求側のクライアントによって送信された元のホストヘッダーは、リバースプロキシによって変更されるのではなく、透過的に渡す必要があります。
    
- 外部で定義された 1 つのポート (例: TCP 443) から別の定義されたポート (例: TCP 4443) への TLS トラフィックのブリッジを許可する必要があります。 リバースプロキシは、受信時にパケットの暗号化を解除し、送信時にパケットを再度暗号化することができます。
    
- 1 つのポート (例: TCP 80) から別のポート (例: TCP 8080) への暗号化されていない TCP トラフィックのブリッジを許可する必要があります。
    
- NTLM 認証、認証なし、およびパススルー認証の構成を許可または受け入れる必要があります。
    
リバースプロキシによってこのリストのすべてのニーズを解決できる場合は、上記のリンクを参照してください。お勧めします。
  
### <a name="firewalls"></a>ファイアウォール
<a name="Firewalls"> </a>

外部ファイアウォールの内側にエッジ展開を配置する必要がありますが、1 つの外部ファイアウォールと、エッジ環境と内部環境の間に配置する 1 つの内部ファイアウォールの、2 つのファイアウォールを使用することをお勧めします。シナリオのすべてのドキュメントには 2 つのファイアウォールが含まれます。2 つのファイアウォールをお勧めするのは、ネットワーク エッジ間の厳密なルーティングが実現され、内部ネットワーク用にファイアウォール保護が二重になるからです。
  
### <a name="directors"></a>ディレクター
<a name="Directors"> </a>

これは、オプションの役割です。 1台のサーバーまたはディレクターの役割を実行しているサーバーのプールを指定できます。 このロールは、内部の Skype for Business Server 環境で検索されます。
  
ディレクターは、Skype for Business Server の内部サーバー向けのエッジサーバーから受信 SIP トラフィックを受信する、内部の次ホップサーバーです。 着信した要求を事前認証し、これをユーザーのホーム プールまたはサーバーにリダイレクトします。 この事前認証により、識別されていないユーザー アカウントの要求を破棄できます。
  
このことが問題になる理由について説明します。 ディレクターの重要な機能は、サービス拒否 (DoS) 攻撃などの悪意のあるトラフィックから、標準エディションのサーバーとフロントエンドサーバーまたはフロントエンドプールを保護することです。 ネットワークに無効な外部トラフィックがあふれている場合、トラフィックはディレクターで停止します。
  
### <a name="load-balancers"></a>ロード バランサー
<a name="LoadBalancers"> </a>

Skype for Business Server の統合されたエッジトポロジは、新しい展開で DNS の負荷分散を最適化するために最適化されています。これをお勧めします。 高可用性が必要な場合は、1つの特定の状況に対してハードウェアロードバランサーを使うことをお勧めします。
  
- Exchange 2013 の**前**に exchange um を使用しているリモートユーザーの exchange um。
    
> [!IMPORTANT]
> ロード バランサーを混在させることができない点に注意することが非常に重要です。 Skype for Business Server 環境では、すべてのインターフェイスで DNS または HLB のいずれかを使用する必要があります。 
  
> [!NOTE]
> Skype for Business Server では、Direct server return (DSR) NAT はサポートされていません。 
  
#### <a name="hardware-load-balancer-requirements-for-edge-servers-edge-servers-running-the-av-edge-service"></a>A/V Edge サービスを実行しているエッジサーバーエッジサーバーのハードウェアロードバランサーの要件

A/V Edge サービスを実行しているエッジサーバーについては、次の要件があります。
  
- 内部と外部の両方のポート 443 に対して TCP のネーグル処理がオフになっていること。ネーグル処理はいくつかの小さなパケットを 1 つの大きなパケットにまとめて転送効率を向上させるプロセスです。
    
- 外部ポート範囲 50000 ～ 59999 の TCP のネーグル処理がオフになっていること。
    
- 内部または外部のファイアウォールで NAT が使用されていないこと。
    
- Edge の内部インターフェイスは、Edge Server の外部インターフェイスとは異なるネットワーク上に存在する必要があります。また、このインターフェイス間のルーティングは無効にする必要があります。
    
- A/V Edge サービスを実行しているエッジサーバーの外部インターフェイスでは、公開ルーティング可能な IP アドレスを使用し、エッジ外部 IP アドレスには NAT やポートの変換を行わないようにする必要があります。
    
#### <a name="hlb-requirements"></a>HLB の要件

Skype for Business Server には、cookie ベースのアフィニティ要件はあまりありません。 したがって、cookie ベースの常設を使用する必要**** はありません (これは Skype For business server 2015 固有のものである)。 Skype For business server 環境では、Lync Server 2010 フロントエンドサーバーまたはフロントエンドプールを使用する必要があります。 Lync Server 2010 で推奨される構成方法では、cookie ベースのアフィニティが必要です。
  
> [!NOTE]
> HLB 用に Cookie ベースのアフィニティを有効にすることを決定した場合、環境で不要であっても、そのような操作に問題はありません。 
  
環境で Cookie ベースのアフィニティが**不要**である場合は、次のようになります。
  
- ポート443のリバースプロキシ公開ルールで、 **Forward host header**を**True**に設定します。 これにより、元の URL が確実に転送されます。
    
Cookie ベースのアフィニティが**必要**である展開の場合:
  
- ポート443のリバースプロキシ公開ルールで、 **Forward host header**を**True**に設定します。 これにより、元の URL が確実に転送されます。
    
- ハードウェアロードバランサーの cookie は、httpOnly とマークさ**れていない必要があり**ます。
    
- ハードウェアロードバランサーの cookie には、有効期限を設定することは**できません**。
    
- ハードウェアロードバランサー cookie は、 **MS-WSMAN** (これは、Web サービスが期待する値であり、変更できません) という名前で**ある必要があり**ます。
    
- ハードウェアロードバランサー cookie は、同じ TCP 接続に対する以前の HTTP 応答が cookie を取得したかどうかに関係なく、着信 HTTP 要求の cookie がないすべての HTTP 応答で設定**する必要があり**ます。 ハードウェアロードバランサーが、TCP 接続ごとに1回のみ cookie の挿入を最適化する場合は、その最適化を使用**しないでください**。
    
> [!NOTE]
> HLB 構成では、ソースアフィニティと20分の TCP セッションの有効期間を使うのが一般的です。これは、Skype for Business Server とそのクライアントには適しています。これは、クライアントの使用状況やアプリケーションの操作によってセッションの状態が維持されるためです。 
  
モバイル デバイスを展開する場合、HLB で、TCP セッション内の個々の要求を負荷分散できるようにする必要があります (実際には、ターゲット IP アドレスに基づいて個々の要求を負荷分散できる必要があります)。
  
> [!IMPORTANT]
> F5 HLB には、OneConnect と呼ばれる機能があります。この機能を使用すると、TCP 接続内の各要求が個々に負荷分散されます。モバイル デバイスを展開する場合、HLB のベンダーが同じ機能をサポートしていることを確認してください。最新の iOS モバイル アプリでは、TLS バージョン 1.2 が必要です。より詳細な情報が必要な場合は、F5 が、その固有の設定を提供します。 
  
以下に、(オプション) ディレクターと (必須) フロントエンドプール Web サービスの HLB 要件を示します。
  
- 内部の Web サービス Vip で、HLB 上に Source_addr persistence (内部ポート 80, 443) を設定します。 Skype for Business Server の場合、Source_addr persistence は、1つの IP アドレスからの複数の接続が常に1つのサーバーに送信され、セッションの状態を維持することを意味します。
    
- TCP アイドル タイムアウト 1800 秒を使用すること。
    
- リバースプロキシと次ホッププールの HLB の間のファイアウォールで、https: ポート4443上のトラフィックを許可するルールを、リバースプロキシから HLB まで作成します。 ポート 80、443、および 4443 をリッスンするように HLB を構成する必要があります。
    
#### <a name="summary-of-hlb-affinity-requirements"></a>HLB のアフィニティ要件の概要

|**クライアント/ユーザーの場所**|**外部 Web サービスの FQDN のアフィニティ要件**|**内部 Web サービスの FQDN のアフィニティ要件**|
|:-----|:-----|:-----|
|Skype for Business Web App (内部と外部のユーザー)  <br/> モバイル デバイス (内部および外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (外部ユーザーのみ)  <br/> モバイル デバイス (内部および外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (内部ユーザーのみ)  <br/> モバイル デバイス (展開しない)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
   
#### <a name="port-monitoring-for-hlbs"></a>HLB のポート監視

ハードウェアまたは通信の障害のため、ハードウェアロードバランサーでポート監視を定義して、特定のサービスが使用できなくなったタイミングを判断します。 たとえば、フロントエンドサーバーまたはフロントエンドプールに障害が発生したために、フロントエンドサーバーサービス (RTCSRV) が停止した場合、HLB の監視でも Web サービスのトラフィックの受信を停止する必要があります。 HLB の外部インターフェイスに関する以下の部分を監視する目的で、HLB にポート監視を実装する必要があります。
  
|**仮想 IP/ポート**|**ノード ポート**|**ノード コンピューター/モニター**|**保存プロファイル**|**メモ**|
|:-----|:-----|:-----|:-----|:-----|
|\<プール\>web_mco_443_vs  <br/> 443  <br/> |4443  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTPS  <br/> |
|\<プール\>web_mco_80_vs  <br/> 80  <br/> |8080  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTP  <br/> |
   
## <a name="hardware-and-software-requirements"></a>ハードウェアおよびソフトウェア要件

Skype for business [server 2015 の全体的なサーバー要件](../../plan-your-deployment/requirements-for-your-environment/server-requirements.md)および[Skype for business server 2019 ドキュメントのシステム要件](../../../SfBServer2019/plan/system-requirements.md)については、「エッジサーバーのハードウェアとソフトウェアの要件」を参照してください。
  
## <a name="collocation"></a>併置

[Skype For Business Server ドキュメントのトポロジの基礎](../../plan-your-deployment/topology-basics/topology-basics.md)として、Edge server collocation について説明しました。
  

