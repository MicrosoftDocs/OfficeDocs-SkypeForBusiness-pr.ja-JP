---
title: Skype for Business Server でのエッジサーバーのシステム要件
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
audience: ITPro
ms.topic: conceptual
manager: serdars
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: ed53a566-0504-46f9-81a7-116a637833af
description: '概要: Skype for Business Server のエッジサーバーのシステム要件について説明します。'
ms.openlocfilehash: ce68475ffc2534f686b39bbcdbcd46b7cdee735a
ms.sourcegitcommit: d69bad69ba9a9bca4614d72d8f34fb2a0a9e4dc4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/13/2020
ms.locfileid: "44221027"
---
# <a name="edge-server-system-requirements-in-skype-for-business-server"></a>Skype for Business Server でのエッジサーバーのシステム要件
 
**概要:** Skype for Business Server のエッジサーバーのシステム要件について説明します。
  
Skype for Business Server エッジサーバーの展開については、次のように、環境構造の計画だけでなく、環境内のサーバーに対して行う必要があります。 トポロジ、DNS、証明書、およびその他のインフラストラクチャの問題の詳細については、「環境要件」のドキュメントを参照してください。
  
## <a name="components"></a>コンポーネント

エッジサーバー環境について説明するときには、境界ネットワークに展開されているコンポーネント (ワークグループ内、または Skype for Business Server ドメイン構造の外部にあるドメインのいずれかであることを言う) を参照しています。
  
この点を念頭に置いて、エッジを正常に展開するために考慮する必要があるコンポーネントは次のとおりです。
  
- [エッジ サーバー](system-requirements.md#EdgeServers)
    
- [リバースプロキシ](system-requirements.md#ReverseProxies)
    
- [ファイアウォール](system-requirements.md#Firewalls)
    
- [ディレクター](system-requirements.md#Directors) (これらはオプションであり、含まれている場合は内部ネットワーク上に配置されます)
    
- [ロードバランサー](system-requirements.md#LoadBalancers) (DNS 負荷分散またはハードウェアロードバランサー (hlb) を使用できますが、単一エッジサーバーの場合はこれは必要ありません)
    
以下の各セクションについて詳細に説明します。
  
### <a name="edge-servers"></a>エッジ サーバー
<a name="EdgeServers"> </a>

これらは、境界環境に展開された Skype for Business サーバーです。 これらの役割は、内部の Skype for Business Server 展開で提供されるサービスについて、外部ユーザーへのネットワークトラフィックを送受信することです。 この操作を正常に行うには、各エッジサーバーが次のように実行されます。
  
- **アクセスエッジサービス**: 発信および受信のセッション開始プロトコル (SIP) トラフィックに対して、1つの信頼できる接続ポイントを提供します。
    
- **Web 会議エッジサービス**: 外部ユーザーが、内部の Skype For business Server 環境でホストされている会議に参加できるようにします。
    
- 音声ビデオ**エッジサービス**: 外部ユーザーがオーディオ、ビデオ、アプリケーション共有、およびファイル転送を使用できるようにします。
    
- **Xmpp プロキシサービス**: 構成済みの Xmpp フェデレーションパートナーとの間で、拡張可能な messaging およびプレゼンスプロトコル (xmpp) メッセージを送受信します。
    
許可された外部ユーザーは、内部の Skype for Business Server 展開に接続するためにエッジサーバーを使用することができますが、それ以外の場合は、どのユーザーにも内部ネットワークへのアクセスを提供しません。
  
> [!NOTE]
> エッジサーバーは、有効な Skype for Business クライアントおよびその他のエッジサーバー (フェデレーションのシナリオ) への接続を提供するために展開されます。 他のエンドポイントクライアントまたはサーバーの種類から接続することはできません。 XMPP ゲートウェイサーバーは、構成された XMPP パートナーとの接続を許可することができます。 しかし、それでも動作するのはクライアントとフェデレーションの種類だけです。 

> [!NOTE]
> XMPP ゲートウェイおよびプロキシは、Skype for business Server 2015 で利用できますが、Skype for business Server 2019 ではサポートされなくなりました。 詳細については、「 [XMPP フェデレーションの移行](../../../SfBServer2019/migration/migrating-xmpp-federation.md)」を参照してください。
  
### <a name="reverse-proxies"></a>リバースプロキシ
<a name="ReverseProxies"> </a>

リバースプロキシ (RP) サーバーには Skype for Business Server の役割はありませんが、エッジサーバーの展開に不可欠なコンポーネントです。 リバースプロキシを使用すると、外部ユーザーは次のことを行うことができます。
  
- 簡易 Url を使用して会議またはダイヤルイン会議に接続します。
    
- 会議コンテンツをダウンロードする。
    
- [配布グループ] を展開します。
    
- クライアント証明書ベースの認証用のユーザーベースの証明書を取得する
    
- アドレス帳サーバーからファイルをダウンロードするか、アドレス帳 Web クエリサービスにクエリを送信します。
    
- クライアントおよびデバイスソフトウェアの更新プログラムを取得します。
    
モバイルデバイスの場合は次のようになります。
  
- これにより、モビリティサービスを提供するフロントエンドサーバーを自動的に検出できるようになります。
    
- Microsoft 365 または Office 365 からモバイルデバイスへのプッシュ通知を有効にします。
    
現在のリバースプロキシの推奨事項については、「Skype for business[のテレフォニーインフラストラクチャ](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways)」ページを参照してください。 そのため、リバースプロキシは次のようになります。
  
- パブリック証明書を介して環境に導入されたトランスポート層セキュリティ (TLS) を使用して、次のような公開外部 Web サービスに接続できるようにする必要があります。
    
  - ディレクターまたはディレクター プール
    
  - フロントエンドサーバーまたはフロントエンドプール
    
- は、暗号化用の証明書を使用して内部 Web サイトを公開するか、必要に応じて暗号化されていない方法で公開する必要があります。
    
- 完全修飾ドメイン名 (FQDN) を使用して、内部でホストされている web サイトを外部に公開できるようにする必要があります。
    
- ホストされている web サイトのすべてのコンテンツを発行できる必要があります。 既定では、 **/\\** ほとんどの web サーバーによって認識される * ディレクティブを使用して、"web サーバー上のすべてのコンテンツを公開" という意味を持つことができます。 また、ディレクティブ (たとえば、* */Uwca/* * *) を変更することもでき \\ ます。これは、"仮想ディレクトリの下にあるすべてのコンテンツを公開する" という意味です。
    
- 発行された web サイトのコンテンツを要求するクライアントとの TLS 接続を要求する必要があります。
    
- サブジェクトの別名 (SAN) エントリを含む証明書を受け入れる必要があります。
    
- 外部 web サービスの FQDN が解決されるリスナーまたはインターフェイスへの証明書のバインドを許可する必要があります。 リスナー構成は、インターフェイスに推奨されます。 多くのリスナーは、1つのインターフェイスで構成できます。
    
- ホストヘッダー処理の構成を許可する必要があります。 多くの場合、要求元のクライアントによって送信される元のホストヘッダーは、リバースプロキシによって変更されるのではなく、透過的に渡される必要があります。
    
- 外部で定義された1つのポート (たとえば、tcp 443) から別の定義済みポート (たとえば、TCP 4443) への TLS トラフィックのブリッジを許可する必要があります。 リバースプロキシは、受信時にパケットの暗号化を解除し、送信時にパケットを再度暗号化することができます。
    
- 1つのポート (たとえば、tcp 80) から別のポート (たとえば、TCP 8080) への暗号化されていない TCP トラフィックのブリッジを許可する必要があります。
    
- NTLM 認証、認証なし、パススルー認証の構成を許可する必要があります。
    
リバースプロキシがこの一覧に記載されているすべてのニーズに対応できる場合は、この記事のリンクにある推奨事項にご注意ください。
  
### <a name="firewalls"></a>ファイアウォール
<a name="Firewalls"> </a>

エッジの展開は、外部ファイアウォールの背後に配置する必要がありますが、エッジ環境と内部環境の間には、2つのファイアウォール、1つの外部、内部の1つを使用することをお勧めします。 シナリオに記載されているすべてのドキュメントは、2つのファイアウォールを備えています。 2つのファイアウォールを使用することをお勧めします。これにより、ネットワークエッジ間の厳密なルーティングが行われ、内部ネットワークのファイアウォール保護が2倍になります。
  
### <a name="directors"></a>レ
<a name="Directors"> </a>

これはオプションの役割です。 1台のサーバー、またはディレクターの役割を実行しているサーバーのプールを指定できます。 これは、内部の Skype for Business Server 環境で見つかった役割です。
  
ディレクターは、Skype for Business Server の内部サーバーを宛先とするエッジサーバーからの受信 SIP トラフィックを受信する、内部の次ホップサーバーです。 受信要求を事前認証し、ユーザーのホームプールまたはサーバーにリダイレクトします。 この事前認証により、未識別のユーザーアカウント要求を削除することができます。
  
このような問題があるのはなぜですか。 ディレクターの重要な機能は、サービス拒否 (DoS) 攻撃などの悪意のあるトラフィックから、Standard Edition サーバーとフロントエンドサーバーまたはフロントエンドプールを保護することです。 ネットワークに無効な外部トラフィックが殺到している場合、トラフィックはディレクターで停止します。
  
### <a name="load-balancers"></a>ロードバランサー
<a name="LoadBalancers"> </a>

Skype for Business Server 拡張統合エッジトポロジは、新しい展開で DNS 負荷分散のために最適化されており、これをお勧めします。 高可用性が必要な場合は、1つの特定の状況でハードウェアロードバランサーを使用することをお勧めします。
  
- Exchange 2013**より前**の exchange um を使用するリモートユーザー用の exchange um。
    
> [!IMPORTANT]
> ロードバランサーを混在させることはできないことに注意することが重要です。 Skype for Business Server 環境では、すべてのインターフェイスで DNS または HLB のいずれかを使用する必要があります。 
  
> [!NOTE]
> Skype for Business Server では、Direct server return (DSR) NAT はサポートされていません。 
  
#### <a name="hardware-load-balancer-requirements-for-edge-servers-edge-servers-running-the-av-edge-service"></a>音声ビデオエッジサービスを実行するエッジサーバーエッジサーバーに対するハードウェアロードバランサーの要件

音声ビデオエッジサービスを実行しているエッジサーバーについては、次の要件があります。
  
- 内部および外部の両方のポートに対して TCP ネーグル処理がをオフにします 443 (ネーグル処理がは、複数の小さなパケットを1つの大きなパケットに結合して、より効率的に転送するプロセスです)。
    
- 外部ポート範囲 5万 ~ 59999 の TCP ネーグル処理がをオフにします。
    
- 内部または外部のファイアウォールで NAT を使用しないでください。
    
- エッジの内部インターフェイスは、エッジサーバーの外部インターフェイスとは別のネットワークに配置し、それらの間のルーティングを無効にする必要があります。
    
- 音声ビデオエッジサービスを実行しているすべてのエッジサーバーの外部インターフェイスでは、公開されたルーティング可能な IP アドレスを使用し、エッジの外部 IP アドレスで NAT またはポート変換を使用することはできません。
    
#### <a name="hlb-requirements"></a>HLB の要件

Skype for Business Server には、多くの cookie ベースのアフィニティ要件はありません。 そのため、cookie ベースの永続性を使用する必要はありません (これが Skype for Business Server 2015 固有**の場合)** 、Skype For business server 環境で Lync Server 2010 フロントエンドサーバーまたはフロントエンドプールを使用する予定です。 Lync Server 2010 に推奨される構成方法では、cookie ベースのアフィニティが必要になります。
  
> [!NOTE]
> HLB に対して cookie ベースのアフィニティを有効にする場合は、環境で必要でない場合でも、そのような問題はありません。 
  
環境で cookie ベースのアフィニティが**必要ない場合**は、次のようにします。
  
- ポート443のリバースプロキシ公開ルールで、[**フォワードホストヘッダー** ] を [ **True**] に設定します。 これにより、元の URL が確実に転送されます。
    
Cookie**ベースのアフィニティを必要と**する展開の場合:
  
- ポート443のリバースプロキシ公開ルールで、[**フォワードホストヘッダー** ] を [ **True**] に設定します。 これにより、元の URL が確実に転送されます。
    
- ハードウェアロードバランサーの cookie は、httpOnly とマークさ**れていてはなりません**。
    
- ハードウェアロードバランサーの cookie に有効期限を設定することは**できません**。
    
- ハードウェアロードバランサーの cookie は、 **MS-WSMAN**という名前にする**必要があり**ます (これは、Web サービスが期待する値で、変更することはできません)。
    
- ハードウェアロードバランサー cookie は、同じ TCP 接続に対する以前の HTTP 応答が cookie を受け取ったかどうかにかかわらず、受信 HTTP 要求が cookie を持たないすべての HTTP 応答で設定**する必要があり**ます。 ハードウェアロードバランサーが、TCP 接続ごとに1回だけ cookie 挿入を最適化する場合は、その最適化を使用**しないでください**。
    
> [!NOTE]
> 通常、HLB 構成では、ソースアフィニティと20分の TCP セッションの有効期間を使用します。これは、Skype for Business Server およびそのクライアントには適しています。これは、クライアントの使用状況やアプリケーションの相互作用によってセッション状態が維持されるためです。 
  
モバイルデバイスを展開している場合、HLB は TCP セッション内の個々の要求を負荷分散できる必要があります (実際には、ターゲット IP アドレスに基づいて個々の要求を負荷分散できる必要があります)。
  
> [!IMPORTANT]
> F5 HLBs には、OneConnect という機能があります。 これにより、TCP 接続内の各要求が個別に負荷分散されるようになります。 モバイルデバイスを展開している場合は、HLB ベンダーが同じ機能をサポートしていることを確認してください。 最新の iOS モバイルアプリでは、TLS バージョン1.2 が必要です。 詳細については、「F5」を参照してください。 
  
(オプション) ディレクターおよび (必須) フロントエンドプール Web サービスの HLB 要件を以下に示します。
  
- 内部 Web サービスの Vip で、HLB の Source_addr 常設 (内部ポート 80, 443) を設定します。 Skype for Business Server の場合、Source_addr 常設は、セッション状態を維持するために、1つの IP アドレスからの複数の接続が常に1つのサーバーに送信されることを意味します。
    
- TCP アイドルタイムアウト (1800 秒) を使用します。
    
- リバースプロキシと次ホッププールの HLB の間のファイアウォールで、リバースプロキシから HLB に https: 4443 トラフィックを許可するためのルールを作成します。 ポート80、443、4443をリッスンするように HLB を構成する必要があります。
    
#### <a name="summary-of-hlb-affinity-requirements"></a>HLB アフィニティ要件の概要

|**クライアント/ユーザーの場所**|**外部 Web サービスの FQDN のアフィニティ要件**|**内部 web サービスの各アフィニティの要件**|
|:-----|:-----|:-----|
|Skype for Business Web App (内部および外部ユーザー)  <br/> モバイルデバイス (内部および外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (外部ユーザーのみ)  <br/> モバイルデバイス (内部および外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (内部ユーザーのみ)  <br/> モバイル デバイス (展開しない)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
   
#### <a name="port-monitoring-for-hlbs"></a>HLBs ポートの監視

ハードウェアまたは通信障害によって特定のサービスがいつ使用できなくなるかを判断するには、ハードウェアロードバランサーに対してポート監視を定義します。 たとえば、フロントエンドサーバーまたはフロントエンドプールに障害が発生したためにフロントエンドサーバーサービス (RTCSRV) が停止した場合、HLB の監視でも Web サービス上のトラフィックの受信を停止する必要があります。 Hlb にポート監視を実装して、HLB 外部インターフェイスの次のものを監視する必要があります。
  
|**仮想 IP/ポート**|**ノード ポート**|**ノード コンピューター/モニター**|**保存プロファイル**|**メモ**|
|:-----|:-----|:-----|:-----|:-----|
|\<プール \> web_mco_443_vs  <br/> 443  <br/> |4443  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTPS  <br/> |
|\<プール \> web_mco_80_vs  <br/> 80  <br/> |8080  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTP  <br/> |
   
## <a name="hardware-and-software-requirements"></a>ハードウェア要件およびソフトウェア要件

ここでは、「Skype for business [server 2015 のサーバーの](../../plan-your-deployment/requirements-for-your-environment/server-requirements.md)全体的な要件」および「 [Skype for business server 2019 のドキュメントのシステム要件](../../../SfBServer2019/plan/system-requirements.md)」に記載されているエッジサーバーのハードウェア要件とソフトウェア要件について説明してきました。
  
## <a name="collocation"></a>併置

[Skype For Business server のドキュメントに関するトポロジの基本](../../plan-your-deployment/topology-basics/topology-basics.md)については、「エッジサーバーの併置」を参照してください。
  

