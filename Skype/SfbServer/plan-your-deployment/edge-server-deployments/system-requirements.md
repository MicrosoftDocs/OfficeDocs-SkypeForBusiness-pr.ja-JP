---
title: Skype for Business Server のエッジ サーバーのシステム要件
ms.reviewer: ''
ms.author: v-cichur
author: cichur
audience: ITPro
ms.topic: conceptual
manager: serdars
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: ed53a566-0504-46f9-81a7-116a637833af
description: '概要: Skype for Business Server のエッジ サーバーのシステム要件について説明します。'
ms.openlocfilehash: e066249498febbd5e622546533f49422320c7c87
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "49813767"
---
# <a name="edge-server-system-requirements-in-skype-for-business-server"></a>Skype for Business Server のエッジ サーバーのシステム要件
 
**概要:** Skype for Business Server のエッジ サーバーのシステム要件について説明します。
  
Skype for Business Server エッジ サーバーの展開に関しては、環境構造の計画に加え、環境内のサーバーに対して行う必要がある操作を以下に示します。 トポロジ、DNS、証明書、その他のインフラストラクチャに関する問題の詳細については、環境要件のドキュメントを参照してください。
  
## <a name="components"></a>コンポーネント

エッジ サーバー環境について説明する場合、大部分は境界ネットワークに展開されているコンポーネントを参照しています (つまり、ワークグループまたは Skype for Business Server ドメイン構造の外部にあるドメインのいずれかです)。
  
次のコンポーネントを念頭に置いて、Edge を正常に展開するために注意する必要があるコンポーネントを示します。
  
- [エッジ サーバー](system-requirements.md#EdgeServers)
    
- [リバース プロキシ](system-requirements.md#ReverseProxies)
    
- [ファイアウォール](system-requirements.md#Firewalls)
    
- [ディレクター](system-requirements.md#Directors) (これらはオプションであり、含まれている場合は内部ネットワークに保存されます)
    
- [ロード バランサー](system-requirements.md#LoadBalancers) (DNS 負荷分散またはハードウェア ロード バランサー (HLB) を使用できますが、単一のエッジ サーバーの場合は必要ない)
    
以下では、これらのそれぞれについて詳しく説明します。
  
### <a name="edge-servers"></a>エッジ サーバー
<a name="EdgeServers"> </a>

これらは、境界環境に展開されている Skype for Business サーバーです。 その役割は、内部の Skype for Business Server 展開によって提供されるサービスの外部ユーザーとの間でネットワーク トラフィックを送受信する役割です。 これを正常に行うには、各エッジ サーバーが次の手順を実行します。
  
- **アクセス エッジ サービス**: 送信と受信の両方のセッション開始プロトコル (SIP) トラフィックに対して、単一の信頼できる接続ポイントを提供します。
    
- **Web 会議エッジ サービス**: 外部ユーザーが内部 Skype for Business Server 環境でホストされている会議に参加できます。
    
- **音声ビデオ エッジ サービス**: 音声、ビデオ、アプリケーション共有、およびファイル転送を外部ユーザーが利用できます。
    
- **XMPP プロキシ サービス: XMPP** フェデレーション パートナーとの間で XMPP (Extensible Messaging and Presence Protocol) メッセージを受け入れて送信します。
    
承認された外部ユーザーは、エッジ サーバーを使用して内部の Skype for Business Server 展開に接続できますが、それ以外の場合は、すべてのユーザーに内部ネットワークへの他のアクセスを提供しません。
  
> [!NOTE]
> エッジ サーバーは、有効な Skype for Business クライアントおよび他のエッジ サーバー (フェデレーション シナリオの場合) に接続を提供するために展開されます。 他のエンド ポイント クライアントやサーバーの種類から接続できません。 XMPP ゲートウェイ サーバーは、構成済みの XMPP パートナーとの接続を許可できます。 ただし、これらは、動作する唯一のクライアントとフェデレーションの種類です。 

> [!NOTE]
> XMPP ゲートウェイとプロキシは Skype for Business Server 2015 で使用できますが、Skype for Business Server 2019 ではサポートされなくなりました。 詳細 [については、「XMPP フェデレーションの移行](../../../SfBServer2019/migration/migrating-xmpp-federation.md) 」を参照してください。
  
### <a name="reverse-proxies"></a>リバース プロキシ
<a name="ReverseProxies"> </a>

リバース プロキシ (RP) サーバーは Skype for Business Server の役割を持たませんが、エッジ サーバー展開の重要なコンポーネントです。 リバース プロキシを使用すると、外部ユーザーは次の機能を実行できます。
  
- 簡易 URL を使用して会議またはダイヤルイン会議に接続します。
    
- 会議コンテンツをダウンロードします。
    
- 配布グループを展開します。
    
- クライアント証明書ベースの認証用にユーザーベースの証明書を取得する
    
- アドレス帳サーバーからファイルをダウンロードするか、アドレス帳 Web クエリ サービスにクエリを送信します。
    
- クライアントおよびデバイス ソフトウェアの更新プログラムを取得します。
    
モバイル デバイスの場合:
  
- これにより、モビリティ サービスを提供するフロントエンド サーバーを自動的に検出できます。
    
- Microsoft 365 または Office 365 からモバイル デバイスへのプッシュ通知を有効にします。
    
現在のリバース プロキシに関する推奨事項については、Skype for Business のテレフォニー [インフラストラクチャページをご覧](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways) ください。 そのため、リバース プロキシは次の点に注意してください。
  
- は、パブリック証明書を介して環境に導入されたトランスポート層セキュリティ (TLS) を使用して、次の公開された外部 Web サービスに接続できる必要があります。
    
  - ディレクターまたはディレクター プール
    
  - フロントエンド サーバーまたはフロントエンド プール
    
- 暗号化のために証明書を使用して内部 Web サイトを公開したり、必要に応じて暗号化されていない方法で公開したりできる必要があります。
    
- は、完全修飾ドメイン名 (FQDN) を使用して、内部ホスト型 Web サイトを外部に公開できる必要があります。
    
- ホストされた Web サイトのすべてのコンテンツを発行できる必要があります。 既定では、 _ ディレクティブを使用できます。_ ディレクティブは、ほとんどの Web サーバーで認識され、"Web サーバー上のすべてのコンテンツを公開する" ことを **/\\** 意味します。 また、ディレクティブ _*(/Uwca/ \\* *_ など) を変更できます。これは、"仮想ディレクトリ Ucwa の下のすべてのコンテンツを公開する" を意味します。
    
- は、公開された Web サイトからコンテンツを要求するクライアントとの TLS 接続を要求する必要があります。
    
- は、サブジェクトの代替名 (SAN) エントリを持つ証明書を受け入れる必要があります。
    
- 外部 Web サービスの FQDN が解決されるリスナーまたはインターフェイスへの証明書のバインドを許可できる必要があります。 リスナーの構成は、インターフェイスの方が望ましいです。 多くのリスナーは、1 つのインターフェイスで構成できます。
    
- ホスト ヘッダー処理の構成を許可する必要があります。 多くの場合、要求元のクライアントによって送信される元のホスト ヘッダーは、リバース プロキシによって変更されるのではなく、透過的に渡される必要があります。
    
- 1 つの外部で定義されたポート (たとえば、TCP 443) から別の定義済みポート (たとえば、TCP 4443) への TLS トラフィックのブリッジを許可する必要があります。 リバース プロキシは、受信時にパケットの暗号化を解除し、送信時にパケットを再暗号化できます。
    
- 1 つのポート (たとえば、TCP 80) から別のポート (たとえば、TCP 8080) への暗号化されていない TCP トラフィックのブリッジを許可する必要があります。
    
- NTLM 認証、認証なし、およびパススルー認証の構成を許可する必要があります。
    
リバース プロキシでこの一覧のすべてのニーズに対応できる場合は、必ず実行してください。ただし、上記のリンクにある推奨事項に注意してください。
  
### <a name="firewalls"></a>ファイアウォール
<a name="Firewalls"> </a>

エッジ展開は外部ファイアウォールの内側に配置する必要がありますが、エッジ環境と内部環境の間には 2 つのファイアウォール、1 つは外部、もう 1 つは内部ファイアウォールを使用することをお勧めします。 シナリオに含まれていますすべてのドキュメントには、2 つのファイアウォールがあります。 2 つのファイアウォールをお勧めします。このファイアウォールは、ネットワーク エッジ間の厳密なルーティングを保証し、内部ネットワークのファイアウォール保護を 2 倍にします。
  
### <a name="directors"></a>ディレクター
<a name="Directors"> </a>

これはオプションの役割です。 単一サーバーまたはディレクターの役割を実行するサーバーのプールを指定できます。 これは、内部の Skype for Business Server 環境で見つかった役割です。
  
ディレクターは、Skype for Business Server の内部サーバー宛てのエッジ サーバーから受信 SIP トラフィックを受信する内部の次ホップ サーバーです。 受信要求を事前認証し、ユーザーのホーム プールまたはサーバーにリダイレクトします。 この事前認証を使用すると、未確認のユーザー アカウント要求を削除できます。
  
なぜそれが重要なのでしょうか。 ディレクターにとって重要な機能は、サービス拒否 (DoS) 攻撃などの悪意のあるトラフィックから Standard Edition サーバーとフロントエンド サーバーまたはフロントエンド プールを保護する機能です。 ネットワークに無効な外部トラフィックが流された場合、トラフィックはディレクターで停止します。
  
### <a name="load-balancers"></a>ロード バランサー
<a name="LoadBalancers"> </a>

Skype for Business Server の拡張統合エッジ トポロジは、新しい展開用に DNS 負荷分散用に最適化されています。この方法をお勧めします。 高可用性が必要な場合は、特定の状況に合ったハードウェア ロード バランサーを使用することをお勧めします。
  
- Exchange UM _prior *** to Exchange 2013 を使用するリモート ユーザーの Exchange UM。
    
> [!IMPORTANT]
> ロード バランサーを混在できない点に注意してください。 Skype for Business Server 環境では、すべてのインターフェイスで DNS または HLB を使用する必要があります。 
  
> [!NOTE]
> 直接サーバー リターン (DSR) NAT は、Skype for Business Server ではサポートされていません。 
  
#### <a name="hardware-load-balancer-requirements-for-edge-servers-edge-servers-running-the-av-edge-service"></a>A/V エッジ サービスを実行するエッジ サーバーエッジ サーバーのハードウェア ロード バランサー要件

A/V エッジ サービスを実行しているエッジ サーバーの要件は次のとおりです。
  
- 内部ポートと外部ポート 443 の両方に対して TCP ネーグリングをオフにします (ネーグリングは、送信効率を向上するために、複数の小さなパケットを 1 つの大きなパケットに結合するプロセスです)。
    
- 外部ポート範囲 50000 ~ 59999 の TCP の入れ子をオフにします。
    
- 内部または外部のファイアウォールで NAT を使用しない。
    
- エッジの内部インターフェイスは、エッジ サーバーの外部インターフェイスとは異なるネットワーク上に用意する必要があります。また、エッジ間のルーティングを無効にする必要があります。
    
- A/V エッジ サービスを実行しているエッジ サーバーの外部インターフェイスは、パブリックにログアウト可能な IP アドレスを使用する必要があります。また、エッジの外部 IP アドレスに NAT またはポート変換を使用する必要はありません。
    
#### <a name="hlb-requirements"></a>HLB の要件

Skype for Business Server には、Cookie ベースのアフィニティ要件があまり存在しません。 そのため、Skype for Business Server 環境に Lync Server 2010 フロントエンド サーバーまたはフロント エンド プールが含まれる **(これは** Skype for Business Server 2015 固有の場合) ない限り、Cookie ベースの永続性を使用する必要はありません。 Lync Server 2010 に推奨される構成方法では、Cookie ベースのアフィニティが必要になります。
  
> [!NOTE]
> HLB に対して Cookie ベースのアフィニティを有効にしても、環境に必要ない場合でも問題はありません。 
  
環境に Cookie **ベースのアフィニティ** が必要ない場合:
  
- ポート 443 のリバース プロキシ公開ルールで、転送ホスト ヘッダーを True **に** 設定 **します**。 これにより、元の URL が確実に転送されます。
    
Cookie ベースのアフィニティ **が必要** な展開の場合:
  
- ポート 443 のリバース プロキシ公開ルールで、転送ホスト ヘッダーを True **に** 設定 **します**。 これにより、元の URL が確実に転送されます。
    
- ロード バランサーのハードウェア Cookie **は** httpOnly とマークしなけずにしてください。
    
- ハードウェア ロード バランサー Cookie **には有効期限** を設定する必要があります。
    
- ロード バランサーハードウェア **Cookie** には **MS-WSMAN** という名前を付けます (これは Web サービスが期待する値であり、変更できません)。
    
- ハードウェア ロード バランサー  Cookie は、同じ TCP 接続上の以前の HTTP 応答が Cookie を取得したかどうかに関係なく、受信 HTTP 要求に Cookie が設定されなかったすべての HTTP 応答で設定する必要があります。 ハードウェア ロード バランサーが COOKIE の挿入を TCP 接続ごとに 1 回だけ行う最適化を行う場合は、その最適化 **を** 使用する必要があります。
    
> [!NOTE]
> HLB 構成では、ソース アフィニティと 20 分間の TCP セッションの有効期間を使用するのが一般的です。これは、クライアントの使用状況やアプリケーションの操作によってセッション状態が維持される場合に、Skype for Business Server とそのクライアントで問題ありません。 
  
モバイル デバイスを展開する場合、HLB は TCP セッション内の個々の要求を負荷分散できる必要があります (実際には、ターゲット IP アドレスに基づいて個々の要求を負荷分散できる必要があります)。
  
> [!IMPORTANT]
> F5 HLB には OneConnect という機能があります。 これにより、TCP 接続内の各要求が個別に負荷分散されます。 モバイル デバイスを展開する場合は、HLB ベンダーが同じ機能をサポートしている必要があります。 最新の iOS モバイル アプリには TLS バージョン 1.2 が必要です。 詳細を知る必要がある場合は、F5 キーを押してこの設定を行います。 
  
(オプション) ディレクターと (必須) フロントエンド プール Web サービスの HLB 要件を次に示します。
  
- 内部 Web サービスの VIP については、HLB Source_addr永続性 (内部ポート 80、443) を設定します。 Skype for Business Server の場合、Source_addrは、セッション状態を維持するために、1 つの IP アドレスから複数の接続が常に 1 つのサーバーに送信されます。
    
- 1800 秒の TCP アイドル タイムアウトを使用します。
    
- リバース プロキシと次ホップ プールの HLB の間のファイアウォールで、リバース プロキシから HLB への https: ポート 4443 のトラフィックを許可するルールを作成します。 HLB は、ポート 80、443、および 4443 をリッスンするように構成する必要があります。
    
#### <a name="summary-of-hlb-affinity-requirements"></a>HLB アフィニティ要件の概要

|**クライアント/ユーザーの場所**|**外部 Web サービスの FQDN のアフィニティ要件**|**内部 Web サービスの FQSN アフィニティ要件**|
|:-----|:-----|:-----|
|Skype for Business Web App (内部ユーザーと外部ユーザー)  <br/> モバイル デバイス (内部ユーザーと外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (外部ユーザーのみ)  <br/> モバイル デバイス (内部ユーザーと外部ユーザー)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
|Skype for Business Web App (内部ユーザーのみ)  <br/> モバイル デバイス (展開しない)  <br/> |アフィニティなし  <br/> |送信元アドレスのアフィニティ  <br/> |
   
#### <a name="port-monitoring-for-hlbs"></a>HLB のポート監視

ハードウェア ロード バランサーでポート監視を定義し、ハードウェアまたは通信の障害が原因で特定のサービスが使用できなくなった状況を判断します。 たとえば、フロントエンド サーバーまたはフロント エンド プールに障害が発生してフロントエンド サーバー サービス (RTCSRV) が停止した場合、HLB 監視は Web サービス上のトラフィックの受信も停止する必要があります。 HLB の外部インターフェイスを監視するには、HLB にポート監視を実装する必要があります。
  
|**仮想 IP/ポート**|**ノード ポート**|**ノード コンピューター/モニター**|**保存プロファイル**|**注**|
|:-----|:-----|:-----|:-----|:-----|
|\<pool\>web_mco_443_vs  <br/> 443  <br/> |4443  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTPS  <br/> |
|\<pool\>web_mco_80_vs  <br/> 80  <br/> |8080  <br/> |フロントエンド  <br/> 5061  <br/> |なし  <br/> |HTTP  <br/> |
   
## <a name="hardware-and-software-requirements"></a>ハードウェア要件とソフトウェア要件

[Skype for Business Server 2015](../../plan-your-deployment/requirements-for-your-environment/server-requirements.md)のサーバーの全体的な要件と、Skype for Business [Server 2019](../../../SfBServer2019/plan/system-requirements.md)のシステム要件に関するドキュメントでは、エッジ サーバーのハードウェア要件とソフトウェア要件について説明しました。
  
## <a name="collocation"></a>Collocation

Skype for Business Server のトポロジの基本に関するドキュメントでは、エッジ サーバーのコロケーション [について説明](../../plan-your-deployment/topology-basics/topology-basics.md) しました。
  

