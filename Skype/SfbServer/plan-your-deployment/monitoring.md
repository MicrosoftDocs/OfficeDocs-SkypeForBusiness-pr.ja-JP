---
title: Skype for Business Server で監視を計画する
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.assetid: 5d5eb658-7fe0-42e6-acaf-700051d0a823
description: '概要: Skype for Business Server で監視サービスを計画しているときに、このトピックを確認してください。'
ms.openlocfilehash: 6089997a606463b93e7ae68a2cf080f1bb58ebc1
ms.sourcegitcommit: e64c50818cac37f3d6f0f96d0d4ff0f4bba24aef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2020
ms.locfileid: "41815805"
---
# <a name="plan-for-monitoring-in-skype-for-business-server"></a>Skype for Business Server で監視を計画する

**概要:** このトピックは、Skype for Business Server で監視サービスを計画しているときに確認してください。

Skype for Business Server の監視サービスを使用すると、管理者は、組織内で行われる通信セッションの利用状況データと品質データを収集して、傾向や問題を特定することができます。 展開を継続的に監視することで、早期に問題を検出し、組織のユーザーの満足度を維持することができます。

Skype for Business Server での監視は、個別のサーバーの役割を必要としません (以前のバージョンの Lync の場合と同じです)。代わりに、監視サービスは各フロントエンドサーバーに組み込まれています。 Skype for Business Server では、監視機能は既定で有効になっていません。 この記事では、最初の Skype for Business Server の構成の最中または後の監視を有効にするかどうかを決定する方法、および操作の監視をサポートするために必要な SQL リソースについて説明します。 監視されていないかどうかがわからない場合や、監視が役に立つ方法がわからない場合は、「[監視の基本](monitoring.md#Basics)」を参照してください。 計画プロセスを開始するには、「[監視の要件を定義](monitoring.md#requirements)する」を参照してください。 監視の SQL 要件の詳細については、「[監視のための sql 要件](monitoring.md#topologies)」を参照してください。

## <a name="basics-about-monitoring"></a>監視の基本
<a name="Basics"> </a>

セッションとは、ユーザーの a への接続に関する一般的な用語です。

- 電話会議

- 会議ツール (音声ビデオやアプリケーション共有など)

- インスタント メッセージングや音声通話などのピアツーピア会話を介した別のユーザー

> [!NOTE]
> Skype for Business Server は、各セッションについての情報を追跡します。誰がだれか。セッションで使用されたエンドポイントセッションの最後の所要時間セッションの品質はどのようなものだったのでしょうか。などなど。 Skype for Business Server では、実際の通話は記録および保存されません。 インスタントメッセージングセッションが含まれている場合: Skype for Business Server はインスタントメッセージングセッションに関する情報を記録しますが、セッション中に送信されたインスタントメッセージの記録は保持されません。

各セッションの Skype for Business Server によって収集される基本的な通話の詳細情報は、次の用途に使用できます。

- **投資収益率 (ROI)** の分析。 管理者は、料金を節約し、Skype for Business Server の展開を正当化するために、以前のテレフォニーシステムで収集された類似データと使用状況データを比較することができます。

- **デバイス インベントリ管理**。管理者は資産管理情報を活用して、交換が必要でもまだ使用されている古いデバイスや、使用されていない、または使用率の低い高価なデバイスを特定できます。

- **ヘルプ デスク**。 データのトラブルシューティングを行うと、サーバーまたはクライアント側のログを収集せずに、ユーザーの通話が失敗した理由がエンジニアによって判断されます。 この情報は、Skype for Business クライアントと Skype for business Server についての技術的な知識を持っていないサポート担当者が、簡単にアクセスして理解することができます。

- **システム トラブルシューティング**。管理者は、エンド ユーザーが会議への参加、通話の確立、インスタント メッセージの送信などの基本的なタスクを実行できなくなるような深刻な問題を検出できます。

また、監視には、SIP エンドポイント (Skype for Business など) が、他の方法ではアクセスできないトラブルシューティング情報を提供するメカニズムも用意されています。

- **品質に影響するメディア指標**。これらの指標は、通話の実際の送信を処理します。ネットワーク上の通話の経路としてトラベログのようなものを提供します。これらの指標 (パケット損失、ジッター、往復時間などを含む) は、通話があるユーザーのエンドポイントで発信されてから他のユーザーのエンドポイントに到達するまでに起きたことに関する情報を提供します。

- **エンド ユーザーにレポートされる問題**。 これらのメトリックには、マイクから離れている、音声が小さすぎる、または、ネットワーク接続が弱い、または別のプログラムが原因で音質が低下している場合に、Skype for Business がエンドユーザーに提示する低品質の通知が含まれます。コンピューターで利用可能なリソースが消費されている。

- **環境情報**。これらの指標は、使用されているマイクとスピーカーの種類、ユーザーが VPN 接続経由で接続しているかどうか、ユーザーがワイヤレスで接続しているかどうかなど、通話品質要因の詳細を示します。

各通話の終了時に、SIP 対応のエンドポイントは通話を支援したフロントエンド サーバーにこの情報を送信します。その情報を送信するためにエンドポイントで何も実行する必要はありません。この動作は SIP プロトコルに組み込まれています。ただし、その情報を収集して保存する場合は、監視をインストールして有効にする必要があります。監視をインストールして有効にした場合、通話情報はフロントエンド サーバーで実行されているエージェントによって収集され、SQL Server データベースのペアに中継されます。監視サービス (「統合データ収集エージェント」の形式による) は、すべてのフロント エンド サーバーに併置されます。

## <a name="define-your-requirements-for-monitoring"></a>会議の要件を定義する
<a name="requirements"> </a>

Skype for Business Server で監視をインストールして構成する前に、いくつかの重要な問題に対処する必要があります。

 **どのような場合に監視をインストールしますか?** Skype for Business Server をインストールして構成するときに、同時に監視をインストールして構成することができます。Skype for Business Server 展開ウィザードを使用すると、セットアップ時にフロントエンドプールを監視データベースに関連付けることができます。 または、Skype for Business Server 自体をインストールした後で、監視をインストールすることもできます。これを行うには、トポロジビルダーを使用して、フロントエンドプールとサーバーを監視データベースに関連付け、更新されたトポロジを公開します。

監視を展開して構成する前に、SQL Server をインストールして構成する必要があることに注意してください。 ただし、SQL Server 自体のみを展開する必要があります。Skype for Business Server トポロジを公開すると、監視データベースが作成されます。

 **どのような種類のデータを監視しますか?** Skype for Business Server では、次の2種類の一般的なデータを監視できます。レコーディング (CDR) データと Quality of Experience (QoE) データの呼び出し。 通話の詳細レコーディングは、ボイスオーバー IP (VoIP) 通話などの Skype for Business Server 機能の使用状況を追跡するための手段を提供します。インスタントメッセージング (IM);ファイルの転送音声/ビデオ (A/V) 会議アプリケーション共有セッション。 この情報は、どの Skype for Business Server 機能が使用されているかを把握するのに役立ちます。また、どの機能が使用されているかについての情報も提供します。 エクスペリエンスデータの品質によって、紛失したネットワークパケットの数、背景の雑音、"ジッター" の量 (パケット遅延の違い) など、組織内で行われた音声通話やビデオ通話の音質を管理することができます。

Skype for Business Server で監視を有効にすると、CDR monitoring と QoE の両方の監視を有効にすることができます。または、他の種類を無効のままにして、いずれかの種類の監視を有効にすることもできます。 たとえば、ユーザーがインスタント メッセージングとファイル転送だけを使用し、音声またはビデオ通話を行わないとします。 この場合、QoE 監視を有効にする意味はほとんどありません。 同様に、Skype for Business Server を使用すると、監視が展開された後で簡単に監視を有効または無効にすることができます。 たとえば、監視を展開するが、最初は QoE 監視を無効にする場合があります。 ユーザーが音声またはビデオ通話の問題に遭遇し始めた場合は、QoE 監視を有効にし、そのデータを使用して問題のトラブルシューティングと解決にあたります。

Skype for business server をインストールするのと同時に、監視をインストールすることはできません。 Skype for Business Server がインストールされた後で監視をインストールすることはできません。 注意する必要がある点は、監視をインストールする前に、バックエンドの監視ストアをホストするコンピューターを選択し、そのコンピューターを監視に使用する前に、サポートされているバージョンの SQL Server をそのコンピューターにインストールして構成する必要があるということです。 コンピューターに SQL Server が既にインストールされていて、そのコンピューターで使用できる状態になっている場合は、Skype for Business Server をインストールするときに同時に監視をインストールできます。 バックエンドコンピューターを用意していない場合は、Skype for Business Server だけをインストールして、バックエンドコンピューターを使用する準備ができたら、監視をインストールします。

 **必要なバックエンド監視データベースの数はいくつですか?** 監視とアーカイブのどちらにも併置されたデータベースは、24万 Skype for Business Server ユーザーをサポートしている可能性があるという見積もりでした。 さらに、単一の監視データベースを複数のフロントエンドプールで使うことができます。組織内の3つのフロントエンドプールを使用している場合は、これらの3つのプールをすべて同じバックエンドストアに関連付けることができます。

多くの組織では、必要なバックエンド監視データベースの数を決定するときに、データベースの容量が決定的要素になりません。その代わりに、ネットワークの速度がより重要な考慮事項になります。フロントエンド プールが 3 つあるが、そのうちの 1 つのプールが低速のネットワーク接続に配置されているとします。この場合、2 つの監視データベースを使用することをお勧めします。つまり、1 つのデータベースを良好なネットワーク接続を持つ 2 つのプールに使用し、もう一方のデータベースを低速のネットワーク接続を持つプールに使用します。

また、Skype for Business Server がミラーデータベースの使用をサポートしていることも考慮する必要があります。 "データベース ミラーリング" を使用すると、データベースの 2 つのコピーを、それぞれ別のサーバー上で同時に保持することができます。 データがプライマリ データベースに書き込まれるたびに、同じデータがミラー データベースに書き込まれます。 プライマリデータベースの障害が発生したり、その他の方法で利用できない場合は、単純な Skype for Business Server PowerShell コマンドを使用して、ミラーデータベースに "フェールオーバー" することができます。 次に例を示します。

```PowerShell
Invoke-CsDatabaseFailover -PoolFqdn atl-cs-001.litwareinc.com -DatabaseType "Monitoring" -NewPrincipal "Mirror"
```

これが計画において重要なのは、ミラーリングでは必要なデータベースの数が 2 倍になるからです。プライマリ データベースそれぞれの他に、ミラーとして動作する第 2 のデータベースが必要になります。

 **Skype for Business Server サイトには独自のカスタム監視構成が必要ですか?** Skype for Business Server をインストールする場合は、CDR と QoE の構成設定のグローバルコレクションもインストールします。これらのグローバルコレクションを使うと、同じ CDR と QoE の設定を組織全体に適用することができます。 In many cases, this will be sufficient: often-times you will want, say, to have CDR monitoring enabled for all of your users.

ただし、サイトごとに異なる設定を適用する必要がある場合もあります。 たとえば、Redmond サイトで CDR と QoE の両方の監視を使用したいが、場合によっては、ダブリンサイトでは CDR monitoring しか使用できません。 同様に、Redmond サイトで60日間の監視データを保持する必要がある場合もありますが、ダブリンサイトではこの種類のデータを30日間保持する必要があります。 Skype for Business Server では、CDR と QoE の構成設定をサイトのスコープで個別に作成することができます。これにより、各サイトを個別に管理することができます。 (これには、監視の有効化と無効化、およびデータの保持期間などの管理設定の構成が含まれます)。

この判断は、監視を展開する前または監視を展開した後にできることに注意してください。たとえば、監視を展開してから、グローバル設定を使用して組織全体を管理できます。後で変更する場合には、たとえば、Redmond サイト用の設定の別個のコレクションを作成し、これらの設定を使用して Redmond 用の監視を管理します (サイト スコープに適用された設定は、グローバル スコープに適用された設定よりも常に優先されます)。再び変更する場合は、Redmond サイトに適用された構成設定を単に削除します。サイト設定のコレクションを削除すると、設定のグローバル コレクションがそのサイトに自動的に適用されます。

## <a name="sql-requirements-for-monitoring"></a>監視の SQL 要件
<a name="topologies"> </a>

監視を有効にすると、統合データ収集エージェントは、各フロントエンド サーバーに自動的にインストールされ、アクティベートされます。 サポートされているバージョンの SQL Server とその他の詳細については、「 [Skype For Business server のサーバー要件 2015](requirements-for-your-environment/server-requirements.md) 」を参照してください。

監視データと他の種類のデータで 1 つの SQL Server インスタンスを共有することができます。一般には、通話詳細記録データベース (LcsCdr) と Quality of Experience データベース (QoEMetrics) で同じ SQL インスタンスを共有します。また、2 つの監視データベースを、アーカイブ データベース (LcsLog) として同じ SQL インスタンスに配置するのも一般的です。SQL Server インスタンスに関する実際の唯一の要件は、SQL Server のどのインスタンスについても、次の制限が設けられることです。

- Skype for Business Server 2015 バックエンドデータベースの1つのインスタンス。 (一般的な規則として、監視データベースを同一の SQL インスタンスまたは同じコンピューター上のバックエンドデータベースとの間で併置することはお勧めしません。 技術的には可能ですが、バックエンドデータベースに必要なディスク領域を使用して、監視データベースのリスクを実行します。

- 通話詳細記録データベースは 1 インスタンス。

- Quality of Experience データベースは 1 インスタンス。

- アーカイブ データベースは 1 インスタンス。

言い換えると、同じ SQL Server インスタンス内に LcsCdr データベースのインスタンスを 2 つ持つことはできません。LcsCdr データベースのインスタンスが複数必要な場合は、SQL Server のインスタンスを複数構成する必要があります。

## <a name="see-also"></a>関連項目


[Deploying Monitoring](https://technet.microsoft.com/library/117f4a3e-0670-4388-a553-b9854921145f.aspx)
