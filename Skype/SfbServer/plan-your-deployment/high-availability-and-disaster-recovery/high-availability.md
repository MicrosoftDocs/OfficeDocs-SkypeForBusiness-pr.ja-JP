---
title: フロントエンド プールの高可用性と管理
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: プールの管理、クォーラム損失、および 2 台のフロントエンド サーバーのみを持つプールの特別な手順など、Skype for Business Server でのフロントエンド プールの管理について説明します。
ms.openlocfilehash: 3f1924b7a8ad26b880f8674ada4f0c99a1bc4596
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "49802797"
---
# <a name="front-end-pool-high-availability-and-management"></a>フロントエンド プールの高可用性と管理
 
プールの管理、クォーラム損失、および 2 台のフロントエンド サーバーのみを持つプールの特別な手順など、Skype for Business Server でのフロントエンド プールの管理について説明します。
  
Skype for Business Server では、フロントエンド プールのアーキテクチャは分散システム モデルを使用し、各ユーザーのデータはプール内の 3 つのフロントエンド サーバーに保持されます。 すべての Enterprise Edition フロントエンド プールには、少なくとも 3 つのフロントエンド サーバーを含める必要があります。

> [!NOTE]
> Skype for Business Server 2019 は、2 台のフロント エンド サーバーを持つ Enterprise Edition フロントエンド プールをサポートしていないので、そのシナリオでトポロジを公開できません。
  
## <a name="planning-for-the-management-of-front-end-pools"></a>フロントエンド プールの管理の計画

 Skype for Business Server は、Windows Fabric に基づく分散システム モデルを使用します。 このモデルでは、各ユーザーおよび会議の重要なデータは、フロントエンド プール内の 3 つのフロントエンド サーバーに格納されます。 特定のデータ セットを格納するこれら 3 つのサーバーは、replicas と呼ばれる名前です。
  
フロントエンド プールの分散モデルでは、プールが機能するには、プールのサーバーの特定の数が実行されている必要があります。 プールには 2 つの損失モードがあります。
  
- ルーティング グループ レベルクォーラム損失。特定のルーティング グループのレプリカ サーバーが不十分な場合に発生します。 ルーティング グループは、プールにホームとして設定されているユーザーのセットです。 各ルーティング グループには、プール内に 3 つのレプリカ (1 つのプライマリ レプリカと 2 つのセカンダリ レプリカ) があります。
    
- プール レベルクォーラム損失。プールで十分なシード サーバーが実行されていない場合に発生します。 
    
### <a name="routing-group-level-quorum-loss"></a>ルーティング グループ レベルクォーラム損失

新しいフロントエンド プールを初めて起動する場合は、次の表に示すように、サーバーの 85% が稼働状態であることが重要です。 実行中のサーバーが少ない場合は、サービスが開始状態でスタックし、プールが開始されない可能性があります。
  
|プール内のサーバーの総数  <br/> |プールを初めて起動するために実行する必要が生じなければならないサーバーの数  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3   <br/> |3   <br/> |
|4   <br/> |3   <br/> |
|5   <br/> |4   <br/> |
|6   <br/> |5   <br/> |
|7   <br/> |5   <br/> |
|8   <br/> |6   <br/> |
|9   <br/> |7   <br/> |
|10   <br/> |8   <br/> |
|11   <br/> |9   <br/> |
|12   <br/> |10   <br/> |
|16 **For Skype for Business Server 2019** <br/> |12   <br/> |


   
それ以降にプールが開始されるごとに、サーバーの 85% を開始する必要があります (前の表を参照)。 この数のサーバーを開始できない場合 (ただし、プール レベルのクォーラム損失が発生しないほど十分な数のサーバーを開始できる場合)、このコマンドレットを使用して、プールでこのルーティング グループ レベルのクォーラム損失から回復し、処理を進めできます。 `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` このコマンドレットの使い方の詳細については [、「Reset-CsPoolRegistrarState」を参照してください](https://docs.microsoft.com/powershell/module/skype/reset-cspoolregistrarstate?view=skype-ps)。 
  
> [!NOTE]
> サーバーの数が等しいプールでは、Skype for Business Server はプライマリ サーバー データベースを監視SQL使用します。 このようなプールでは、プライマリ データベースをシャットダウンしてミラー コピーに切り替え、前の表に従って十分に実行されていないフロントエンド サーバーをシャットダウンすると、プール全体がダウンします。 詳細については、「データベース ミラーリング [監視」を参照してください](https://go.microsoft.com/fwlink/?LinkId=393672)。 
  
#### <a name="pool-level-quorum-loss"></a>プール レベルクォーラム損失

フロントエンド プールが機能するには、プール レベルのクォーラム損失にすることはできません。 次の表に示すように、実行されているサーバーの数が機能レベルを下回った場合、プール内の残りのサーバーは、すべての Skype for Business Server サービスを停止します。 次の表の数値は、プール内のバック エンド サーバーが実行されている場合を想定しています。
  
|プール内のフロントエンド サーバーの総数  <br/> |プールが機能するために実行されている必要のあるサーバーの数  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3-4  <br/> |任意の 2  <br/> |
|5-6  <br/> |任意の 3  <br/> |
|7   <br/> |任意の 4  <br/> |
|8-9  <br/> |最初の 7 つのサーバーの任意の 4 つ  <br/> |
|10-12  <br/> |最初の 9 つのサーバーの任意の 5 つ  <br/> |
|12-16  **For Skype for Business Server 2019**  <br/> |最初の 12 台のサーバーの任意の 7 台  <br/> |
   
前の表の "最初のサーバー" は、プールが初めて起動された際に、時系列的に最初に起動されたサーバーです。 これらのサーバーを確認するには、このコマンドレット  `Get-CsComputer` をオプションと一緒に使用 `-PoolFqdn` します。 このコマンドレットでは、サーバーがトポロジに表示される順序で表示され、一覧の上部にあるサーバーが最初のサーバーになります。
  
> [!IMPORTANT]
> [Skype for Business Server 2019](https://docs.microsoft.com/skypeforbusiness/plan/user-model-2019)では、フロントエンド サーバーの最大数が 16 台に増やされました。
> 
#### <a name="additional-steps-to-ensure-pools-are-functional"></a>プールが機能するための追加の手順

フロント エンド プールの機能を維持するために、その他のいくつかの要因を監視する必要があります。
  
- ユーザーを初めてプールに移動する場合は、少なくとも 3 つのフロントエンド サーバーが実行されている必要があります。
    
- 障害復旧を目的としてこのプールと別のプールの間にペアリング関係を確立する場合は、その関係を確立した後、データをバックアップ プールと適切に同期するために、このプールに同時に 3 つのフロントエンド サーバーが同時に実行されていることを確認する必要があります。 プールのペアリングと障害復旧機能の詳細については [、「Plan for high availability and disaster recovery in Skype for Business Server 」を参照してください](high-availability-and-disaster-recovery.md)。 
    
## <a name="front-end-pool-with-two-front-end-servers"></a>2 台のフロントエンド サーバーを含むフロントエンド プール

2 台のフロントエンド サーバーのみを含むフロントエンド プールを展開はお勧めしません。 この小規模なプールでは、大規模なプールのように堅牢な高可用性ソリューションは提供されないので、管理に特別な注意が必要です。 また、2 台のサーバー プールのバック エンド サーバーがダウンした場合は、プール全体もすぐにダウンする可能性があります。 Skype for Business Server を実行している 1 台または 2 台のサーバーを展開する場合は、Standard Edition サーバーとして展開することをお勧めします。
  
2 台のフロントエンド サーバーを持つプールを展開する必要がある場合は、次のガイドラインに従います。
  
- 2 台のフロントエンド サーバーの 1 つがダウンした場合は、できるだけ早く障害が発生したサーバーをバックアップする必要があります。 同様に、2 台のサーバーのいずれかをアップグレードする必要がある場合は、アップグレードが完了したらすぐにオンラインに戻します。
    
- 何らかの理由で両方のサーバーを同時に停止する必要がある場合は、プールのダウンタイムが終了したら、次の操作を行います。
    
  - ベスト プラクティスは、両方のフロントエンド サーバーを同時に再起動する方法です。 
    
  - 2 台のサーバーを同時に再起動できない場合は、停止した順序と逆の順序でサーバーを戻す必要があります。
    
  - その順序でバックアップできない場合は、プールをバックアップする前に次のコマンドレットを使用します。  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`
    
## <a name="front-end-pool-configuration-failures-and-changes"></a>フロントエンド プールの構成の失敗と変更

フロントエンド サーバーに障害が発生し、数日以上交換する可能性が低い場合は、トポロジからサーバーを削除します。 新しいフロントエンド サーバーが再び使用可能な場合は、トポロジに追加します。
  
サーバーの追加や削除など、フロントエンド プールの構成を変更するたびに、次のガイドラインに従う必要があります。
  
- 新しいトポロジが公開された後、プール内の各フロントエンド サーバーを再起動する必要があります。 一度に 1 回再起動します。
    
- 構成変更中にプール全体がダウンした場合は、新しいトポロジの公開後に次のコマンドレットを実行します。  `Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`
    

