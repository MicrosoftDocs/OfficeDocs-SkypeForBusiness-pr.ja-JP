---
title: フロントエンドプールの高可用性と管理
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: Skype for Business Server のフロントエンドプール管理について説明します。これには、プールの管理、クォーラムの損失、および2台のフロントエンドサーバーのみのプールの特別な手順が含まれます。
ms.openlocfilehash: 2982e2da0e7a103b5b598019baa7403a73da826d
ms.sourcegitcommit: 397c4840fb053238de24b8b24ae75588b33b693d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/10/2020
ms.locfileid: "45098435"
---
# <a name="front-end-pool-high-availability-and-management"></a>フロントエンドプールの高可用性と管理
 
Skype for Business Server のフロントエンドプール管理について説明します。これには、プールの管理、クォーラムの損失、および2台のフロントエンドサーバーのみのプールの特別な手順が含まれます。
  
Skype for Business Server では、フロントエンドプールのアーキテクチャは分散システムモデルを使用しており、各ユーザーのデータはプール内の3台のフロントエンドサーバーに保存されます。 すべての Enterprise Edition フロントエンドプールに、少なくとも3台のフロントエンドサーバーが含まれるようにすることをお勧めします。

> [!NOTE]
> Skype for Business Server 2019 は、2台のフロントエンドサーバーを持つ Enterprise Edition フロントエンドプールをサポートしていません。このシナリオでは、トポロジを公開することはできません。
  
## <a name="planning-for-the-management-of-front-end-pools"></a>フロントエンドプールの管理の計画

 Skype for Business Server は、Windows Fabric に基づく分散システムモデルを使用します。 このモデルでは、各ユーザーおよび会議の重要なデータは、フロントエンドプール内の3つのフロントエンドサーバーに格納されます。 特定のデータセットを格納する3つのサーバーは、レプリカと呼びます。
  
フロントエンドプールの分散モデルでは、プールが機能するためには特定の数のプールのサーバーが実行されている必要があります。 プールには、2つの損失モードがあります。
  
- 特定のルーティンググループに十分な数のレプリカサーバーがないことによって発生した、ルーティンググループレベルのクォーラム損失。 ルーティンググループとは、プールに所属する一連のユーザーのことです。 各ルーティンググループのプールには、1つのプライマリレプリカと2つのセカンダリレプリカの3つのレプリカがあります。
    
- プールレベルのクォーラム損失。プール内で十分な数のシードサーバーが実行されていない場合に発生します。 
    
### <a name="routing-group-level-quorum-loss"></a>ルーティンググループレベルのクォーラム損失

新しいフロントエンドプールを初めて起動するときは、次の表に示すように、サーバーの85% が稼働していることが重要です。 実行されているサーバーの数が少ない場合、サービスが開始状態になり、プールが開始されない可能性があります。
  
|プール内のサーバーの合計数  <br/> |プールを初めて起動するために実行する必要があるサーバーの数  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3   <br/> |3   <br/> |
|4   <br/> |3   <br/> |
|5   <br/> |4   <br/> |
|6   <br/> |5   <br/> |
|7   <br/> |5   <br/> |
|8   <br/> |6   <br/> |
|9   <br/> |7   <br/> |
|10   <br/> |8   <br/> |
|11   <br/> |9   <br/> |
|12   <br/> |10   <br/> |
|Skype for business **Server 2019 の場合は**16 <br/> |12   <br/> |


   
今後プールが起動されるたびに、サーバーの85% が開始されます (前の表に示すように)。 この数のサーバーを開始できない場合 (ただし、プールレベルのクォーラム損失が発生しないように十分な数のサーバーを起動できる場合) は、コマンドレットを使用して、 `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` このルーティンググループレベルのクォーラム損失から回復し、進行状況を発生させるためにプールを有効にすることができます。 このコマンドレットの使用方法の詳細については、「 [reset-cspoolregistrarstate](https://docs.microsoft.com/powershell/module/skype/reset-cspoolregistrarstate?view=skype-ps)」を参照してください。 
  
> [!NOTE]
> サーバー数が偶数のプールでは、Skype for Business Server はプライマリ SQL データベースをミラーリング監視として使用します。 このようなプールでは、プライマリデータベースをシャットダウンし、ミラーコピーに切り替えて、前の表に従って十分な数が実行されないように十分な数のフロントエンドサーバーをシャットダウンすると、プール全体がダウンします。 詳細については、「[データベースミラーリング監視](https://go.microsoft.com/fwlink/?LinkId=393672)」を参照してください。 
  
#### <a name="pool-level-quorum-loss"></a>プールレベルのクォーラム損失

フロントエンドプールが完全に機能するために、プールレベルのクォーラム損失になることはありません。 次の表に示すように、実行しているサーバーの数が機能レベルを下回っている場合、プール内の残りのサーバーはすべての Skype for Business Server サービスを停止します。 次の表の番号は、プール内のバックエンドサーバーが動作していることを前提としています。
  
|プール内のフロントエンド サーバーの総数  <br/> |プールが機能するために実行されている必要のあるサーバーの数  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3-4  <br/> |任意の2  <br/> |
|5-6  <br/> |任意の3つ  <br/> |
|7   <br/> |任意4  <br/> |
|8-9  <br/> |最初の7台のサーバーのうち4台  <br/> |
|10-12  <br/> |最初の9台のサーバーのうち5台  <br/> |
|**Skype For Business Server 2019 の場合は**12-16  <br/> |最初の12台のサーバーのうち7台  <br/> |
   
上記の表では、最初にプールが開始されたときに、最初に開始されたサーバーが "最初のサーバー" です。 これらのサーバーを決定するには、 `Get-CsComputer` オプションでコマンドレットを使用でき `-PoolFqdn` ます。 このコマンドレットでは、トポロジに表示される順序でサーバーが表示され、一覧の一番上にあるサーバーが最初のサーバーになります。
  
> [!IMPORTANT]
> [Skype For Business Server 2019](https://docs.microsoft.com/skypeforbusiness/plan/user-model-2019)では、フロントエンドサーバーの最大数が16に増加しています。
> 
#### <a name="additional-steps-to-ensure-pools-are-functional"></a>プールが機能していることを確認するための追加の手順

フロントエンドプールが機能していることを確認するには、他にもいくつかの要因を監視する必要があります。
  
- ユーザーをプールに初めて移動するときは、少なくとも3台のフロントエンドサーバーが稼働していることを確認してください。
    
- このプールと障害復旧のために別のプールとの間にペアリング関係を確立している場合は、その関係を確立した後で、その関係を確立した後、データをバックアッププールと同期するために、同時に3台のフロントエンドサーバーがこのプールに存在することを確認する必要があります。 プールのペアリングと障害復旧機能の詳細については、「 [Plan for high availability and disaster recovery In Skype For Business Server](high-availability-and-disaster-recovery.md)」を参照してください。 
    
## <a name="front-end-pool-with-two-front-end-servers"></a>2台のフロントエンドサーバーを備えたフロントエンドプール

2台のフロントエンドサーバーのみが含まれるフロントエンドプールを展開することはお勧めしません。 この小規模プールでは、より大規模なプールのような高可用性ソリューションは提供されません。また、管理に特に注意が必要です。 さらに、2台のサーバープールのバックエンドサーバーがダウンした場合は、プール全体がすぐに停止する可能性もあります。 Skype for Business Server を実行している1台または2台のサーバーのみを展開する場合は、Standard Edition サーバーとして展開することをお勧めします。
  
2台のフロントエンドサーバーでプールを展開する必要がある場合は、次のガイドラインに従ってください。
  
- 2台のフロントエンドサーバーのうち1台がダウンした場合は、障害が発生したサーバーをできるだけ早く復旧するようにしてください。 同様に、2台のサーバーのいずれかをアップグレードする必要がある場合は、アップグレードが完了したらすぐにオンラインに戻します。
    
- 何らかの理由で両方のサーバーを同時に停止する必要がある場合は、プールのダウンタイムが終了したら、次の手順を実行します。
    
  - ベストプラクティスは、両方のフロントエンドサーバーを同時に再起動することです。 
    
  - 2台のサーバーを同時に再起動できない場合は、停止した順序とは逆の順序でバックアップする必要があります。
    
  - その順序で復元できない場合は、プールを復旧する前に、次のコマンドレットを使用します。`Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`
    
## <a name="front-end-pool-configuration-failures-and-changes"></a>フロントエンドプール構成のエラーと変更

フロントエンドサーバーに障害が発生した場合、数日間またはそれ以上の交換が必要になる可能性がある場合は、サーバーをトポロジから削除します。 再び使用できるようになったら、新しいフロントエンドサーバーをトポロジに追加します。
  
サーバーの追加や削除など、フロントエンドプールに構成の変更を行う場合は、次のガイドラインに従う必要があります。
  
- 新しいトポロジが公開されたら、プール内の各フロントエンドサーバーを再起動する必要があります。 一度に1つずつ再起動します。
    
- 構成の変更中にプール全体がダウンしていた場合は、新しいトポロジが公開された後、次のコマンドレットを実行します。`Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`
    

