---
title: 内部および外部のネットワークに対して従来の認証方法を無効にする計画
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.custom: tracyp
ms.assetid: ''
description: この記事では、ビジネスの内部および外部で使用される認証方法を管理者が制御できるコマンドレットについて説明します。 管理者は、内部または外部のネットワークに認証方法を有効または無効にすることができます。
ms.openlocfilehash: aaee46b04832cc114f895f905c180fe089d7349d
ms.sourcegitcommit: ab47ff88f51a96aaf8bc99a6303e114d41ca5c2f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/20/2019
ms.locfileid: "34297268"
---
# <a name="planning-to-turn-off-legacy-authentication-methods-internally-and-externally-to-your-network"></a><span data-ttu-id="07894-104">内部および外部のネットワークに対して従来の認証方法をオフにすることを計画しています。</span><span class="sxs-lookup"><span data-stu-id="07894-104">Planning to turn off Legacy authentication methods internally and externally to your network.</span></span>

> [!NOTE]
> <span data-ttu-id="07894-105">この記事をお読みになる場合は、サポートされている先進認証トポロジ、ADAL、先進認証構成について既に理解している必要があります。ただし、そうしない場合は、次の記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="07894-105">If you're about to read this article, you should already know about supported Modern Authentication topologies, ADAL, and about Modern Authentication config, but, in case you don't, here are the articles you need to start out:</span></span> 
>  + [https://docs.microsoft.com/skypeforbusiness/plan-your-deployment/modern-authentication/topologies-supported](https://docs.microsoft.com/skypeforbusiness/plan-your-deployment/modern-authentication/topologies-supported)
>  + [https://docs.microsoft.com/skypeforbusiness/manage/authentication/use-adal](https://docs.microsoft.com/skypeforbusiness/manage/authentication/use-adal)
  
<span data-ttu-id="07894-106">先進認証は、2要素認証や証明書ベース認証などのセキュリティ保護された認証方法を実現するだけでなく、ユーザー名やパスワードを必要とせずに、ユーザーの認証を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="07894-106">Modern Authentication doesn't just enable more secure methods of authentication, like Two-Factor Auth, or Certificate-based Auth, it can carry out authorization of your user without needing a username or password too.</span></span> <span data-ttu-id="07894-107">とても便利です。</span><span class="sxs-lookup"><span data-stu-id="07894-107">It's pretty handy.</span></span>

<span data-ttu-id="07894-108">この記事では、Skype for Business Server のサービス拒否 (DOS) 攻撃に悪用された可能性のあるものを、ネットワークに対して外部、内部、またはその両方の認証に使用しないようにすることを目的としています。</span><span class="sxs-lookup"><span data-stu-id="07894-108">This article will help you plug holes that have been exploited for Denial Of Service (DOS) attacks on Skype for Business Servers, by turning off older methods used for authentication, externally, internally, or both, to your network.</span></span> <span data-ttu-id="07894-109">たとえば、DOS 攻撃を止めるための適切な方法の1つとして、Windows 統合認証を無効にする方法があります (NTLM と Kerberos を含む)。</span><span class="sxs-lookup"><span data-stu-id="07894-109">For example, one good method to help stop DOS attacks would be to turn off Windows Integrated Authentication (which includes NTLM and Kerberos).</span></span> <span data-ttu-id="07894-110">NTLM をオフにして証明書ベースの認証を使用すると、パスワードが漏洩するのを防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="07894-110">Turning off NTLM externally and relying on certificate-based authentication helps to protect passwords from exposure.</span></span> <span data-ttu-id="07894-111">これは、NTLM はパスワード資格情報を使用してユーザーを認証するのに対し、証明書ベースの認証は先進認証によって有効になっているためです。</span><span class="sxs-lookup"><span data-stu-id="07894-111">This is because NTLM uses password credentials to authenticate users, but certificate-based authentication -- enabled by Modern Auth -- doesn't.</span></span> <span data-ttu-id="07894-112">つまり、DOS 攻撃を軽減するために最適なオプションの1つとして、NTLM をブロックし、代わりに証明書ベースの認証のみを使うことができます。</span><span class="sxs-lookup"><span data-stu-id="07894-112">That means one ideal option to reduce DOS attacks is to block NTLM externally, and use only certificate-based authentication there, instead.</span></span>

<span data-ttu-id="07894-113">さあ、始めましょう。</span><span class="sxs-lookup"><span data-stu-id="07894-113">All right, let's get started.</span></span>

## <a name="what-would-you-be-changing"></a><span data-ttu-id="07894-114">何を変更しますか?</span><span class="sxs-lookup"><span data-stu-id="07894-114">What would you be changing?</span></span> 

<span data-ttu-id="07894-115">これらのコマンドレットは、SIP と Web サービスの両方のアクセスポイントで機能します。</span><span class="sxs-lookup"><span data-stu-id="07894-115">These cmdlets work for both SIP and Web Services points of access.</span></span> <span data-ttu-id="07894-116">この2つのチャネルでは、さまざまなアクセス方法を使用していますが、NTLM と Kerberos から匿名アクセスに適用されているすべての標準的な方法が考慮されています。</span><span class="sxs-lookup"><span data-stu-id="07894-116">Though these two channels use different access methods, running the gamut from NTLM and Kerberos to Anonymous access, all standard methods used by Skype for Business have been taken into consideration.</span></span>

## <a name="how-to-get-the-get--and-set-csauthconfig-cmdlets"></a><span data-ttu-id="07894-117">Get と Set の設定コマンドレットを取得する方法</span><span class="sxs-lookup"><span data-stu-id="07894-117">How to get the Get- and Set-CsAuthConfig cmdlets</span></span>

<span data-ttu-id="07894-118">これらのコマンドレットは、Microsoft Skype for Business Server 2015 の2018年7月の累積更新プログラム (6.0.9319.534) の投稿のみにインストールされています。そのため、Skype for Business server 用に展開できるさまざまなトポロジが用意されています。</span><span class="sxs-lookup"><span data-stu-id="07894-118">These cmdlets will only be installed post July 2018 cumulative update (6.0.9319.534) for Microsoft Skype for Business Server 2015, and then you have a variety of topologies that can be rolled out for your Skype for Business server.</span></span>

## <a name="topologies"></a><span data-ttu-id="07894-119">トポロジー</span><span class="sxs-lookup"><span data-stu-id="07894-119">Topologies</span></span>

<span data-ttu-id="07894-120">このシナリオでは、これらはサポートされているトポロジであることに注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="07894-120">It's important to keep in mind that these are the Supported Topologies involved in this scenario!</span></span> <span data-ttu-id="07894-121">たとえば、メソッドをブロックするためのサポートについては、以下の型のいずれかを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="07894-121">If you need to go to Support for help with blocking a method, for example, you will need to have a configuration among the types below.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="07894-122">以下の表と説明では、*先進認証*は__MA__として省略されており、 *Windows 統合認証*は__Win__と略記されています。</span><span class="sxs-lookup"><span data-stu-id="07894-122">In the table and descriptions below, *Modern Authentication* is abbreviated as __MA__ and *Windows Integrated Authentication* is abbreviated as __Win__.</span></span> <span data-ttu-id="07894-123">Windows 統合認証は、NTLM と Kerberos 認証という2つの方法で構成されます。</span><span class="sxs-lookup"><span data-stu-id="07894-123">As a reminder, Windows Integrated Authentication is made up of two methods: NTLM and Kerberos authentication.</span></span> <span data-ttu-id="07894-124">表を正しく読むには、これを知っておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="07894-124">You'll need to know this to read the table properly!</span></span>


|       |<span data-ttu-id="07894-125">的</span><span class="sxs-lookup"><span data-stu-id="07894-125">Externally</span></span>  |<span data-ttu-id="07894-126">内部</span><span class="sxs-lookup"><span data-stu-id="07894-126">Internally</span></span>  |<span data-ttu-id="07894-127">パラメーター</span><span class="sxs-lookup"><span data-stu-id="07894-127">Parameter</span></span>  |
|---------|:---------|:---------|---------|
|<span data-ttu-id="07894-128">__「1」と入力__</span><span class="sxs-lookup"><span data-stu-id="07894-128">__Type 1__</span></span>   |  <span data-ttu-id="07894-129">MA + Win</span><span class="sxs-lookup"><span data-stu-id="07894-129">MA + Win</span></span>       | <span data-ttu-id="07894-130">MA + Win</span><span class="sxs-lookup"><span data-stu-id="07894-130">MA + Win</span></span>         |  <span data-ttu-id="07894-131">AllowAllExternallyAndInternally</span><span class="sxs-lookup"><span data-stu-id="07894-131">AllowAllExternallyAndInternally</span></span>       |
|<span data-ttu-id="07894-132">__「2」と入力__</span><span class="sxs-lookup"><span data-stu-id="07894-132">__Type 2__</span></span>   |  <span data-ttu-id="07894-133">100</span><span class="sxs-lookup"><span data-stu-id="07894-133">MA</span></span>       | <span data-ttu-id="07894-134">MA + Win</span><span class="sxs-lookup"><span data-stu-id="07894-134">MA + Win</span></span>         | <span data-ttu-id="07894-135">外部のブロック</span><span class="sxs-lookup"><span data-stu-id="07894-135">BlockWindowsAuthExternally</span></span>        |
|<span data-ttu-id="07894-136">__「3」と入力します。__</span><span class="sxs-lookup"><span data-stu-id="07894-136">__Type 3__</span></span>   |  <span data-ttu-id="07894-137">100</span><span class="sxs-lookup"><span data-stu-id="07894-137">MA</span></span>       | <span data-ttu-id="07894-138">100</span><span class="sxs-lookup"><span data-stu-id="07894-138">MA</span></span>        | <span data-ttu-id="07894-139">BlockWindowsAuthExternallyAndInternally</span><span class="sxs-lookup"><span data-stu-id="07894-139">BlockWindowsAuthExternallyAndInternally</span></span>        |
|<span data-ttu-id="07894-140">__「4」と入力__</span><span class="sxs-lookup"><span data-stu-id="07894-140">__Type 4__</span></span>   |  <span data-ttu-id="07894-141">100</span><span class="sxs-lookup"><span data-stu-id="07894-141">MA</span></span>       | <span data-ttu-id="07894-142">Win</span><span class="sxs-lookup"><span data-stu-id="07894-142">Win</span></span>        | <span data-ttu-id="07894-143">BlockWindowsAuthExternallyAndModernAuthInternally</span><span class="sxs-lookup"><span data-stu-id="07894-143">BlockWindowsAuthExternallyAndModernAuthInternally</span></span>    |
|<span data-ttu-id="07894-144">__「5」と入力__</span><span class="sxs-lookup"><span data-stu-id="07894-144">__Type 5__</span></span>   |  <span data-ttu-id="07894-145">MA + Win</span><span class="sxs-lookup"><span data-stu-id="07894-145">MA + Win</span></span>       | <span data-ttu-id="07894-146">Win</span><span class="sxs-lookup"><span data-stu-id="07894-146">Win</span></span>        | <span data-ttu-id="07894-147">BlockModernAuthInternally</span><span class="sxs-lookup"><span data-stu-id="07894-147">BlockModernAuthInternally</span></span>         |

<span data-ttu-id="07894-148">__1 の説明を入力します。__ これは、Skype for Business Server で MA ____ をオンにした場合の既定のシナリオです。</span><span class="sxs-lookup"><span data-stu-id="07894-148">__Type 1 Description:__ This is the default scenario when MA is turned __on__ for Skype for Business Server.</span></span> <span data-ttu-id="07894-149">つまり、MA が構成されている場合は、これが*出発点*となります。</span><span class="sxs-lookup"><span data-stu-id="07894-149">In other words, this is the *starting point* when MA is configured.</span></span>

<span data-ttu-id="07894-150">__「2」と入力します。__ このトポロジでは、NTLM が*外部*でブロックされますが、ntlm または KERBEROS (ADAL をサポートしていないクライアントの場合) は*内部*で動作することができます。</span><span class="sxs-lookup"><span data-stu-id="07894-150">__Type 2 Description:__ This topology blocks NTLM *externally*, but allows NTLM or Kerberos (for clients that don't support ADAL) to work *internally*.</span></span> <span data-ttu-id="07894-151">クライアントが ADAL をサポートしている場合は、内部で MA が使用されます。</span><span class="sxs-lookup"><span data-stu-id="07894-151">If your clients  do support ADAL they will use MA internally.</span></span>

<span data-ttu-id="07894-152">__「3の説明」と入力します。__ このトポロジには、すべてのユーザーに対して MA が必要です。</span><span class="sxs-lookup"><span data-stu-id="07894-152">__Type 3 Description:__ This topology requires MA for all users.</span></span> <span data-ttu-id="07894-153">すべての ADAL 対応クライアントはこのトポロジで動作します。たとえば、証明書ベースの Auth でパスワードの使用を無効にした場合、パスワードは利用できません。</span><span class="sxs-lookup"><span data-stu-id="07894-153">All your ADAL-capable clients will work in this topology, and passwords will not be leveraged if, for example, you turn off the use of passwords with Certificate-based Auth.</span></span>

<span data-ttu-id="07894-154">__「4」の説明を入力します。__ このトポロジは、NTLM を*外部*および MA に内部的にブロックします。</span><span class="sxs-lookup"><span data-stu-id="07894-154">__Type 4 Description:__ This topology blocks NTLM *externally* and MA internally.</span></span> <span data-ttu-id="07894-155">すべての*クライアント*で*内部的*に (ADAL 対応クライアントでも) 従来の認証方法を使用できるようにします。</span><span class="sxs-lookup"><span data-stu-id="07894-155">It allows *all clients* to use legacy authentication methods *internally* (even ADAL-capable clients).</span></span>

<span data-ttu-id="07894-156">__「5」の説明を入力します。__*外部*では、最新の adal クライアントは MA を使用し、adal をサポートしていないすべてのクライアントは従来の認証方法を使用します。</span><span class="sxs-lookup"><span data-stu-id="07894-156">__Type 5 Description:__ *Externally*, your modern ADAL clients will use MA and any clients that don't support ADAL will use legacy authentication methods.</span></span> <span data-ttu-id="07894-157">ただし、 \*\* *すべてのクライアント*は従来の認証 (すべての ADAL 対応クライアントを含む) を使用します。</span><span class="sxs-lookup"><span data-stu-id="07894-157">But, *internally* *all clients* will use legacy authentication (including all ADAL-capable clients).</span></span>

<span data-ttu-id="07894-158">使用可能なオプションでパスワードの保護の目標を把握するのは非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="07894-158">It's pretty easy to lose track of the goal of protecting your passwords in the options available.</span></span> <span data-ttu-id="07894-159">理想的な状況としては、(証明書ベースの認証を構成するなど) MA を外部で使用して、DOS 攻撃を回避することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="07894-159">Keep in mind the ideal situation is to use MA externally (for example, by configuring certificate-based auth), to avoid DOS attacks.</span></span> <span data-ttu-id="07894-160">最新のクライアントに対して内部で利用すると、Skype for Business Server の DOS 攻撃に関するネットワークの将来性を証明することになります。</span><span class="sxs-lookup"><span data-stu-id="07894-160">If you leverage it internally for your modern clients, you'll also future-proof your network regarding Skype for Business Server DOS attacks.</span></span>

## <a name="why-to-use-set-csauthconfig-at-the-global-level"></a><span data-ttu-id="07894-161">グローバルレベルで Set-CsAuthConfig を使用する理由</span><span class="sxs-lookup"><span data-stu-id="07894-161">Why to use Set-CsAuthConfig at the Global level</span></span>

<span data-ttu-id="07894-162">レジストラー `Set-CsAuthConfig`と Web サービスの役割の両方での、コマンドレットの効果の構成。</span><span class="sxs-lookup"><span data-stu-id="07894-162">The `Set-CsAuthConfig` cmdlet effects configuration on both the Registrar and the Web Services roles.</span></span>

<span data-ttu-id="07894-163">このコマンドレットは、Skype for Business server のグローバルレベルで実行することを目的としています。</span><span class="sxs-lookup"><span data-stu-id="07894-163">This cmdlet is meant to be run at the Global level of your Skype for Business server.</span></span> <span data-ttu-id="07894-164">プールレベルで実行する*ことはでき*ますが、インストールの複雑さが増すため、*お勧めできません*。</span><span class="sxs-lookup"><span data-stu-id="07894-164">It *can* be run at the Pool level but that is *not recommended* because it will add complexity to your installation.</span></span> <span data-ttu-id="07894-165">プールレベルでこれらのコマンドを実行することによって、プールにすべてのロールが含まれていない場合 (たとえば、Web サービスがない場合)、設定はレジストラーの役割に対してのみ設定されます。</span><span class="sxs-lookup"><span data-stu-id="07894-165">By running these commands at the Pool level, if your Pool doesn't have all of the roles included (for example, it doesn't have Web Services), the settings will only be set for the Registrar role.</span></span> <span data-ttu-id="07894-166">その場合、Web サービスはグローバルレベルの設定を使用して実行されます。これにより、混乱を招く可能性があります (特に、意図せずに実行された場合)。</span><span class="sxs-lookup"><span data-stu-id="07894-166">In that case, Web Services will carry on with settings from the Global level, which can be confusing behaviour (particularly when this is done unintentionally).</span></span>

<span data-ttu-id="07894-167">クライアントが1つのプールのレジストラー設定と別のプールの Web サービス設定を使用していて、認証設定が不整合な状態にある場合は、yous クライアントでログオンできないことがあります。</span><span class="sxs-lookup"><span data-stu-id="07894-167">If a client uses the Registrar settings from one pool and the Web Services settings from another pool and the authentication settings are in an inconsistent state, yous clients may be unable to log on.</span></span>

<span data-ttu-id="07894-168">また、プールに対して1つの役割しか存在しない場合は、次の操作も行います。</span><span class="sxs-lookup"><span data-stu-id="07894-168">Also, if there's only one role present for a pool:</span></span> 
* <span data-ttu-id="07894-169">Set-存在するロールに対応する設定のみを設定します。</span><span class="sxs-lookup"><span data-stu-id="07894-169">Set- will only set the settings that correspond to the role that exists.</span></span> <span data-ttu-id="07894-170">一部の設定が設定*されてい*ないため、特別な警告は表示されません。</span><span class="sxs-lookup"><span data-stu-id="07894-170">No special warning will be given because some settings were *not* set.</span></span> 
* <span data-ttu-id="07894-171">Get-存在するロールに対応する設定と、存在しないロールのグローバル設定が返されます。</span><span class="sxs-lookup"><span data-stu-id="07894-171">Get- will return the setting that corresponds to the role that exists, and the Global settings for the role that doesn't exist.</span></span>
* <span data-ttu-id="07894-172">プールのどちらのロールも存在しない場合、Set と Get の両方が、エラーメッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="07894-172">If neither role is present for a pool, both Set- and Get- will return an error message.</span></span>
* <span data-ttu-id="07894-173">プールの両方の役割が存在するが、ポリシーがプールレベルで定義されていない場合は、Get-エラーメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="07894-173">If both roles are present for a pool but policies aren't defined at the pool level, Get- will return an error message.</span></span>

<span data-ttu-id="07894-174">これらの値に対して wisest を実行し、変更を行う前に、スクリーンショットを表示したり、開始状態を記録したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="07894-174">It may be wisest to do a Get- for these values, and to screenshot or record their starting state before making any changes.</span></span> <span data-ttu-id="07894-175">また、変更履歴を OneNote に保存することも検討してください。</span><span class="sxs-lookup"><span data-stu-id="07894-175">You might also consider keeping a log of changes in a OneNote.</span></span>

> [!NOTE]
> 
> <span data-ttu-id="07894-176">注: CsAuthConfig を構成した後、設定を有効にするには、各コンピューターで [CsComputer を有効にする] を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="07894-176">Note: After configuring the CsAuthConfig, you must run Enable-CsComputer on each computer in order for the settings to take effect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="07894-177">Lync Web Access (LWA) を使用していて、外部アクセスにフォームベースのアクセス (FBA) を使用する必要がある場合は、これらのシナリオをサポートするために、クライアントが匿名アクセスでアクセスできるように LWA を再構成してください。</span><span class="sxs-lookup"><span data-stu-id="07894-177">If you're using Lync Web Access (LWA) and must use Forms-based Access (FBA) for external access, reconfigure LWA so that clients can access it with Anonymous Access to support these scenarios.</span></span> <span data-ttu-id="07894-178">同様に、ダイヤルイン Pin を使用している場合、FBA は外部ユーザーに対してのみブロックされます。</span><span class="sxs-lookup"><span data-stu-id="07894-178">Likewise, if you use Dial-in Pin, FBA will be blocked for external users only.</span></span> <span data-ttu-id="07894-179">Pin を変更する必要がある場合は、社内にログインしてください。</span><span class="sxs-lookup"><span data-stu-id="07894-179">If they need to change their pin, they will need to login to their corporation to do so, internally.</span></span>

## <a name="links"></a><span data-ttu-id="07894-180">リンク</span><span class="sxs-lookup"><span data-stu-id="07894-180">Links</span></span> 
- <span data-ttu-id="07894-181">PowerShell に関するその他の情報:</span><span class="sxs-lookup"><span data-stu-id="07894-181">For more PowerShell information:</span></span>
    -  [<span data-ttu-id="07894-182">CsAuthConfig</span><span class="sxs-lookup"><span data-stu-id="07894-182">Get-CsAuthConfig</span></span>](https://docs.microsoft.com/powershell/module/skype/get-csauthconfig?view=skype-ps)
    -  [<span data-ttu-id="07894-183">Set-CsAuthConfig</span><span class="sxs-lookup"><span data-stu-id="07894-183">Set-CsAuthConfig</span></span>](https://docs.microsoft.com/en-us/powershell/module/skype/set-csauthconfig?view=skype-ps)

- <span data-ttu-id="07894-184">コマンドの使用方法や、インストールに必要な CU の詳細については、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="07894-184">For more direction on how to use the commands or on the CU needed to install them:</span></span>
    - [<span data-ttu-id="07894-185">コマンドレットのブリーフィング</span><span class="sxs-lookup"><span data-stu-id="07894-185">Cmdlets briefing</span></span>](https://support.microsoft.com/en-us/help/4346673/new-cmdlets-to-manage-skype-for-business-server-2015-authentication)
    - <span data-ttu-id="07894-186">[Skype For Business Server 2015 の更新プログラム](https://support.microsoft.com/en-us/help/3061064/updates-for-skype-for-business-server-2015)汎用的</span><span class="sxs-lookup"><span data-stu-id="07894-186">[Updates for Skype for Business Server 2015](https://support.microsoft.com/en-us/help/3061064/updates-for-skype-for-business-server-2015) (General)</span></span>
    - <span data-ttu-id="07894-187">[2018 年7月の Skype For Business Server 2015、コアコンポーネント CU](https://support.microsoft.com/en-us/help/4340903/july-2018-cumulative-update-6-0-9319-534-for-skype-for-business-server) (6.0.9319.534)</span><span class="sxs-lookup"><span data-stu-id="07894-187">The [July 2018 Skype for Business Server 2015, Core Components CU](https://support.microsoft.com/en-us/help/4340903/july-2018-cumulative-update-6-0-9319-534-for-skype-for-business-server) (6.0.9319.534)</span></span>


 
