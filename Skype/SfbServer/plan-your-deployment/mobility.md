---
title: Skype for Business Server のモバイル機能の計画
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
ms.date: 2/17/2018
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 7117eff5-6860-4673-b366-afe0756c4bb2
description: Skype for Business Server のモバイル機能の実装を計画します。
ms.openlocfilehash: 8b0ba8dd4ae07d3330a8ca722a1101c6b41a7cec
ms.sourcegitcommit: ab47ff88f51a96aaf8bc99a6303e114d41ca5c2f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/20/2019
ms.locfileid: "34297324"
---
# <a name="plan-for-mobility-for-skype-for-business-server"></a>Skype for Business Server のモバイル機能の計画
 
Skype for Business Server のモバイル機能の実装を計画します。
  
Skype for Business Server を使用すると、モバイルデバイスで Skype for Business Server 機能を提供するためのモバイル機能を展開できます。 この記事では、モバイル機能の詳細について説明し、展開を計画するのに役立ちます。
  
Skype for Business Server のモビリティ機能は、Skype for Business のモバイルクライアントや2010に戻す Lync クライアントをサポートできます。 展開後、ユーザーはサポートされている iOS、Android、Windows Phone のモバイルデバイスを使用して、Skype for Business Server の展開に接続し、エンタープライズ Voip 機能など、さまざまな機能を利用することができます。 詳細については、以下の一覧の部分を参照してください。また、 [Skype For business のデスクトップクライアントの機能比較](clients-and-devices/desktop-feature-comparison.md)を確認することもできます。
  
- メッセージの送受信
    
- プレゼンスの表示
    
- 連絡先の表示
    
- クリックして会議に参加
    
- 勤務先から通話
    
- 同一番号接続
    
- ボイス メール
    
- 不在着信通知
    
- ボイス オーバー IP (VoIP)
    
- 出席者のビデオ (H.264)
    
- 会議コンテンツの表示 (PowerPoint とデスクトップ/アプリケーション共有)
    
このすべては統合コミュニケーション Web API または UCWA を介して達成されます。 UCWA は Lync Server 2013 で初めて導入されましたが、Skype for Business Server では引き続き使用されています。 Lync 2010 クライアントと通信するための機能が追加されています。モビリティサービス (MCX) にも対応しています。 Lync Server 2010 および2013クライアント、および Skype for Business クライアントで、Skype for Business Server の展開に正常にアクセスできる無料サービスです。
  
> [!NOTE]
> Skype for Business Server 2019 では、従来のモバイルクライアントに対する MCX (モバイルサービス) のサポートは利用できなくなりました。 現在のすべての Skype for Business のモバイルクライアントでは、インスタントメッセージング (IM)、プレゼンス、連絡先をサポートするために、既にユニファイドコミュニケーション Web API (UCWA) を使用しています。 MCX を使用するレガシクライアントを使っているユーザーは、現在のクライアントにアップグレードする必要があります。
  
ただし、これらの機能はすべて、機動性が実装された時点で利用可能ですが、一部のデバイスでは動作が少し異なる場合があります。 [Skype For business のモバイルクライアント機能の比較](clients-and-devices/mobile-feature-comparison.md)では、どの機能がどのデバイスで動作するかについて説明する web サイトが用意されています。 また、[クライアントとデバイスに](clients-and-devices/clients-and-devices.md)ついては、デバイスと OS に関する優れた情報が計画に含まれています。
  
モバイル機能は自動検出機能を利用しているため、クライアントは任意の Url に入力する必要がなくても、ユーザーは自動的に Skype for Business Server web サービスを見つけることができます (これを知っている必要はありません)。 トラブルシューティングを行う必要がある場合でも、Url の手動入力はサポートされます。
  
Skype for Business アプリがバックグラウンドで実行されていない場合や、バックグラウンドで実行されているアプリケーションをサポートしていないモバイルデバイスの場合は、プッシュ通知もサポートされます。 デバイスまたはアプリが非アクティブになっているときに発生するイベントについて、プッシュ通知がモバイルデバイスに送信されます。 電話がアクティブでない場合に、IM メッセージが表示されないことがあります。その結果、プッシュ通知が送信されます (アプリがバックグラウンドで実行されているときなど、トーストまたは通知として表示されます)。 プッシュ通知を使用すると、ユーザーは IM や音声通話を逃すことはありません。
  
詳しくは、以下のセクションを参照してください。
  
- [モビリティ コンポーネント](mobility.md#MobilityComponents)
    
- [サポートされるトポロジ](mobility.md#SupportedTopos)
    
- [技術要件](mobility.md#TechRequirements)
    
- [モビリティのニーズの定義](mobility.md#MobilityNeeds)
    
## <a name="mobility-components"></a>モビリティ コンポーネント
<a name="MobilityComponents"> </a>

Skype for Business Server のモバイル機能を構成する4つのサービスがあります。
  
- **Unified Communications Web API (UCWA)**
    
    Skype for Business Server のモバイルおよび web クライアントとのリアルタイム通信のサービスを提供します。 Skype for Business Server が展開されると、内部と外部の web サービスで、UCWA 仮想ディレクトリが作成されます。 この仮想ディレクトリの仮想コンポーネントは、UCWA が有効になっているクライアントからの着信に応答します。 クライアント アプリは REST (Representational State Transfer) インターフェイスを介して以下の通信を行います。
    
  - プレゼンス
    
  - 連絡先
    
  - インスタント メッセージング (IM)
    
  - VoIP
    
  - ビデオ会議
    
  - コラボレーション
    
    UCWA では、P-GET ベースのチャネルを使用して、着信通話、着信 IM、メッセージなどのイベントをクライアント アプリに送信します。
    
- **Mobility Service (MCX)**
    
    モバイルデバイスでは、IM、プレゼンス、連絡先などの Skype for Business Server 機能をサポートしています。 モバイルデバイスで Skype for Business Server 機能をサポートすることを目的とした各プールの各フロントエンドサーバーには、モビリティーサービスがインストールされています。 Skype for Business Server 2015 をインストールすると、フロントエンドサーバー上の内部と外部の両方の web サイトの下に新しい仮想ディレクトリ (Mcx) が作成されます。
    
    > [!NOTE]
    > Skype for Business Server 2019 では、従来のモバイルクライアントに対する MCX (モバイルサービス) のサポートは利用できなくなりました。 現在のすべての Skype for Business のモバイルクライアントでは、インスタントメッセージング (IM)、プレゼンス、連絡先をサポートするために、既にユニファイドコミュニケーション Web API (UCWA) を使用しています。 MCX を使用するレガシクライアントを使っているユーザーは、現在のクライアントにアップグレードする必要があります。
  
- **自動検出サービス**
    
    ユーザーの場所を特定し、ネットワークの場所に関係なく、モバイルデバイスやその他の Skype for Business クライアントがリソース (Skype for Business Server Web サービスの内部および外部 URL、Mcx URL、または UCWA URL) を見つけることができるようにします。 自動検出では、ハードコーディングされたホスト名 (ネットワーク内のユーザーの lyncdiscoverinternal、ネットワーク外のユーザーのための lyncdiscover)、ユーザーの SIP ドメインを使用します。 HTTP または HTTPS を使用しているクライアント接続をサポートします。 
    
    自動検出サービスは、各フロントエンドサーバーにインストールされ、モバイルデバイスで Skype for Business Server 機能をサポートすることを目的とした各プールのすべてのディレクターにインストールされます。 サービスをインストールすると、フロントエンドサーバーとディレクターの内部と外部の両方の web サイトの下に新しい仮想ディレクトリ (自動検出) が作成されます。
    
- **プッシュ通知サービス**
    
    Skype for Business Online データセンターにあるクラウドベースのサービスです。 Skype for Business クライアントがバックグラウンドで実行されていない電話では、新しいイベントが発生すると、不在イベント (プッシュ通知と呼ばれます) の通知がモバイルデバイスに送信されます。 モビリティサービスは、通知をプッシュ通知サービス (MPNS) に送信します。これにより、モバイルデバイスに通知が送信されます。 その後、ユーザーはモバイル デバイス上で通知に応答し、アプリをアクティブにすることができます。 この機能を使用するには、エッジサーバーが必要です。
    
## <a name="supported-topologies"></a>サポートされるトポロジ
<a name="SupportedTopos"> </a>

お客様のトポロジ計画用に、次の Skype for Business Server アプリケーションがサポートされています。
  
- モバイル標準エディション
    
- Mobility Enterprise Edition
    
この機能は、Skype for Business Server Edge サーバーまたは Lync Server 2013 Edge サーバーで使用できます。
  
モバイルサービスは、2つのネットワークインターフェイスで仲介サーバーの役割を使用している場合に、フロントエンドサーバーでサポートされますが、これらのインターフェイスを構成するために適切な手順を実行する必要があります。 仲介サーバーとして通信する特定のインターフェイスに IP アドレスを割り当てる必要があります。また、フロントエンドサーバーとして通信するネットワーク IP インターフェイスもあります。 この操作は、トポロジビルダーで、[**構成されているすべての ip アドレスを使用**する] の選択の代わりに、各サービスの正しい ip アドレスを選択して行うことができます。
  
## <a name="technical-requirements"></a>技術要件
<a name="TechRequirements"> </a>

モバイル ユーザーが直面する可能性のあるさまざまなモバイル アプリケーション シナリオを考慮して計画することは重要です。 たとえば、業務外で 3G ネットワーク経由で接続してモバイル アプリを使い始め、職場に到着すると会社の Wi-Fi ネットワークに切り替えるユーザーがいるとします。 建物を離れるときは4G に切り替えることができます。 計画によって、これらのネットワークの移行をサポートし、一貫したユーザー エクスペリエンスを保証できるようになります。
  
### <a name="dns-configuration"></a>DNS 構成

モバイルサービスの Mcx と UCWA では、同じ方法で DNS を使用します。 自動検出では、モバイルデバイスは DNS を使ってリソースを探します。 DNS 参照中に、内部 DNS レコードに関連付けられている FQDN への接続が試行されました (lyncdiscoverinternal内部ドメイン名])。 内部 DNS レコードを使用してその接続を確立できない場合、2つ目の接続が試みられます。この時点では、外部 DNS レコード (lyncdiscoversipdomain]). それでは、2つあります。 ネットワーク内部のモバイルデバイスは、内部の自動検出 URL を使うことができます。 外部のモバイルデバイスでは、外部の自動検出 URL が使用されます。 どちらの場合も、自動検出サービスは、モビリティサービス (Mcx および UCWA) を含む、ユーザーのホームプールのすべての Web サービス Url を返します。
  
外部の自動検出要求は、Skype for Business Server 用に構成したリバースプロキシを通過することを前提としています。 ただし、内部のモビリティーサービス URL と外部モビリティーサービスの URL の両方が、外部 Web サービスの FQDN と関連付けられています。 したがって、モバイルデバイスがネットワークの内部と外部のどちらであるかに関係なく、デバイスは常に、リバースプロキシを介して Skype for Business Server Mobility service に接続します。
  
> [!NOTE]
> このように、すべてのモバイルサービストラフィック (内部および外部) は、リバースプロキシを経由します。 ただし、内部トラフィックがインターフェイスを出るときに、出て行ったのと同じインターフェイスに戻ってきた場合に限り、問題が発生することがあります。 これは、スプーフィング セキュリティ ルール (以前は TCP パケット スプーフィングと呼ばれていました) に違反する場合があります。 **髪のピン留め**を有効にするには、モビリティー機能を有効にする必要があります。
  
> [!NOTE]
> この操作を行う準備ができたら、ファイアウォールとは別のリバースプロキシの使用を選択することもできます (セキュリティのため、スプーフィング防止は常にファイアウォールに適用する必要があります)。 これにより、転送は、ファイアウォールの外部インターフェイスではなく、リバースプロキシの外部インターフェイスで発生する可能性があります。 これにより、リバースプロキシでルールを緩和しながら、ファイアウォールで適切にスプーフィングを検出し、モバイル機能を利用できるようになります。 
  
> [!NOTE]
> このルートに移動する場合は、可能であれば、DNS host または CNAME レコードを使用して、転送の動作 (ファイアウォールではなく) のリバースプロキシを定義してください。 
  
企業ネットワークの内外のユーザーをサポートするには、いくつかの構成を行う必要があります。
  
以下は、内部および外部 Web FQDN のルールです。
  
- 新しい CNAME、または A (ホスト、IPv6 の場合は AAAA) DNS レコード - 自動検出用。
    
- 新しいファイアウォール ルール - Wi-Fi ネットワーク経由でプッシュ通知をサポートする場合。
    
- 自動検出のために、内部サーバー証明書と逆プロキシ証明書のサブジェクト別の名前。
    
- フロントエンドサーバーハードウェア負荷分散の構成によってソースの類似性が変更されます。
    
モビリティサービスと自動検出サービスをサポートするために必要なトポロジの要件を次に示します。
  
- フロントエンドプールの内部 web FQDN は、フロントエンドプールの外部 web FQDN とは別のものにする必要があります。
    
- 内部 Web FQDN は、企業ネットワーク内にのみ解決し、社内ネットワークの内側からのみアクセスできる必要があります。
    
- 外部 Web FQDN は、インターネットにのみ解決し、インターネットからのみアクセスできる必要があります。
    
- 企業ネットワーク内のユーザーの場合は、モビリティサービスの URL が外部 web FQDN に対応している必要があります。 この要件は、モバイルサービス用で、この URL にのみ適用されます。
    
- 企業ネットワークの外部にいるユーザーの場合、要求はフロントエンドプールまたはディレクターの外部 web FQDN にアクセスする必要があります。
    
自動検出をサポートする場合、SIP ドメインごとに以下の DNS レコードを作成する必要があります。
  
- 組織のネットワーク内から接続するモバイル ユーザーをサポートするための内部 DNS レコード。
    
- インターネットから接続するモバイル ユーザーをサポートするための外部 (パブリック) DNS レコード。
    
内部の自動検出 URL に内部ネットワークの外側からアドレス指定できないようにする必要があります。外部の自動検出 URL にネットワーク内からアドレス指定できないようにする必要があります。ただし、外部 URL でこれが不可能な場合でも、モバイル クライアントは機能的に影響を受けません。内部 URL が常に最初に試みられるためです。
  
### <a name="port-and-firewall-requirements"></a>ポートとファイアウォールの要件

これについては、その他のドキュメントでも説明してきましたが、特にモビリティについては、Survivable Branch Appliance (SBA) を使用しているユーザーがいる場合は、次のポートをエンタープライズ Wi-fi ネットワークで開いておく必要があります。
  
- UcwaSipExternalListeningPort にはポート 5088 が必要です。
    
- UcwaSipPrimaryListeningPort にはポート 5089 が必要です。
    
### <a name="certificate-requirements"></a>証明書の要件

Skype for Business モバイルクライアントの自動検出を使用している場合は、モバイルクライアントからのセキュリティで保護された接続をサポートするために、証明書の SAN (サブジェクト別の名前) の一覧を変更する必要があります。 すでに証明書を配置している場合は、ここで説明されている SAN エントリを持つ新しい証明書を要求して割り当てる必要があります。 これは、自動検出サービスを実行するフロントエンドサーバーとディレクター (環境内の場合) ごとに行う必要があります。 また、リバースプロキシ証明書で SAN リストを変更して、組織内のすべての SIP ドメインに対する SAN エントリを追加することをお勧めします。
  
これは、内部 CA (証明機関) で新しい証明書を要求していて、公開証明書がより複雑であり、要求に対してより高い料金がかかる可能性がある場合に、このプロセスは非常に簡単です。ドメインを新しいパブリック証明書に追加します。この場合、サポートされている方法はありますが、**お勧めできません**。 プロキシを構成して、ポート 443 (ポートではなく HTTP を使用します。これは HTTPS で、443は既定の構成です) という最初の自動検出サービス80要求を行うことができます。 この着信要求は、フロントエンドプールまたはディレクターのポート8080にリダイレクトされます。 これにより、このトラフィックが要求に HTTPS を使用していないため、証明書の変更を行う必要がなくなります。 ただし、この方法はお勧めしませんが、ご利用いただけます。
  
### <a name="windows-and-iis-requirements"></a>Windows と IIS の要件

Skype for Business Server 環境でサポートされている Windows Server バージョンが必要です。 結果として、モビリティのニーズに合わせて IIS 8 か IIS 8.5 も必要です。 既定の ASP.NET 設定にはいくつかの変更が必要ですが、モバイルサービスのインストーラーで自動的に実行されます。
  
### <a name="hlb-requirements"></a>HLB の要件

Skype for Business Server で、フロントエンドプールに HLB を含むトポロジ (複数のフロントエンドサーバーを含むトポロジ) を使用している場合は、Web サービストラフィック用の外部 Web サービス仮想 Ip (Vip) を構成する必要があります。ソースの場合。 ソース アフィニティは、1 つのクライアントからの複数の接続が同じサーバーに送信されてセッション状態を維持するのに役立ちます。
  
社内の Wi-fi ネットワーク経由でのみ Skype for Business モバイルクライアントをサポートする予定の場合、外部 Web サービス Vip の説明に従って、ソース用の内部 Web サービスの Vip を構成する必要があります。 この状況では、HLB の内部 Web サービス Vip に対して source_addr (または TCP) アフィニティを使用する必要があります。
  
このすべての詳細については、「[Load balancing requirements for Skype for Business](network-requirements/load-balancing.md)」のドキュメントを参照してください。
  
### <a name="reverse-proxy-requirements"></a>リバース プロキシの要件

Skype for Business mobile クライアントの自動検出をサポートするには、次のように現在の公開ルールを更新する必要があります。
  
- リバースプロキシ証明書で SAN リストを更新する場合、最初の自動検出サービス要求に HTTPS を使用している場合は、lyncdiscover の web 公開ルールを更新する必要があります。\<sipdomain\>。 通常、この機能は、フロントエンドプールの外部 Web サービスの URL に対する公開用の公開されたものと組み合わされています。
    
- 最初の自動検出サービス要求に対して HTTP を使用して、リバースプロキシ証明書の SAN リストを更新しないようにする場合 (推奨しません)、ポート HTTP/TCP 80 に新しい web 公開ルールを作成する必要があります (存在しない場合)。もう。 このルールが存在する場合は、それを更新して lyncdiscover を含めます。\<sipdomain\>エントリ。
    
## <a name="defining-your-mobility-needs"></a>モビリティのニーズの定義
<a name="MobilityNeeds"> </a>

トポロジ、コンポーネント、技術要件を確認しましたが、ここでは、お客様の組織がモビリティの実装に関して必要となる可能性のあることについて見ていきましょう。
  
### <a name="do-you-want-to-use-automatic-discovery-for-skype-for-business-mobile-clients"></a>Skype for Business モバイル クライアントで、自動検出を使用しますか?

自動検出を使用することを強くお勧めします。 それには、上記の「技術要件」のセクションで説明したように、内部および外部の新しい DNS レコードを作成する必要があります。 自動検出によって、Skype for business クライアントは、手動で入力する URL を使わなくても、どこからでも Skype for Business Server Web サービスを自動的に見つけることができます。
  
必要な場合は手動設定を使用できます。 以下の URL は、ユーザーがモバイル デバイスに入力する必要があります。
  
- 外部アクセス用の**Https://\<extpoolfqdn\>/Autodiscover/autodiscoverservice.svc/Root** 。
    
- 内部アクセス用の**Https://\<intpoolfqdn\>/Autodiscover/autodiscoverservice.svc/Root** 。
    
繰り返しますが、自動検出を使用することをお勧めします。トラブルシューティング目的の場合は手動設定が役立つ場合があります。
  
### <a name="are-you-going-to-support-push-notifications"></a>プッシュ通知をサポートしますか?

プッシュ通知は、この機能をサポートするモバイル アプリケーションで、アプリがアクティブでないときにユーザーにイベントを通知するために使用されます。 エッジサーバーには、クラウドベースの Skype for business Server プッシュ通知サービスとのフェデレーション関係が必要です。これは、Skype for Business Online データセンターにあります。 プッシュ通知を有効にするには、コマンドレットを実行する必要があります。
  
> [!NOTE]
> まだ Lync Server 2010 クライアントを使っているユーザーがいる場合は、エンタープライズ WiFi ネットワーク上で TCP ポート5223が開かれている必要があります。 
  
### <a name="do-you-want-all-your-users-accessing-all-mobility-features-or-do-you-want-to-specify-the-users-who-can-access-these-features-instead"></a>すべてのユーザーがすべてのモバイル機能にアクセスする必要がありますか。または、これらの機能にアクセスできるユーザーを指定しますか?

すべてのユーザーが使用できる機能の一部、および既定で設定されているかどうかについて説明する表を参照してください。 すべての機能のリストについては、「[New-CsMobilityPolicy](https://docs.microsoft.com/powershell/module/skype/new-csmobilitypolicy?view=skype-ps)」を参照してください。
  
> [!NOTE]
> これらすべての機能の適用範囲は、グローバル/サイト/ユーザーです。 
  
|**機能**|**パラメーター名**|**説明**|**既定の設定**|
|:-----|:-----|:-----|:-----|
|モビリティを有効にする  <br/> |EnableMobility  <br/> |Skype for Business mobile クライアントがインストールされている特定のスコープ内のユーザーを制御します。 ポリシーを False に設定すると、ユーザーはクライアントでサインインできません。  <br/> |True  <br/> |
|外部音声  <br/> |EnableOutsideVoice  <br/> |ユーザーが [勤務先から通話] を使用する機能を有効にします。これによりユーザーは、携帯電話番号ではなく勤務先の電話番号を使用して、通話を発信および受信できます。False に設定すると、勤務先の電話番号を使用して、自分の携帯電話で通話を発信および受信することはできません。  <br/> |True  <br/> |
|IP オーディオと IP ビデオを有効にする  <br/> |EnableIPAudioVideo  <br/> |既定に設定すると、ユーザーは、VoIP を使用してモバイル デバイスで電話またはビデオ通話を発信または受信することができます。False に設定すると、ユーザーはモバイル デバイスを使用してこれらのいずれを行うこともできません。  <br/> |True  <br/> |
|IP オーディオ用の WiFi が必要  <br/> |RequireWiFiForIPAudio  <br/> |クライアントが、携帯電話会社の回線ではなく WiFi の VoIP を使用して通話を発信または受信する必要があるかどうかを定義します。True に設定すると、WiFi ネットワークに接続されている場合に限り、ユーザーは VoIP 通話を発信および受信することができます。  <br/> |False  <br/> |
|IP ビデオ用の WiFi が必要  <br/> |RequireWiFiForIPVideo  <br/> |クライアントが、携帯電話会社の回線ではなく WiFi を使用してビデオ通話を発信または受信する必要があるかどうかを定義します。True に設定すると、WiFi ネットワークに接続されている場合に限り、ユーザーは VoIP 通話を発信および受信することができます。  <br/> |False  <br/> |
   
### <a name="should-users-who-arent-enabled-for-enterprise-voice-be-able-to-use-click-to-join-to-join-conferences"></a>エンタープライズ VoIP が有効になっていないユーザーは、クリックして参加を使用して電話会議に参加できますか?

ユーザーがモバイル機能にアクセスし、勤務先から通話を発信できるようにするには、エンタープライズ Voip を有効にする必要があります。 ただし、有効になっていない場合でも、モバイル デバイス上でリンクをクリックすることで電話会議に参加することはできますが、これはユーザーに適切な音声ポリシーが割り当てられている場合に限ります。 次のいずれかを行うことができます。
  
- 特定の音声ポリシーをこれらのユーザーに割り当てます。または、
    
- グローバル ポリシーかサイトレベルのポリシーが存在し、ユーザーに適用されていることを確認します。
    
いずれの場合も、割り当てた音声ポリシーには、公衆交換電話網 (PSTN) 使用法レコードとユーザーが電話会議に参加するためにダイヤルできる場所を定義するルートが必要です。
  
> [!NOTE]
> クリックして参加したいモバイルユーザーは、モバイルデバイスでそのリンクをクリックすると、Skype for Business Server からの発信通話が実行されるため、音声ポリシーと関連する PSTN 使用状況レコードと音声ルートが必要になります。 
  

