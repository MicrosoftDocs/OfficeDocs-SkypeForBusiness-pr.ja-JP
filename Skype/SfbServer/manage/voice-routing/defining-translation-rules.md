---
title: Skype for Business Server で変換ルールを定義する
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
description: Skype for Business Server Enterprise Voice は、e.164 形式に正規化された電話番号に基づいて通話をルーティングします。 つまり、逆引き番号検索 (RNL) を実行して、一致する SIP URI に変換できるようにするには、すべてのダイヤル文字列を e.164 形式に正規化する必要があります。 Skype for Business Server には、呼び出し元 ID と発信者番号のプレゼンテーションを操作する機能が用意されています。
ms.openlocfilehash: 49598c2ef6b1a145c206bece3e06068067b0a0e0
ms.sourcegitcommit: 33db8c7febd4cf1591e8dcbbdfd6fc8e8925896e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/19/2020
ms.locfileid: "42151207"
---
# <a name="defining-translation-rules-in-skype-for-business-server"></a><span data-ttu-id="2f930-105">Skype for Business Server で変換ルールを定義する</span><span class="sxs-lookup"><span data-stu-id="2f930-105">Defining translation rules in Skype for Business Server</span></span>

<span data-ttu-id="2f930-106">Skype for Business Server Enterprise Voice は、e.164 形式に正規化された電話番号に基づいて通話をルーティングします。</span><span class="sxs-lookup"><span data-stu-id="2f930-106">Skype for Business Server Enterprise Voice routes calls based on phone numbers normalized to E.164 format.</span></span> <span data-ttu-id="2f930-107">つまり、逆引き番号検索 (RNL) を実行して、一致する SIP URI に変換できるようにするには、すべてのダイヤル文字列を e.164 形式に正規化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f930-107">This means that all dialed strings must be normalized to E.164 format for the purpose of performing reverse number lookup (RNL) so they can be translated to their matching SIP URI.</span></span> <span data-ttu-id="2f930-108">Skype for Business Server には、呼び出し元 ID と発信者番号のプレゼンテーションを操作する機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="2f930-108">Skype for Business Server provides the ability to manipulate the called ID and the caller ID presentation.</span></span>

<span data-ttu-id="2f930-109">Skype for Business Server では、発信者の電話番号 (と呼ばれる電話番号) は、トランクピアで必要なローカルのダイヤル形式 (関連付けられたゲートウェイ、構内交換機 (PBX)、または SIP) に変換されます。トランク)。</span><span class="sxs-lookup"><span data-stu-id="2f930-109">With Skype for Business Server, the called party’s phone number (that is, the phone number called) can be translated from E.164 format to the local dialing format that is required by the trunk peer (that is, the associated gateway, private branch exchange (PBX), or SIP trunk).</span></span> <span data-ttu-id="2f930-110">これを行うためには、トランク ピアへのルーティングの前に要求 URI を変換する変換ルールを 1 つ以上定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f930-110">To do this, you must define one or more translation rules to translate the Request URI before routing it to the trunk peer.</span></span>

## <a name="caller-id-presentation"></a><span data-ttu-id="2f930-111">発信者番号のプレゼンテーション</span><span class="sxs-lookup"><span data-stu-id="2f930-111">Caller ID presentation</span></span>

<span data-ttu-id="2f930-112">Skype for Business Server では、発信者の電話番号 (発信者の発信元の電話番号) を e.164 形式から、トランクピアに必要なローカルのダイヤル形式に変換するオプションも提供されています。</span><span class="sxs-lookup"><span data-stu-id="2f930-112">Skype for Business Server offers the option to also translate the calling party’s phone number (that is, the phone number that the caller is calling from) from E.164 format to the local dialing format that is required by the trunk peer.</span></span> <span data-ttu-id="2f930-113">たとえば、ダイヤル文字列の冒頭から +44 を取り除いて 0114 に置き換える変換ルールを記述できます。</span><span class="sxs-lookup"><span data-stu-id="2f930-113">For example, you can write a translation rule to remove +44 from the beginning of a dial string and replace it with 0144.</span></span>

<span data-ttu-id="2f930-114">**Skype for Business Server コントロールパネルを使用して発信者番号を構成するには**</span><span class="sxs-lookup"><span data-stu-id="2f930-114">**To configure Caller ID by using the Skype for Business Server Control Panel**</span></span>

1. <span data-ttu-id="2f930-115">RTCUniversalServerAdmins グループのメンバーとして、または CsVoiceAdministrator、CsServerAdministrator、または CsAdministrator の役割のメンバーとしてコンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2f930-115">Log on to the computer as a member of the RTCUniversalServerAdmins group, or as a member of the CsVoiceAdministrator, CsServerAdministrator, or CsAdministrator role.</span></span> <span data-ttu-id="2f930-116">詳細については、「[委任のセットアップのアクセス許可](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-116">For details, see [Delegate setup permissions](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).</span></span>
2. <span data-ttu-id="2f930-117">ブラウザーウィンドウを開き、管理 URL を入力してコントロールパネルを開きます。</span><span class="sxs-lookup"><span data-stu-id="2f930-117">Open a browser window, and then enter the Admin URL to open the Control Panel.</span></span> <span data-ttu-id="2f930-118">Skype for Business コントロールパネルの起動に使用できるさまざまな方法の詳細については、「 [Install and open 管理ツール](../../management-tools/install-and-open-administrative-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-118">For details about the different methods you can use to start the Skype for Business Control Panel, see [Install and open administrative tools](../../management-tools/install-and-open-administrative-tools.md).</span></span>
3. <span data-ttu-id="2f930-119">左側のナビゲーション バーで [**音声ルーティング**] をクリックし、[**トランク構成**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-119">In the left navigation bar, click **Voice Routing**, and then click **Trunk Configuration**.</span></span>
4. <span data-ttu-id="2f930-120">[トランク構成] ページで、既存のトランク (たとえば [**グローバル**] トランク) をダブルクリックして [**編集トランク構成**] ダイアログ ボックスを表示します。</span><span class="sxs-lookup"><span data-stu-id="2f930-120">On the Trunk Configuration page, double-click an existing trunk (for example, the **Global** trunk) to display the **Edit Trunk Configuration** dialog box.</span></span>
5. <span data-ttu-id="2f930-121">発信者番号のプレゼンテーションを構成するには、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="2f930-121">To configure caller ID presentation:</span></span>
    - <span data-ttu-id="2f930-122">エンタープライズ VoIP 展開で利用できるすべての変換ルールの一覧から 1 つ以上のルールを選択するには、**[選択]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-122">To choose one or more rules from a list of all translation rules available in your Enterprise Voice deployment, click **Select**.</span></span> <span data-ttu-id="2f930-123">[**発信者番号の変換ルール**] で、トランクに関連付けるルールをクリックし、[**OK**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-123">In **Calling number translation rules**, click the rules that you want to associate with the trunk, and then click **OK**.</span></span>
    - <span data-ttu-id="2f930-124">新しい変換ルールを定義してトランクに関連付ける場合は、[**新規**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-124">To define a new translation rule and associate it with the trunk, click **New**.</span></span> 
    - <span data-ttu-id="2f930-125">既にトランクに関連付けられている変換ルールを編集するには、ルールの名前をクリックして、[**詳細の表示**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-125">To edit a translation rule that is already associated with the trunk, click the rule name, and then click **Show details**.</span></span>
    - <span data-ttu-id="2f930-126">既存の変換ルールをコピーして新しいルールを定義するための開始点として使用するには、ルールの名前をクリックし、[**コピー**] をクリックして、[**貼り付け**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-126">To copy an existing translation rule to use as a starting point for defining a new rule, click the rule name, click **Copy**, and then click **Paste**.</span></span>
    - <span data-ttu-id="2f930-127">トランクから変換ルールを削除するには、ルールの名前を選択状態にし、[**削除**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-127">To remove a translation rule from the trunk, highlight the rule name and click **Remove**.</span></span>

> [!Warning] 
> <span data-ttu-id="2f930-128">関連付けられたトランク ピアに対して変換ルールを構成している場合は、2 つのルールが競合する危険があることから、変換ルールをトランクに関連付けないでください。</span><span class="sxs-lookup"><span data-stu-id="2f930-128">Do not associate translation rules with a trunk if you have configured translation rules on the associated trunk peer, because the two rules might conflict.</span></span> 

## <a name="called-id-presentation"></a><span data-ttu-id="2f930-129">呼び出し先 ID プレゼンテーション</span><span class="sxs-lookup"><span data-stu-id="2f930-129">Called ID presentation</span></span>

> [!Important]
> <span data-ttu-id="2f930-p108">1 つ以上の変換ルールをエンタープライズ VoIP のトランク構成と関連付ける機能は、トランク ピアに変換ルールを構成することの*代替*として使用されます。 トランク ピアで変換ルールを構成した場合は、2 つのルールが競合する可能性があるため、変換ルールをエンタープライズ VoIP トランク構成に関連付けないでください。</span><span class="sxs-lookup"><span data-stu-id="2f930-p108">The ability to associate one or more translation rules with an Enterprise Voice trunk configuration is intended to be used as an *alternative* to configuring translation rules on the trunk peer. Do not associate translation rules with an Enterprise Voice trunk configuration if you have configured translation rules on the trunk peer because the two rules might conflict.</span></span> 

<span data-ttu-id="2f930-132">次のいずれかの方法を使用して、変換ルールを作成または変更できます。</span><span class="sxs-lookup"><span data-stu-id="2f930-132">You can use either of the following methods to create or modify a translation rule:</span></span>

- <span data-ttu-id="2f930-133">[[変換ルールの構築] ツールを使用](#create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool)して、先頭の数字、長さ、削除する数字、および数字を追加する数値を指定します。その後、Skype For Business Server コントロールパネルで対応する一致パターンと変換ルールを生成するようにします。</span><span class="sxs-lookup"><span data-stu-id="2f930-133">[Use the Build a Translation Rule tool](#create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool) to specify values for the starting digits, length, digits to remove and digits to add, and then let the Skype for Business Server Control Panel generate the corresponding matching pattern and translation rule for you.</span></span>
- <span data-ttu-id="2f930-134">[正規表現を手動で記述](#create-or-modify-a-translation-rule-manually)して、照合パターンと変換ルールを定義します。</span><span class="sxs-lookup"><span data-stu-id="2f930-134">[Write regular expressions manually](#create-or-modify-a-translation-rule-manually) to define the matching pattern and translation rule.</span></span>

> [!Note]
> <span data-ttu-id="2f930-135">正規表現を記述する方法については、「 [.Net Framework 正規表現](https://go.microsoft.com/fwlink/p/?linkId=140927)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-135">For information about how to write regular expressions, see [.NET Framework Regular Expressions](https://go.microsoft.com/fwlink/p/?linkId=140927).</span></span> 

### <a name="create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool"></a><span data-ttu-id="2f930-136">変換ルールの構築ツールを使用して変換ルールを作成または変更する</span><span class="sxs-lookup"><span data-stu-id="2f930-136">Create or modify a translation rule by using the Build a Translation Rule tool</span></span>

<span data-ttu-id="2f930-137">[変換ルールの構築] ツールに値のセットを入力して、Skype for Business Server コントロールパネルを有効にして対応する一致パターンと変換ルールを生成することによって、変換ルールを定義するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="2f930-137">Follow these steps if you want to define a translation rule by entering a set of values in the Build a Translation Rule tool and enabling the Skype for Business Server Control Panel to generate the corresponding matching pattern and translation rule for you.</span></span> 

<span data-ttu-id="2f930-138">**変換ルールの構築ツールを使用してルールを定義するには**</span><span class="sxs-lookup"><span data-stu-id="2f930-138">**To define a rule by using the Build a Translation Rule tool**</span></span>

1. <span data-ttu-id="2f930-139">RTCUniversalServerAdmins グループのメンバーとして、または CsVoiceAdministrator、CsServerAdministrator、または CsAdministrator の役割のメンバーとしてコンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2f930-139">Log on to the computer as a member of the RTCUniversalServerAdmins group, or as a member of the CsVoiceAdministrator, CsServerAdministrator, or CsAdministrator role.</span></span> <span data-ttu-id="2f930-140">詳細については、「[委任のセットアップのアクセス許可](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-140">For details, see [Delegate setup permissions](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).</span></span>
2. <span data-ttu-id="2f930-141">ブラウザーウィンドウを開き、管理 URL を入力してコントロールパネルを開きます。</span><span class="sxs-lookup"><span data-stu-id="2f930-141">Open a browser window, and then enter the Admin URL to open the Control Panel.</span></span> <span data-ttu-id="2f930-142">Skype for Business コントロールパネルの起動に使用できるさまざまな方法の詳細については、「 [Install and open 管理ツール](../../management-tools/install-and-open-administrative-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-142">For details about the different methods you can use to start the Skype for Business Control Panel, see [Install and open administrative tools](../../management-tools/install-and-open-administrative-tools.md).</span></span>
3. <span data-ttu-id="2f930-143">変換ルールの定義を開始するには、手順10で [[メディアバイパスを使用](GET LINK AFTER MIGRATION)してトランクを構成する] または手順9を使用して[メディアバイパスを構成](GET LINK AFTER MIGRATION)するの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="2f930-143">To begin defining a translation rule, follow the steps in [Configure a trunk with media bypass](GET LINK AFTER MIGRATION)through step 10 or [Configure a trunk without media bypass](GET LINK AFTER MIGRATION) through step 9.</span></span>
4. <span data-ttu-id="2f930-144">[**新しい変換ルール**] ページまたは [**変換ルールの編集**] ページの [**名前**] に、変換対象の番号パターンを説明する名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-144">Under **Name** on the **New Translation Rule** or **Edit Translation Rule** page, type a name that describes the number pattern being translated.</span></span>
5. <span data-ttu-id="2f930-145">オプション[**説明**] に、変換ルールの説明を入力します。たとえば、**米国の国際長距離電話番号**です。</span><span class="sxs-lookup"><span data-stu-id="2f930-145">(Optional) Under **Description**, type a description of the translation rule - for example, **US International long-distance dialing**.</span></span>
6. <span data-ttu-id="2f930-146">ダイアログ ボックスの [**変換ルールの構築**] セクションの次のフィールドに値を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-146">In the **Build a Translation Rule** section of the dialog box, enter values in the following fields:</span></span>
    - <span data-ttu-id="2f930-147">[**開始番号**]: (オプション) パターンに一致させる番号の先頭の番号を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-147">**Starting digits**: (Optional) Specify the leading digits of numbers you want the pattern to match.</span></span> <span data-ttu-id="2f930-148">たとえば、+ で開始される E.164 形式の番号に一致させるには、このフィールドに「+」を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-148">For example, enter + in this field to match numbers in E.164 format (which begin with +).</span></span>
    - <span data-ttu-id="2f930-p112">[**長さ**]: 一致パターンの桁数を指定し、パターンをこの長さと同じ桁数の番号に一致させるか、この長さ以上の番号に一致させるか、どの長さの番号にも一致させるかを選択します。 たとえば、**[11]** と入力してドロップダウン リストで **[最少]** を選択すると、最低でも 11 桁の長さの番号に一致されます。</span><span class="sxs-lookup"><span data-stu-id="2f930-p112">**Length**: Specify the number of digits in the matching pattern and select whether you want the pattern to match numbers that are this length exactly, at least this length, or any length. For example, enter **11** and select **At least** in the drop-down list to match numbers that are at least 11 digits in length.</span></span>
    - <span data-ttu-id="2f930-151">[**削除する番号**]: (オプション) 開始番号から削除する桁数を指定します。</span><span class="sxs-lookup"><span data-stu-id="2f930-151">**Digits to remove**: (Optional) Specify the number of starting digits to be removed.</span></span> <span data-ttu-id="2f930-152">たとえば、「**1**」と入力すると、番号の先頭から + が削除されます。</span><span class="sxs-lookup"><span data-stu-id="2f930-152">For example, enter **1** to strip out the + from the beginning of the number.</span></span>
    - <span data-ttu-id="2f930-p114">[**追加する番号**]: (オプション) 変換済みの番号の先頭に追加する番号を指定します。 たとえば、ルール適用時、変換済みの番号の先頭に 011 を追加したい場合は、「**011**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-p114">**Digits to add**: (Optional) Specify digits to be prepended to the translated numbers. For example, enter **011** if you want 011 to be prepended to the translated numbers when the rule is applied.</span></span>
    
    <span data-ttu-id="2f930-155">これらのフィールドに入力した値は、[**一致するパターン**] フィールドと [**変換**ルール] フィールドに反映されます。</span><span class="sxs-lookup"><span data-stu-id="2f930-155">The values you enter in these fields are reflected in the **Pattern to match** and **Translation** rule fields.</span></span> <span data-ttu-id="2f930-156">たとえば、前の例の値を指定した場合、[ **matc] フィールドにパターン**の正規表現は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="2f930-156">For example, if you specify the preceding example values, the resulting regular expression in the **Pattern to matc**h field is:</span></span>
    
    <span data-ttu-id="2f930-157">**^\+(\d{9}\d +) $**</span><span class="sxs-lookup"><span data-stu-id="2f930-157">**^\+(\d{9}\d+)$**</span></span> 

    <span data-ttu-id="2f930-p116">[**変換ルール**] フィールドには、変換済みの番号の形式のパターンを指定します。 このパターンには、次の 2 つのパーツがあります。</span><span class="sxs-lookup"><span data-stu-id="2f930-p116">The **Translation rule** field specifies a pattern for the format of translated numbers. This pattern has two parts:</span></span>
    - <span data-ttu-id="2f930-160">一致パターンの桁数を表す値 (**$1** など)</span><span class="sxs-lookup"><span data-stu-id="2f930-160">A value (for example, **$1**) that represents the number of digits in the matching pattern</span></span>
    - <span data-ttu-id="2f930-161">(オプション) [**追加する番号**] フィールドに入力することで先頭に追加できる値</span><span class="sxs-lookup"><span data-stu-id="2f930-161">(Optional) A value that you can prepend by entering it in the **Digits to add** field</span></span>

    <span data-ttu-id="2f930-162">上述の例の値を使用した場合、[**変換ルール**] フィールドに **011$1** が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2f930-162">Using the preceding example values, **011$1** appears in the **Translation rule** field.</span></span>
    
    <span data-ttu-id="2f930-163">この変換ルールを適用すると、+441235551010 が 011441235551010 になります。</span><span class="sxs-lookup"><span data-stu-id="2f930-163">When this translation rule is applied, +441235551010 becomes 011441235551010.</span></span>
7. <span data-ttu-id="2f930-164">[**OK**] をクリックして変換ルールを保存します。</span><span class="sxs-lookup"><span data-stu-id="2f930-164">Click **OK** to save the translation rule.</span></span>
8. <span data-ttu-id="2f930-165">[**OK**] をクリックしてトランク構成を保存します。</span><span class="sxs-lookup"><span data-stu-id="2f930-165">Click **OK** to save the trunk configuration.</span></span>
9. <span data-ttu-id="2f930-166">[**トランク**の選択] ページで、[**確定**] をクリックし、[**すべて確定**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-166">On the **Trunk Configuratio**n page, click **Commit**, and then click **Commit all**.</span></span> 

> [!Note]
> <span data-ttu-id="2f930-167">変換ルールを作成または変更したときは必ず、[**すべて確定**] コマンドを実行して構成の変更を公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f930-167">Whenever you create or modify a translation rule, you must run the **Commit all** command to publish the configuration change.</span></span> <span data-ttu-id="2f930-168">詳細については、「[保留中の変更を音声ルーティング構成に公開する](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-168">For details, see [Publish pending changes to the voice routing configuration](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx).</span></span> 

### <a name="create-or-modify-a-translation-rule-manually"></a><span data-ttu-id="2f930-169">手動で変換ルールを作成または変更する</span><span class="sxs-lookup"><span data-stu-id="2f930-169">Create or modify a translation rule manually</span></span>

<span data-ttu-id="2f930-170">一致するパターンおよび変換ルールの正規表現を書いて変換ルールを定義する場合は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="2f930-170">Follow these steps if you want to define a translation rule by writing a regular expression for the matching pattern and translation rule.</span></span> 

<span data-ttu-id="2f930-171">**変換ルールを手動で定義するには**</span><span class="sxs-lookup"><span data-stu-id="2f930-171">**To define a translation rule manually**</span></span>

1. <span data-ttu-id="2f930-172">RTCUniversalServerAdmins グループのメンバーとして、または CsVoiceAdministrator、CsServerAdministrator、または CsAdministrator の役割のメンバーとしてコンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2f930-172">Log on to the computer as a member of the RTCUniversalServerAdmins group, or as a member of the CsVoiceAdministrator, CsServerAdministrator, or CsAdministrator role.</span></span> <span data-ttu-id="2f930-173">詳細については、「[委任のセットアップのアクセス許可](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-173">For details, see [Delegate setup permissions](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).</span></span>
2. <span data-ttu-id="2f930-174">ブラウザーウィンドウを開き、管理 URL を入力してコントロールパネルを開きます。</span><span class="sxs-lookup"><span data-stu-id="2f930-174">Open a browser window, and then enter the Admin URL to open the Control Panel.</span></span> <span data-ttu-id="2f930-175">Skype for Business コントロールパネルの起動に使用できるさまざまな方法の詳細については、「 [Install and open 管理ツール](../../management-tools/install-and-open-administrative-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-175">For details about the different methods you can use to start the Skype for Business Control Panel, see [Install and open administrative tools](../../management-tools/install-and-open-administrative-tools.md).</span></span>
3. <span data-ttu-id="2f930-176">変換ルールの定義を開始するには、手順10で [[メディアバイパスを使用](GET LINK AFTER MIGRATION)してトランクを構成する] または手順9を使用して[メディアバイパスを構成](GET LINK AFTER MIGRATION)するの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="2f930-176">To begin defining a translation rule, follow the steps in [Configure a trunk with media bypass](GET LINK AFTER MIGRATION)through step 10 or [Configure a trunk without media bypass](GET LINK AFTER MIGRATION) through step 9.</span></span>
4. <span data-ttu-id="2f930-177">[**新しい変換ルール**] ページまたは [**変換ルールの編集**] ページの [**名前**] フィールドに、変換対象の番号パターンを説明する名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-177">In the **Name** field on the **New Translation Rule** or **Edit Translation Rule** page, type a name that describes the number pattern being translated.</span></span>
5. <span data-ttu-id="2f930-178">オプション[**説明**] に、変換ルールの説明を入力します。たとえば、**米国の国際長距離通話**。</span><span class="sxs-lookup"><span data-stu-id="2f930-178">(Optional) In **Description**, type a description of the translation rule; for example, **US International long-distance dialing**.</span></span>
6. <span data-ttu-id="2f930-179">[**変換ルールの構築**] セクションの一番下にある [**編集**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-179">Click **Edit** at the bottom of the **Build a Translation Rule** section.</span></span>
7. <span data-ttu-id="2f930-180">「**正規表現**を入力してください」に、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="2f930-180">Enter the following in Type a **Regular Expression**:</span></span>
    - <span data-ttu-id="2f930-181">[**このパターンと一致**] に、変換する番号を照合するために使用するパターンを指定します。</span><span class="sxs-lookup"><span data-stu-id="2f930-181">In **Match this pattern**, specify the pattern that will be used to match the numbers to be translated.</span></span>
    - <span data-ttu-id="2f930-182">[**変換ルール**] に、変換される番号の形式のパターンを指定します。</span><span class="sxs-lookup"><span data-stu-id="2f930-182">In **Translation rule**, specify a pattern for the format of translated numbers.</span></span>

    <span data-ttu-id="2f930-183">たとえば、[**このパターンを照合**] に\*\* ^ \+「{9}(\d \d +) $\*\* 」と入力し、[**変換ルール**] に「 **011 $ 1** 」と入力すると、ルールは + 441235551010 から011441235551010に翻訳されます。</span><span class="sxs-lookup"><span data-stu-id="2f930-183">For example, if you enter **^\+(\d{9}\d+)$** in **Match this pattern** and **011$1** in **Translation rule**, the rule will translate +441235551010 to 011441235551010.</span></span>
8. <span data-ttu-id="2f930-184">[**OK**] をクリックして変換ルールを保存します。</span><span class="sxs-lookup"><span data-stu-id="2f930-184">Click **OK** to save the translation rule.</span></span>
9. <span data-ttu-id="2f930-185">[**OK**] をクリックしてトランク構成を保存します。</span><span class="sxs-lookup"><span data-stu-id="2f930-185">Click **OK** to save the trunk configuration.</span></span>
10. <span data-ttu-id="2f930-186">[**トランク構成**] ページで [**確定**] をクリックして、[**すべて確定**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2f930-186">On the **Trunk Configuration** page, click **Commit**, and then click **Commit all**.</span></span> 

> [!Note] 
> <span data-ttu-id="2f930-187">変換ルールを作成または変更したときは必ず、[**すべて確定**] コマンドを実行して構成の変更を公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f930-187">Whenever you create or modify a translation rule, you must run the **Commit all** command to publish the configuration change.</span></span> <span data-ttu-id="2f930-188">詳細については、「[保留中の変更を音声ルーティング構成に公開する](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f930-188">For details, see [Publish pending changes to the voice routing configuration](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx).</span></span> 
