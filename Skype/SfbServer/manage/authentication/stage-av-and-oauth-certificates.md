---
title: Skype で AV と OAuth の証明書をビジネス サーバーのステージ ・ セット CsCertificate でロールを使用します。
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: '概要: ステージの AV と OAuth の証明書ビジネス サーバーの Skype のです。'
ms.openlocfilehash: 793791ad882171e381eff751a6f57425de0c8ca7
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/11/2019
ms.locfileid: "33919396"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-using--roll-in-set-cscertificate"></a><span data-ttu-id="2e562-103">Skype で AV と OAuth の証明書をビジネス サーバーのステージ ・ セット CsCertificate でロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-103">Stage AV and OAuth certificates in Skype for Business Server using -Roll in Set-CsCertificate</span></span>
 
<span data-ttu-id="2e562-104">**の概要:** ステージ AV と OAuth の証明書ビジネス サーバーの Skype のです。</span><span class="sxs-lookup"><span data-stu-id="2e562-104">**Summary:** Stage AV and OAuth certificates for Skype for Business Server.</span></span>
  
<span data-ttu-id="2e562-105">オーディオ/ビデオ (A/V) の通信は、Skype のビジネス サーバーの重要なコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="2e562-105">Audio/Video (A/V) communications is a key component of Skype for Business Server.</span></span> <span data-ttu-id="2e562-106">A に割り当てられている証明書に基づいて、アプリケーションの共有、オーディオおよびビデオ会議などの機能と音声ビデオ エッジ サービス、具体的には、A/V 認証サービスです。</span><span class="sxs-lookup"><span data-stu-id="2e562-106">Features such as application sharing and audio and video conferencing rely on the certificates assigned to the A/V Edge service, specifically the A/V Authentication service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="2e562-107">この新しい機能が用意されています a/V エッジ サービスおよび OAuthTokenIssuer 証明書。</span><span class="sxs-lookup"><span data-stu-id="2e562-107">This new feature is designed to work for the A/V Edge service and the OAuthTokenIssuer certificate.</span></span> <span data-ttu-id="2e562-108">A とその他の種類の証明書を準備することができます証明書の種類ですが、共存の問題からもメリットはありません音声ビデオ エッジ サービスと OAuth とを A と、音声ビデオ エッジ サービスの証明書は。</span><span class="sxs-lookup"><span data-stu-id="2e562-108">Other certificate types can be provisioned along with the A/V Edge service and OAuth certificate type, but will not benefit from the coexistence behavior that the A/V Edge service certificate will.</span></span>
  
<span data-ttu-id="2e562-109">Skype をビジネスのサーバー証明書の管理に使用されるビジネス サーバー管理シェルの PowerShell コマンドレットの Skype は、A/V エッジ AudioVideoAuthentication 証明書の種類として証明書と、OAuthServer 証明書としてのサービスtypeOAuthTokenIssuer。</span><span class="sxs-lookup"><span data-stu-id="2e562-109">The Skype for Business Server Management Shell PowerShell cmdlets used to manage Skype for Business Server certificates refers to the A/V Edge service certificate as the AudioVideoAuthentication certificate type and the OAuthServer certificate as typeOAuthTokenIssuer.</span></span> <span data-ttu-id="2e562-110">証明書を一意に識別するのには、このトピックの以降は、それらを参照、同じ識別子の種類、AudioVideoAuthentication andOAuthTokenIssuer で。</span><span class="sxs-lookup"><span data-stu-id="2e562-110">For the rest of this topic and to uniquely identify the certificates, they will be referred to by the same identifier type, AudioVideoAuthentication andOAuthTokenIssuer.</span></span>
  
<span data-ttu-id="2e562-111">A/V 認証サービスは、クライアントおよびその他の A で使用されるトークンの発行を担当すると V の消費者です。</span><span class="sxs-lookup"><span data-stu-id="2e562-111">The A/V Authentication service is responsible for issuing tokens that are used by clients and other A/V consumers.</span></span> <span data-ttu-id="2e562-112">トークンが、証明書の属性から生成され、証明書が期限切れになったときの接続と新しい証明書によって生成された新しいトークンを使用して再度参加する必要性が失われます。</span><span class="sxs-lookup"><span data-stu-id="2e562-112">The tokens are generated from attributes on the certificate, and when the certificate expires, loss of connection and requirement to rejoin with a new token generated by the new certificate will result.</span></span> <span data-ttu-id="2e562-113">Skype ビジネス サーバー用の新機能でこの問題が古いものを期限切れにし、引き続き一定期間の両方の証明書を許可する前に新しい証明書を準備することが軽減されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-113">A new feature in Skype for Business Server will alleviate this problem - the ability to stage a new certificate in advance of the old one expiring and allowing both certificates to continue to function for a period of time.</span></span> <span data-ttu-id="2e562-114">この機能は、ビジネスのサーバー管理シェル コマンドレットのセット CsCertificate Skype で更新された機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-114">This feature uses updated functionality in the Set-CsCertificate Skype for Business Server Management Shell cmdlet.</span></span> <span data-ttu-id="2e562-115">新しいパラメーターにロールバックするには、既存のパラメーターを使用して - EffectiveDate は、証明書ストアに新しい AudioVideoAuthentication 証明書が配置されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-115">The new parameter -Roll, with the existing parameter -EffectiveDate, will place the new AudioVideoAuthentication certificate in the certificate store.</span></span> <span data-ttu-id="2e562-116">古い AudioVideoAuthentication 証明書に対して検証するのには発行されたトークンの残ります。</span><span class="sxs-lookup"><span data-stu-id="2e562-116">The older AudioVideoAuthentication certificate will still remain for issued tokens to be validated against.</span></span> <span data-ttu-id="2e562-117">AudioVideoAuthentication 証明書の新規の場所に配置することから、次の一連のイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="2e562-117">Beginning with putting the new AudioVideoAuthentication certificate in place, the following series of events will occur:</span></span>
  
> [!TIP]
> <span data-ttu-id="2e562-118">Skype を使用して、証明書を管理するためのビジネス サーバー管理シェル コマンドレットは、エッジ サーバー上でそれぞれの目的とは別の証明書を要求できます。</span><span class="sxs-lookup"><span data-stu-id="2e562-118">Using the Skype for Business Server Management Shell cmdlets for managing certificates, you can request separate and distinct certificates for each purpose on the Edge Server.</span></span> <span data-ttu-id="2e562-119">Skype のビジネス サーバーの展開ウィザードの証明書ウィザードを使用して、証明書の作成に役立つが、通常どのカップル単一の証明書をエッジ サーバーのすべての証明書を使用して、**既定**の種類の。</span><span class="sxs-lookup"><span data-stu-id="2e562-119">Using the Certificate Wizard in the Skype for Business Server Deployment Wizard assists you in creating certificates, but is typically of the **default** type which couples all certificate uses for the Edge Server onto a single certificate.</span></span> <span data-ttu-id="2e562-120">ローリング証明書機能を使用する場合は、AudioVideoAuthentication 証明書を他の証明書の用途から切り離すことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2e562-120">The recommended practice if you are going to use the rolling certificate feature is to decouple the AudioVideoAuthentication certificate from the other certificate purposes.</span></span> <span data-ttu-id="2e562-121">既定の種類の証明書をプロビジョニングおよびステージングすることもできますが、結合された証明書の AudioVideoAuthentication 部分のみがステージングによる恩恵を受けます。</span><span class="sxs-lookup"><span data-stu-id="2e562-121">You can provision and stage a certificate of the Default type, but only the AudioVideoAuthentication portion of the combined certificate will benefit from the staging.</span></span> <span data-ttu-id="2e562-122">(たとえば) に関連するインスタント メッセージの会話、証明書の有効期限が切れたときにする必要があるして再度ログインするには、アクセス エッジ サービスに関連付けられている新しい証明書を使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-122">A user involved in (for example) an instant messaging conversation when the certificate expires will need to log out and log back in to make use of the new certificate associated with the Access Edge service.</span></span> <span data-ttu-id="2e562-123">ユーザーが Web 会議エッジ サービスを使用して Web 会議に関連する同様の現象が発生します。</span><span class="sxs-lookup"><span data-stu-id="2e562-123">Similar behavior will occur for a user involved in a Web conference using the Web Conferencing Edge service.</span></span> <span data-ttu-id="2e562-124">OAuthTokenIssuer 証明書は、すべてのサーバーの間で共有される特定の種類の証明書です。</span><span class="sxs-lookup"><span data-stu-id="2e562-124">The OAuthTokenIssuer certificate is a specific type that is shared across all servers.</span></span> <span data-ttu-id="2e562-125">証明書が格納されているとを作成し、1 つの場所に証明書を管理する中央管理ストア内の他のすべてのサーバーです。</span><span class="sxs-lookup"><span data-stu-id="2e562-125">You create and manage the certificate in one place and the certificate is stored in the Central Management store for all other servers.</span></span>
  
<span data-ttu-id="2e562-126">Set-CsCertificate コマンドレットを使用するとき、および現在の証明書の有効期限が切れる前にこのコマンドレットを使用して証明書をステージングするときのオプションと要件を十分に理解するには、さらに詳しい説明が必要です。</span><span class="sxs-lookup"><span data-stu-id="2e562-126">Additional detail is needed to fully understand your options and requirements when using the Set-CsCertificate cmdlet and using it to stage certificates prior to the current certificate expiring.</span></span> <span data-ttu-id="2e562-127">-ロール パラメーターが重要ですが、基本的に 1 つの目的です。</span><span class="sxs-lookup"><span data-stu-id="2e562-127">The -Roll parameter is important, but essentially single purpose.</span></span> <span data-ttu-id="2e562-128">セット CsCertificate、証明書の情報に影響を受けるので定義されているを提供することをパラメーターとして定義する場合 (たとえば AudioVideoAuthentication、OAuthTokenIssuer など) の種類の証明書がいつになります。-EffectiveDate で定義されている有効です。</span><span class="sxs-lookup"><span data-stu-id="2e562-128">If you define it as a parameter, you are telling Set-CsCertificate that you will be providing information about the certificate that will be affected defined by -Type (for example AudioVideoAuthentication and OAuthTokenIssuer), when the certificate will become effective defined by -EffectiveDate.</span></span>
  
 <span data-ttu-id="2e562-129">**・ ロール ・**: パラメーターは必須では、一緒に指定する必要がある依存関係は、ロール。</span><span class="sxs-lookup"><span data-stu-id="2e562-129">**-Roll**: The -Roll parameter is required and has dependencies that must be supplied along with it.</span></span> <span data-ttu-id="2e562-130">どの証明書が影響を受け、どのように適用されるかを完全に定義するための必須パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="2e562-130">Required parameters to fully define which certificates will be affected and how they will be applied:</span></span>
  
 <span data-ttu-id="2e562-131">**-EffectiveDate**: パラメーター EffectiveDate の定義、新しい証明書が現在の証明書を持つ co-active になります。</span><span class="sxs-lookup"><span data-stu-id="2e562-131">**-EffectiveDate**: The parameter -EffectiveDate defines when the new certificate will become co-active with the current certificate.</span></span> <span data-ttu-id="2e562-132">-EffectiveDate は、現在の証明書の有効期限の時刻の近くに、または時間の長い期間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="2e562-132">The -EffectiveDate can be close to the expiry time of the current certificate, or it can be a longer period of time.</span></span> <span data-ttu-id="2e562-133">推奨される最小の EffectiveDate AudioVideoAuthentication 証明書の AV エッジ サービスのトークンが AudioVideoAuthentication の証明書を使用して発行の既定値トークンの有効期間は 8 時間があります。</span><span class="sxs-lookup"><span data-stu-id="2e562-133">A recommended minimum -EffectiveDate for the AudioVideoAuthentication certificate would be 8 hours, which is the default token lifetime for AV Edge service tokens issued using the AudioVideoAuthentication certificate.</span></span>
  
<span data-ttu-id="2e562-p109">OAuthTokenIssuer 証明書をステージングするときは、証明書が有効になるまでのリード タイムの要件が異なります。OAuthTokenIssuer 証明書のリード タイムは、現在の証明書の有効期限が切れる 24 時間以上前に設定する必要があります。共存のリード タイムが長いのは、OAuthTokenIssuer 証明書に依存する他のサーバーの役割 (たとえば Exchange Server) で、証明書によって作成された認証と暗号化キー材料の保有期間が長いためです。</span><span class="sxs-lookup"><span data-stu-id="2e562-p109">When staging OAuthTokenIssuer certificates, there are different requirements for the lead time before the certificate can become effective. The minimum time that the OAuthTokenIssuer certificate should have for its lead time is 24 hours before the expiration time of the current certificate. The extended lead time for the coexistence is because of other server roles that are dependent on the OAuthTokenIssuer certificate (Exchange Server, for example) which has a longer retention time for certificate created authentication and encryption key materials.</span></span>
  
 <span data-ttu-id="2e562-137">**-Thumbprint**: 拇印は証明書の属性で、証明書ごとに一意となります。</span><span class="sxs-lookup"><span data-stu-id="2e562-137">**-Thumbprint**: The thumbprint is an attribute on the certificate that is unique to that certificate.</span></span> <span data-ttu-id="2e562-138">拇印セット CsCertificate コマンドレットの操作が影響を受ける証明書を識別するパラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-138">The -Thumbprint parameter is used to identify the certificate that will be affected by the actions of the Set-CsCertificate cmdlet.</span></span>
  
 <span data-ttu-id="2e562-139">**-タイプ**: の型パラメーターは、単一の証明書の使用法の種類や証明書の使用法の種類のコンマ区切りのリストを受け入れることができます。</span><span class="sxs-lookup"><span data-stu-id="2e562-139">**-Type**: The -Type parameter can accept a single certificate usage type or a comma separated list of certificate usage types.</span></span> <span data-ttu-id="2e562-140">証明書の種類は、証明書の目的は、どのようなコマンドレットと、サーバーを識別するものです。</span><span class="sxs-lookup"><span data-stu-id="2e562-140">The certificate types are those that identify to the cmdlet and to the server what the purpose of the certificate is.</span></span> <span data-ttu-id="2e562-141">AudioVideoAuthentication の種類は、A で使用すると音声ビデオ エッジ サービス、および AV の認証サービスです。</span><span class="sxs-lookup"><span data-stu-id="2e562-141">For example, type AudioVideoAuthentication is for use by the A/V Edge service and the AV Authentication service.</span></span> <span data-ttu-id="2e562-142">場合は別の種類のステージとプロビジョニングの証明書を同時は、証明書の最長必要最低限効果的なリード時間を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2e562-142">If you decide to stage and provision certificates of a different type at the same time, you must consider the longest required minimum effective lead time for the certificates.</span></span> <span data-ttu-id="2e562-143">たとえば、する必要がありますの種類の証明書をステージに AudioVideoAuthentication と OAuthTokenIssuer。</span><span class="sxs-lookup"><span data-stu-id="2e562-143">For example, you need to stage certificates of type AudioVideoAuthentication and OAuthTokenIssuer.</span></span> <span data-ttu-id="2e562-144">EffectiveDate 最小は、この場合は、OAuthTokenIssuer は、最小のリード タイムが 24 時間の内、2 つの証明書のうち、大きい方である必要があります。</span><span class="sxs-lookup"><span data-stu-id="2e562-144">Your minimum -EffectiveDate must be the greater of the two certificates, in this case the OAuthTokenIssuer, which has a minimum lead time of 24 hours.</span></span> <span data-ttu-id="2e562-145">AudioVideoAuthentication 証明書と 24 時間のリード タイムを段階的にしたくない場合にお客様の要件には、EffectiveDate とは別にステージです。</span><span class="sxs-lookup"><span data-stu-id="2e562-145">If you do not want to stage the AudioVideoAuthentication certificate with a lead time of 24 hours, stage it separately with an EffectiveDate that is more to your requirements.</span></span>
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="2e562-146">更新または A を更新する-ロールと EffectiveDate ・ パラメーターを使用して音声ビデオ エッジ サービスが証明書と</span><span class="sxs-lookup"><span data-stu-id="2e562-146">To update or renew an A/V Edge service certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="2e562-147">Administrators グループのメンバーとして、ローカル コンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2e562-147">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="2e562-148">A 上の既存の証明書のエクスポート可能な秘密キーの更新または新しい証明書の AudioVideoAuthentication を要求すると音声ビデオ エッジ サービスです。</span><span class="sxs-lookup"><span data-stu-id="2e562-148">Request a renewal or new AudioVideoAuthentication certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>
    
3. <span data-ttu-id="2e562-149">新しい AudioVideoAuthentication 証明書をエッジ サーバーと、プール内の他のすべてのエッジ サーバーにインポートし、(展開されたプールの場合)。</span><span class="sxs-lookup"><span data-stu-id="2e562-149">Import the new AudioVideoAuthentication certificate to the Edge Server and all other Edge Server in your pool (if you have a pool deployed).</span></span>
    
4. <span data-ttu-id="2e562-150">セット CsCertificate コマンドレットを使用してインポートする証明書を構成しを使用してロール パラメーターを指定する-EffectiveDate パラメーターを持つ。</span><span class="sxs-lookup"><span data-stu-id="2e562-150">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="2e562-151">有効日は、現在の証明書の有効期限 (14:00:00 または 2:00:00 PM) からトークン存続時間 (既定では 8 時間) を引いた値で定義します。</span><span class="sxs-lookup"><span data-stu-id="2e562-151">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus token lifetime (by default eight hours).</span></span> <span data-ttu-id="2e562-152">これにより、証明書をアクティブに設定する必要がある時は、- EffectiveDate\<文字列\>:「2015/7/22 午前 6:00:00"です。</span><span class="sxs-lookup"><span data-stu-id="2e562-152">This gives us a time that the certificate must be set to active, and is the -EffectiveDate \<string\>: "7/22/2015 6:00:00 AM".</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="2e562-153">エッジ プールに対して、すべての AudioVideoAuthentication 証明書を展開し、展開可能な A を避けるために証明書の最初の - EffectiveDate パラメーターで定義されたときの日時でを設定する必要があります/旧バージョンのための V の通信停止クライアントとコンシューマーのすべてのトークンは、新しい証明書を使用して書き換えられている場合がある前に有効期限が切れる証明書です。</span><span class="sxs-lookup"><span data-stu-id="2e562-153">For an Edge pool, you must have all AudioVideoAuthentication certificates deployed and provisioned by the date and time defined by the -EffectiveDate parameter of the first certificate deployed to avoid possible A/V communications disruption due to the older certificate expiring before all client and consumer tokens have been renewed using the new certificate.</span></span> 
  
    <span data-ttu-id="2e562-154">セット-CsCertificate は - ロールと EffectiveTime のパラメーターを使用してコマンドします。</span><span class="sxs-lookup"><span data-stu-id="2e562-154">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
   ```

    <span data-ttu-id="2e562-155">Set-CsCertificate コマンドの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2e562-155">An example Set-CsCertificate command:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
   ```

    > [!IMPORTANT]
    > <span data-ttu-id="2e562-156">EffectiveDate は、サーバーの地域と言語の設定に一致するようにフォーマットしなければなりません。</span><span class="sxs-lookup"><span data-stu-id="2e562-156">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="2e562-157">この例で使用している地域と言語の設定は英語 (米国) です。</span><span class="sxs-lookup"><span data-stu-id="2e562-157">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="2e562-158">さらにそのセット CsCertificate のロール、および EffectiveDate - AudioVideoAuthentication を検証するために既存の証明書を使用中に使用されている新規の AudioVideoAuthentication トークンを発行するための新しい証明書を段階的にプロセスを理解するには消費者は、ビジュアルのタイムラインは、プロセスを理解するための効果的な手段です。</span><span class="sxs-lookup"><span data-stu-id="2e562-158">To further understand the process that Set-CsCertificate, -Roll, and -EffectiveDate use to stage a new certificate for issuing new AudioVideoAuthentication tokens while still using an existing certificate to validate AudioVideoAuthentication that are in use by consumers, a visual timeline is an effective means of understanding the process.</span></span> <span data-ttu-id="2e562-159">次の例では、管理者が決定する、A 音声ビデオ エッジ サービスの証明書は 2015/07/22 の 2時 00分: 00 PM に有効期限。</span><span class="sxs-lookup"><span data-stu-id="2e562-159">In the following example, the administrator determines that the A/V Edge service certificate is due to expire at 2:00:00 PM on 07/22/2015.</span></span> <span data-ttu-id="2e562-160">要求彼と新しい証明書を受信し、プール内の各エッジ サーバーにインポートします。</span><span class="sxs-lookup"><span data-stu-id="2e562-160">He requests and receives a new certificate and imports it to each Edge Server in his pool.</span></span> <span data-ttu-id="2e562-161">2015/07/22 の 2 AM、彼が開始の役割を持つ Get CsCertificate を実行して、拇印は、新しい証明書の拇印文字列に等しい] および [EffectiveTime-2015/07/22 に設定 6時 00分: 00 AM。</span><span class="sxs-lookup"><span data-stu-id="2e562-161">At 2 AM on 07/22/2015, he begins running Get-CsCertificate with -Roll, -Thumbprint equal to the thumbprint string of the new certificate, and -EffectiveTime set to 07/22/2015 6:00:00 AM.</span></span> <span data-ttu-id="2e562-162">彼は、各エッジ サーバーでこのコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="2e562-162">He runs this command on each Edge Server.</span></span>
  
![Roll および EffectiveDate パラメーターの使用](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|<span data-ttu-id="2e562-164">**コールアウト**</span><span class="sxs-lookup"><span data-stu-id="2e562-164">**Callout**</span></span>|<span data-ttu-id="2e562-165">**ステージ**</span><span class="sxs-lookup"><span data-stu-id="2e562-165">**Stage**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2e562-166">1</span><span class="sxs-lookup"><span data-stu-id="2e562-166">1</span></span>  <br/> |<span data-ttu-id="2e562-167">開始: 2015 年 7 月 22 日午前 12:00:00</span><span class="sxs-lookup"><span data-stu-id="2e562-167">Start: 7/22/2015 12:00:00 AM</span></span>  <br/> <span data-ttu-id="2e562-p115">現在の AudioVideoAuthentication 証明書の有効期限が 2015 年 7 月 22 日の午後 2:00:00 に終了します。これは証明書の有効期限タイムスタンプにより決定されます。既存の証明書が有効期限に達する前の 8 時間のオーバーラップ (既定のトークン寿命) を考慮して、証明書の交換とロールオーバーを計画します。この例では、午前 2:00:00 のリード タイムを使用して、管理者が有効時刻の午前 6:00:00 の前に新しい証明書を配置およびプロビジョニングするための適切な時間を確保しています。</span><span class="sxs-lookup"><span data-stu-id="2e562-p115">The current AudioVideoAuthentication certificate is due to expire at 2:00:00 PM on 7/22/2015. This is determined by the expires time stamp on the certificate. Plan your certificate replacement and rollover to account for an 8 hour overlap (default token lifetime) before the existing certificate reaches the expire time. The 2:00:00 AM lead time is used in this example to allow the administrator adequate time to place and provision the new certificates in advance of the 6:00:00 AM effective time.</span></span>  <br/> |
|<span data-ttu-id="2e562-172">2</span><span class="sxs-lookup"><span data-stu-id="2e562-172">2</span></span>  <br/> |<span data-ttu-id="2e562-173">2015 年 7 月 22 日午前 2:00:00 ～ 2015 年 7 月 22 日午前 5:59:59</span><span class="sxs-lookup"><span data-stu-id="2e562-173">7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM</span></span>  <br/> <span data-ttu-id="2e562-174">6時 00分: 00 (4 時間以内リード タイムは、この例が、長くすることができます) の有効期間と、エッジ トランスポート サーバーの証明書を設定セット CsCertificate を使用する-タイプ\<証明書の使用法の種類\>・拇印\<新しい証明書の拇印\>-ロール ・ EffectiveDate\<新しい証明書の有効期間の日付時刻文字列\></span><span class="sxs-lookup"><span data-stu-id="2e562-174">Set Certificates on Edge Servers with effective time of 6:00:00 AM (4 hour lead time is for this example, but can be longer) using Set-CsCertificate -Type \<certificate usage type\> -Thumbprint \<thumbprint of new certificate\> -Roll -EffectiveDate \<datetime string of the effective time for new certificate\></span></span>  <br/> |
|<span data-ttu-id="2e562-175">3</span><span class="sxs-lookup"><span data-stu-id="2e562-175">3</span></span>  <br/> |<span data-ttu-id="2e562-176">2015 年 7 月 22 日午前 6:00 ～ 2015 年 7 月 22 日午後 2:00</span><span class="sxs-lookup"><span data-stu-id="2e562-176">7/22/2015 6:00 AM - 7/22/2015 2:00 PM</span></span>  <br/> <span data-ttu-id="2e562-p116">トークンを検証するためにまず新しい証明書が試されます。新しい証明書でトークンの検証に失敗した場合、古い証明書が試されます。8 時間 (既定のトークン寿命) のオーバーラップ期間中にすべてのトークンにこの処理が適用されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-p116">To validate tokens, the new certificate is tried first, and if the new certificate fails to validate the token, the old certificate is tried. This process is used for all tokens during the 8 hour (default token lifetime) overlap period.</span></span>  <br/> |
|<span data-ttu-id="2e562-179">4</span><span class="sxs-lookup"><span data-stu-id="2e562-179">4</span></span>  <br/> |<span data-ttu-id="2e562-180">終了: 2015 年 7 月 22 日午後 2:00:01</span><span class="sxs-lookup"><span data-stu-id="2e562-180">End: 7/22/2015 2:00:01 PM</span></span>  <br/> <span data-ttu-id="2e562-181">古い証明書の期限が切れ、新しい証明書に引き継がれます。</span><span class="sxs-lookup"><span data-stu-id="2e562-181">Old certificate has expired and the new certificate has taken over.</span></span> <span data-ttu-id="2e562-182">削除 CsCertificate で、古い証明書を安全に削除できます-タイプ\<証明書の使用法の種類\>-前</span><span class="sxs-lookup"><span data-stu-id="2e562-182">Old certificate can be safely removed with Remove-CsCertificate -Type \<certificate usage type\> -Previous</span></span>  <br/> |
   
<span data-ttu-id="2e562-183">有効時刻 (2015 年 7 月 22 日午前 6:00:00) になると、新しいトークンはすべて新しい証明書によって発行されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-183">When the effective time is reached (7/22/2015 6:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="2e562-184">トークンを検証する場合、トークンはまず新しい証明書に照らして検証されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-184">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="2e562-185">検証が失敗した場合は、古い証明書が試されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-185">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="2e562-186">新しい証明書を試してから古い証明書にフォールバックするこのプロセスは、古い証明書の有効期限まで続きます。</span><span class="sxs-lookup"><span data-stu-id="2e562-186">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="2e562-187">古い証明書の有効期限が切れた後は (2015 年 7 月 22 日午後 2:00)、トークンは新しい証明書のみを使用して検証されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-187">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="2e562-188">古い証明書を削除 CsCertificate コマンドレットを使用して安全に削除する前のパラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-188">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="2e562-189">更新するか、OAuthTokenIssuer を更新する-ロールと EffectiveDate ・ パラメーターを使用して証明書の</span><span class="sxs-lookup"><span data-stu-id="2e562-189">To update or renew an OAuthTokenIssuer certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="2e562-190">Administrators グループのメンバーとして、ローカル コンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="2e562-190">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="2e562-191">フロント エンド サーバー上の既存の証明書のエクスポート可能な秘密キーを更新または新規の OAuthTokenIssuer 証明書を要求します。</span><span class="sxs-lookup"><span data-stu-id="2e562-191">Request a renewal or new OAuthTokenIssuer certificate with exportable private key for the existing certificate on the Front End Server.</span></span>
    
3. <span data-ttu-id="2e562-192">(プール展開の場合) は、プール内のフロント エンド サーバーに新しい OAuthTokenIssuer 証明書をインポートします。</span><span class="sxs-lookup"><span data-stu-id="2e562-192">Import the new OAuthTokenIssuer certificate to a Front End Server in your pool (if you have a pool deployed).</span></span> <span data-ttu-id="2e562-193">OAuthTokenIssuer 証明書はグローバルにレプリケートされるので、展開内の任意のサーバーで更新と書き換えを行うだけで十分です。</span><span class="sxs-lookup"><span data-stu-id="2e562-193">The OAuthTokenIssuer certificate is replicated globally and only needs to be updated and renewed at any server in your deployment.</span></span> <span data-ttu-id="2e562-194">例としては、フロント エンド サーバーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-194">The Front End Server is used as an example.</span></span>
    
4. <span data-ttu-id="2e562-195">セット CsCertificate コマンドレットを使用してインポートする証明書を構成しを使用してロール パラメーターを指定する-EffectiveDate パラメーターを持つ。</span><span class="sxs-lookup"><span data-stu-id="2e562-195">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="2e562-196">有効日は、現在の証明書の有効期限 (14:00:00 または 2:00:00 PM) から少なくとも 24 時間を引いた値で定義します。</span><span class="sxs-lookup"><span data-stu-id="2e562-196">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus a minimum of 24 hours.</span></span> 
    
    <span data-ttu-id="2e562-197">セット-CsCertificate は - ロールと EffectiveTime のパラメーターを使用してコマンドします。</span><span class="sxs-lookup"><span data-stu-id="2e562-197">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
   ```

<span data-ttu-id="2e562-198">Set-CsCertificate コマンドの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2e562-198">An example Set-CsCertificate command:</span></span>
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> <span data-ttu-id="2e562-199">EffectiveDate は、サーバーの地域と言語の設定に一致するようにフォーマットしなければなりません。</span><span class="sxs-lookup"><span data-stu-id="2e562-199">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="2e562-200">この例で使用している地域と言語の設定は英語 (米国) です。</span><span class="sxs-lookup"><span data-stu-id="2e562-200">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="2e562-201">有効時刻 (2015 年 7 月 21 日午前 1:00) になると、新しいトークンはすべて新しい証明書によって発行されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-201">When the effective time is reached (7/21/2015 1:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="2e562-202">トークンを検証する場合、トークンはまず新しい証明書に照らして検証されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-202">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="2e562-203">検証が失敗した場合は、古い証明書が試されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-203">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="2e562-204">新しい証明書を試してから古い証明書にフォールバックするこのプロセスは、古い証明書の有効期限まで続きます。</span><span class="sxs-lookup"><span data-stu-id="2e562-204">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="2e562-205">古い証明書の有効期限が切れた後は (2015 年 7 月 22 日午後 2:00)、トークンは新しい証明書のみを使用して検証されます。</span><span class="sxs-lookup"><span data-stu-id="2e562-205">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="2e562-206">古い証明書を削除 CsCertificate コマンドレットを使用して安全に削除する前のパラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="2e562-206">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a><span data-ttu-id="2e562-207">関連項目</span><span class="sxs-lookup"><span data-stu-id="2e562-207">See also</span></span>

[<span data-ttu-id="2e562-208">サーバーからサーバーへの認証 (OAuth) とパートナーのアプリケーションで Skype ビジネス サーバーを管理します。</span><span class="sxs-lookup"><span data-stu-id="2e562-208">Manage server-to-server authentication (OAuth) and partner applications in Skype for Business Server</span></span>](server-to-server-and-partner-applications.md)

[<span data-ttu-id="2e562-209">セット CsCertificate</span><span class="sxs-lookup"><span data-stu-id="2e562-209">Set-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[<span data-ttu-id="2e562-210">削除 CsCertificate</span><span class="sxs-lookup"><span data-stu-id="2e562-210">Remove-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)
