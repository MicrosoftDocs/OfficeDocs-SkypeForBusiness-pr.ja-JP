---
title: Skype for Business Server 2015 での常設チャット サーバーの高可用性および障害復旧の構成
ms.reviewer: ''
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 2/7/2018
ms.audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.assetid: 5fb5b189-56c1-49cf-92c8-e4fd6e2fdd5c
description: '概要: ビジネス サーバー 2015 の Skype での永続的なチャット サーバーの高可用性と障害回復を構成する方法の詳細については、このトピックを読みます。'
ms.openlocfilehash: 7bc1ae0b71df3916c36acfdc7fabce91caa297e8
ms.sourcegitcommit: 111bf6255fa877b3fce70fa8166e8ec5a6643434
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32225449"
---
# <a name="configure-high-availability-and-disaster-recovery-for-persistent-chat-server-in-skype-for-business-server-2015"></a>Skype for Business Server 2015 での常設チャット サーバーの高可用性および障害復旧の構成
 
**の概要:** ビジネス サーバー 2015 の Skype での永続的なチャット サーバーの高可用性と障害回復を構成する方法の詳細については、このトピックを参照してください。
  
ビジネス サーバー用の Skype は、バック エンド サーバー、データベース ・ ミラーリングなどの複数の高可用性モードをサポートします。 詳細については、「[Plan for high availability and disaster recovery in Skype for Business Server 2015](../../plan-your-deployment/high-availability-and-disaster-recovery/high-availability-and-disaster-recovery.md)」を参照してください。
  
> [!NOTE]
> AlwaysOn 可用性グループは、永続的なチャット サーバーではサポートされていません。 

> [!NOTE] 
> 永続的なチャットですがビジネス サーバー 2015 の Skype で利用可能なビジネス サーバー 2019 の Skype でサポートされていません。 同じ機能は、チームで使用できます。 詳細については、[マイクロソフトのチームにビジネス用の Skype からの旅](/microsoftteams/journey-skypeforbusiness-teams)を参照してください。 永続的なチャットを使用する場合は、選択肢は、いずれかをチームでは、この機能を必要とするユーザーを移行するまたはビジネス サーバー 2015 の Skype を使用し続ける。
  
高可用性と災害復旧について、永続的なチャットの展開を構成する前に、[高可用性とビジネス サーバー 2015 の Skype での永続的なチャット サーバーの障害回復の計画](../../plan-your-deployment/persistent-chat-server/high-availability-and-disaster-recovery.md)の概念に精通していることを確認します。 拡大された永続的なチャット サーバー プールの永続的なチャット サーバーがこれらのトピックで説明されている災害復旧ソリューションがビルドされます。 計画の内容は、リソース要件、および永続的なチャット サーバーは、SQL Server のミラーリングを使用して、高い可用性と SQL Server のログ配布を含む、高可用性と災害復旧を可能にする拡大されたプール トポロジについて説明します。災害復旧します。
  
## <a name="use-topology-builder-to-configure-high-availability-and-disaster-recovery"></a>トポロジ ビルダーを使用して高可用性と障害復旧を構成する

トポロジ ビルダーで、次の手順に従って常設チャット サーバーのための高可用性と障害復旧を構成します。
  
1. ミラー データベースとログ配布セカンダリ データベースの SQL Server の格納を追加します。
    
2. 永続的なチャット サーバー サービスのプロパティを編集します。
    
    a. プライマリ データベースのミラーリングを有効にします。
    
    b. プライマリ ・ ミラーの SQL Server ストアを追加します。
    
    c. SQL Server のログ配布のデータベースを有効にします。
    
    d. SQL Server のログ配布のセカンダリ SQL Server ストアを追加します。
    
    e。 セカンダリ データベースの SQL Server ストアのミラーを追加します。
    
    f。 トポロジを公開します。
    
## <a name="set-up-sql-server-log-shipping-for-the-persistent-chat-server-primary-database"></a>常設チャット サーバーのプライマリ データベースの SQL Server ログ配布を設定する

SQL Server Management Studio を使用すると、永続的なチャット サーバー セカンダリ ログ配布のデータベースのインスタンスに接続し、SQL Server エージェントが実行されていることを確認します。 プライマリ ・ データベースの永続的なチャット インスタンスに接続し、次の手順を実行します。
  
1. mgc データベースを右クリックし、[**プロパティ**] をクリックします。
    
2. [**ページの選択**] で、[**トランザクション ログの配布**] をクリックします。
    
3. [**ログ配布構成のプライマリ データベースとして有効にする**] チェック ボックスをオンにします。
    
4. [**トランザクション ログのバックアップ**] で、[**バックアップの設定**] をクリックします。
    
5. [**バックアップ フォルダーのネットワーク パスを指定する**] ボックスに、トランザクション ログのバックアップ用に作成した共有フォルダーへのネットワーク パスを入力します。
    
6. バックアップ フォルダーがプライマリ サーバーに存在する場合は、[**バックアップ フォルダーがプライマリ サーバーに存在する場合は、バックアップ フォルダーのローカル パスを入力 (例: c:\backup)**] ボックスにバックアップ フォルダーのローカル パスを入力します (バックアップ フォルダーがプライマリ サーバーに存在しない場合は、このボックスを空のままにします)。
    
    > [!IMPORTANT]
    > プライマリ サーバー上の SQL Server サービス アカウントは、ローカル システム アカウントで実行する場合は、プライマリ サーバーで、バックアップ フォルダーを作成し、そのフォルダーのローカル パスを指定する必要があります。 
  
7. [**次の期間を経過したファイルを削除する**] パラメーターと [**バックアップが次の期間内に行われない場合は警告する**] パラメーターを構成します。
    
8. [**バックアップ ジョブ**] の [**スケジュール**] ボックスに一覧表示されるバックアップ スケジュールを確認してください。 インストールのスケジュールをカスタマイズするには、**スケジュール**] をクリックし、必要に応じて SQL Server エージェントのスケジュールを調整します。
    
9. [**圧縮**] の [**既定のサーバー設定を使用する**] を選択し、[**OK**] をクリックします。
    
10. [**セカンダリ サーバー インスタンスとデータベース**] で、[**追加**] をクリックします。
    
11. [**接続**] をクリックし、セカンダリ サーバーとして構成した SQL Server のインスタンスに接続します。
    
12. [**セカンダリ データベース**] ボックスで、一覧から [**mgc**] データベースを選択します。
    
13. [**セカンダリ データベースの初期化**] タブで、[**はい、プライマリ データベースの完全バックアップを生成して、セカンダリ データベースに復元します**] オプションを選択します (また、セカンダリ データベースが存在しない場合は作成します)。
    
14. [**ファイルのコピー**] タブの [**ファイルのコピー先フォルダー**] ボックスに、トランザクション ログのバックアップのコピー先フォルダーのパスを入力します。このフォルダーは通常はセカンダリ サーバー上にあります。
    
15. [**コピー ジョブ**] の [**スケジュール**] ボックスに一覧表示されるコピー スケジュールを確認します。 インストールのスケジュールをカスタマイズするには、**スケジュール**] をクリックし、必要に応じて SQL Server エージェントのスケジュールを調整します。 このスケジュールは、バックアップ スケジュールとよく似た内容にする必要があります。
    
16. [**復元**] タブの [**バックアップ復元時のデータベース状態**] で、[**復旧モードなし**] オプションを選択します。
    
17. [**バックアップの復元を最低限次の期間遅延する**] で [**0 分**] を選択します。
    
18. [**復元が次の期間内に行われない場合は警告する**] で警告のしきい値を選択します。
    
19. [**復元ジョブ**] の [**スケジュール**] ボックスに一覧表示される復元スケジュールを確認します。 インストールのスケジュールをカスタマイズするには、[**スケジュール**] をクリックして **]** を必要に応じて、SQL Server エージェントのスケジュールを調整します。 このスケジュールは、バックアップ スケジュールとよく似た内容にする必要があります。
    
20. [**データベースのプロパティ**] ダイアログ ボックスで、[**OK**] をクリックして構成のプロセスを開始します。
    
## <a name="set-up-sql-server-log-shipping-between-the-primary-mirror-and-the-secondary-database"></a>プライマリ ミラーとセカンダリ データベースとの間の SQL Server ログ配布をセットアップする

ログ配布のプライマリの永続的なチャットのデータベースは、ミラー データベースにフェールオーバーしているかを続行するには、次の手順を実行します。
  
1. 手動でミラーを永続的なチャットのプライマリ データベースにフェールオーバーします。 これは、Skype をビジネス サーバー管理シェルを**呼び出し CsDatabaseFailover**コマンドレットを使用して行われます。
    
2. SQL Server Management Studio を使用すると、永続的なチャット サーバーのプライマリ ・ ミラー ・ インスタンスに接続します。
    
3. SQL Server エージェントが実行されていることを確認します。
    
4. mgc データベースを右クリックし、[**プロパティ**] をクリックします。
    
5. [**ページの選択**] で、[**トランザクション ログの配布**] をクリックします。
    
6. [**ログ配布構成のプライマリ データベースとして有効にする**] チェック ボックスをオンにします。
    
7. [**トランザクション ログのバックアップ**] で、[**バックアップの設定**] をクリックします。
    
8. [**バックアップ フォルダーのネットワーク パスを指定する**] ボックスに、トランザクション ログのバックアップ フォルダーとして作成した共有場所へのネットワーク パスを入力します。
    
9. バックアップ フォルダーがプライマリ サーバーに存在する場合は、[**バックアップ フォルダーがプライマリ サーバーに存在する場合は、バックアップ フォルダーのローカル パスを入力**] ボックスにバックアップ フォルダーのローカル パスを入力します (バックアップ フォルダーがプライマリ サーバーに存在しない場合は、このボックスを空のままにします)。
    
    > [!IMPORTANT]
    > プライマリ サーバー上の SQL Server サービス アカウントは、ローカル システム アカウントで実行する場合は、プライマリ サーバーで、バックアップ フォルダーを作成し、そのフォルダーのローカル パスを指定する必要があります。 
  
10. [**次の期間を経過したファイルを削除する**] パラメーターと [**バックアップが次の期間内に行われない場合は警告する**] パラメーターを構成します。
    
11. [**バックアップ ジョブ**] の [**スケジュール**] ボックスに一覧表示されるバックアップ スケジュールを確認してください。 インストールのスケジュールをカスタマイズするには、**スケジュール**] をクリックし、必要に応じて、SQL Server エージェントのスケジュールを調整します。
    
    > [!IMPORTANT]
    > プライマリ データベースと同じ設定を使用します。 
  
12. [**圧縮**] で、[**既定のサーバー設定を使用する**] をクリックし、[**OK**] をクリックします。
    
13. [**セカンダリ サーバー インスタンスとデータベース**] で、[**追加**] をクリックします。
    
14. [**接続**] をクリックして、セカンダリ サーバーとして構成した SQL Server のインスタンスに接続します。
    
15. [**セカンダリ データベース**] ボックスで、一覧から [**mgc**] データベースを選択します。
    
16. [**セカンダリ データベースの初期化**] タブで、[**いいえ、セカンダリ データベースは初期化されています**] オプションをクリックします。
    
17. [**ファイルのコピー**] タブの [**ファイルのコピー先フォルダー**] に、トランザクション ログのバックアップをコピーするフォルダーのパスを入力して、[**OK**] をクリックします。多くの場合、このフォルダーは、セカンダリ サーバー上にあります。
    
18. [**スクリプトの構成**] ボックスの一覧を開き、[**スクリプト構成を新規クエリ ウィンドウに保存**] をクリックします。
    
19. [**データベースのプロパティ**] に表示された新規クエリ ウィンドウで [**OK**] をクリックして、構成プロセスを開始します。
    
20. 選択し、クエリの最初の実行 (を参照してください手順 18) 上の行に:- \* \* \* \* \* \*終了: プライマリ ・ サイトで実行するスクリプト: \* \* \* \* \* \*。
    
    > [!IMPORTANT]
    > このスクリプトを手動で実行すると、SQL Server Management Studio は、SQL Server ログ配布構成の複数のプライマリ ・ データベースをサポートしていないために、必要があります。 
  
21. [**キャンセル**] をクリックして、ログ配布構成パネルを閉じ、プライマリ データベースとミラー化されたデータベース (フェールオーバー時) の両方でログ ファイルの配布を適切に実装する実用的なセットアップを確立します。 
    
22. プライマリに永続的なチャットのプライマリ ・ データベースの手動でフェイル バックします。 これは、Skype をビジネス サーバー管理シェル、および**呼び出し CsDatabaseFailover**コマンドレットを使用して行われます。
    

