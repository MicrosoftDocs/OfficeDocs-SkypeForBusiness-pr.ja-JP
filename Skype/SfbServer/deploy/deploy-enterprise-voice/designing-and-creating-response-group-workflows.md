---
title: Skype for Business 2015 での応答グループ ワークフローの設計と作成
ms.author: kenwith
author: kenwith
manager: serdars
ms.date: 2/7/2018
ms.audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.custom: Strat_SB_Admin
ms.assetid: dcb9effb-5d12-4dee-80fc-ab9654222d5a
description: 設計し、ビジネス サーバーのエンタープライズ VoIP の Skype で応答グループのワークフローを作成します。 ハント グループ ワークフローと対話ワークフローの両方について説明します。
ms.openlocfilehash: acbe37456f644ab387da57942cccf8fee527a16e
ms.sourcegitcommit: 7d819bc9eb63bfd85f5dada09f1b8e5354c56f6b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
---
# <a name="designing-and-creating-response-group-workflows-in-skype-for-business-2015"></a>Skype for Business 2015 での応答グループ ワークフローの設計と作成
 
設計し、ビジネス サーバーのエンタープライズ VoIP の Skype で応答グループのワークフローを作成します。 ハント グループ ワークフローと対話ワークフローの両方について説明します。
  
ワークフローは、電話への着信から、だれかが呼び出しに応答するまでの通話の動作を定義します。 ワークフローは呼び出しを保持するために使用するキューを指定し、対話型応答グループ ワークフローに使用するハント グループのワークフローや、質疑応答に使用するルーティング方法を指定します。 
  
また、ワークフローは、開始メッセージ、保留音、営業時間、休日などの設定も定義します。
  
> [!NOTE]
> エージェント グループとキューは、これらを使用するワークフローの作成前に作成しておく必要があります。 
  
## <a name="creating-or-modifying-a-hunt-group-workflow"></a>作成またはハント グループのワークフローを変更します。

### <a name="to-use-response-group-configuration-tool-to-create-or-modify-a-hunt-group-workflow"></a>作成またはハント グループのワークフローを変更する応答グループ構成ツールを使用するには

1. RTCUniversalServerAdmins グループのメンバーまたは応答グループをサポートする定義済みの管理者の役割のいずれかのメンバーとしてログオンします。
    
2. 、ブラウザー ウィンドウを開き、を開くには、Skype ビジネス サーバーのコントロール パネルの管理 URL を入力します。  
    
3. 左側のナビゲーション バーで、[**応答グループ**] をクリックし、[**ワークフロー**] をクリックします。
    
4. [**ワークフロー**] ページで、[**ワークフローの作成または編集**] をクリックします。
    
5. **サービスを選択して**検索フィールドに、作成または変更するワークフローをホストする**アプリケーション サーバー**のサービスの名前のすべてまたは一部を入力します。 表示されたサービスの一覧で、目的のサービスをクリックし、[**OK**] をクリックします。
    
    > [!NOTE]
    > 応答グループ構成ツールを開きます。 次の URL を入力して、web ブラウザーから直接応答グループ構成ツールを開くことができますも: https:// _ \<webPoolFqdn\>_/RgsConfig。 
  
6. 次のいずれかの操作を行います。
    
   - [**新規ワークフローの作成**] で、[**ハント グループ**] の横にある [作成] をクリックします。
    
   - [**既存ワークフローの管理**] で変更するワークフローを見つけて、[**アクション**] の [**編集**] をクリックします。
    
7. ユーザーがワークフローへの通話を開始する準備ができている場合は、[**ワークフローのアクティブ化**] を選択します。
    
    > [!NOTE]
    >  管理ワークフローを作成する場合は、[**ワークフローのアクティブ化**] を選択する必要があります。アクティブな管理ワークフローを保存した後、そのワークフローを変更したり、非アクティブ化したりできます。 
  
8. フェデレーション ユーザーにグループへの通話を許可するには、[**フェデレーションを有効にする**] チェック ボックスをオンにします。 フェデレーション用に構成された応答グループ アプリケーションに適用される外部アクセス ポリシーも必要です。
    
    > [!NOTE]
    > グローバル外部アクセス ポリシーは、応答グループ アプリケーションに適用されます。 ビジネス サーバーのコントロール パネルの Skype を使用して、または**セット CsExternalAccessPolicy**コマンドレットを使用して、EnableOutsideAccess パラメーターを True に設定して、応答グループのフェデレーション用のグローバル ポリシーを構成できます。 グローバル ポリシー設定は、サイトやユーザー ポリシーに割り当てられていない限り、すべてのユーザーに適用されることに注意してください。 そのため、応答グループ向けにこの設定を変更する前に、フェデレーション設定が組織の要件を満たしていることを確認してください。 ユーザーにポリシーを適用する方法に関する詳細については、[組織の外部アクセス ポリシーの管理](http://technet.microsoft.com/library/5571811e-34c8-443a-b94c-1ab5d4275581.aspx)を参照してください。 フェデレーション設定の詳細については、[一連の CsExternalAccessPolicy](https://docs.microsoft.com/powershell/module/skype/set-csexternalaccesspolicy?view=skype-ps)を参照してください。 
  
    > [!NOTE]
    > ビジネス オンラインの Skype でホストされているユーザーは、設置型展開でホストされている応答グループへの呼び出しを配置することはできません。 これは、両方のハイブリッド展開では、Skype のオンライン ビジネスの展開で、設置型展開のフェデレーション場所の場合は true。 
  
9. 通話中、エージェントの ID を非表示にするには、[**エージェントの匿名性を有効にする**] チェック ボックスをオンにします。
    
    > [!NOTE]
    > 匿名の通話は、インスタント メッセージング (IM) やビデオから開始することはできません。ただし、通話の確立後、エージェントまたは発信者が IM やビデオを追加することはできます。匿名のエージェントは、通話の保留、通話の転送 (無条件転送と取次転送)、および通話の保留と保留解除を行うこともできます。匿名の通話では、会議、アプリケーション共有とデスクトップ共有、ファイル転送、ホワイトボードとデータのグループ作業、および通話の記録はサポートされません。Lync VDI プラグインを使用するエージェントは、着信通話を匿名で受信できますが、発信通話を匿名で行うことはできません。 
  
10. [**通話を受けるグループのアドレスを入力します**] に、ワークフローへの通話に応答するグループのプライマリ SIP Uniform Resource Identifier (URI) アドレスを入力します。
    
    > [!NOTE]
    > ワークフローのプライマリ URI は、ワークフローをどのように識別および参照するかを表します。 SIP URI を入力するには、Active Directory ドメイン サービスの連絡先オブジェクトとして作成されます。 URI を作成するには、オブジェクトを Active Directory 内で一意にする必要があります。 
  
11. **名を表示**するには、(たとえば、売り上げ高応答グループ) のワークフローを表示する名前を入力します。
    
    > [!NOTE]
    > 表示名に「<」または「>」という文字を含めないでください。次の表示名は予約されているため、使用しないでください。**RGS Presence Watcher** または **Announcement Service**。 
  
12. [**電話番号**] に、応答グループの回線 URI を入力します (入力例 +14255550165)。
    
13. [**表示番号**] に、応答グループに対して表示する番号を入力します (入力例 +1 (425) 555-0165)。
    
14. (省略可能)**説明**ビジネスの Skype の連絡先カードに表示するワークフローの説明を入力します。
    
15. このワークフローを応答グループのマネージャーが管理する場合は、[**ワークフローの種類**] で [**管理**] を選択します。 ワークフローに応答グループの管理者を割り当てるには、次の操作を行います。
    
    a. このワークフローのマネージャーの SIP URI を入力して、[**追加**] をクリックします。
    
    b. ワークフローに追加するマネージャーの SIP URI を入力して、[**追加**] をクリックします。
    
    > [!IMPORTANT]
    > 応答グループのマネージャーに指定されているすべてのユーザーに CsResponseGroupManager ロールを割り当てる必要があります。このロールが割り当てられていない場合、ユーザーは応答グループを管理できません。 
  
16. [**ステップ 2 言語の選択**] で、音声認識と音声合成で使用する言語をクリックします。
    
17. 開始メッセージを構成する場合は、[**ステップ 3 開始メッセージの構成**] で [**開始メッセージを再生する**] チェック ボックスをオンにして、次のいずれかの操作を行います。
    
   - 発信者用の音声に変換される開始メッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスに開始メッセージを入力します。
    
    > [!NOTE]
    > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
   - 開始メッセージに Wave (.wav) または Windows Media オーディオ (.wma) ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するオーディオ ファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
    > [!NOTE]
    > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているファイル形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
18. [**ステップ 4 営業時間の指定**] の [**タイム ゾーン**] で、ワークフローのタイム ゾーンをクリックします。
    
    > [!NOTE]
    > このタイム ゾーンは、ワークフローの発信者とエージェントの所在地のタイム ゾーンです。これを使用して、始業時間と終業時間が計算されます。たとえば、北アメリカ東部標準時を使用するようにワークフローが構成されており、ワークフローで始業が午前 7:00、終業が午後 11:00 にスケジュールされている場合は、東部標準時の 7:00 と 23:00 がそれぞれ始業時刻と終業時刻になります (時間は 24 時間表記で入力する必要があります)。 
  
19. 次のいずれかの操作を実行して、使用する営業時間スケジュールの種類を選択します。
    
   - 事前に定義した営業時間スケジュールを使用するには、[**プリセット スケジュールを使用する**] をクリックして、ドロップダウン リストから使用するスケジュールを選択します。
    
     > [!NOTE]
     > このオプションを選択できるようにするには、あらかじめ少なくとも 1 つのプリセット スケジュールを定義しておく必要があります。 **New-CSRgsHoursOfBusiness** コマンドレットを使用してプリセット スケジュールを定義します。 詳細については、 [Skype のビジネス 2015年で営業時間 (をオプション) 応答グループの定義](optional-define-response-group-business-hours.md)を参照してください。 
  
     > [!NOTE]
     > プリセット スケジュールを選択すると、応答グループの対応日時で、[**曜日**]、[**開始**]、[**終了**] が自動的に設定されます。
  
   - このワークフローのみに適用するカスタム スケジュールを使用するには、[**カスタム スケジュールを使用する**] をクリックします。
    
20. このワークフロー用のカスタム スケジュールを作成する場合は、応答グループが対応可能な曜日のチェック ボックスをオンにします。
    
21. カスタム スケジュールを作成する場合は、応答グループが対応可能な各曜日の [**開始**] 時間と [**終了**] 時間を入力します。
    
    > [!NOTE]
    > [**開始**] 時間と [**終了**] 時間は 24 時間表記で入力する必要があります。たとえば、職場の営業時間が営業日の 9 時から 5 時までで、昼休みのために正午にオフィスを一度閉める場合、営業時間は [**開始**] 9:00、[**終了**] 12:00、[**開始**] 13:00、[**終了**] 17:00 として指定します。
  
22. 営業時間外にメッセージを再生するには、[**応答グループの営業時間外にメッセージを再生する**] チェック ボックスをオンにしてから、次のいずれかの操作を実行して再生するメッセージを指定します。
    
   - 発信者用に音声に変換されるメッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスにメッセージを入力します。
    
     > [!NOTE]
     > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
   - メッセージにオーディオ ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
     > [!NOTE]
     > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているオーディオ ファイルの形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
23. メッセージが構成されている場合は、メッセージ再生後の通話の処理方法を次のように指定します。
    
   - 通話を終了するには、[**終話**] をクリックします。
    
   - 通話をボイス メールに転送するには、[**ボイス メールに転送**] をクリックして、ボイス メール アドレスを入力します。 ボイス ・ メール ・ アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_(たとえば、bob@contoso.com)。
    
   - 通話を別のユーザーに転送するには、[**SIP URI に転送**] をクリックして、ユーザー アドレスを入力します。 ユーザー アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_。
    
   - 通話を別の電話番号に転送するには、[**電話番号に転送**] をクリックして、電話番号を入力します。 電話番号の形式は、_\<数\>_@ _\<ドメイン名\>_(+14255550121@contoso.com など)。 発信者は、ドメイン名を使用して適切な宛先にルーティングされます。
    
24. [**ステップ 5 休日の指定**] で、応答グループが営業しない日を定義する、1 つまたは複数の休日セットのチェック ボックスをオンにします。
    
    > [!NOTE]
    > ワークフローを構成する前に、休日および休日セットを定義する必要があります。 休日および休日セットを定義するには、**New-CsRgsHoliday** コマンドレットおよび **New-CsRgsHolidaySet** コマンドレットを使用します。 詳細については、[ビジネス 2015年の Skype での定義 (省略可能) の応答グループ休日セット](optional-define-response-group-holiday-sets.md)を参照してください。 
  
25. 休日にメッセージを再生するには、[**休日にメッセージを再生する**] チェック ボックスをオンにしてから、次のいずれかの操作を実行して再生するメッセージを指定します。
    
  - 発信者用に音声に変換されるメッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスにメッセージを入力します。
    
    > [!NOTE]
    > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
   - メッセージにオーディオ ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
     > [!NOTE]
     > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているオーディオ ファイルの形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
26. メッセージが構成されている場合は、メッセージ再生後の通話の処理方法を次のように指定します。
    
   - 通話を終了するには、[**終話**] をクリックします。
    
   - 通話をボイス メールに転送するには、[**ボイス メールに転送**] をクリックして、ボイス メール アドレスを入力します。 ボイス ・ メール ・ アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_(たとえば、bob@contoso.com)。
    
   - 通話を別のユーザーに転送するには、[**SIP URI に転送**] をクリックして、ユーザー アドレスを入力します。 ユーザー アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_。
    
   - 通話を別の電話番号に転送するには、[**電話番号に転送**] をクリックして、電話番号を入力します。 電話番号の形式は、_\<数\>_@ _\<ドメイン名\>_(+14255550121@contoso.com など)。 発信者は、ドメイン名を使用して適切な宛先にルーティングされます。
    
27. [**ステップ 6 キューの構成**] の [**通話を受け取るキューを選択します**] で、エージェントが応答可能になるまで発信者を保留するキューを選択します。
    
28. [**ステップ 7 保留音の構成**] で次のいずれかの操作を実行して、発信者がエージェントの応答を待機しているときの保留音を選択します。
    
   - 既定の保留音の録音を使用するには、[**既定値を使用する**] をクリックします。
    
   - 保留音にオーディオ ファイルの録音を使用するには、[**音楽ファイルを選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**音楽ファイル**] リンクをクリックします。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
     > [!NOTE]
     > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているオーディオ ファイルの形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
29. [**展開**] をクリックします。
    
### <a name="to-use-skype-for-business-server-management-shell-to-create-or-modify-a-hunt-group-workflow"></a>Skype ビジネス サーバー管理シェルを使用して作成または、ハント グループのワークフローを変更するのには

1. RTCUniversalServerAdmins グループのメンバーまたは応答グループをサポートする定義済みの管理者の役割のいずれかのメンバーとしてログオンします。
    
2. Skype for Business Server 管理シェルを以下の手順で起動します。[**スタート**]、[**すべてのプログラム**]、[**Skype for Business 2015**]、[**Skype for Business Server 管理シェル**] の順にクリックします。
    
3. 開始メッセージで再生されるプロンプトを作成し、変数に格納します。コマンド ラインで、次のコマンドを実行します。
    
   ```
   $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "<text for TTS prompt>"
   ```

    例:
    
   ```
   $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "Welcome to Contoso. Please wait for an available agent."
   ```

     > [!NOTE]
     > プロンプトのオーディオ ファイルを使用するには、**インポート CsRgsAudioFile**コマンドレットを使用します。 詳細については、[インポートの CsRgsAudioFile](https://docs.microsoft.com/powershell/module/skype/import-csrgsaudiofile?view=skype-ps)を参照してください。 
  
4. 通話が転送されることになるキューまたは質問の ID を取得します。コマンド ラインで、次のコマンドを実行します。
    
   ```
   $qid = (Get-CsRgsQueue -Name "Help Desk").Identity
   ```

    キューを作成する方法については、[新規 CsRgsQueue](https://docs.microsoft.com/powershell/module/skype/new-csrgsqueue?view=skype-ps)を参照してください。
    
5. 営業時間中にワークフローを開いたときに実行される既定のアクションを定義し、変数に格納します。コマンド ラインで、次のコマンドを実行します。
    
   ```
   $actionWM = New-CsRgsCallAction -Prompt <saved prompt from previous step> -Action <action to be taken> -QueueID $qid
   ```

    > [!NOTE]
    > ハント グループ ワークフローでは、既定のアクションにより通話がキューに転送される必要があります。アクティブなワークフローでは、このパラメーターが必要です。非アクティブなワークフローでは不要です。 
  
    例:
    
   ```
   $actionWM = New-CsRgsCallAction -Prompt $promptWM -Action TransferToQueue -QueueID $qid.Identity
   ```

6. 営業時間と休日を定義する場合は、ワークフローを作成または変更する前に、営業時間と休日を作成する必要があります。 詳細については、[ビジネス 2015年の Skype での定義 (省略可能) の応答グループ営業時間](optional-define-response-group-business-hours.md)および[ビジネス 2015年の Skype での定義 (省略可能) の応答グループ休日セット](optional-define-response-group-holiday-sets.md)を参照してください。
    
7. 営業時間外や休日に受信した呼び出しの入力を要求する場合は、**新規 CsRgsPrompt**コマンドレットを使用して、プロンプトを定義し、**新規 CsRgsCallAction**を使用して、プロンプトの後に実行するアクションを定義するのには。 詳細については、[新規 CsRgsPrompt](https://docs.microsoft.com/powershell/module/skype/new-csrgsprompt?view=skype-ps)および[新しい CsRgsCallAction](https://docs.microsoft.com/powershell/module/skype/new-csrgscallaction?view=skype-ps)を参照してください。
    
8. Lync Server の応答グループ サービスのサービス名を取得し、変数に割り当てます。 コマンド ラインで、次のコマンドを実行します。
    
   ```
   $serviceId="service:"+(Get-CSService | ?{$_.Applications -like "*RGS*"}).ServiceId;
   ```

9. ワークフローを作成または変更します。 ワークフローを作成するには、**新規 CsRgsWorkflow**を使用します。 ワークフローを変更するには、**セット CsRgsWorkflow**を使用します。 コマンドラインで、次のように入力します。
    
   ```
   $workflowHG = New-CsRgsWorkflow -Parent <service ID for the Response Group service> -Name "<hunt group name>" [-Description "<hunt group description>"] -PrimaryUri "<SIP address for the workflow>" [-LineUri "<Phone number for the workflow>"] [-DisplayNumber "<Phone number displayed in Lync>"] [-Active <$true | $false>] [-Anonymous <$true | $false>] [-DefaultAction <variable from preceding step>] [-EnabledForFederation <$true | $false>] [-Managed <$true | $false>] [-MangersByUri <SIP addresses for Response Group Managers who can manage the workflow>]
   ```

    例:
    
   ```
   $workflowHG = New-CsRgsWorkflow -Parent $serviceID -Name "Human Resources" -Description "Human Resources workflow" -PrimaryUri "sip:humanresources@contoso.com" -LineUri "TEL:+14255551219" -DisplayNumber "555-1219" -Active $true -Anonymous $true -DefaultAction $actionWM -EnabledForFederation $false -Managed $true -ManagersByUri "sip:bob@contoso.com", "mindy@contoso.com"
   ```

     > [!IMPORTANT]
     > ワークフローのマネージャーに指定されているすべてのユーザーに CsResponseGroupManager ロールを割り当てる必要があります。 
  
     > [!NOTE]
     > その他の省略可能なパラメーターの詳細については、「[新規 CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/new-csrgsworkflow?view=skype-ps)または[セット CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/set-csrgsworkflow?view=skype-ps)の使用」を参照していますください。
  
## <a name="designing-an-interactive-workflow"></a>対話ワークフローの設計

対話型音声応答 (IVR) を使用すると、発信者から情報を取得し、通話を適切なキューに転送できます。 使用するキューは質問と回答のペアによって決定されます。 、呼び出し元の応答によって、呼び出し元は、フォロー アップの質問を聞くことするか、または適切なキューにルーティングされます。 IVR の質問と、呼び出し元の応答は、貴重な情報をエージェントに提供することを 1 回の呼び出しには応答側のエージェントに提供されます。
  
### <a name="overview-of-ivr-features"></a>IVR 機能の概要

応答グループ アプリケーションでは、音声認識および 26 の言語で音声合成機能を提供します。 IVR の質問は、音声合成や wave (.wav) または Windows Media オーディオ (.wma) ファイルを使用して入力できます。 発信者は、音声またはデュアルトーン多重周波数 (DTMF) 応答を使用して応答できます。
  
対話ワークフローでは最高 2 問の質問がサポートされ、各質問には回答の選択肢を 4 つまで設定できます。 IVR は呼び出し元に、問い合わせを行い、呼び出し元の応答によって、呼び出し元をキューにルーティングや、2 つ目の質問。 2 番目の質問にも、4 つの回答を設定できます。 2 番目のレベルの質問に対する回答に応じて、発信者は適切なキューにルーティングされます。
  
> [!NOTE]
> Skype ビジネス サーバー管理シェルを使用して通話フローを設計するときは、任意番号レベルの IVR の質問と回答の任意の数を定義できます。 ただし、発信者の利便性を考え、3 問より多くの質問は使用せず、それぞれの回答の選択肢を 5 つ以下にするようお勧めします。 さらに、以上の 4 つの回答と質問の 2 つ以上のレベルを持つ呼び出しのフローを設計する場合は、Skype ビジネス サーバーのコントロール パネルを使用して呼び出しの流れを編集できません。 
  
IVR の質問と応答を呼び出し元の呼び出しには応答エージェントに提供されます。
  
### <a name="working-with-speech-technologies"></a>音声テクノロジの操作

音声認識や音声合成などの音声テクノロジにより、顧客のエクスペリエンスが強化され、情報へのより自然で効率的なアクセスが可能となります。ただし、指定したテキストやユーザーの音声応答が、音声エンジンによって正しく認識されない場合もあります。たとえば、"#" 記号は、音声合成エンジンによって "番号" という語に変換されます。この問題は、次の方法によって軽減されます。
  
- 音声エンジンにより、発信者は 5 回まで質問に回答することができます。発信者の質問に対する回答が不適切な場合 (回答が指定された応答のいずれでもない)、またはまったく回答がない場合には、発信者にもう一度その質問に回答する機会が与えられます。発信者は、通話が切断されるまでに 5 回質問に回答することができます。IVR は、発信者の回答に誤りがあるたびにカスタマイズしたメッセージを再生するように構成できます。質問は毎回繰り返されます。
    
- 音声エンジンによって周囲の雑音が応答として解釈される可能性を最小限に抑えるため、長めの応答を使用してください。たとえば、応答には複数の音節を含め、発音が相互に明確に異なるようにしてください。
    
- 質問に音声応答と DTMF 応答の両方が含まれる場合は、DTMF 応答ではなく概念を表す語句で音声応答を構成してください。たとえば、「1 を押すか 1 とお答えください」を使用する代わりに、「1 を押すか請求とお答えください」を使用します。
    
- IVR を設計したら、ワークフローを呼び出して質問を聞き、音声で各質問に応答して、IVR が正常に再生および動作することを確認します。その後、IVR を変更して、解釈の問題を修正できます。# キーを示す必要がある場合は、前の例に従って、# 記号ではなく、キー名を使用して IVR の質問を書き直すことができます。たとえば、「営業部門をご希望の場合は、シャープを押してください」とします。
    
### <a name="ivr-design-examples"></a>IVR 設計の例

以下のセクションでは、さまざまな IVR シナリオおよび質問と回答のペアの例を示します。 
  
#### <a name="ivr-with-one-level-of-questions"></a>1 問の質問が設定された IVR

次の例は、1 問の質問を使用する IVR を示しています。 呼び出し元の応答を検出するために音声認識を使用します。
  
 **質問:** 「人事部にお問い合わせいただき、ありがとうございます。給与課をご希望の場合は、給与課とお答えください。それ以外の場合は、人事部とお答えください。」
  
- **1 つ目のオプションが選択された場合:** 発信者は給与課にルーティングされます。
    
- **2 つ目のオプションが選択された場合:** 発信者は人事部にルーティングされます。
    
次の図は、通話の流れを示します。
  
 **1 問対話の通話の流れ**
  
![対話型音声応答の使用による通話フローの設計](../../media/Ops_OCS_RGS_IVRLevel1.jpg)
  
#### <a name="ivr-with-two-levels-of-questions"></a>2 問の質問が設定された IVR

次の例は、2 問の質問を使用する IVR を示しています。この例で発信者は、音声または DTMF キーパッド入力を使用して応答できます。
  
 **質問:** 「IT ヘルプ デスクにお問い合わせいただき、ありがとうございます。ネットワーク アクセスに問題がある場合は、1 を押すか、ネットワークとお答えください。ソフトウェアに問題がある場合は、2 を押すか、ソフトウェアとお答えください。ハードウェアに問題がある場合は、3 を押すか、ハードウェアとお答えください。」
  
- **1 つ目のオプションが選択された場合:** 発信者はネットワーク サポート チームにルーティングされます。
    
- **2 つ目のオプションが選択された場合:** 発信者には、追加の質問が行われます。
    
    **質問:** 「オペレーティング システムに問題がある場合は、1 を押すか、オペレーティング システムとお答えください。内部アプリケーションに問題がある場合は、2 を押すか、内部アプリケーションとお答えください。それ以外の場合は、3 を押すか、それ以外とお答えください。」
    
  - **1 つ目のオプションが選択された場合:** 発信者はオペレーティング システムのサポート チームにルーティングされます。
    
  - **2 つ目のオプションが選択された場合:** 発信者は内部アプリケーションのサポート チームにルーティングされます。
    
  - **3 つ目のオプションが選択された場合:** 発信者はソフトウェアのサポート チームにルーティングされます。
    
- **3 つ目のオプションが選択された場合:** 発信者には、追加の質問が行われます。
    
    **質問:** 「プリンターに問題がある場合は 1 を、それ以外の場合は 2 を押してください。」
    
  - **1 つ目のオプションが選択された場合:** 発信者はプリンターのサポート チームにルーティングされます。
    
  - **2 つ目のオプションが選択された場合:** 発信者はハードウェアのサポート チームにルーティングされます。
    
次の図は、通話の流れを示します。
  
 **2 問対話の通話の流れ**
  
![対話型音声応答の使用による通話フローの設計](../../media/Ops_OCS_RGS_IVRLevel2.jpg)
  
### <a name="best-practices"></a>ベスト プラクティス

以下に、IVR を設計する場合のベスト プラクティスをいくつか示します。
  
- 発信者がすばやくタスクに取りかかることができるようにする。過剰な情報や長いマーケティング メッセージを IVR に含めないようにする。
    
- 長いメッセージを含める場合は、開始メッセージの代わりに、最初の質問に追加することを考慮する。発信者は、そのメッセージが最初の質問の一部であれば、質問に回答することによって省略できるが、開始メッセージを省略することはできない。
    
- 呼び出し元の言語で話します。 堅苦しい言い回しを避ける。 自然に話す。
    
- 効率的かつ効果的な案内を記述する。 不要なオプションを削除する。 文の末尾が予想される応答を呼び出し元の情報を構造化します。 たとえば、「1 を押して、セールス ・ チームに話をする」。
    
- 音声応答をわかりやすいものにする。たとえば、DTMF 応答と音声応答の両方を指定する場合は、次のようにする。「営業部をご希望の場合は、1 を押すか、営業と答えてください。」
    
- 組織全体で展開する前に、ユーザーのグループで IVR をテストする。
    
## <a name="creating-or-modifying-an-interactive-workflow"></a>対話ワークフローの作成または変更

### <a name="to-use-response-group-configuration-tool-to-create-or-modify-an-interactive-workflow"></a>応答グループ構成ツールを使用して作成または、対話型のワークフローを変更するのには

1. RTCUniversalServerAdmins グループのメンバーまたは応答グループをサポートする定義済みの管理者の役割のいずれかのメンバーとしてログオンします。
    
2. 、ブラウザー ウィンドウを開き、を開くには、Skype ビジネス サーバーのコントロール パネルの管理 URL を入力します。  
    
3. 左側のナビゲーション バーで、[**応答グループ**] をクリックし、[**ワークフロー**] をクリックします。
    
4. [**ワークフロー**] ページで、[**ワークフローの作成または編集**] をクリックします。
    
5. **サービスを選択して**検索フィールドに、作成または変更するワークフローをホストする**アプリケーション サーバー**のサービスの名前のすべてまたは一部を入力します。 表示されたサービスの一覧で、目的のサービスをクリックし、[**OK**] をクリックします。
    
    > [!NOTE]
    > 応答グループ構成ツールを開きます。 次の URL を入力して、web ブラウザーから直接応答グループ構成ツールを開くことができますも: https:// _ \<webPoolFqdn\>_/RgsConfig。 
  
6. 次のいずれかの操作を行います。
    
   - [**新規ワークフローの作成**] の [**対話型**] の横にある [**作成**] をクリックします。
    
   - [**既存ワークフローの管理**] で変更するワークフローを見つけて、[**アクション**] の [**編集**] をクリックします。
    
7. ユーザーがワークフローへの通話を開始できる状態ではない場合は、[**ワークフローのアクティブ化**] チェック ボックスをオフにします。
    
    > [!NOTE]
    >  管理ワークフローを作成する場合は、[**ワークフローのアクティブ化**] を選択する必要があります。アクティブな管理ワークフローを保存した後、そのワークフローを変更したり、非アクティブ化したりできます。 
  
8. フェデレーション ユーザーにグループへの通話を許可するには、[**フェデレーションを有効にする**] チェック ボックスをオンにします。 フェデレーション用に構成された応答グループ アプリケーションに適用される外部アクセス ポリシーも必要です。
    
    > [!NOTE]
    > グローバル外部アクセス ポリシーは、応答グループ アプリケーションに適用されます。 ビジネス サーバーのコントロール パネルの Skype を使用して、または**セット CsExternalAccessPolicy**コマンドレットを使用して、EnableOutsideAccess パラメーターを True に設定して、応答グループのフェデレーション用のグローバル ポリシーを構成できます。 グローバル ポリシー設定は、サイトやユーザー ポリシーに割り当てられていない限り、すべてのユーザーに適用されることに注意してください。 そのため、応答グループ向けにこの設定を変更する前に、フェデレーション設定が組織の要件を満たしていることを確認してください。 ユーザーにポリシーを適用する方法に関する詳細については、[組織の外部アクセス ポリシーの管理](http://technet.microsoft.com/library/5571811e-34c8-443a-b94c-1ab5d4275581.aspx)を参照してください。 フェデレーション設定の詳細については、**セット CsExternalAccessPolicy**のマニュアルを参照してください.
  
    > [!NOTE]
    > ビジネス オンラインの Skype でホストされているユーザーは、設置型展開でホストされている応答グループへの呼び出しを配置することはできません。 これは、両方のハイブリッド展開では、Skype のオンライン ビジネスの展開で、設置型展開のフェデレーション場所の場合は true。 
  
9. 通話中、エージェントの ID を非表示にするには、[**エージェントの匿名性を有効にする**] チェック ボックスをオンにします。
    
    > [!NOTE]
    > 匿名の通話は、インスタント メッセージング (IM) やビデオから開始することはできません。ただし、通話の確立後、エージェントまたは発信者が IM やビデオを追加することはできます。匿名のエージェントは、通話の保留、通話の転送 (無条件転送と取次転送)、および通話の保留と保留解除を行うこともできます。匿名の通話では、会議、アプリケーション共有とデスクトップ共有、ファイル転送、ホワイトボードとデータのグループ作業、および通話の記録はサポートされません。Lync VDI プラグインを使用するエージェントは、着信通話を匿名で受信できますが、発信通話を匿名で行うことはできません。 
  
10. [**通話を受けるグループのアドレスを入力します**] に、ワークフローへの通話に応答するグループのプライマリ SIP Uniform Resource Identifier (URI) アドレスを入力します。
    
11. [**表示名**] に、ワークフローに表示する名前を入力します (入力例: Sales IVR Response Group)。
    
    > [!NOTE]
    > 含まれていない、"\<「または」\>"の表示名に文字。 次の表示名が予約されているため使用しないで: RG のプレゼンスの監視やサービスのお知らせします。 
  
12. [**電話番号**] に、応答グループの回線 URI を入力します (入力例 +14255550165)。
    
13. [**表示番号**] に、応答グループに対して表示する番号を入力します (入力例 +1 (425) 555-0165)。
    
14. (省略可能)[**説明**] に、ビジネスの Skype の連絡先カードに表示するワークフローの説明を入力します。 
    
15. このワークフローを応答グループのマネージャーが管理する場合は、[**ワークフローの種類**] で [**管理**] を選択します。 ワークフローに応答グループの管理者を割り当てるには、次の操作を行います。
    
    a. このワークフローのマネージャーの SIP URI を入力して、[**追加**] をクリックします。
    
    b. ワークフローに追加するマネージャーの SIP URI を入力して、[**追加**] をクリックします。
    
    > [!IMPORTANT]
    > 応答グループのマネージャーに指定されているすべてのユーザーに CsResponseGroupManager ロールを割り当てる必要があります。このロールが割り当てられていない場合、ユーザーは応答グループを管理できません。 
  
16. [**ステップ 2 言語の選択**] で、音声認識と音声合成で使用する言語をクリックします。
    
17. 開始メッセージを構成する場合は、[**ステップ 3 開始メッセージの構成**] で [**開始メッセージを再生する**] チェック ボックスをオンにして、次のいずれかの操作を行います。
    
    - 発信者用の音声に変換される開始メッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスに開始メッセージを入力します。
    
    > [!NOTE]
    > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
    - 開始メッセージに Wave または Windows Media オーディオ ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するオーディオ ファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
    > [!NOTE]
    > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているファイル形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
18. [**ステップ 4 営業時間の指定**] の [**タイム ゾーン**] ボックスで、ワークフローのタイム ゾーンをクリックします。
    
    > [!NOTE]
    > このタイム ゾーンは、ワークフローの発信者とエージェントの所在地のタイム ゾーンです。これを使用して、始業時間と終業時間が計算されます。たとえば、北アメリカ東部標準時を使用するようにワークフローが構成されており、ワークフローで始業が午前 7:00、終業が午後 11:00 にスケジュールされている場合は、東部標準時の 7:00 と 23:00 がそれぞれ始業時刻と終業時刻になります (時間は 24 時間表記で入力する必要があります)。 
  
19. 次のいずれかの操作を実行して、使用する営業時間スケジュールの種類を選択します。
    
   - 事前に定義した営業時間スケジュールを使用するには、[**プリセット スケジュールを使用する**] をクリックして、ドロップダウン リストから使用するスケジュールを選択します。
    
     > [!NOTE]
     > このオプションを選択できるようにするには、あらかじめ少なくとも 1 つのプリセット スケジュールを定義しておく必要があります。 **New-CSRgsHoursOfBusiness** コマンドレットを使用してプリセット スケジュールを定義します。 詳細については、 [Skype のビジネス 2015年で営業時間 (をオプション) 応答グループの定義](optional-define-response-group-business-hours.md)を参照してください。 プリセット スケジュールを選択すると、応答グループの対応日時で、[**曜日**]、[**開始**]、[**終了**] が自動的に設定されます。
  
   - このワークフローのみに適用するカスタム スケジュールを使用するには、[**カスタム スケジュールを使用する**] をクリックします。
    
20. このワークフロー用のカスタム スケジュールを作成する場合は、応答グループが対応可能な曜日のチェック ボックスをオンにします。
    
21. カスタム スケジュールを作成する場合は、応答グループが対応可能な [**開始**] 時間と [**終了**] 時間を入力します。
    
     > [!NOTE]
     > [**開始**] 時間と [**終了**] 時間は 24 時間表記で入力する必要があります。たとえば、職場の営業時間が営業日の 9 時から 5 時までで、昼休みのために正午にオフィスを一度閉める場合、営業時間は [**開始**] 9:00、[**終了**] 12:00、[**開始**] 13:00、[**終了**] 17:00 として指定します。
  
22. 営業時間外にメッセージを再生するには、[**応答グループの営業時間外にメッセージを再生する**] チェック ボックスをオンにしてから、次のいずれかの操作を実行して再生するメッセージを指定します。
    
    - 発信者用に音声に変換されるメッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスにメッセージを入力します。
    
     > [!NOTE]
     > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
    - メッセージにオーディオ ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
    > [!NOTE]
    > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているファイル形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
23. メッセージが構成されている場合は、メッセージ再生後の通話の処理方法を次のように指定します。
    
     - 通話を終了するには、[**終話**] をクリックします。
    
     - 通話をボイス メールに転送するには、[**ボイス メールに転送**] をクリックして、ボイス メール アドレスを入力します。 ボイス ・ メール ・ アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_(たとえば、bob@contoso.com)。
    
     - 通話を別のユーザーに転送するには、[**SIP URI に転送**] をクリックして、ユーザー アドレスを入力します。 ユーザー アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_。
    
     - 通話を別の電話番号に転送するには、[**電話番号に転送**] をクリックして、電話番号を入力します。 電話番号の形式は、_\<数\>_@ _\<ドメイン名\>_(+14255550121@contoso.com など)。 発信者は、ドメイン名を使用して適切な宛先にルーティングされます。
    
24. [**ステップ 5 休日の指定**] で、応答グループが営業しない日を定義する、1 つまたは複数の休日セットのチェック ボックスをオンにします。
    
    > [!NOTE]
    > ワークフローを構成する前に、休日および休日セットを定義する必要があります。 休日および休日セットを定義するには、**New-CsRgsHoliday** コマンドレットおよび **New-CsRgsHolidaySet** コマンドレットを使用します。 詳細については、[ビジネス 2015年の Skype での定義 (省略可能) の応答グループ休日セット](optional-define-response-group-holiday-sets.md)を参照してください。 
  
25. 休日にメッセージを再生するには、[**休日にメッセージを再生する**] チェック ボックスをオンにしてから、次のいずれかの操作を実行して再生するメッセージを指定します。
    
   - 発信者用に音声に変換されるメッセージをテキストとして入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスにメッセージを入力します。
    
     > [!NOTE]
     > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
   - メッセージにオーディオ ファイルの録音を使用するには、[**録音を選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**録音**] リンクをクリックしてください。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
     > [!NOTE]
     > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているオーディオ ファイルの形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
26. メッセージが構成されている場合は、メッセージ再生後の通話の処理方法を次のように指定します。
    
    - 通話を終了するには、[**終話**] をクリックします。
    
    - 通話をボイス メールに転送するには、[**ボイス メールに転送**] をクリックして、ボイス メール アドレスを入力します。 ボイス ・ メール ・ アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_(たとえば、bob@contoso.com)。
    
    - 通話を別のユーザーに転送するには、[**SIP URI に転送**] をクリックして、ユーザー アドレスを入力します。 ユーザー アドレスの形式は、_\<ユーザー名\>_@ _\<ドメイン名\>_。
    
    - 通話を別の電話番号に転送するには、[**電話番号に転送**] をクリックして、電話番号を入力します。 電話番号の形式は、_\<数\>_@ _\<ドメイン名\>_(+14255550121@contoso.com など)。 発信者は、ドメイン名を使用して適切な宛先にルーティングされます。
    
27. [**ステップ 6 保留音の構成**] で、次のいずれかの操作を実行して、発信者がエージェントの応答を待機しているときの保留音を選択します。
    
    - 既定の保留音の録音を使用するには、[**既定値を使用する**] をクリックします。
    
    - 保留音にオーディオ ファイルの録音を使用するには、[**音楽ファイルを選択する**] をクリックします。新しいオーディオ ファイルをアップロードする場合は、[**音楽ファイル**] リンクをクリックします。新しいブラウザー ウィンドウで [**参照**] をクリックし、使用するファイルを選択して、[**開く**] をクリックします。[**アップロード**] をクリックしてオーディオ ファイルを読み込みます。
    
    > [!NOTE]
    > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているファイル形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
28. [**ステップ 7 対話型音声応答の構成**] の [**ユーザーには、次のテキストまたは録音メッセージを再生します**] という見出しの下で、次のように発信者に対する質問を指定します。
    
    - 質問をテキスト形式で入力するには、[**音声合成を使用する**] をクリックして、テキスト ボックスに質問を入力します。
    
    > [!NOTE]
    > 入力するテキストに HTML タグを含めないでください。HTML タグを含めると、エラー メッセージが表示されます。 
  
    > [!NOTE]
    > "#" 記号は、音声合成エンジンによって "番号" という語に変換されます。 # キーを示す必要がある場合は、記号ではなく、キーの名前を質問に使用してください。 たとえば、「営業部門をご希望の場合は、シャープを押してください」とします。 
  
   - 質問を含む録音済みのオーディオ ファイルを使用する場合は、[**録音を選択する**] をクリックし、[**録音**] リンクをクリックしてファイルをアップロードします。 新しいブラウザー ウィンドウで [**参照**] をクリックし、オーディオ ファイルを選択して、[**開く**] をクリックします。 **アップロード**ファイルを読み込む] をクリックし、必要に応じて、質問を入力できます (これにより、質問と応答エージェントに転送するのには、呼び出し元の応答) のテキスト ボックスにします。
    
     > [!NOTE]
     > ユーザーが指定したすべてのオーディオ ファイルは、特定の要件を満たしている必要があります。 サポートされているファイル形式についての詳細は、[応答グループの技術的な要件](http://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx)を参照してください。 
  
29. [**応答 1**] で次の操作を実行して、質問に対する 1 つ目の回答を指定します。
    
    > [!IMPORTANT]
    > いずれの音声応答にも引用符 (") を使用しないでください。引用符は IVR が失敗する原因になります。 
  
    > [!NOTE]
    > 発信者が音声、英数字のキーパッド入力、または両方を使用して回答できるようにすることもできます。 
  
    - 発信者が音声で応答できるようにする場合は、[**音声応答の入力**] に応答を入力します。
    
    - 発信者がキーパッドのキー入力で応答できるようにする場合は、[**数字**] で、目的のキーパッドの数字をクリックします。
    
30. 次のように、発信者をキューにルーティングするか、もう 1 つ質問するかを指定します。
    
    - 発信者をキューにルーティングするには [**キューに送る**] をクリックし、[**キューの選択**] で、使用するキューをクリックします。
    
    - もう 1 つ質問をするには、[**もう 1 つ質問する**] をクリックしてから、[**音声合成を使用する**] をクリックして質問を入力するか、[**録音を選択する**] をクリックします。このセクションにある応答グループを使用して、追加の質問に対する最大 4 つの応答と、各応答で使用するキューを指定します。3 番目または 4 番目の応答を指定するには、[**応答 3**] チェック ボックスまたは [**応答 4**] チェック ボックスをオンにします。
    
31. 手順 28 と 29 を繰り返して応答と各応答に対するアクションを指定し、元の質問に対する回答を最大 3 つ追加します。3 番目または 4 番目の回答を指定するには、[**応答 3**] チェック ボックスまたは [**応答 4**] チェック ボックスをオンにします。
    
32. [**展開**] をクリックします。
    
### <a name="to-use-skype-for-business-server-management-shell-to-create-or-modify-an-interactive-workflow"></a>ビジネス サーバー管理シェルの Skype を使用して作成または、対話型のワークフローを変更するのには

1.  RTCUniversalServerAdmins グループのメンバーまたは応答グループをサポートする定義済みの管理者の役割のいずれかのメンバーとしてログオンします。
    
2. Skype for Business Server 管理シェルを以下の手順で起動します。[**スタート**]、[**すべてのプログラム**]、[**Skype for Business 2015**]、[**Skype for Business Server 管理シェル**] の順にクリックします。
    
3. 応答グループ サービスのサービス名を取得し、変数に割り当てます。コマンド ラインで、次のコマンドを実行します。
    
   ```
   $serviceId="service:"+(Get-CSService | ?{$_.Applications -like "*RGS*"}) .ServiceId;
   ```

4. 対話ワークフローには、2 つ以上のキューと 2 つ以上のエージェント グループが必要です。まず、エージェント グループを作成します。次のコマンドを実行します。
    
   ```
   $AGSupport = New-CsRgsAgentGroup -Parent $serviceId -Name "Technical Support" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:agent1@contoso.com", "sip:agent2@contoso.com")]
   $AGSales = New-CsRgsAgentGroup -Parent $serviceId -Name "Sales Team" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:bob@contoso.com", "sip:alice@contoso.com")]
   ```

5. キューを作成します。次のコマンドを実行します。
    
   ```
   $QSupport = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Support" -AgentGroupIDList($AG-Support.Identity)
   $QSales = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Sales" -AgentGroupIDList($AG-Sales.Identity)
   ```

6. 応答グループ プロンプトを作成します。次のコマンドを実行します。
    
   ```
   $SupportPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please be patient while we connect you with Contoso Technical Support."
   ```

7. 次に、プロンプトの後に実行するアクションを作成します。次のコマンドを実行します。
    
   ```
   $SupportAction = New-CsRgsCallAction -Prompt $SupportPrompt -Action TransferToQueue -QueueID $QSupport.Identity
   ```

8. 最初の応答グループ回答を作成します。次のコマンドを実行します。
    
   ```
   $SupportAnswer = New-CsRgsAnswer -Action $SupportAction [-DtmfResponse 1]
   ```

9. 2 番目のプロンプト、通話アクション、および回答を作成します。まず、プロンプトを作成します。次のコマンドを実行します。
    
   ```
   $SalesPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please hold while we connect you with Contoso Sales."
   ```

10. 2 番目の通話アクションを作成します。次のコマンドを実行します。
    
    ```
    $SalesAction = New-CsRgsCallAction -Prompt $SalesPrompt -Action TransferToQueue -QueueID $QSales.Identity
    ```

11. 2 番目の応答グループ回答を作成します。次のコマンドを実行します。
    
    ```
    $SalesAnswer = New-CsRgsAnswer -Action $SalesAction [-DtmfResponse 2]
    ```

12. 最上位のプロンプトを作成します。次のコマンドを実行します。
    
    ```
    $TopLevelPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Thank you for calling Contoso. For Technical Support, press 1. For a Sales Representative, press 2."
    ```

13. 最上位の質問を作成します。次のコマンドを実行します。
    
    ```
    $TopLevelQuestion = New-CsRgsQuestion -Prompt $TopLevelPrompt [-AnswerList ($SupportAnswer, $SalesAnswer)]
    ```

14. ここで、ワークフローを作成します。次のコマンドを実行します。
    
    ```
    $IVRAction = New-CsRgsCallAction -Action TransferToQuestion [-Question $Question]
    $IVRWorkflow = New-CsRgsWorkflow -Parent $ServiceId -Name "Contoso Helpdesk" [-Description "The Contoso Helpdesk line."] -PrimaryUri "sip:helpdesk@contoso.com" [-LineUri tel:+14255554321] [-DisplayNumber "+1 (425) 555-4321"] [-Active $true] [-Anonymous $true] [-DefaultAction $IVRAction] [-Managed $true] [-ManagersByURI ("sip:mindy@contoso.com", "sip:bob@contoso.com")]
    ```

     > [!NOTE]
     > 応答グループのマネージャーに指定されているすべてのユーザーに CsResponseGroupManager ロールを割り当てる必要があります。このロールが割り当てられていない場合、ユーザーは応答グループを管理できません。 
  
## <a name="see-also"></a>関連項目

#### 

[(省略可能)ビジネス 2015年の Skype を定義する応答グループ休日を設定します。](optional-define-response-group-holiday-sets.md)
#### 

[(省略可能)ビジネス 2015年の Skype での定義の応答グループ営業時間](optional-define-response-group-business-hours.md)
#### 

[新しい-CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/new-csrgsworkflow?view=skype-ps)
  
[セット CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/set-csrgsworkflow?view=skype-ps)
  
[新しい-CsRgsPrompt](https://docs.microsoft.com/powershell/module/skype/new-csrgsprompt?view=skype-ps)
  
[新しい-CsRgsCallAction](https://docs.microsoft.com/powershell/module/skype/new-csrgscallaction?view=skype-ps)

