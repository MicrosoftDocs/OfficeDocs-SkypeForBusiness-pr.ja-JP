---
title: トポロジ内のサーバーに Skype for Business Server をインストールする
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.date: 2/15/2018
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Admin
ms.custom: ''
ms.assetid: defd6b2c-f267-4f8c-bc94-8894e2a429b6
description: '概要: トポロジ内の各サーバーに Skype for Business Server システムコンポーネントをインストールする方法について説明します。 次https://www.microsoft.com/evalcenter/evaluate-skype-for-business-serverの Microsoft 評価センターから、無料の Skype For business Server の試用版をダウンロードしてください。'
ms.openlocfilehash: 0fe1c7b6088732932457d25c68a8fd6476a1bfbd
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/15/2020
ms.locfileid: "42018248"
---
# <a name="install-skype-for-business-server-on-servers-in-the-topology"></a>トポロジ内のサーバーに Skype for Business Server をインストールする
 
**概要:** トポロジ内の各サーバーに Skype for Business Server システムコンポーネントをインストールする方法について説明します。 [Microsoft 評価センター](https://www.microsoft.com/evalcenter/evaluate-skype-for-business-server)から、無料の Skype For business Server の試用版をダウンロードします。
  
中央管理ストアにトポロジが読み込まれ、Active Directory によってどのサーバーがどの役割を実行するかがわかったら、トポロジ内の各サーバーに Skype for Business Server システムをインストールする必要があります。 手順1から5までを任意の順序で実行できます。 ただし、手順6、7、および8は、図で説明されている手順 1 ~ 5 の後で実行する必要があります。 Skype for Business Server システムのインストール手順は 7/8 です。
  
![概要図](../../media/6855713d-a5b4-4e5b-8f83-fef3d7a5ec5d.png)
  
## <a name="install-skype-for-business-server-system"></a>Skype for Business Server システムのインストール

トポロジを公開すると、トポロジ内の各サーバーに Skype for Business Server コンポーネントをインストールできます。 このセクションでは、Skype for Business Server をインストールする方法と、フロントエンドプールのサーバーの役割と、フロントエンドサーバーに併置されているサーバーの役割を設定する方法について説明します。 サーバーの役割をインストールしてセットアップするには、サーバーの役割をインストールする各コンピューターで Skype for Business Server 展開ウィザードを実行します。 展開ウィザードを使用して、ローカル構成ストアのインストール、フロントエンドサーバーのインストール、証明書の構成、サービスの開始など、4つの展開手順をすべて実行します。
  
> [!IMPORTANT]
> サーバーに Skype for Business Server をインストールするには、トポロジビルダーを使用してトポロジを完成させ、公開する必要があります。 
  
> [!NOTE]
> この手順は、トポロジ内のすべてのサーバーで完了する必要があります。 
  
> [!CAUTION]
> フロントエンドサーバーに Skype for Business Server をインストールした後、最初にサービスを開始するときに、サーバー上で Windows ファイアウォールサービスが実行されていることを確認する必要があります。 
  
> [!CAUTION]
> これらの手順を実行する前に、ローカル管理者および RTCUniversalServerAdmins グループのメンバーの両方のドメインユーザーアカウントを使用してサーバーにログオンしていることを確認してください。 
  
> [!NOTE]
> このサーバーで Skype for Business Server のセットアップを実行していない場合は、インストールのドライブとパスを入力するように求められます。 これにより、組織で必要に応じて、システムドライブ以外のドライブにインストールしたり、容量に関する懸念がある場合にインストールすることができます。 [**セットアップ**] ダイアログボックスで、Skype For business Server ファイルのインストール場所のパスを新しい利用可能なドライブに変更することができます。 このパスに、OCSCore .msi を含むセットアップファイルをインストールすると、その他の Skype for Business Server ファイルも同様に展開されます。
  
> [!IMPORTANT]
> インストールを開始する前に、windows Update を使用して、Windows Server が最新の状態になっていることを確認してください。 
  
![Windows Server を最新の状態にします。](../../media/a8d57a97-a55e-443b-b304-c534ae9a71b2.png)
  
### <a name="install-skype-for-business-server-system"></a>Skype for Business Server システムのインストール

1. Skype for Business Server のインストールメディアを挿入します。 セットアップが自動的に開始しない場合は、[**セットアップ**] をダブルクリックします。
    
2. インストールメディアを実行するには、Microsoft Visual C++ が必要です。 インストールするかどうかを確認するダイアログがポップアップ表示されます。 [**はい] をクリックします。**
    
3. 使用許諾契約書をよく読んで、同意する場合は [**使用許諾契約書に同意**します] を選択して、[ **OK**] をクリックします。 
    
4. スマートセットアップは、図に示すように、インターネットに接続して、インストールプロセス中に Microsoft Update (MU) から更新プログラムをチェックすることができる Skype for Business Server の機能です。 これにより、製品に最新の更新プログラムがインストールされていることを確認することができるようになります。 **[インストール]** をクリックして、インストールを開始します。
    
    > [!NOTE]
    > 多くの組織では、企業環境に Windows Server Update Services (WSUS) が展開されています。 WSUS を使用すると、管理者は、Microsoft Update を介してリリースされた更新の配布をネットワーク内のコンピューターに完全に管理することができます。 累積的な更新プログラム1の一部として、Skype for Business Server のリリースでは、スマートセットアップが WSUS と連携するためのサポートが導入されました。 一括アップグレード機能を使用して Skype for Business Server を初めて展開したり、Lync Server 2013 環境からアップグレードしたりする WSUS を使用しているお客様には、更新プログラムを取得するのではなく、スマートセットアップで WSUS から Windows 更新プログラムを取得する必要があります。MU から。 スマートセットアップを使用する必要があるお客様は、setup.exe を実行する前に、すべてのコンピューターで SmartSetupWithWSUS を実行する必要があります。 
  
     ![スマートセットアップのスクリーンショット。](../../media/d35c6cd9-3b8d-4510-871c-30ad07b1f4f2.png)
  
5. [展開ウィザード] ページで、[ **Skype For Business Server システムのインストールまたは更新**] をクリックします。
    
6. 次の手順を実行します。完了したら、[**終了**] をクリックして展開ウィザードを閉じます。 プール内のフロントエンドサーバーごとに、この手順を繰り返します。
    
### <a name="step-1-install-local-configuration-store"></a>手順 1: ローカル構成ストアをインストールする

1. 前提条件を確認し、[**ステップ 1: ローカル構成ストアのインストール**] の横にある [**実行**] をクリックします。
    
    > [!NOTE]
    > ローカル構成ストアは、中央管理ストアの読み取り専用コピーです。 Standard Edition 展開では、フロントエンドサーバー上に SQL Server Express Edition のローカルコピーを使用して、中央管理ストアが作成されます。 これは、最初の Standard Edition サーバーの準備手順を実行すると発生します。 Enterprise Edition の展開では、Enterprise Edition フロントエンドプールを含むトポロジを公開するときに、中央管理ストアが作成されます。 
  
2. [**ローカル構成ストアのインストール**] ページで、[**中央管理ストアから直接取得**する] オプションがオンになっていることを確認し、[**次へ**] をクリックします。
    
    SQL Server Express Edition がローカルサーバーにインストールされている。 ローカル構成ストアには SQL Server Express Edition が必要です。
    
3. ローカル サーバー構成のインストールが完了したら、**[完了]** をクリックします。
    
### <a name="step-2-setup-or-remove-skype-for-business-server-components"></a>手順 2: Skype for Business Server コンポーネントのセットアップまたは削除

1. 前提条件を確認し、[**手順 2: Skype For Business Server コンポーネントのセットアップまたは削除**] の横にある [**実行**] をクリックします。
    
2. [ **Skype For Business Server コンポーネント**のセットアップ] ページで、[**次へ**] をクリックして、公開したトポロジで定義されているようにコンポーネントを設定します。
    
3. [**コマンドの実行**] ページには、セットアップが行われたときに、コマンドとインストール情報の概要が表示されます。 完了したら、一覧を使用して表示するログを選択し、[**ログの表示**] をクリックします。
    
4. Skype for Business Server コンポーネントのセットアップが完了し、必要に応じてログを確認したら、[**完了**] をクリックして、インストールでこの手順を完了します。
    
    > [!NOTE]
    > プロンプトが表示されたら、サーバーを再起動します (Windows デスクトップがインストールされていない場合に発生する可能性があります)。 コンピューターをバックアップして実行している場合は、この手順を再度実行する必要があります (手順 2: Skype for Business Server コンポーネントのセットアップまたは削除)。 
  
    > [!NOTE]
    > 満たされていない前提条件がインストーラーによって検出された場合は、図に示すように、"前提条件を満たしていません" というメッセージが通知されます。 必要な前提条件を満たし、その後 (「手順 2: Skype for Business Server コンポーネントのセットアップまたは削除)」の手順を再度実行します。 
  
     ![前提条件が必要です。](../../media/21a84dfe-70ff-4f76-bd7e-41032660200a.png)
  
5. 最初の2つの手順が正常に完了したことを確認します。 図に示すように、[**完了**] という単語があることを確認します。
    
     ![コンポーネントのインストールから、最初の2つの手順が完了しました。](../../media/59851804-d805-4fa8-854b-60c3de2d109f.png)
  
6. **Windows Update**を再度実行して、Skype For Business Server コンポーネントをインストールした後に更新プログラムが存在するかどうかを確認します。
    
### <a name="step-3-request-install-or-assign-certificates"></a>手順 3: 証明書の要求、インストール、または割り当て

1. 前提条件を確認し、[**手順 3: 証明書の要求、インストール、または割り当て**] の横にある [**実行**] をクリックします。
    
    > [!NOTE]
    > Windows 10、Windows 8、Windows 7、Windows Server 2012 R2、Windows を実行しているクライアントからの接続については、Skype for Business Server に含まれる SHA-1 スイート (SHA-1 は、224、256、384、または512ビット) のダイジェストの長さを使用します。サーバー2012、または Windows Server 2008 R2 オペレーティングシステム。 SHA-1 スイートを使用して外部アクセスをサポートするために、外部証明書はパブリック CA によって発行され、同じビット長のダイジェストを使用して証明書を発行することもできます。 
  
    > [!IMPORTANT]
    > どのハッシュダイジェストと署名アルゴリズムを選択するかは、その証明書を使用するクライアントとサーバー、およびクライアントとサーバーが通信するその他のコンピューターとデバイスが、クライアントとサーバーによって使用されるアルゴリズムの使用方法についても知っている必要があります。certificate. オペレーティングシステムと一部のクライアントアプリケーションでサポートされているダイジェストの長さについては、「 [WINDOWS PKI ブログ-SHA2 および windows](https://go.microsoft.com/fwlink/p/?LinkId=287002)」を参照してください。 
  
    各 Standard Edition またはフロントエンドサーバーは、最大4つの証明書を必要とします: oAuthTokenIssuer 証明書、既定の証明書、web 内部証明書、web 外部証明書。 ただし、適切なサブジェクトの別名エントリおよび oAuthTokenIssuer 証明書を使用して、1つの既定の証明書を要求して割り当てることができます。 証明書の要件の詳細については、「skype for business [server の環境要件](../../plan-your-deployment/requirements-for-your-environment/environmental-requirements.md)」または「 [Skype for Business server のサーバー要件 2019](../../../SfBServer2019/plan/system-requirements.md)」を参照してください。
    
    > [!IMPORTANT]
    > 次の手順では、内部 Active Directory 証明書サービスベースの証明機関から証明書を構成する方法について説明します。 
  
2. **証明書ウィザード**のページで **[要求]** をクリックします。
    
3. [**証明書要求**] ページで、SIP ドメインの選択を含む、関連するデータを入力し、[**次へ**] をクリックします。
    
4. [**遅延または即時要求**] ページで、[**次へ**] をクリックして、[**オンライン証明機関に直ちに要求を送信する**] オプションをそのまま使用できます。 このオプションを選択する場合は、自動オンライン登録を使用する内部 CA を使用できる必要があります。 要求を延期するオプションを選択すると、証明書要求ファイルを保存するための名前と場所の入力を求められます。 証明書要求は、組織内またはパブリック CA のどちらかで、CA によって提示および処理される必要があります。 その後、証明書応答をインポートして、適切な証明書の役割に割り当てる必要があります。
    
5. [**証明機関 (ca) を選択**してください] ページで、[**環境で検出されたリストから CA を選択**してください] オプションを選択し、一覧から (Active Directory ドメインサービスへの登録を通じて) ca を選択します。 または、[**別の証明機関を指定**する] オプションを選択し、別の CA の名前をボックスに入力して、[**次へ**] をクリックします。
    
6. **[証明機関のアカウント]** ページで、CA に対する証明書要求の要求および処理のために、資格情報の入力を求められます。 証明書を要求するためには、ユーザー名とパスワードが必要かどうかを、事前に判断する必要があります。 CA 管理者は必要な情報を持っているため、この手順を支援する必要がある場合があります。 別の資格情報の入力が必要な場合は、チェック ボックスをオンにし、テキスト ボックスにユーザー名とパスワードを入力してから、**[次へ]** をクリックします。
    
7. **[代替証明書テンプレートの指定]** ページで、既定の Web サーバー テンプレートを使用する場合は **[次へ]** をクリックします。
    
    > [!NOTE]
    > CA の既定の Web サーバー テンプレートの代わりに使用するテンプレートを組織が作成している場合は、チェック ボックスをオンにして、代替のテンプレートの名前を入力します。 CA 管理者が定義したテンプレートの名前を入力する必要があります。 
  
8. [**名前およびセキュリティの設定**] ページで、**フレンドリ名**を指定します。 フレンドリ名を使用すると、証明書と目的をすばやく識別できます。 空白のままにした場合、名前は自動的に生成されます。 キーの **[ビット長]** を設定するか、既定の 2048 ビットをそのまま使用します。 証明書と秘密キーを他のシステムに移動またはコピーする必要があると判断した場合は、[**証明書の秘密キーをエクスポート可能としてマーク**する] を選択し、[**次へ**] をクリックします。
    
    > [!NOTE]
    > Skype for Business Server には、エクスポート可能な秘密キーに対する最小限の要件があります。 その対象の 1 つがプール内のエッジ サーバーで、ここではメディア リレー認証サービスが、プール内の各インスタンスに対する個々の証明書ではなく、証明書のコピーを使用します。 
  
9. [**組織情報**] ページで、必要に応じて組織情報を入力し、[**次へ**] をクリックします。
    
10. [**地理情報**] ページで、必要に応じて地理情報を入力し、[**次へ**] をクリックします。
    
11. **[サブジェクト名/サブジェクト代替名]** ページで、追加するサブジェクトの別名を確認してから、**[次へ]** をクリックします。
    
12. [ **Sip ドメインの設定**] ページで、 **sip ドメイン**を選択し、[**次へ**] をクリックします。
    
13. [**追加のサブジェクト代替名の構成**] ページで、追加の必要なサブジェクトの別名 (今後追加する SIP ドメインに必要なものも含む) を追加し、[**次へ**] をクリックします。
    
14. [**証明書要求の概要**] ページで、概要の情報を確認します。 情報が正しい場合は、[**次へ**] をクリックします。 設定を修正または変更する必要がある場合は、適切なページに**戻る**をクリックして修正または修正を行います。
    
15. **[コマンドを実行しています]** ページで、**[次へ]** をクリックします。
    
16. [**オンライン証明書要求の状態**] ページで、返された情報を確認します。 証明書が発行され、ローカル証明書ストアにインストールされていることに注意してください。 発行済みとインストール済みであることが報告されているが、有効ではない場合は、CA ルート証明書がサーバーの信頼されたルート CA ストアにインストールされていることを確認してください。 信頼されたルート CA 証明書を取得する方法については、CA のドキュメントを参照してください。 取得した証明書を表示する必要がある場合は、[**証明書の詳細の表示**] をクリックします。 既定では、[ **Skype For Business Server 証明書の使用法に証明書を割り当てる**] チェックボックスがオンになっています。 証明書を手動で割り当てる場合は、このチェックボックスをオフにして、[**完了**] をクリックします。
    
17. 前のページの「**証明書を Skype For Business Server 証明書の使用法に割り当てる**」チェックボックスをオフにした場合は、[**証明書の割り当て**] ページが表示されます。 **[次へ]** をクリックします。
    
18. [**証明書ストア**] ページで、要求した証明書を選択します。 証明書を表示する場合は、[**証明書の詳細の表示**] をクリックし、[**次**へ] をクリックして続行します。
    
    > [!NOTE]
    > [**オンライン証明書要求の状態**] ページで証明書に関する問題 (証明書が無効な場合など) が報告された場合は、実際の証明書を表示して問題を解決してください。 証明書が有効でない原因となる2つの特定の問題として、既に説明した信頼できるルート CA 証明書と、証明書に関連付けられている秘密キーが見つからないことが挙げられます。 これら2つの問題を解決するには、CA のマニュアルを参照してください。
  
19. [**証明書の割り当ての概要**] ページで、提示された情報を確認して、割り当てられる証明書であることを確認してから、[**次へ**] をクリックします。
    
20. [**コマンドの実行**] ページで、コマンドの出力を確認します。 割り当てプロセスを確認する場合、またはエラーまたは警告が発行された場合は、[**ログの表示**] をクリックします。 レビューが終了したら、[**完了**] をクリックします。
    
21. [**証明書ウィザード**] ページで、図に示されているように、すべてのサービスに緑のチェックマークがあり、OAuthTokenIssuer を含むすべてのサービスが証明書に割り当てられていることを確認してから、[**閉じる**] をクリックします。
    
     ![証明書がインストールされ、正しく割り当てられている。](../../media/d8e1911c-d096-4f88-97a9-d2a704defa17.png)
  
    > [!TIP]
    > ラボ環境でインストールしていて、Active Directory 証明書サービスを使用して証明機関を設定するだけの場合は、証明書サービスを実行しているサーバーと、証明書の前にフロントエンドサーバーの両方を再起動する必要があります。割り当ては正常に終了します。 
  
    > [!TIP]
    >  Active Directory 証明書サービスの証明書の詳細については、「 [Active Directory 証明書サービス](https://technet.microsoft.com/windowsserver/dd448615.aspx)」を参照してください。 
  
### <a name="step-4-start-services"></a>手順 4: サービスを開始する

1. **手順 4: サービスを開始**するための前提条件を確認します。
    
2. これが少なくとも3つのサーバーを持つ Enterprise Edition フロントエンドプールの場合は、Windows Fabric が使用されるため、 **Start-CsPool**コマンドレットを使用する必要があります。 単一のサーバーが使用されている場合は、常に Standard Edition の場合**は、これコマンドレット**を使用します。 この例では、Enterprise Edition をプール内の3つのフロントエンドサーバーと共に使用しています。次の図に示すように、 **Skype For Business Server 管理シェル**を開き、 **Start-cspool**コマンドレットを実行します。 Standard Edition サーバーを含むその他すべての役割については、 **Start-CsWindowsService**を使用する必要があります。 フロントエンドの役割以外の役割を展開するには、その特定の役割に関するドキュメントを参照してください。
    
     ![Skype for Business サービスを開始します。](../../media/f52ec719-9476-419f-9a78-df08368395f7.png)
  
3. すべてのサービスが正常に開始されたら、**[コマンドの実行]** ページで **[終了]** をクリックします。
    
    > [!IMPORTANT]
    > サーバー上でサービスを開始するコマンドは、サービスが実際に開始されたことを報告するためのベストエフォート型の方法です。 サービスの実際の状態を反映していない場合もあります。 次の図に示すように、手順**サービスの状態 (オプション)** を使用して Microsoft 管理コンソール (MMC) を開き、サービスが正常に開始されたことを確認することをお勧めします。 いずれかの Skype for Business Server サービスが開始されていない場合は、MMC でそのサービスを右クリックし、[**開始**] をクリックします。 
  
     ![サービスが開始されたことを確認します。](../../media/47906fb7-9d37-4d55-8d8d-e5a4a2366510.png)
  

