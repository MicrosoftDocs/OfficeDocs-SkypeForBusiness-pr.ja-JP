---
title: トポロジ内のサーバーに Skype for Business Server をインストールする
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
ms.date: 2/15/2018
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Admin
ms.custom: ''
ms.assetid: defd6b2c-f267-4f8c-bc94-8894e2a429b6
description: '概要: トポロジ内の各サーバーに Skype for Business Server システム コンポーネントをインストールする方法について説明します。 Microsoft Evaluation Center から Skype for Business Server の無料試用版を次の場所からダウンロードします https://www.microsoft.com/evalcenter/evaluate-skype-for-business-server 。'
ms.openlocfilehash: e6aa1dde01f7f91b7d1c18b1664a3658911cf50b
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "49801687"
---
# <a name="install-skype-for-business-server-on-servers-in-the-topology"></a>トポロジ内のサーバーに Skype for Business Server をインストールする
 
**概要:** トポロジ内の各サーバーに Skype for Business Server システム コンポーネントをインストールする方法について説明します。 Microsoft Evaluation Center から Skype for Business Server の無料試用版 [をダウンロードします](https://www.microsoft.com/evalcenter/evaluate-skype-for-business-server)。
  
トポロジが中央管理ストアに読み込まれ、Active Directory でどのサーバーがどの役割を実行するのかを確認したら、トポロジ内の各サーバーに Skype for Business Server システムをインストールする必要があります。 手順 1. ~ 5. は任意の順序で実行できます。 ただし、手順 6、7、および 8 を順番に実行し、図に示されている手順 1 ~ 5 の後に実行する必要があります。 Skype for Business Server システムのインストールは、手順 7/8 です。
  
![概要図](../../media/6855713d-a5b4-4e5b-8f83-fef3d7a5ec5d.png)
  
## <a name="install-skype-for-business-server-system"></a>Skype for Business Server システムのインストール

トポロジを公開したら、トポロジ内の各サーバーに Skype for Business Server コンポーネントをインストールできます。 このセクションでは、Skype for Business Server のインストールと、フロントエンド プールのサーバーの役割、およびフロントエンド サーバーと一緒に展開されるサーバーの役割のセットアップについて説明します。 サーバーの役割をインストールしてセットアップするには、サーバーの役割をインストールする各コンピューターで Skype for Business Server 展開ウィザードを実行します。 展開ウィザードを使用して、ローカル構成ストアのインストール、フロントエンド サーバーのインストール、証明書の構成、サービスの開始など、4 つの展開手順を完了します。
  
> [!IMPORTANT]
> サーバーに Skype for Business Server をインストールする前に、トポロジ ビルダーを使用してトポロジを完了して公開する必要があります。 
  
> [!NOTE]
> この手順は、トポロジ内のすべてのサーバーに対して実行する必要があります。 
  
> [!CAUTION]
> フロント エンド サーバーに Skype for Business Server をインストールした後、サービスを初めて開始する場合は、サーバーで Windows ファイアウォール サービスが実行されている必要があります。 
  
> [!CAUTION]
> これらの手順を実行する前に、ローカル管理者と RTCUniversalServerAdmins グループのメンバーの両方であるドメイン ユーザー アカウントを使用してサーバーにログオンしてください。 
  
> [!NOTE]
> このサーバーで Skype for Business Server のセットアップを実行したことがない場合は、インストールのドライブとパスの入力を求めるメッセージが表示されます。 これにより、システム ドライブ以外のドライブ(組織で必要な場合)、またはスペースに問題がある場合にインストールする機能が提供されます。 [セットアップ] ダイアログ ボックスで Skype for Business Serverファイルのインストール場所のパスを、新しい利用可能なドライブに変更できます。 このパス (OCSCore.msi を含む) にセットアップ ファイルをインストールすると、残りの Skype for Business Server ファイルもそこに展開されます。
  
> [!IMPORTANT]
> インストールを開始する前に、Windows Update を使用して Windows Server が最新の情報に更新されている必要があります。 
  
![Windows Server を最新の情報に更新しました。](../../media/a8d57a97-a55e-443b-b304-c534ae9a71b2.png)
  
### <a name="install-skype-for-business-server-system"></a>Skype for Business Server システムのインストール

1. Skype for Business Server インストール メディアを挿入します。 セットアップが自動的に開始されない場合は、[セットアップ] をダブルクリック **します**。
    
2. インストール メディアを実行するには、Microsoft Visual C++ が必要です。 インストールを求めるダイアログが表示されます。 [はい **] をクリックします。**
    
3. 使用許諾契約書を慎重に確認し、同意する場合は、[使用許諾契約書に同意します] を選択し **、[OK]** をクリックします。 
    
4. スマート セットアップは Skype for Business Server の機能で、図に示すように、インターネットに接続して、インストール プロセス中に Microsoft Update (MU) からの更新プログラムを確認できます。 これにより、製品の最新の更新プログラムが確実に提供され、エクスペリエンスが向上します。 **[インストール]** をクリックして、インストールを開始します。
    
    > [!NOTE]
    > 多くの組織ではWindows Server Update Services (WSUS) を企業環境に展開しています。 WSUS を使用すると、管理者は Microsoft Update を通じてリリースされた更新プログラムをネットワーク内のコンピューターに完全に配布できます。 累積的な更新プログラム 1 リリースの一部として、Skype for Business Server では、WSUS で動作するスマート セットアップのサポートが導入されました。 Skype for Business Server を初めて展開する、または In-Place アップグレード機能を使用して Lync Server 2013 環境からアップグレードする WSUS を使用しているお客様は、MU から更新プログラムを取得するのとは対照的に、WSUS から Skype for Windows 更新プログラムをフェッチするスマート セットアップを使用します。 スマート セットアップを使用する場合は、スマート セットアップを実行する前に、すべてのコンピューターで SmartSetupWithWSUS.psq を実行Setup.exe。 
  
     ![スマート セットアップのスクリーンショット。](../../media/d35c6cd9-3b8d-4510-871c-30ad07b1f4f2.png)
  
5. [展開ウィザード] ページで **、[Skype for Business Server システムのインストールまたは更新] をクリックします**。
    
6. 以下の手順を実行します。完了したら、[終了] をクリックして展開ウィザードを閉じます。 プール内のフロントエンド サーバーごとに手順を繰り返します。
    
### <a name="step-1-install-local-configuration-store"></a>手順 1: ローカル構成ストアをインストールする

1. 前提条件を確認し、[手順1: ローカル構成ストアのインストール] の横にある [実行 **] をクリックします**。
    
    > [!NOTE]
    > ローカル構成ストアは、中央管理ストアの読み取り専用コピーです。 Standard Edition 展開では、フロントエンド サーバー上の SQL Server Express Edition のローカル コピーを使用して中央管理ストアが作成されます。 これは、最初の Standard Edition サーバーの準備手順を実行すると発生します。 Enterprise Edition 展開では、Enterprise Edition フロントエンド プールを含むトポロジを公開すると、中央管理ストアが作成されます。 
  
2. [ローカル構成 **ストアの** インストール] ページで、[中央管理ストアから直接取得する] オプションが選択され、[次へ]**をクリックします**。
    
    SQL Server Express Edition はローカル サーバーにインストールされます。 SQL Server構成ストアには Express Edition が必要です。
    
3. ローカル サーバー構成のインストールが完了したら、**[完了]** をクリックします。
    
### <a name="step-2-setup-or-remove-skype-for-business-server-components"></a>手順 2: Skype for Business Server コンポーネントをセットアップまたは削除する

1. 前提条件を確認し、[ステップ **2: Skype for Business Server** コンポーネントのセットアップまたは削除] の横にある [実行] をクリックします。
    
2. [Skype **for Business Server** コンポーネントのセットアップ]ページで、[次へ] をクリックして、公開トポロジで定義されているコンポーネントを設定します。
    
3. [ **コマンドの実行]** ページには、セットアップの実行中にコマンドとインストール情報の概要が表示されます。 完了したら、リストを使用して表示するログを選択し、[ログの表示] を **クリックします**。
    
4. Skype for Business Server コンポーネントのセットアップが完了し、必要に応じてログを確認したら、[完了] をクリックしてインストールのこの手順を完了します。
    
    > [!NOTE]
    > メッセージが表示されたら、サーバーを再起動します (Windows デスクトップ エクスペリエンスをインストールする必要がある場合に発生する可能性があります)。 コンピューターをバックアップして実行している場合は、この手順 (手順 2: Skype for Business Server コンポーネントのセットアップまたは削除) を再度実行する必要があります。 
  
    > [!NOTE]
    > インストーラーが満たされていない前提条件を見つけた場合は、次の図に示すように、"前提条件が満たされていない" というメッセージが表示されます。 必要な前提条件を満たしてから、この手順 (手順 2: Skype for Business Server コンポーネントのセットアップまたは削除) を再度開始します。 
  
     ![前提条件が必要です。](../../media/21a84dfe-70ff-4f76-bd7e-41032660200a.png)
  
5. 最初の 2 つの手順が期待通り完了したのを確認します。 図に示すように **、"Complete"** という単語を持つ緑色のチェックマークが付いそれを確認します。
    
     ![コンポーネントのインストールから完了した最初の 2 つの手順。](../../media/59851804-d805-4fa8-854b-60c3de2d109f.png)
  
6. **Windows Update を再度** 実行して、Skype for Business Server コンポーネントをインストールした後に更新プログラムがインストールされたのか確認します。
    
### <a name="step-3-request-install-or-assign-certificates"></a>手順 3: 証明書を要求、インストール、または割り当てる

1. 前提条件を確認し、[手順 3: **証明書の** 要求、インストール、または割り当て] の横にある [実行] **をクリックします**。
    
    > [!NOTE]
    > Skype for Business Server には、Windows 10、Windows 8、Windows 7、Windows Server 2012 R2、Windows Server 2012、または Windows Server 2008 R2 オペレーティング システムを実行しているクライアントからの接続に関して、SHA-2 スイート (SHA-2 はダイジェスト長 224、256、384、または 512 ビットを使用) のダイジェスト ハッシュと署名アルゴリズムのサポートが含まれています。 SHA-2 スイートを使用した外部アクセスをサポートするために、外部証明書は、同じビット長ダイジェストを持つ証明書を発行できるパブリック CA によって発行されます。 
  
    > [!IMPORTANT]
    > どのハッシュ ダイジェストと署名アルゴリズムの選択は、証明書を使用するクライアントとサーバー、およびクライアントとサーバーが通信する他のコンピューターとデバイスによって異なります。また、証明書で使用されるアルゴリズムの使用方法も知っている必要があります。 オペレーティング システムと一部のクライアント アプリケーションでサポートされているダイジェストの長さについては、Windows PKI ブログ [(SHA2](https://go.microsoft.com/fwlink/p/?LinkId=287002)および Windows) を参照してください。 
  
    各 Standard Edition サーバーまたはフロントエンド サーバーには、oAuthTokenIssuer 証明書、既定の証明書、Web 内部証明書、および Web 外部証明書の 4 つまでの証明書が必要です。 ただし、oAuthTokenIssuer 証明書だけでなく、適切なサブジェクトの代替名エントリを持つ 1 つの既定の証明書を要求して割り当てすることもできます。 証明書の要件の詳細については [、「Environmental requirements for Skype for Business Server](../../plan-your-deployment/requirements-for-your-environment/environmental-requirements.md) or Server [requirements for Skype for Business Server 2019](../../../SfBServer2019/plan/system-requirements.md)」を参照してください。
    
    > [!IMPORTANT]
    > 次の手順では、内部の Active Directory 証明書サービス ベースの証明機関からの証明書を構成する方法について説明します。 
  
2. **証明書ウィザード** のページで **[要求]** をクリックします。
    
3. [証明書要求 **] ページで** 、SIP ドメインの選択などの関連データを入力し、[次へ] をクリック **します**。
    
4. [遅延要求 **] または**[イミディエイト要求]ページで、[次へ] をクリックすると、既定の [要求をすぐにオンライン証明機関に送信する] オプションを受け入 **れできます**。 このオプションを選択する場合は、オンライン登録が自動で行う内部 CA を使用できる必要があります。 要求を延期するオプションを選択すると、証明書要求ファイルを保存する名前と場所を求めるメッセージが表示されます。 証明書要求は、組織内の CA またはパブリック CA によって提示および処理される必要があります。 その後、証明書の応答をインポートし、適切な証明書の役割に割り当てる必要があります。
    
5. [証明機関 **(CA)** の選択] ページで、[環境で検出された一覧から **CA** を選択する] オプションを選択し、一覧から既知の (Active Directory ドメイン サービスへの登録によって) CA を選択します。 または、[別の証明機関 **の指定]** オプションを選択し、ボックスに別の CA の名前を入力して、[次へ] をクリック **します**。
    
6. **[証明機関のアカウント]** ページで、CA に対する証明書要求の要求および処理のために、資格情報の入力を求められます。 証明書を要求するためには、ユーザー名とパスワードが必要かどうかを、事前に判断する必要があります。 CA 管理者が必要な情報を取得し、この手順を支援する必要がある場合があります。 別の資格情報の入力が必要な場合は、チェック ボックスをオンにし、テキスト ボックスにユーザー名とパスワードを入力してから、**[次へ]** をクリックします。
    
7. **[代替証明書テンプレートの指定]** ページで、既定の Web サーバー テンプレートを使用する場合は **[次へ]** をクリックします。
    
    > [!NOTE]
    > CA の既定の Web サーバー テンプレートの代わりに使用するテンプレートを組織が作成している場合は、チェック ボックスをオンにして、代替のテンプレートの名前を入力します。 CA 管理者が定義したテンプレートの名前を入力する必要があります。 
  
8. [名前と **セキュリティの設定] ページ** で、表示名 **を指定します**。 表示名を使用すると、証明書と目的をすばやく識別できます。 空白のままにした場合、名前は自動的に生成されます。 キーの **[ビット長]** を設定するか、既定の 2048 ビットをそのまま使用します。 証明書と **プライベート キーを他** のシステムに移動またはコピーする必要がある場合は、[証明書のプライベート キーをエクスポート可能としてマークする] を選択し、[次へ] **をクリックします**。
    
    > [!NOTE]
    > Skype for Business Server には、エクスポート可能なプライベート キーに関する最小限の要件があります。 その対象の 1 つがプール内のエッジ サーバーで、ここではメディア リレー認証サービスが、プール内の各インスタンスに対する個々の証明書ではなく、証明書のコピーを使用します。 
  
9. [組織情報 **] ページで** 、必要に応じて組織情報を入力し、[次へ] をクリック **します**。
    
10. [地理 **情報] ページで** 、必要に応じて地理情報を入力し、[次へ] をクリック **します**。
    
11. **[サブジェクト名/サブジェクト代替名]** ページで、追加するサブジェクトの別名を確認してから、**[次へ]** をクリックします。
    
12. [SIP **ドメイン設定] ページで****、[SIP** ドメイン] を選択し、[次へ] をクリック **します**。
    
13. [追加 **の** サブジェクト代替名の構成] ページで、今後追加の SIP ドメインで必要になる可能性がある名前を含む、追加の必要なサブジェクトの代替名を追加し、[次へ] **をクリックします**。
    
14. [ **証明書要求の概要]** ページで、概要の情報を確認します。 情報が正しい場合は、[次へ] を **クリックします**。 設定を修正または変更する必要がある場合は、[戻る] をクリックして適切なページに戻り、修正または変更を行います。
    
15. **[コマンドを実行しています]** ページで、**[次へ]** をクリックします。
    
16. [オンライン **証明書要求の状態** ] ページで、返された情報を確認します。 証明書が発行され、ローカル証明書ストアにインストールされた点に注意してください。 発行済みおよびインストール済みとして報告されているが、有効ではない場合は、CA ルート証明書がサーバーの信頼されたルート CA ストアにインストールされていることを確認します。 信頼されたルート CA 証明書を取得する方法については、CA のドキュメントを参照してください。 取得した証明書を表示する必要がある場合は、[証明書の詳細の表示 **] をクリックします**。 既定では **、[Skype for Business Server** 証明書の使用法に証明書を割り当てる] チェック ボックスがオンになっています。 証明書を手動で割り当てる場合は、チェック ボックスをオフにして、[完了] をクリック **します**。
    
17. 前のページで **[Skype for Business Server** 証明書の使用法に証明書を割り当てる] チェック ボックスをオフにした場合は、[証明書の割り当て] ページ **が表示** されます。 [**次へ**] をクリックします。
    
18. [証明書 **ストア] ページ** で、要求した証明書を選択します。 証明書を表示する場合は、[証明書の詳細の表示] をクリックし、[次へ]**をクリックして** 続行します。
    
    > [!NOTE]
    > [ **オンライン証明書の要求** の状態] ページで証明書に関する問題 (証明書が無効など) を報告した場合は、実際の証明書を参照して問題を解決してください。 証明書が無効になる可能性がある 2 つの具体的な問題は、前述の信頼されたルート CA 証明書の欠落と、その証明書に関連付けられている、見つからないプライベート キーです。 これら 2 つの問題を解決するには、CA のドキュメントを参照してください。
  
19. [証明書 **の割り** 当ての概要] ページで、表示される情報を確認して、これが割り当てられる証明書を確認し、[次へ] をクリック **します**。
    
20. [ **コマンドの実行] ページ** で、コマンドの出力を確認します。 割 **り当てプロセスを** 確認する場合、またはエラーまたは警告が発行された場合は、[ログの表示] をクリックします。 レビューが完了したら、[完了] をクリック **します**。
    
21. [証明書ウィザード] ページで、図に示すように、すべてのサービスに証明書 (OAuthTokenIssuer を含む) が割り当てられているかどうかを示す緑色のチェックボックスが表示されているのを確認し、[閉じる] をクリックします。
    
     ![証明書が正しくインストールされ、割り当てられている。](../../media/d8e1911c-d096-4f88-97a9-d2a704defa17.png)
  
    > [!TIP]
    > ラボ環境にインストールし、Active Directory 証明書サービスを使用して証明機関をセットアップしたことがない場合は、証明書の割り当てが正常に完了する前に、証明書サービスを実行しているサーバーとフロントエンド サーバーの両方を再起動する必要があります。 
  
    > [!TIP]
    >  Active Directory 証明書サービスの証明書の詳細については、「Active Directory 証明書サービス [」を参照してください](https://technet.microsoft.com/windowsserver/dd448615.aspx)。 
  
### <a name="step-4-start-services"></a>手順 4: サービスを開始する

1. 手順 **4: サービスを開始するための前提条件を確認します**。
    
2. サーバーが 3 つ以上ある Enterprise Edition フロントエンド プールの場合は、Windows Fabric が使用され **、Start-CsPool** コマンドレットを使用する必要があります。 1 台のサーバーを使用する場合 (Standard Edition の場合は常に同じ **)、Start-CsWindowsService コマンドレットを使用** します。 この例では、プール内に 3 つのフロントエンド サーバーがある Enterprise Edition を使用し **、Skype for Business Server** 管理シェルを開き、図に示すように **Start-CsPool** コマンドレットを実行します。 Standard Edition サーバーを含む他のすべての役割では **、Start-CsWindowsService を使用する必要があります**。 フロント エンドの役割以外の役割を展開するには、これらの特定の役割のドキュメントを参照してください。
    
     ![Skype for Business サービスを開始します。](../../media/f52ec719-9476-419f-9a78-df08368395f7.png)
  
3. すべてのサービスが正常に開始されたら、**[コマンドの実行]** ページで **[終了]** をクリックします。
    
    > [!IMPORTANT]
    > サーバー上でサービスを開始するコマンドは、サービスが実際に開始されたと報告するベスト の方法です。 サービスの実際の状態を反映していない場合もあります。 次の図に示すように、手順のサービスの状態 **(オプション)** を使用して Microsoft 管理コンソール (MMC) を開き、サービスが正常に開始されたことを確認することをお勧めします。 Skype for Business Server サービスが開始されていない場合は、MMC でそのサービスを右クリックし、[スタート] をクリック **します**。 
  
     ![サービスが開始されたのを確認します。](../../media/47906fb7-9d37-4d55-8d8d-e5a4a2366510.png)
  

