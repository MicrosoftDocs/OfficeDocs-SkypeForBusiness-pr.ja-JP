---
title: トポロジ内のサーバーにSkype for Business Serverをインストールする
ms.reviewer: ''
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 2/15/2018
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection:
- IT_Skype16
- Strat_SB_Admin
ms.custom: ''
ms.assetid: defd6b2c-f267-4f8c-bc94-8894e2a429b6
description: '概要: トポロジ内の各サーバーにSkype for Business Serverシステム コンポーネントをインストールする方法について説明します。'
ms.openlocfilehash: 7aea6d25edcd28ba611b81d33eceed4172019bee
ms.sourcegitcommit: e99471689ff60f9ab1095bc075f8b4c5569c9634
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/02/2022
ms.locfileid: "65860618"
---
# <a name="install-skype-for-business-server-on-servers-in-the-topology"></a>トポロジ内のサーバーにSkype for Business Serverをインストールする
 
**概要：** トポロジ内の各サーバーにSkype for Business Serverシステム コンポーネントをインストールする方法について説明します。
  
トポロジが Central Management Microsoft Storeに読み込まれ、Active Directory がどのサーバーがどのロールを実行するかを認識したら、トポロジ内の各サーバーにSkype for Business Server システムをインストールする必要があります。 手順 1 ~ 5 は、任意の順序で実行できます。 ただし、図に示すように、手順 6、7、および 8 を順番に実行し、手順 1 ~ 5 を実行する必要があります。 Skype for Business Server システムのインストールは、手順 7/ 8 です。
  
![概要図。](../../media/6855713d-a5b4-4e5b-8f83-fef3d7a5ec5d.png)
  
## <a name="install-skype-for-business-server-system"></a>システムSkype for Business Serverインストールする

トポロジを公開したら、トポロジ内の各サーバーにSkype for Business Server コンポーネントをインストールできます。 このセクションでは、Skype for Business Serverをインストールし、フロントエンド プールのサーバーロールと、フロントエンド サーバーと併置されるサーバーロールを設定する方法について説明します。 サーバーロールをインストールして設定するには、サーバーロールをインストールする各コンピューターでSkype for Business Server展開ウィザードを実行します。 展開ウィザードを使用して、ローカル構成ストアのインストール、フロントエンド サーバーのインストール、証明書の構成、サービスの開始など、4 つの展開手順をすべて完了します。
  
> [!IMPORTANT]
> サーバーにSkype for Business Serverをインストールする前に、トポロジ ビルダーを使用してトポロジを完了して公開する必要があります。 
  
> [!NOTE]
> トポロジ内のすべてのサーバーに対して、この手順を完了する必要があります。 
  
> [!CAUTION]
> フロント エンド サーバーにSkype for Business Serverをインストールした後、サービスを初めて開始するときに、Windows ファイアウォール サービスがサーバーで実行されていることを確認する必要があります。 
  
> [!CAUTION]
> これらの手順を実行する前に、ローカル管理者と RTCUniversalServerAdmins グループのメンバーの両方であるドメイン ユーザー アカウントを使用してサーバーにログオンしていることを確認します。 
  
> [!NOTE]
> このサーバーでSkype for Business Serverセットアップをまだ実行していない場合は、インストール用のドライブとパスを入力するように求められます。 これにより、システム ドライブ以外のドライブにインストールする機能が提供されます。組織で必要な場合、または領域に問題がある場合です。 **[セットアップ]** ダイアログ ボックスで、Skype for Business Server ファイルのインストール場所パスを新しい使用可能なドライブに変更できます。 セットアップ ファイルをこのパス (OCSCore.msiを含む) にインストールすると、残りのSkype for Business Server ファイルもそこに配置されます。
  
> [!IMPORTANT]
> インストールを開始する前に、Windows Updateを使用して、Windows Server が最新であることを確認します。 
  
![Windows サーバーを最新の状態にします。](../../media/a8d57a97-a55e-443b-b304-c534ae9a71b2.png)
  
### <a name="install-skype-for-business-server-system"></a>システムSkype for Business Serverインストールする

1. Skype for Business Serverインストール メディアを挿入します。 セットアップが自動的に開始されない場合は、[ **セットアップ**] をダブルクリックします。
    
2. インストール メディアを実行するには、Microsoft Visual C++が必要です。 インストールするかどうかを確認するダイアログが表示されます。 [**はい**] をクリックします。
    
3. 使用許諾契約書を慎重に確認し、同意する場合 **は、使用許諾契約書の条項に同意する** を選択し、[OK] をクリック **します**。 
    
4. スマート セットアップはSkype for Business Serverの機能であり、図に示すように、インストール プロセス中に Microsoft Update (MU) からの更新プログラムを確認するためにインターネットに接続できます。 これにより、製品の最新の更新プログラムがあることを確認することで、エクスペリエンスが向上します。 **[インストール]** をクリックして、インストールを開始します。
    
    > [!NOTE]
    > 多くの組織は、企業環境にWindows Server Update Services (WSUS) を展開しています。 WSUS を使用すると、管理者は、Microsoft Update を通じてリリースされた更新プログラムのネットワーク内のコンピューターへの配布を完全に管理できます。 累積的な更新プログラム 1 リリースの一環としてSkype for Business Serverスマート セットアップで WSUS を使用するためのサポートが導入されました。 In-Place アップグレード機能を使用して Lync Server 2013 環境から初めてSkype for Business Serverを展開する WSUS をお持ちのお客様は、MU からの更新プログラムのフェッチではなく、WSUS からのWindows更新プログラムのSkypeをスマート セットアップでフェッチできます。 スマート セットアップを使用したいお客様は、Setup.exeを実行する前にすべてのマシンで SmartSetupWithWSUS.psq を実行する必要があります。 
  
     ![スマート セットアップのスクリーンショット。](../../media/d35c6cd9-3b8d-4510-871c-30ad07b1f4f2.png)
  
5. [展開ウィザード] ページで、[**システムのインストールまたは更新] Skype for Business Server** クリックします。
    
6. 次の手順の手順を実行します。完了したら、[ **終了** ] をクリックして展開ウィザードを閉じます。 プール内の各フロントエンド サーバーに対して手順を繰り返します。
    
### <a name="step-1-install-local-configuration-store"></a>手順 1: ローカル構成Microsoft Storeをインストールする

1. 前提条件を確認し、**手順 1: [ローカル構成のインストール] Microsoft Store** の横にある **[実行**] をクリックします。
    
    > [!NOTE]
    > ローカル構成Microsoft Storeは、中央管理Microsoft Storeの読み取り専用コピーです。 Standard Edition展開では、中央管理Microsoft Storeは、フロントエンド サーバー上の SQL Server Express Edition のローカル コピーを使用して作成されます。 これは、ファースト Standard Edition サーバーの準備プロシージャを実行するときに発生します。 Enterprise Edition展開では、Enterprise Edition フロント エンド プールを含むトポロジを発行すると、Central Management ストアが作成されます。 
  
2. [**ローカル構成Microsoft Storeのインストール**] ページで、[**中央管理ストアから直接取得]** オプションが選択されていることを確認し、[**次へ**] をクリックします。
    
    SQL Server Express Edition はローカル サーバーにインストールされます。 SQL Server Express エディションは、ローカル構成ストアに必要です。
    
3. ローカル サーバー構成のインストールが完了したら、**[完了]** をクリックします。
    
### <a name="step-2-set-up-or-remove-skype-for-business-server-components"></a>手順 2: Skype for Business Server コンポーネントを設定または削除する

1. 前提条件を確認し、[**手順 2: Skype for Business Server コンポーネントのセットアップまたは削除]** の横にある [**実行**] をクリックします。
    
2. [**Skype for Business Server コンポーネントのセットアップ**] ページで、[**次へ**] をクリックして、公開済みのトポロジで定義されているコンポーネントを設定します。
    
3. [ **コマンドの実行]** ページには、セットアップが行われるときのコマンドとインストール情報の概要が表示されます。 完了したら、一覧を使用して表示するログを選択し、[ **ログの表示**] をクリックします。
    
4. Skype for Business Serverコンポーネントのセットアップが完了し、必要に応じてログを確認したら、[**完了]** をクリックしてインストールでこの手順を完了します。
    
    > [!NOTE]
    > メッセージが表示されたらサーバーを再起動します (デスクトップ エクスペリエンスWindowsインストールする必要がある場合に発生する可能性があります)。 コンピューターのバックアップと実行が完了したら、この手順 (手順 2: Skype for Business Server コンポーネントのセットアップまたは削除) 手順をもう一度実行する必要があります。 
  
    > [!NOTE]
    > インストーラーで満たされていない前提条件が見つかると、図に示すように"前提条件が満たされていない" というメッセージが表示されます。 必要な前提条件を満たし、この手順 (手順 2: Skype for Business Server コンポーネントのセットアップまたは削除) を再度開始します。 
  
     ![前提条件が必要です。](../../media/21a84dfe-70ff-4f76-bd7e-41032660200a.png)
  
5. 最初の 2 つの手順が想定どおりに完了したことを確認します。 図に示すように、[ **完了**] という単語に緑色のチェックマークがあることを確認します。
    
     ![コンポーネントのインストールから最初の 2 つの手順が完了しました。](../../media/59851804-d805-4fa8-854b-60c3de2d109f.png)
  
6. **Windows Update** をもう一度実行して、Skype for Business Server コンポーネントをインストールした後に更新プログラムがあるかどうかを確認します。
    
### <a name="step-3-request-install-or-assign-certificates"></a>手順 3: 証明書を要求、インストール、または割り当てる

1. 前提条件を確認し、[**手順 3: 証明書の要求、インストール、または割り当て]** の横にある **[実行**] をクリックします。
    
    > [!NOTE]
    > Skype for Business Serverには、Windows 10、Windows 8、Windows 7、Windows Server 2012 R2 を実行しているクライアントからの接続に対するダイジェスト ハッシュと署名アルゴリズムの SHA-2 スイート (SHA-2 ではダイジェストの長さが 224、256、384、または 512 ビットを使用) のサポートが含まれます。Windows Server 2012、または Server 2008 R2 オペレーティング システムWindows。 SHA-2 スイートを使用した外部アクセスをサポートするために、外部証明書はパブリック CA によって発行され、同じビット長ダイジェストを使用して証明書を発行することもできます。 
  
    > [!IMPORTANT]
    > どのハッシュ ダイジェストと署名アルゴリズムを選択するかは、証明書を使用するクライアントとサーバー、およびクライアントとサーバーが通信するその他のコンピューターとデバイスに依存し、証明書で使用されるアルゴリズムの使用方法も知っている必要があります。 オペレーティング システムと一部のクライアント アプリケーションでサポートされるダイジェストの長さの詳細については、[PKI ブログの SHA2 とWindows Windows](/archive/blogs/pki/sha2-and-windows)参照してください。 
  
    各Standard Editionまたはフロントエンド サーバーには、最大 4 つの証明書 (oAuthTokenIssuer 証明書、既定の証明書、Web 内部証明書、Web 外部証明書) が必要です。 ただし、適切なサブジェクト代替名エントリと oAuthTokenIssuer 証明書を使用して、1 つの既定の証明書を要求して割り当てることができます。 証明書の要件の詳細については、「[Skype for Business Serverの環境要件](../../plan-your-deployment/requirements-for-your-environment/environmental-requirements.md)」または[「Skype for Business Server 2019 のサーバー要件](../../../SfBServer2019/plan/system-requirements.md)」を参照してください。
    
    > [!IMPORTANT]
    > 次の手順では、内部 Active Directory Certificate Services ベースの証明機関から証明書を構成する方法について説明します。 
  
2. **証明書ウィザード** のページで **[要求]** をクリックします。
    
3. [ **証明書要求]** ページで、SIP ドメインの選択を含む関連データを入力し、[ **次へ**] をクリックします。
    
4. [**遅延要求または即時要求]** ページで、[**次へ**] をクリックして、既定 **の [要求をすぐにオンライン証明機関に送信** する] オプションを受け入れます。 このオプションを選択する場合は、自動オンライン登録を使用する内部 CA を使用できる必要があります。 要求を延期するオプションを選択した場合は、証明書要求ファイルを保存する名前と場所を求めるメッセージが表示されます。 証明書要求は、組織内の CA またはパブリック CA によって提示され、処理される必要があります。 その後、証明書応答をインポートし、適切な証明書ロールに割り当てる必要があります。
    
5. [**証明機関 (CA) の選択]** ページ **で、[環境で検出された一覧から CA を選択** する] オプションを選択し、一覧から既知の (Active Directory Domain Servicesへの登録を通じて) CA を選択します。 または、[別の **証明機関の指定** ] オプションを選択し、ボックスに別の CA の名前を入力して、[ **次へ**] をクリックします。
    
6. **[証明機関のアカウント]** ページで、CA に対する証明書要求の要求および処理のために、資格情報の入力を求められます。 証明書を要求するためには、ユーザー名とパスワードが必要かどうかを、事前に判断する必要があります。 CA 管理者は必要な情報を持ち、この手順を支援する必要がある場合があります。 別の資格情報の入力が必要な場合は、チェック ボックスをオンにし、テキスト ボックスにユーザー名とパスワードを入力してから、**[次へ]** をクリックします。
    
7. **[代替証明書テンプレートの指定]** ページで、既定の Web サーバー テンプレートを使用する場合は **[次へ]** をクリックします。
    
    > [!NOTE]
    > CA の既定の Web サーバー テンプレートの代わりに使用するテンプレートを組織が作成している場合は、チェック ボックスをオンにして、代替のテンプレートの名前を入力します。 CA 管理者が定義したテンプレートの名前を入力する必要があります。 
  
8. **[名前とセキュリティ設定**] ページで、[**フレンドリ名]** を指定します。 フレンドリ名を使用すると、証明書と目的をすばやく識別できます。 空白のままにした場合、名前は自動的に生成されます。 キーの **[ビット長]** を設定するか、既定の 2048 ビットをそのまま使用します。 証明書と秘密キーを他のシステムに移動またはコピーする必要があると判断した場合は、[証明書の秘密キーを **エクスポート可能としてマーク** する] を選択し、[ **次へ**] をクリックします。
    
    > [!NOTE]
    > Skype for Business Serverには、エクスポート可能な秘密キーに対する最小限の要件があります。 その対象の 1 つがプール内のエッジ サーバーで、ここではメディア リレー認証サービスが、プール内の各インスタンスに対する個々の証明書ではなく、証明書のコピーを使用します。 
  
9. [ **組織情報** ] ページで、必要に応じて組織情報を指定し、[ **次へ**] をクリックします。
    
10. [ **地理情報** ] ページで、必要に応じて地理的情報を指定し、[ **次へ**] をクリックします。
    
11. **[サブジェクト名/サブジェクト代替名]** ページで、追加するサブジェクトの別名を確認してから、**[次へ]** をクリックします。
    
12. [ **SIP ドメインの設定]** ページで、 **SIP ドメイン** を選択し、[ **次へ**] をクリックします。
    
13. [ **追加のサブジェクト代替名の構成** ] ページで、今後の追加の SIP ドメインに必要になる可能性のあるサブジェクト代替名を含め、追加で必要なサブジェクト代替名を追加し、[ **次へ**] をクリックします。
    
14. [ **証明書要求の概要]** ページで、概要の情報を確認します。 情報が正しい場合は、[ **次へ**] をクリックします。 設定を修正または変更する必要がある場合は、適切なページに **戻る** をクリックして修正または変更を行います。
    
15. **[コマンドを実行しています]** ページで、**[次へ]** をクリックします。
    
16. [ **オンライン証明書要求の状態]** ページで、返された情報を確認します。 証明書が発行され、ローカル証明書ストアにインストールされていることに注意してください。 発行およびインストールされたと報告されているが無効な場合は、サーバーの信頼されたルート CA ストアに CA ルート証明書がインストールされていることを確認します。 信頼されたルート CA 証明書を取得する方法については、CA のドキュメントを参照してください。 取得した証明書を表示する必要がある場合は、[ **証明書の詳細の表示**] をクリックします。 既定では、[**証明書の使用状況に証明書を割り当てるSkype for Business Server**] チェック ボックスがオンになっています。 証明書を手動で割り当てる場合は、チェック ボックスをオフにし、[ **完了**] をクリックします。
    
17. 前のページで[**証明書の使用状況に証明書を割り当てるSkype for Business Server**] チェック ボックスをオフにすると、[**証明書の割り当て]** ページが表示されます。 **[次へ]** をクリックします。
    
18. [**証明書Microsoft Store**] ページで、要求した証明書を選択します。 証明書を表示する場合は、[証明書の **詳細の表示**] をクリックし、[ **次へ** ] をクリックして続行します。
    
    > [!NOTE]
    > **[オンライン証明書要求の状態]** ページで証明書に関する問題 (証明書が無効など) が報告された場合は、実際の証明書を参照して問題の解決に役立ちます。 証明書が無効になる可能性がある 2 つの具体的な問題は、前述の信頼されたルート CA 証明書と、証明書に関連付けられている秘密キーがないことです。 これら 2 つの問題を解決するには、CA のドキュメントを参照してください。
  
19. [ **証明書の割り当ての概要** ] ページで、表示された情報を確認して、これが割り当てる証明書であることを確認し、[ **次へ**] をクリックします。
    
20. [ **コマンドの実行]** ページで、コマンドの出力を確認します。 割り当てプロセスを確認する場合、またはエラーまたは警告が発行された場合は、[ **ログの表示** ] をクリックします。 レビューが完了したら、[ **完了]** をクリックします。
    
21. **[証明書ウィザード**] ページで、図に示すように、すべてのサービスに、OAuthTokenIssuer を含むすべてのサービスに証明書が割り当てられていることを示す緑色のチェックがあることを確認し、[**閉じる**] をクリックします。
    
     ![証明書が正しくインストールされ、割り当てられている。](../../media/d8e1911c-d096-4f88-97a9-d2a704defa17.png)
  
    > [!TIP]
    > ラボ環境にインストールしていて、Active Directory Certificate Services を使用して証明機関を設定したばかりの場合は、証明書の割り当てが正常に完了する前に、Certificate Services を実行しているサーバーとフロントエンド サーバーの両方を再起動する必要があります。 
  
    > [!TIP]
    >  Active Directory 証明書サービスの証明書の詳細については、「 [Active Directory 証明書サービス」を](/windows/deployment/deploy-whats-new)参照してください。 
  
### <a name="step-4-start-services"></a>手順 4: サービスを開始する

1. **手順 4: サービスの開始** の前提条件を確認します。
    
2. 少なくとも 3 台のサーバーを持つEnterprise Edition フロントエンド プールの場合は、Windows Fabricが使用され、**Start-CsPool** コマンドレットを使用する必要があります。 1 台のサーバーが使用されている場合(常にStandard Editionの場合)、**Start-CsWindowsService** コマンドレットを使用します。 この例では、プール内の 3 つのフロントエンド サーバーでEnterprise Editionを使用し、**Skype for Business Server管理シェルを** 開き、図に示すように **Start-CsPool** コマンドレットを実行します。 Standard Edition サーバーを含む他のすべてのロールでは、**Start-CsWindowsService を使用する** 必要があります。 フロントエンド ロール以外のロールを展開するには、これらの特定のロールのドキュメントを参照してください。
    
     ![サービスSkype for Business開始します。](../../media/f52ec719-9476-419f-9a78-df08368395f7.png)
  
3. すべてのサービスが正常に開始されたら、**[コマンドの実行]** ページで **[終了]** をクリックします。
    
    > [!IMPORTANT]
    > サーバー上でサービスを開始するコマンドは、サービスが実際に開始されたことを報告するためのベスト エフォート方式です。 サービスの実際の状態を反映していない場合もあります。 図に示すように、手順 **[サービスの状態 ] (省略可能)** を使用して Microsoft 管理コンソール (MMC) を開き、サービスが正常に開始されたことを確認することをお勧めします。 Skype for Business Serverサービスが起動していない場合は、MMC でそのサービスを右クリックし、[**開始**] をクリックします。 
  
     ![サービスが開始されたことを確認します。](../../media/47906fb7-9d37-4d55-8d8d-e5a4a2366510.png)
