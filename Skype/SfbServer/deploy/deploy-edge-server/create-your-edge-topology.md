---
title: Skype for Business Server のエッジ トポロジを作成する
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: 5ea18841-afdc-4ccb-8d86-30584c1f5aca
description: '概要: Skype for Business Server でエッジ サーバー トポロジを構築、公開、エクスポートする方法について学習します。'
ms.openlocfilehash: 8dff318b5d198eb1e8d59ef465bf648125f31327
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "49804397"
---
# <a name="create-your-edge-topology-for-skype-for-business-server"></a>Skype for Business Server のエッジ トポロジを作成する
 
**概要:** Skype for Business Server でエッジ サーバー トポロジを構築、公開、エクスポートする方法について学習します。
  
トポロジ ビルダーは、Skype for Business Server のトポロジ コンポーネントで使用されるのと同様に、エッジ サーバー トポロジの構築に使用する必要があるツールです。 以下の手順を実行する前に、少なくとも 1 つのフロントエンド プールまたは Standard Edition サーバーをセットアップする必要があります。
  
この記事では、次のトピックについて説明します。
  
- エッジ サーバー トポロジを構築する
    
- エッジ サーバー トポロジの公開
    
- エッジ サーバー トポロジをエクスポートする
    
  > [!NOTE]
  > 以下の手順を実行するには、次に示すドメイン サーバーに、次のドメイン グループのメンバーであるユーザーとしてログインする必要があります。 
  
- RTCUniversalServerAdmins
    
- Domain Admins
    
## <a name="build-your-edge-server-topology"></a>エッジ サーバー トポロジを構築する

最初の展開手順は、次の 3 つのオプションから構成される Skype for Business Server エッジ サーバー トポロジの構築です。
  
- 単一のエッジ サーバー
    
- DNS 負荷分散エッジ プール (1 つ以上のサーバー)
    
- ハードウェア負荷分散エッジ プール (1 つ以上のサーバー)
    
必要な情報が分からない場合は、次の手順を実行する前に、「計画」のドキュメントを参照してください。 それ以外の場合は、始めましょう。
  
### <a name="defining-the-topology-for-a-single-edge-server"></a>単一のエッジ サーバーのトポロジの定義

1. Skype for Business Server Standard Edition サーバーまたは Skype for Business Server フロントエンド プールにログオンします。
    
2. その後 **、Skype for Business Server トポロジ ビルダーを開きます**。
    
3. コンソール ツリーで、エッジ サーバーの展開先のサイトを展開します。
    
4. [エッジ プール **] を右クリックし**、[新しいエッジ プール] **をクリックします**。
    
5. [新しいエッジ プール **の** 定義] **画面で [次へ] をクリック** します。
    
6. [エッジ プール **の FQDN** の定義] 画面で、エッジ サーバーが使用する内部完全修飾ドメイン名 (FQDN) を入力し、[単一コンピュータープール] を選択し、完了したら [次へ] をクリックします。
    
7. [機能 **の選択] 画面** には、次の選択肢があります。
    
   - SIP アクセス サービス、Skype for Business Server Web 会議サービス、音声ビデオ エッジ サービスに同じ FQDN と IP アドレスを使用する場合があります。 その場合は、[単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにする必要があります (以下の手順 9 ではこの点に注意してください)。
    
   - フェデレーションを有効にする予定の場合は、[このエッジ プールのフェデレーションを有効にする **(ポート 5061)** ] チェック ボックスをオンにします。
    
8. [次へ] **をクリック** すると、[IP オプション] 画面 **が表示** されます。 オプションは次のとおりです。
    
   - 内部インターフェイスで IPv4 を有効にする
    
   - 内部インターフェイスで IPv6 を有効にする
    
   - 外部インターフェイスで IPv4 を有効にする
    
   - 外部インターフェイスで IPv6 を有効にする
    
   これらは、IPv4 アドレスと IPv6 アドレスの両方を使用している場合でも、そのアドレスを内部的または外部的にエッジ サーバーに適用する場合でも、非常に簡単です (手順 10 では、この点を念頭に置く必要があります)。 外部 IP アドレスにネットワーク アドレス変換 (NAT) アドレスを使用するためにエッジ サーバーまたはエッジ プールを構成するオプションもあります。 これを行うには、NAT チェック ボックスでこのエッジ プールの外部 IP アドレスを変換 **するを** 選択します。 準備ができたら **、[次へ** ] をクリックします。
    
9. [外部 FQDN] 画面では、上記の手順 7 で選択した内容によって選択内容が異なっています。
    
   - [単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにした場合は、[SIP アクセス] ボックスに単一の外部 **FQDN を入力する必要** があります。 次に、エッジ サービスごとに異なるポート番号を入力して、すべてのエッジ サービスが個別に接続できる必要があります。 **SIP** アクセス エッジ サービスには 5061、Web 会議エッジサービスには 444、音声ビデオ エッジサービスには 443 を推奨します。 操作が完了したら、**[次へ]** をクリックします。
    
   - [単一の FQDN と IP アドレスを使用する] チェック ボックスをオンにしなかった場合は、SIP アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオエッジ サービスの 3 つの外部 **FQDN** を入力する必要があります。  操作が完了したら、**[次へ]** をクリックします。
    
10. これで、[内部 IP アドレスの **定義] 画面が表示** されます。 ここでは、手順 8 で選択した内容に応じて、[内部 **IPv4** アドレス] ボックスと [内部 **IPv6** アドレス] テキスト ボックスにエッジ サーバーの IP アドレスを入力します。 準備ができたら **、[次へ** ] をクリックします。
    
11. [ **外部 IP アドレスの** 定義] 画面には、以前の選択内容に応じていくつかのオプションがあります。
    
    - すべてのサービスに 1 つの FQDN を使用している可能性があります。 その場合は **、[SIP** アクセス] テキスト ボックスに外部 IPv4 アドレスまたは IPv6 アドレス (使用しているアドレス) を入力し、[次へ] をクリック **します**。
    
    - サービスに 3 つの別々の FQDN と IP アドレスを使用する場合があります。 その場合は **、SIP** アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオ エッジ サービスの外部 IPv4 アドレスまたはIPv6 アドレスを入力し、[次へ] をクリック **します。**
    
    > [!NOTE]
    > 以前に IPv6 アドレスを有効にして割り当てなかった場合、このダイアログ ボックスは表示されます。 これは通常、次の手順に進みます。 
  
12. 手順 8 で NAT を使用し戻す場合は、パブリック IP アドレス テキスト ボックスが表示された画面 **が** 表示されます。 NAT によって変換するには、A/V エッジ サービスに設定したパブリック IPv4 アドレスまたは IPv6 アドレスを入力する必要があります。 次に、[**次へ**] をクリックします。
    
13. 次の画面は次 **ホップの定義です**。 [次 **ホップ プール]** ボックスで、内部プールの名前 (フロントエンド プールまたはスタンドアロン プール) を選択します。 環境にディレクターがある場合は、ディレクターを選択する必要があります。 次に、[**次へ**] をクリックします。
    
14. [フロントエンド **プールの** 関連付け] 画面で、このエッジ サーバーに関連付ける 1 つ以上の内部プール (フロントエンド プールと Standard Edition サーバーを含む) を指定する必要があります。 このエッジ サーバーを使用してサポートされている外部ユーザーと通信する内部プールの名前を選択します。 [**次へ**] をクリックします。
    
    > [!NOTE]
    > ここで念頭に置く必要があるのは、内部プールまたはスタンドアロン サーバーが既に別の Skype for Business Server エッジ サーバーを使用している場合、複数の関連付けを持てない、という意味です。 その状況にある内部プールまたはスタンドアロン サーバーを選択すると、他のエッジ サーバーに関する警告が表示され、続行するかどうかを決定できます。 この新しい関連付けを続けて実行すると、他のエッジ サーバーへの接続が停止します。 
  
15. 次 **の画面で [** 完了] をクリックします。
    
16. これで、この更新されたテクノロジを公開し [、「Skype for Business Server](deploy-edge-servers.md) でエッジ サーバーを展開する」の手順に従って、ここからエッジ サーバーに展開できます。
    
### <a name="defining-the-topology-for-a-dns-load-balanced-edge-server-pool"></a>DNS 負荷分散エッジ サーバー プールのトポロジの定義

1. Skype for Business Server Standard Edition サーバーまたは Skype for Business Server フロントエンド サーバーにログオンします。
    
2. その後 **、Skype for Business Server トポロジ ビルダーを開きます**。
    
3. コンソール ツリーで、エッジ サーバーの展開先のサイトを展開します。
    
4. [エッジ プール **] を右クリックし**、[新しいエッジ プール] **をクリックします**。
    
5. [新しいエッジ プール **の** 定義] **画面で [次へ] をクリック** します。
    
6. [エッジ プール **の FQDN** の定義] 画面で、エッジ プールが使用する内部完全修飾ドメイン名 (FQDN) を入力し、[複数のコンピュータープール] を選択し、完了したら [次へ] をクリックします。
    
7. [機能 **の選択] 画面** には、次の選択肢があります。
    
    - SIP アクセス サービス、Skype for Business Server Web 会議サービス、音声ビデオ エッジ サービスに同じ FQDN と IP アドレスを使用する場合があります。 その場合は、[単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにする必要があります (以下の手順 9 ではこの点に注意してください)。
    
    - フェデレーションを有効にする予定の場合は、[このエッジ プールのフェデレーションを有効にする **(ポート 5061)** ] チェック ボックスをオンにします。
    
8. [次へ] **をクリック** すると、[IP オプション] 画面 **が表示** されます。 オプションは次のとおりです。
    
    - 内部インターフェイスで IPv4 を有効にする
    
   - 内部インターフェイスで IPv6 を有効にする
    
   - 外部インターフェイスで IPv4 を有効にする
    
   - 外部インターフェイスで IPv6 を有効にする
    
     これらは、IPv4 アドレスと IPv6 アドレスの両方を使用している場合でも、そのアドレスをエッジ サーバーに内部的または外部的に適用する場合でも、非常に簡単です (手順 11 でこの点を念頭に置く必要があります)。 外部 IP アドレスにネットワーク アドレス変換 (NAT) アドレスを使用するためにエッジ サーバーまたはエッジ プールを構成するオプションもあります。 これを行うには、NAT チェック ボックスでこのエッジ プールの外部 IP アドレスを変換 **するを** 選択します。 準備ができたら **、[次へ** ] をクリックします。
    
9. [外部 FQDN] 画面では、上記の手順 7 で選択した内容によって選択内容が異なっています。
    
   - [単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにした場合は、[SIP アクセス] ボックスに単一の外部 **FQDN を入力する必要** があります。 次に、エッジ サービスごとに異なるポート番号を入力して、すべてのエッジ サービスが個別に接続できる必要があります。 **SIP** アクセス エッジ サービスには 5061、Web 会議エッジサービスには 444、音声ビデオ エッジサービスには 443 を推奨します。 操作が完了したら、**[次へ]** をクリックします。
    
   - [単一の FQDN と IP アドレスを使用する] チェック ボックスをオンにしなかった場合は、SIP アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオエッジ サービスの 3 つの外部 **FQDN** を入力する必要があります。  操作が完了したら、**[次へ]** をクリックします。
    
10. これで、[このプールの **コンピューターの定義] 画面に到達** しました。 [**追加**] ボタンをクリックします。
    
11. これで、[内部 IP アドレスの **定義] 画面が表示** されます。 ここでは、手順 8 で選択した内容に応じて、[内部 **IPv4** アドレス] ボックスと [内部 **IPv6** アドレス] テキスト ボックスにエッジ サーバーの IP アドレスを入力します。 準備ができたら **、[次へ** ] をクリックします。
    
12. [ **外部 IP アドレスの** 定義] 画面には、以前の選択内容に応じていくつかのオプションがあります。
    
    - すべてのサービスに 1 つの FQDN を使用している可能性があります。 その場合は **、[SIP** アクセス] テキスト ボックスに外部 IPv4 アドレスまたは IPv6 アドレス (使用しているアドレス) を入力し、[次へ] をクリック **します**。
    
    - サービスに 3 つの別々の FQDN と IP アドレスを使用する場合があります。 その場合は **、SIP** アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオ エッジ サービスの外部 IPv4 アドレスまたはIPv6 アドレスを入力し、[次へ] をクリック **します。**
    
    > [!NOTE]
    > 以前に IPv6 アドレスを有効にして割り当てなかった場合、このダイアログ ボックスは表示されます。 これは通常、次の手順に進みます。 
  
13. **[完了]** をクリックします。 作成したエッジ サーバーが、[このプールのコンピューターの定義] ダイアログ **ボックスに** 表示されます。
    
14. [このプールのコンピューターの定義] 画面で、[追加]ボタンを再度クリックし、このプールに含まれるすべてのエッジ サーバーを追加するまで手順 11 ~ 13 を繰り返します。 これが完了したら、[次へ] を **クリックします**。
    
15. 手順 8 で NAT を使用し戻す場合は、パブリック IP アドレス テキスト ボックスが表示された画面 **が** 表示されます。 NAT によって変換するには、A/V エッジ サービスに設定したパブリック IPv4 アドレスまたは IPv6 アドレスを入力する必要があります。 次に、[**次へ**] をクリックします。
    
16. 次の画面は次 **ホップの定義です**。 [次 **ホップ プール]** ボックスで、内部プールの名前 (フロントエンド プールまたはスタンドアロン プール) を選択します。 環境にディレクターがある場合は、ディレクターを選択する必要があります。 次に、[**次へ**] をクリックします。
    
17. [フロントエンド **プールの** 関連付け] 画面で、このエッジ サーバーに関連付ける 1 つ以上の内部プール (フロント エンド プールと Standard Edition プールを含む) を指定する必要があります。 このエッジ サーバーを使用してサポートされている外部ユーザーと通信する内部プールの名前を選択します。 [**次へ**] をクリックします。
    
    > [!NOTE]
    > ここで念頭に置く必要があるのは、内部プールまたはスタンドアロン サーバーが既に別の Skype for Business Server エッジ サーバーを使用している場合、複数の関連付けを持てない、という意味です。 その状況にある内部プールまたはスタンドアロン サーバーを選択すると、他のエッジ サーバーに関する警告が表示され、続行するかどうかを決定できます。 この新しい関連付けを続けて実行すると、他のエッジ サーバーへの接続が停止します。 
  
18. 次 **の画面で [** 完了] をクリックします。
    
19. これで、この更新されたテクノロジを公開し [、「Skype for Business Server](deploy-edge-servers.md) でエッジ サーバーを展開する」の手順に従って、ここからエッジ サーバーに展開できます。
    
### <a name="defining-the-topology-for-a-hardware-load-balanced-edge-server-pool"></a>ハードウェア負荷分散エッジ サーバー プールのトポロジの定義

1. Skype for Business Server Standard Edition サーバーまたは Skype for Business Server フロントエンド サーバーにログオンします。
    
2. その後 **、Skype for Business Server トポロジ ビルダーを開きます**。
    
3. コンソール ツリーで、エッジ サーバーの展開先のサイトを展開します。
    
4. [エッジ プール **] を右クリックし**、[新しいエッジ プール] **をクリックします**。
    
5. [新しいエッジ プール **の** 定義] **画面で [次へ] をクリック** します。
    
6. [エッジ プール **の FQDN** の定義] 画面で、エッジ プールが使用する内部完全修飾ドメイン名 (FQDN) を入力し、[複数のコンピュータープール] を選択し、完了したら [次へ] をクリックします。
    
7. [機能 **の選択] 画面** には、次の選択肢があります。
    
   - SIP アクセス サービス、Skype for Business Server Web 会議サービス、音声ビデオ エッジ サービスに同じ FQDN と IP アドレスを使用する場合があります。 その場合は、[単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにする必要があります (以下の手順 9 ではこの点に注意してください)。
    
   - フェデレーションを有効にする予定の場合は、[このエッジ プールのフェデレーションを有効にする **(ポート 5061)** ] チェック ボックスをオンにします。
    
8. [次へ] **をクリック** すると、[IP オプション] 画面 **が表示** されます。 オプションは次のとおりです。
    
   - 内部インターフェイスで IPv4 を有効にする
    
   - 内部インターフェイスで IPv6 を有効にする
    
   - 外部インターフェイスで IPv4 を有効にする
    
   - 外部インターフェイスで IPv6 を有効にする
    
     これらは、IPv4 アドレスと IPv6 アドレスの両方を使用している場合でも、そのアドレスをエッジ サーバーに内部的または外部的に適用する場合でも、非常に簡単です (手順 11 でこの点を念頭に置く必要があります)。
    
     > [!NOTE]
     > 他の 2 つのトポロジ オプションとは異なり、ハードウェアロード バランサーを使用する場合は、NAT によってエッジ プールの外部 IP アドレスが変換されるオプションを選択 **しなけずにしてください**。 これはサポート **されていません**。
  
9. [外部 FQDN] 画面では、上記の手順 7 で選択した内容によって選択内容が異なっています。
    
   - [単一の **FQDN** と IP アドレスを使用する] チェック ボックスをオンにした場合は、[SIP アクセス] ボックスに単一の外部 **FQDN を入力する必要** があります。 次に、エッジ サービスごとに異なるポート番号を入力して、すべてのエッジ サービスが個別に接続できる必要があります。 **SIP** アクセス エッジ サービスには 5061、Web 会議エッジサービスには 444、音声ビデオ エッジサービスには 443 を推奨します。 操作が完了したら、**[次へ]** をクリックします。
    
   - [単一の FQDN と IP アドレスを使用する] チェック ボックスをオンにしなかった場合は、SIP アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオエッジ サービスの 3 つの外部 **FQDN** を入力する必要があります。  操作が完了したら、**[次へ]** をクリックします。
    
10. これで、[このプールの **コンピューターの定義] 画面に到達** しました。 [**追加**] ボタンをクリックします。
    
11. これで、[内部 IP アドレスの **定義] 画面が表示** されます。 ここでは、手順 8 で選択した内容に応じて、[内部 **IPv4** アドレス] ボックスと [内部 **IPv6** アドレス] テキスト ボックスにエッジ サーバーの IP アドレスを入力します。 準備ができたら **、[次へ** ] をクリックします。
    
12. [ **外部 IP アドレスの** 定義] 画面には、以前の選択内容に応じていくつかのオプションがあります。
    
    - すべてのサービスに 1 つの FQDN を使用している可能性があります。 その場合は **、[SIP** アクセス] テキスト ボックスに外部 IPv4 アドレスまたは IPv6 アドレス (使用しているアドレス) を入力し、[次へ] をクリック **します**。
    
    - サービスに 3 つの別々の FQDN と IP アドレスを使用する場合があります。 その場合は **、SIP** アクセス エッジ サービス **、Web** 会議エッジ サービス、音声ビデオ エッジ サービスの外部 IPv4 アドレスまたはIPv6 アドレスを入力し、[次へ] をクリック **します。**
    
    > [!NOTE]
    > 以前に IPv6 アドレスを有効にして割り当てなかった場合、このダイアログ ボックスは表示されます。 これは通常、次の手順に進みます。 
  
13. **[完了]** をクリックします。 作成したエッジ サーバーが、[このプールのコンピューターの定義] ダイアログ **ボックスに** 表示されます。
    
14. [このプールのコンピューターの定義] 画面で、[追加]ボタンを再度クリックし、このプールに含まれるすべてのエッジ サーバーを追加するまで手順 11 ~ 13 を繰り返します。 これが完了したら、[次へ] を **クリックします**。
    
15. 次の画面は次 **ホップの定義です**。 [次 **ホップ プール]** ボックスで、内部プールの名前 (フロントエンド プールまたはスタンドアロン プール) を選択します。 環境にディレクターがある場合は、ディレクターを選択する必要があります。 次に、[**次へ**] をクリックします。
    
16. [フロントエンド **プールの** 関連付け] 画面で、このエッジ サーバーに関連付ける 1 つ以上の内部プール (フロント エンド プールと Standard Edition プールを含む) を指定する必要があります。 このエッジ サーバーを使用してサポートされている外部ユーザーと通信する内部プールの名前を選択します。 [**次へ**] をクリックします。
    
    > [!NOTE]
    > ここで念頭に置く必要があるのは、内部プールまたはスタンドアロン サーバーが既に別の Skype for Business Server エッジ サーバーを使用している場合、複数の関連付けを持てない、という意味です。 その状況にある内部プールまたはスタンドアロン サーバーを選択すると、他のエッジ サーバーに関する警告が表示され、続行するかどうかを決定できます。 この新しい関連付けを続けて実行すると、他のエッジ サーバーへの接続が停止します。 
  
17. 次 **の画面で [** 完了] をクリックします。
    
18. これで、この更新されたテクノロジを公開し [、「Skype for Business Server](deploy-edge-servers.md) でエッジ サーバーを展開する」の手順に従って、ここからエッジ サーバーに展開できます。
    
## <a name="publish-your-edge-server-topology"></a>エッジ サーバー トポロジの公開

上記の手順を完了したら、この新しいトポロジを公開します。これにより、Skype for Business Server エッジ サーバーまたはエッジ プールにエクスポートすることもできます。 次の手順を実行します。
  
1. トポロジ **ビルダーを起動** します (前の手順からまだ開始していない場合)。
    
2. トポロジ **ビルダーの** コンソール ツリーで **、[Skype for Business Server]** を右クリックし、[Skype for Business Server トポロジ ビルダー] **をクリックします**。
    
3. ウィザードの [**ようこそ**] ページで、[**次へ**] をクリックします。
    
4. [**他のデータベースの作成**] ページで、[**次へ**] をクリックします。
    
5. 状態がデータベースの作成が成功したと示された場合は、次の手順を実行します。
    
    - ログを表示するには、**[ログの表示]** をクリックします。
    
    - ウィザードを閉じるには、**[完了]** をクリックします。
    
## <a name="export-your-edge-server-topology"></a>エッジ サーバー トポロジをエクスポートする

Skype for Business Server 展開ウィザードを正常に展開するには、中央管理ストアのデータにアクセスする必要があります。 ドメインまたはフォレスト内の内部サーバーの場合、通常、これは簡単です。 エッジ サーバーはドメインの外部にあるので、トポロジ ファイルをエッジ サーバーの場所 (通常は物理メディア) に手動でエクスポートする必要があります。 このエクスポートは、PowerShell を使用して行われます。
  
1. Skype **for Business Server 管理シェルを起動します**。
    
2. Skype **for Business Server 管理シェルで、次** のコマンドを実行します。
    
   ```powershell
   Export-CsConfiguration -FileName <ConfigurationFilePath.zip>
   ```

3. エクスポートしたファイルを外部メディア (たとえば、エッジ サーバーの場所からアクセスできる USB ドライブやネットワーク共有) にコピーします。
    

