---
title: ビジネス サーバーの Skype のバック エンド サーバーに常時接続の可用性グループを展開します。
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: c93c01e6-626c-40ad-92dd-373b0fe9189f
description: (インストール)、常に可用性グループに、Skype のビジネス サーバーの展開を展開します。
ms.openlocfilehash: f04c103d75f385d37804db3b7bf5786b1c14928d
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/11/2019
ms.locfileid: "33894613"
---
# <a name="deploy-an-always-on-availability-group-on-a-back-end-server-in-skype-for-business-server"></a>ビジネス サーバーの Skype のバック エンド サーバーに常時接続の可用性グループを展開します。
 
(インストール)、常に上の可用性グループ (AG)、Skype のビジネス サーバーの展開を展開します。
  
AG をどのように展開することを新しいプール、ミラーリングを使用する既存のプールまたはバックエンド データベースの高可用性がされていない既存のプールに展開するかどうかによって異なります。
  
> [!NOTE]
> AG を使用して永続的なチャット サーバーの役割ではサポートされていません。 
  
- [常に可用性グループに新しいフロント エンド プールでの展開します。](alwayson-availability-group.md#BKMK_NewPool_CreateAlwaysOnGroup)
    
- [常に可用性グループにデータベース ミラーリングを使用する既存のプールでの展開します。](alwayson-availability-group.md#BKMK_MirroredPool_CreateAlwaysOnGroup)
    
- [常に可用性グループにデータベース ミラーリングを使用しない既存のプールでの展開します。](alwayson-availability-group.md#BKMK_NoHAPool_CreateAlwaysOnGroup)
    
## <a name="deploy-an-always-on-availability-group-on-a-new-front-end-pool"></a>常に可用性グループに新しいフロント エンド プールでの展開します。
<a name="BKMK_NewPool_CreateAlwaysOnGroup"> </a>

1. AG の一部となるすべてのデータベース サーバーのフェールオーバー クラスタ リング機能を有効にします。 各サーバーで、以下の作業を行います。
    
   - サーバー マネージャーを開き、[**役割と機能の追加**] をクリックします。
    
   - [**機能の選択**] ボックスが表示されるまで [**次へ**] をクリックします。このボックスで、[**フェールオーバー クラスタリング**] チェック ボックスをオンにします。
    
   - [**フェールオーバー クラスタリングに必要な機能を追加しますか?**] ボックスで、[**機能の追加**] をクリックします。
    
   - [**インストール**] をクリックします。
    
2. クラスター構成を検証します。
    
   - サーバー マネージャーで、[**ツール**] メニューをクリックし、[**フェールオーバー クラスター マネージャー**] をクリックします。
    
   - 画面右側の [**操作**] で、[**構成の検証**] をクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスターに追加するサーバーを選択し、[**すべてのテストを実行**] をクリックします。
    
   - [**概要**] ボックスで、ウィザードにより報告されたすべてのエラーを確認します。確認したら、[**完了**] をクリックして検証を完了します。
    
     特に、共有ストレージを使用していない場合、通常はウィザードにより複数の警告が報告されます。共有ストレージを使用する必要はありませんが、[**エラー**] でメッセージが表示されている場合は、作業を続行する前にこれらの問題を修正する必要があります。
    
3. (WSFC) Windows Server フェールオーバー クラスターを作成します。
    
   - [**フェールオーバー クラスター管理**] ウィザードで、[**フェールオーバー クラスター管理**]、[**クラスターの作成**] の順にクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスター名と IP アドレスを追加します。設定が検証されたら、[**次へ**] をクリックします。
    
   - [確認] ページで、[**次へ**] をクリックします。
    
   - クラスターが作成されたら、[**完了**] をクリックします。
    
4. ファイル共有監視を使用するようにクラスター クォーラム設定を構成することをお勧めします。このためには、以下の手順を行います。
    
   - クラスター名を右クリックし、[**他の操作**]、[**クラスター クォーラム設定の構成**] の順にクリックします。
    
   - [**クォーラム構成オプションの選択**] ページで、[**クォーラム監視を選択する**] をクリックします。
    
   - [**クォーラム監視の選択**] ページで、[**ファイル共有監視を構成する**] をクリックします。
    
   - [**ファイル共有監視の構成**] ページで、使用するファイル共有のパスを入力し、[**次へ**] をクリックします。
    
   - [**確認**] ページで、[**次へ**] をクリックします。
    
5. クラスター内の各サーバーでは、AG 機能で SQL Server 構成マネージャーを有効にします。
    
   - SQL Server 構成マネージャーを開きます。画面左側のツリーで、[**SQL Server のサービス**] をクリックし、SQL Server サービスをダブルクリックします。 
    
   - [**プロパティ**] ボックスで、[**AlwaysOn 高可用性**] タブを選択します。[**AlwaysOn 可用性グループを有効にする**] チェック ボックスをオンにします。SQL Server サービスを再開するよう求めるメッセージが表示されたら、サービスを再開します。
   
6. 説明したように、フロント エンド プールを作成するトポロジ ビルダーを使用して、[を作成する Skype のビジネス サーバーの新しいトポロジを公開し、](../../deploy/install/create-and-publish-new-topology.md)。 実行すると、プールの SQL ストアとして、AG を指定します。
    
7. 可用性グループを作成します。
    
   - SQL Server Management Studio を開き、SQL Server インスタンスに接続します。
    
   - オブジェクト エクスプ ローラーで、**常に高可用性**のフォルダーを展開します。 [**可用性グループ**] フォルダーを右クリックし、[**新しい可用性グループ ウィザード**] をクリックします。
    
   - [**説明**] ページが表示されたら、[**次へ**] をクリックします。
    
   - [**可用性グループ名の指定**] ページで、可用性グループの名前を入力し、[**次へ**] をクリックします。
    
   - データベースの選択] ページでは、AlwaysOn 可用性グループに追加するデータベースを選択します。 続いて [ **次へ**] をクリックします。
    
     **ReportServer**、 **ReportServerTempDB**、またはデータベースの永続的なチャットに含めないで、AlwaysOn 可用性グループと、このシナリオではサポートされていません。 AlwaysOn 可用性グループで、ビジネスのサーバー データベースの他のすべての Skype を含めることができます。
    
   - [**レプリカの指定**] ページで、[**レプリカ**] タブをクリックします。続いて [**レプリカの追加**] ボタンをクリックし、Windows Server フェールオーバー クラスターのノードとして参加させた他の SQL インスタンスに接続します。
    
   - 各インスタンスの [**自動フェールオーバー**] オプションと [**同期コミット**] オプションをオンにします。[**読み取り可能なセカンダリ**] オプションはオンにしないでください。
    
   - [**エンドポイント**] タブをクリックし、[**ポート番号**] が "5022" に設定されていることを確認します。
    
   - [**リスナー**] タブをクリックし、[**可用性グループ リスナーの作成**] オプションをオンにします。そのオプションの下で、リスナーの名前を入力し、[**ポート**] を "1433" (他のポートはこのオプションではサポートされません) に設定します。
    
   - [**追加**] をクリックし、[**IPv4 アドレス**] ボックスに優先させる仮想 IP アドレスを入力して、[**OK**] をクリックします。
    
   - [**最初のデータの同期を選択**] ページで [完全] を選択します。レプリカがアクセスでき、両方のレプリカにより使用される SQL Server サービス アカウントが書き込みアクセス許可を持っているフォルダーを指定します。続いて、[**次へ**] をクリックします。
    
     このファイル共有は、データベースを初期化した時点で一時的に使用されます。大きなデータベースを扱う場合、使用するネットワーク帯域幅でデータベース バックアップのサイズに対応できない場合に備えて、データベースを手動で初期化することを推奨します。
    
   - [検証] ページで、すべての検証チェックが成功したことを確認し、[**次へ**] をクリックします。
    
   - [**概要**] ページで、すべての設定を確認し、[完了] をクリックします。
      
8. プールと AG が配置されると、SQL ログインが各 AlwaysOn 可用性グループのレプリカであることを確認するのにはいくつかの最終的な手順を実行します。 
    
   - トポロジ ビルダーを開き**既存の展開からトポロジをダウンロード**するを選択して **[ok]** をクリックします。
    
   - [Skype for Business Server]、使用するトポロジ、[**SQL Server ストア**] の順に展開します。 新しい AlwaysOn 可用性グループの SQL ストアを右クリックし、[**プロパティの編集**] をクリックします。
    
     - [ **SQL Server の FQDN** ] ボックスで、ページの下部にある AG のリスナーの FQDN の値を変更します。
    
   - トポロジを公開します。[**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。続いて、確認ページで [**次へ**] をクリックします。新しいトポロジがレプリケートされるまで数分待ちます。
    
   - SQL Server Management Studio を開き AG に移動します。 AlwaysOn 可用性グループのセカンダリ レプリカへのフェールオーバーを行います。
    
   - ビジネス サーバー管理シェルの Skype を開きこのレプリカの SQL ログインを作成するのには、次のコマンドレットを入力します。
    
   ```
   Install-CsDatabase -Update
   ```

   - 前の 2 つの手順を繰り返します (セカンダリ レプリカでは、グループをフェールオーバーしを使用して、 `Install-CsDatabase -Update`)、グループ内の各レプリカのです。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-uses-database-mirroring"></a>常に可用性グループにデータベース ミラーリングを使用する既存のプールでの展開します。
<a name="BKMK_MirroredPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> AG にアップグレードするプールでは、組織の中央管理ストアをホストしている場合必要があります最初に移動する CMS 別のプールにこのプールをアップグレードする前にします。 プールを移動するには、Move-CsManagementServer コマンドレットを使用します。 組織内の別のプールがない、Standard Edition サーバーを一時的に展開し、AG にプールをアップグレードする前に、このサーバーに CMS を移動できます。 
  
1. ビジネス サーバー管理シェルの Skype を開き、次のコマンドレットを入力すると、ミラーからのすべてのデータの主要なノードをフェールオーバーします。
    
   ```
   Invoke-CsDatabaseFailover -PoolFqdn <Pool FQDN> -DatabaseType <DatabaseType> -NewPrincipal "Primary"
   ```

    プール内の各データベースの種類に対してこのコマンドレットを繰り返します。次のコマンドレットを使用すると、このプールに格納されているすべてのデータベースの種類を見つけることができます。
     
   ```
   Get-CsPool -Identity <Pool FQDN>
   ```

2. プールからのデータベース ミラーリングを削除するのにには、トポロジ ビルダーを使用します。
    
   - トポロジ ビルダーを開きます。 トポロジで [**Enterprise Edition フロントエンド プール**] を展開し、プール名を右クリックし、[**プロパティの編集**] をクリックします。
    
   - プール内の各種類の SQL ストアに対して、[**SQL ストアのミラーリングを有効にする**] チェック ボックスをオフにします。
    
3. 変更したトポロジを公開します。[**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。続いて確認ページで [**次へ**] をクリックします。
    
4. SQL Server Management Studio を使用して、ミラーを解除します。
    
   - SQL Server Management Studio を開き、使用しているデータベースに移動し、[**タスク**] を右クリックし、[**ミラー**] をクリックします。続いて [**ミラーリングの削除**] をクリックし、[**OK**] をクリックします。
    
   - AG に変換されるプール内のすべてのデータベースに対してこの手順を繰り返します。
    
5. AG の一部となるすべてのデータベース サーバーのフェールオーバー クラスタ リング機能を設定します。 各サーバーで、以下の作業を行います。
    
   - サーバー マネージャーを開き、[**役割と機能の追加**] をクリックします。
    
   - [**機能の選択**] ボックスが表示されるまで [**次へ**] をクリックします。このボックスで、[**フェールオーバー クラスタリング**] チェック ボックスをオンにします。
    
   - [**フェールオーバー クラスタリングに必要な機能を追加しますか?**] ボックスで、[**機能の追加**] をクリックします。
    
   - [**インストール**] をクリックします。
    
6. クラスター構成を検証します。
    
   - サーバー マネージャーで、[**ツール**] メニューをクリックし、[**フェールオーバー クラスター マネージャー**] をクリックします。
    
   - 画面右側の [**操作**] で、[**構成の検証**] をクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスターに追加するサーバーを選択し、[**すべてのテストを実行**] をクリックします。
    
   - [**概要**] ボックスで、ウィザードにより報告されたすべてのエラーを確認します。確認したら、[**完了**] をクリックして検証を完了します。
    
     特に、共有ストレージを使用していない場合、通常はウィザードにより複数の警告が報告されます。共有ストレージを使用する必要はありませんが、[**エラー**] でメッセージが表示されている場合は、作業を続行する前にこれらの問題を修正する必要があります。
    
7. Windows Server フェールオーバー クラスターを作成します。
    
   - [**フェールオーバー クラスター管理**] ウィザードで、[**フェールオーバー クラスター管理**]、[**クラスターの作成**] の順にクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスター名と IP アドレスを追加します。設定が検証されたら、[**次へ**] をクリックします。
    
   - [確認] ページで、[**次へ**] をクリックします。
    
   - クラスターが作成されたら、[**完了**] をクリックします。
    
8. ファイル共有監視を使用するようにクラスター クォーラム設定を構成することをお勧めします。このためには、以下の手順を行います。
    
   - クラスター名を右クリックし、[**他の操作**]、[**クラスター クォーラム設定の構成**] の順にクリックします。
    
   - [**クォーラム構成オプションの選択**] ページで、[**クォーラム監視を選択する**] をクリックします。
    
   - [**クォーラム監視の選択**] ページで、[**ファイル共有監視を構成する**] をクリックします。
    
   - [**ファイル共有監視の構成**] ページで、使用するファイル共有のパスを入力し、[**次へ**] をクリックします。
    
   - [**確認**] ページで、[**次へ**] をクリックします。
    
9. クラスター内の各サーバーでは、AG 機能で SQL Server 構成マネージャーを有効にします。
    
   - SQL Server 構成マネージャーを開きます。画面左側のツリーで、[**SQL Server のサービス**] をクリックし、SQL Server サービスをダブルクリックします。 
    
   - [**プロパティ**] ボックスで、[**AlwaysOn 高可用性**] タブを選択します。[**AlwaysOn 可用性グループを有効にする**] チェック ボックスをオンにします。SQL Server サービスを再開するよう求めるメッセージが表示されたら、サービスを再開します。
    
10. 可用性グループを作成します。
    
    - SQL Server Management Studio を開き、SQL Server インスタンスに接続します。
    
    - オブジェクト エクスプ ローラーで、**常に高可用性**のフォルダーを展開します。 [**可用性グループ**] フォルダーを右クリックし、[**新しい可用性グループ ウィザード**] をクリックします。
    
    - [**説明**] ページが表示されたら、[**次へ**] をクリックします。
    
    - [**可用性グループ名の指定**] ページで、可用性グループの名前を入力し、[**次へ**] をクリックします。
    
    - データベースの選択] ページでは、AlwaysOn 可用性グループに追加するデータベースを選択します。 続いて [ **次へ**] をクリックします。
    
    **ReportServer**、 **ReportServerTempDB**、またはデータベースの永続的なチャットに含めないで、AlwaysOn 可用性グループと、このシナリオではサポートされていません。 AlwaysOn 可用性グループで、ビジネスのサーバー データベースの他のすべての Skype を含めることができます。
    
    - [**レプリカの指定**] ページで、[**レプリカ**] タブをクリックします。続いて [**レプリカの追加**] ボタンをクリックし、Windows Server フェールオーバー クラスターのノードとして参加させた他の SQL インスタンスに接続します。
    
    - 各インスタンスの [**自動フェールオーバー**] オプションと [**同期コミット**] オプションをオンにします。[**読み取り可能なセカンダリ**] オプションはオンにしないでください。
    
    - [**エンドポイント**] タブをクリックし、[**ポート番号**] が "5022" に設定されていることを確認します。
    
      - [**リスナー**] タブをクリックし、[**可用性グループ リスナーの作成**] オプションをオンにします。そのオプションの下で、リスナーの名前を入力し、[**ポート**] を "1433" (他のポートはこのオプションではサポートされません) に設定します。
    
    - [**追加**] をクリックし、[**IPv4 アドレス**] ボックスに優先させる仮想 IP アドレスを入力して、[**OK**] をクリックします。
    
    - [**最初のデータの同期を選択**] ページで [完全] を選択します。レプリカがアクセスでき、両方のレプリカにより使用される SQL Server サービス アカウントが書き込みアクセス許可を持っているフォルダーを指定します。続いて、[**次へ**] をクリックします。
    
    このファイル共有は、データベースを初期化した時点で一時的に使用されます。大きなデータベースを扱う場合、使用するネットワーク帯域幅でデータベース バックアップのサイズに対応できない場合に備えて、データベースを手動で初期化することを推奨します。
    
    - [検証] ページで、すべての検証チェックが成功したことを確認し、[**次へ**] をクリックします。
    
    - [**概要**] ページで、すべての設定を確認し、[完了] をクリックします。
    
11. AG リスナーを指定して、AG のプライマリ ノードとしての古いミラーのプリンシパルを指定することに、新しいストアを作成します。
    
    - トポロジ ビルダーを開きます。 トポロジで、[**共有コンポーネント**] を展開し、[**SQL Server ストア**] を右クリックして、[**新しい SQL Server ストア**] をクリックします。
    
    - [**新しい SQL ストアの定義**] ページで、まず [**高可用性の設定**] チェック ボックスをオンにしてから、SQL AlwaysOn 可用性グループがドロップダウン ボックスに表示されていることを確認します。
    
    - [**SQL Server の可用性グループのリスナーの FQDN**] ボックスに、可用性グループを作成したときに作成したリスナーの FQDN を入力します。
    
    - ボックスで、 **SQL Server の FQDN** AG のプライマリ ノードの FQDN を入力し、し、[ **OK**] をクリックします。 これは、このストアの古いミラーのプリンシパルである必要があります。
    
12. 新しい AG をフロント エンド プールに関連付けます。
    
    - トポロジ ビルダーでは、AG と関連付けるプールを右クリックし、**プロパティの編集**] をクリックします。
    
    - **SQL Server ストア**] ボックスで、[**関連付け**の AG を選択します。 AG への移動先となるプール内の他のデータベースの同じグループを選択します。
    
    - AG に必要なすべてのデータベースが設定されていることを確認したら、[ **OK**] をクリックします。
    
13. トポロジを公開します。 [**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。 続いて、確認ページで [**次へ**] をクリックします。
    
14. AlwaysOn 可用性グループのレプリカの各 SQL ログインしているかどうかを確認するのにはいくつかの最終的な手順を実行します。
    
    - トポロジ ビルダーを開き**既存の展開からトポロジをダウンロード**するを選択して **[ok]** をクリックします。
    
    - [Skype for Business Server]、使用するトポロジ、[**SQL Server ストア**] の順に展開します。 、新しい AG の SQL ストアを右クリックし、[**プロパティの編集**] をクリックします。
    
    - [ **SQL Server の FQDN** ] ボックスで、ページの下部にある AG のリスナーの FQDN の値を変更します。
    
    - トポロジを公開します。[**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。続いて、確認ページで [**次へ**] をクリックします。新しいトポロジがレプリケートされるまで数分待ちます。
    
    - SQL Server Management Studio を開き AG に移動します。 AlwaysOn 可用性グループのセカンダリ レプリカへのフェールオーバーを行います。
    
    - ビジネス サーバー管理シェルの Skype を開きこのレプリカの SQL ログインを作成するのには、次のコマンドレットを入力します。
    
    ```
    Install-CsDatabase -Update
    ```

    - 前の 2 つの手順を繰り返します (セカンダリ レプリカでは、グループをフェールオーバーしを使用して、 `Install-CsDatabase -Update`)、グループ内の各レプリカのです。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-does-not-use-database-mirroring"></a>常に可用性グループにデータベース ミラーリングを使用しない既存のプールでの展開します。
<a name="BKMK_NoHAPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> AG にアップグレードするプールでは、組織の中央管理ストアをホストしている場合必要があります最初に移動する CMS 別のプールにこのプールをアップグレードする前にします。 プールを移動するには、Move-CsManagementServer コマンドレットを使用します。 組織内の別のプールがない、Standard Edition サーバーを一時的に展開し、AG にプールをアップグレードする前に、このサーバーに CMS を移動できます。 
  
1. AG の一部となるすべてのデータベース サーバーのフェールオーバー クラスタ リング機能を設定します。 各サーバーで、以下の作業を行います。
    
   - サーバー マネージャーを開き、[**役割と機能の追加**] をクリックします。
    
   - [**機能の選択**] ボックスが表示されるまで [**次へ**] をクリックします。このボックスで、[**フェールオーバー クラスタリング**] チェック ボックスをオンにします。
    
   - [**フェールオーバー クラスタリングに必要な機能を追加しますか?**] ボックスで、[**機能の追加**] をクリックします。
    
   - [**インストール**] をクリックします。
    
2. クラスター構成を検証します。
    
   - サーバー マネージャーで、[**ツール**] メニューをクリックし、[**フェールオーバー クラスター マネージャー**] をクリックします。
    
   - 画面右側の [**操作**] で、[**構成の検証**] をクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスターに追加するサーバーを選択し、[**すべてのテストを実行**] をクリックします。
    
   - [**概要**] ボックスで、ウィザードにより報告されたすべてのエラーを確認します。確認したら、[**完了**] をクリックして検証を完了します。
    
     特に、共有ストレージを使用していない場合、通常はウィザードにより複数の警告が報告されます。共有ストレージを使用する必要はありませんが、[**エラー**] でメッセージが表示されている場合は、作業を続行する前にこれらの問題を修正する必要があります。
    
3. (WSFC) Windows Server フェールオーバー クラスターを作成します。
    
   - [**フェールオーバー クラスター管理**] ウィザードで、[**フェールオーバー クラスター管理**]、[**クラスターの作成**] の順にクリックします。
    
   - [**開始する前に**] ページで、[**次へ**] をクリックします。
    
   - クラスター名と IP アドレスを追加します。設定が検証されたら、[**次へ**] をクリックします。
    
   - [確認] ページで、[**次へ**] をクリックします。
    
   - クラスターが作成されたら、[**完了**] をクリックします。
    
4. ファイル共有監視を使用するようにクラスター クォーラム設定を構成することをお勧めします。このためには、以下の手順を行います。
    
   - クラスター名を右クリックし、[**他の操作**]、[**クラスター クォーラム設定の構成**] の順にクリックします。
    
   - [**クォーラム構成オプションの選択**] ページで、[**クォーラム監視を選択する**] をクリックします。
    
   - [**クォーラム監視の選択**] ページで、[**ファイル共有監視を構成する**] をクリックします。
    
   - [**ファイル共有監視の構成**] ページで、使用するファイル共有のパスを入力し、[**次へ**] をクリックします。
    
   - [**確認**] ページで、[**次へ**] をクリックします。
    
5. クラスター内の各サーバーでは、AG で、SQL Server 構成マネージャーを有効にします。
    
   - SQL Server 構成マネージャーを開きます。画面左側のツリーで、[**SQL Server のサービス**] をクリックし、SQL Server サービスをダブルクリックします。 
    
   - [**プロパティ**] ボックスで、[**AlwaysOn 高可用性**] タブを選択します。[**AlwaysOn 可用性グループを有効にする**] チェック ボックスをオンにします。SQL Server サービスを再開するよう求めるメッセージが表示されたら、サービスを再開します。
    
6. 可用性グループを作成します。
    
   - SQL Server Management Studio を開き、SQL Server インスタンスに接続します。
    
   - オブジェクト エクスプ ローラーで、**常に高可用性**のフォルダーを展開します。 [**可用性グループ**] フォルダーを右クリックし、[**新しい可用性グループ ウィザード**] をクリックします。
    
   - [**説明**] ページが表示されたら、[**次へ**] をクリックします。
    
   - [**可用性グループ名の指定**] ページで、可用性グループの名前を入力し、[**次へ**] をクリックします。
    
   - データベースの選択] ページでは、AG に追加するデータベースを選択します。 続いて [ **次へ**] をクリックします。
    
     含めないでください、**レポート サーバー**、 **ReportServerTempDB**、またはデータベースの永続的なチャット、AG のようにこのシナリオではサポートされていません。 AG のビジネス サーバー データベースの他のすべての Skype を含めることができます。
    
   - **レプリカの指定**] ページで、[**複製**] タブをクリックします。**レプリカの追加**] ボタンをクリックし、次に、WSFC のノードとして参加した他の SQL インスタンスに接続します。
    
   - 各インスタンスの [**自動フェールオーバー**] オプションと [**同期コミット**] オプションをオンにします。[**読み取り可能なセカンダリ**] オプションはオンにしないでください。
    
   - [**エンドポイント**] タブをクリックし、[**ポート番号**] が "5022" に設定されていることを確認します。
    
   - [**リスナー**] タブをクリックし、[**可用性グループ リスナーの作成**] オプションをオンにします。そのオプションの下で、リスナーの名前を入力し、[**ポート**] を "1433" (他のポートはこのオプションではサポートされません) に設定します。
    
   - [**追加**] をクリックし、[**IPv4 アドレス**] ボックスに優先させる仮想 IP アドレスを入力して、[**OK**] をクリックします。
    
   - [**最初のデータの同期を選択**] ページで [完全] を選択します。レプリカがアクセスでき、両方のレプリカにより使用される SQL Server サービス アカウントが書き込みアクセス許可を持っているフォルダーを指定します。続いて、[**次へ**] をクリックします。
    
     このファイル共有は、データベースを初期化した時点で一時的に使用されます。大きなデータベースを扱う場合、使用するネットワーク帯域幅でデータベース バックアップのサイズに対応できない場合に備えて、データベースを手動で初期化することを推奨します。
    
     - [検証] ページで、すべての検証チェックが成功したことを確認し、[**次へ**] をクリックします。
    
   - [**概要**] ページで、すべての設定を確認し、[完了] をクリックします。
    
7. AG リスナーを指定する新しいストアを作成します。
    
   - トポロジ ビルダーを開きます。 トポロジで、[**共有コンポーネント**] を展開し、[**SQL Server ストア**] を右クリックして、[**新しい SQL Server ストア**] をクリックします。
    
   - [**新しい SQL ストアの定義**] ページで、まず [**高可用性の設定**] チェック ボックスをオンにしてから、SQL AlwaysOn 可用性グループがドロップダウン ボックスに表示されていることを確認します。
    
   - [**SQL Server の可用性グループのリスナーの FQDN**] ボックスに、可用性グループを作成したときに作成したリスナーの FQDN を入力します。
    
   - ボックスで、 **SQL Server の FQDN** AG のプライマリ ノードの FQDN を入力し、し、[ **OK**] をクリックします。
    
8. 新しい常に可用性グループをフロント エンド プールに関連付けます。
    
   - トポロジ ビルダーでは、AG と関連付けるプールを右クリックし、**プロパティの編集**] をクリックします。
    
   - **SQL Server ストア**] ボックスで、[**関連付け**の AG を選択します。 AG への移動先となるプール内の他のデータベースの同じグループを選択します。
    
   - AG に必要なすべてのデータベースが設定されていることを確認したら、[ **OK**] をクリックします。
    
9. トポロジを公開します。 [**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。 続いて、確認ページで [**次へ**] をクリックします。
    
10. AG のレプリカごとに、SQL ログインしているかどうかを確認するのにはいくつかの最終的な手順を実行します。
    
    - トポロジ ビルダーを開き**既存の展開からトポロジをダウンロード**するを選択して **[ok]** をクリックします。
    
    - [Skype for Business Server]、使用するトポロジ、[**SQL Server ストア**] の順に展開します。 、新しい AG の SQL ストアを右クリックし、[**プロパティの編集**] をクリックします。
    
    - [ **SQL Server の FQDN** ] ボックスで、ページの下部にある AG のリスナーの FQDN の値を変更します。
    
    - トポロジを公開します。[**操作**] メニューから、[**トポロジ**]、[**公開**] の順にクリックします。続いて、確認ページで [**次へ**] をクリックします。新しいトポロジがレプリケートされるまで数分待ちます。
    
    - SQL Server Management Studio を開き AG に移動します。 AlwaysOn 可用性グループのセカンダリ レプリカへのフェールオーバーを行います。
    
    - ビジネス サーバー管理シェルの Skype を開きこのレプリカの SQL ログインを作成するのには、次のコマンドレットを入力します。
    
      ```
      Install-CsDatabase -Update
      ```

      - 前の 2 つの手順を繰り返します (セカンダリ レプリカでは、グループをフェールオーバーしを使用して、 `Install-CsDatabase -Update`)、グループ内の各レプリカのです。
