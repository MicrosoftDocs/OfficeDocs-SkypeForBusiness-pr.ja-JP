---
title: サーバー内のバック エンド サーバーに Always On 可用性グループを展開Skype for Business Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
ms.assetid: c93c01e6-626c-40ad-92dd-373b0fe9189f
description: サーバーの展開で Always On 可用性グループを展開 (インストール) Skype for Business Serverします。
ms.openlocfilehash: 72bd60e102bfa121e2b8f7704032f54242aee202
ms.sourcegitcommit: 556fffc96729150efcc04cd5d6069c402012421e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/26/2021
ms.locfileid: "58620483"
---
# <a name="deploy-an-always-on-availability-group-on-a-back-end-server-in-skype-for-business-server"></a>サーバー内のバック エンド サーバーに Always On 可用性グループを展開Skype for Business Server
 
常に可用性グループ (AG) を展開 (インストール) し、Skype for Business Server展開します。
  
AG を展開する方法は、新しいプールに展開するか、ミラーリングを使用する既存のプールか、現在バック エンド データベースの高可用性がない既存のプールに展開するかによって異なります。
  
> [!NOTE]
> 常設チャット サーバーの役割を持つ AG の使用はサポートされていません。 
  
- [新しいフロントエンド プールに Always On 可用性グループを展開する](alwayson-availability-group.md#BKMK_NewPool_CreateAlwaysOnGroup)
    
- [データベース ミラーリングを使用する既存のプールに Always On 可用性グループを展開する](alwayson-availability-group.md#BKMK_MirroredPool_CreateAlwaysOnGroup)
    
- [データベース ミラーリングを使用しない既存のプールに Always On Availability グループを展開する](alwayson-availability-group.md#BKMK_NoHAPool_CreateAlwaysOnGroup)
    
## <a name="deploy-an-always-on-availability-group-on-a-new-front-end-pool"></a>新しいフロントエンド プールに Always On 可用性グループを展開する
<a name="BKMK_NewPool_CreateAlwaysOnGroup"> </a>

1. AG の一部になるすべてのデータベース サーバーでフェールオーバー クラスタリング機能を有効にします。 各サーバーで、次の操作を行います。
    
   - サーバー マネージャーを開き、[役割と **機能の追加] をクリックします**。
    
   - [機能 **の選択]** ボックスに到達するまで、[ **次へ] をクリック** します。 ここでは、[フェールオーバー クラスタリング **] チェック ボックスを** オンにします。
    
   - [フェールオーバー **クラスタリングに必要な機能の追加]** ボックスで、[機能の追加] **をクリックします**。
    
   - **[インストール]** をクリックします。
    
2. クラスター構成を検証します。
    
   - サーバー マネージャーで、[ツール] メニュー **をクリック** し、[フェールオーバー クラスター マネージャー **] をクリックします**。
    
   - 画面 **の右側にある** [アクション] で、[構成の検証] **をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスターに追加するサーバーを選択し、[すべてのテストを実行] **をクリックします**。
    
   - [概要 **] ボックスで** 、ウィザードが報告するエラーを確認します。 次に、[ **完了] を** クリックして検証を完了します。
    
     ウィザードは、共有ストレージを使用していない場合は特に、いくつかの警告を報告する可能性があります。 共有ストレージを使用する必要はありません。 ただし、エラー メッセージが **表示された場合** は、続行する前にこれらの問題を修正する必要があります。
    
3. サーバー フェールオーバー Windows (WSFC) を作成します。
    
   - フェールオーバー クラスター **の管理ウィザードで、[** フェールオーバークラスターの管理] を右クリックし、[クラスターの作成]**をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスター名と IP アドレスを追加します。 設定が検証された場合は、[次へ] を **クリックします**。
    
   - [確認] ページで、 **[次へ]** をクリックします。
    
   - クラスターを作成したら、[完了] を **クリックします**。
    
4. ファイル共有監視を使用するクラスター クォーラム設定を構成することをお勧めします。 これを行うには、次の手順を実行します。
    
   - クラスター名を右クリックし、[その他のアクション]**を** クリックし、[クラスター クォーラム の構成] をクリック **設定。**
    
   - [クォー **ラム構成オプションの選択] ページで** 、[クォーラム **監視の選択] をクリックします**。
    
   - [クォー **ラム監視の選択] ページ** で、[ファイル **共有監視の構成] をクリックします**。
    
   - [ファイル共有 **監視の構成** ] ページで、使用するファイル共有のパスを入力し、[次へ] を **クリックします**。
    
   - **[確認]** ページで、 **[次へ]** をクリックします。
    
5. クラスター内の各サーバーで、クラスター内の AG 機能を有効SQL Server 構成マネージャー。
    
   - SQL Server 構成マネージャーを開きます。 画面の左側のツリーで、[サービス] をクリック **SQL Server** し、サービスをダブルクリックSQL Serverします。 
    
   - [プロパティ **] ボックス** で **、[AlwaysOn 高可用性] タブを選択** します。 **[AlwaysOn 可用性グループを有効にする] チェック ボックス** をオンにします。 メッセージが表示されたらSQL Serverサービスを再起動します。
   
6. トポロジ ビルダーを使用して、フロントエンド プールを作成します(「新しいトポロジを作成して公開する」で説明[Skype for Business Server。](../../deploy/install/create-and-publish-new-topology.md) この操作を行う場合は、プールのSQLとして AG を指定します。
    
7. 可用性グループを作成します。
    
   - [SQL Server Management Studioを開き、インスタンスにSQL Serverします。
    
   - オブジェクト エクスプローラーで **、[Always On High Availability] フォルダーを展開** します。 [可用性グループ] フォルダー **を右クリックし** 、[新しい可用性 **グループ ウィザード] をクリックします**。
    
   - [概要] **ページが表示** されたら、[次へ] を **クリックします**。
    
   - [可用性グループ **名の指定] ページ** で、可用性グループの名前を入力し、[次へ] を **クリックします**。
    
   - [データベースの選択] ページで、AlwaysOn 可用性グループに含めるデータベースを選択します。 [**次へ**] をクリックします。
    
     このシナリオではサポートされていないので、AlwaysOn 可用性グループに **ReportServer** データベース **、ReportServerTempDB** データベース、または常設チャット データベースを含めずに使用します。 AlwaysOn 可用性グループには、Skype for Business Serverデータベースを含めできます。
    
   - [レプリカの **指定] ページで**、[レプリカ]**タブをクリック** します。次に、[**レプリカの追加**] ボタンをクリックし、SQL サーバー フェールオーバー クラスターのノードとして参加した他の Windowsインスタンスに接続します。
    
   - インスタンスごとに、[自動フェールオーバー]**オプションと [同期コミット****] オプションを選択** します。 [読み取り可能 **なセカンダリ] オプションを選択** しない。
    
   - [エンドポイント **] タブをクリック** し、[ポート番号] **が** 5022 に設定されています。
    
   - [リスナー **] タブを** クリックし、[可用性グループ リスナー **の作成] オプションを選択** します。 このオプションの下にリスナーの名前を入力し、 **ポート** を 1433 に設定します (他のポートは、このオプションではサポートされていません)。
    
   - [ **追加]** をクリックし **、[IPv4 アドレス** ] ボックスに希望の仮想 IP アドレスを指定し **、[OK] をクリックします**。
    
   - [初期データ同期 **の** 選択] ページで、[完全] を選択し、レプリカからアクセス可能なフォルダーを指定し、両方のレプリカで使用される SQL Server サービス アカウントに書き込みアクセス許可を付与します。 [**次へ**] をクリックします。
    
     このファイル共有は、データベースを初期化するときに一時的に使用されます。 大規模なデータベースを扱う場合は、ネットワーク帯域幅がデータベース バックアップのサイズに対応できない場合に備え、手動で初期化することをお勧めします。
    
   - [検証] ページで、すべての検証チェックが成功したと確認し、[次へ] を **クリックします**。
    
   - [概要] **ページで、** すべての設定を確認し、[完了] をクリックします。
      
8. プールと AG を展開した後、最終的な手順を実行して、alwaysOn 可用性グループ内の各レプリカに SQL ログインが含まれます。 
    
   - [トポロジ ビルダー] を開き、[ **既存の** 展開からトポロジをダウンロードする] を選択し **、[OK] をクリックします**。
    
   - [Skype for Business Server] を展開し、トポロジを展開し、[ストア] **SQL Server展開します**。 新しい AlwaysOn 可用性グループのSQLを右クリックし、[プロパティの編集]**をクリックします**。
    
     - ページの下部の **[FQDN]** ボックスSQL Server、AG のリスナーの FQDN に値を変更します。
    
   - トポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします**。 次に、新しいトポロジがレプリケートするまで数分待ちます。
    
   - [SQL Server Management Studio開き、AG に移動します。 セカンダリ レプリカにフェールオーバーします。
    
   - [Skype for Business Server管理シェル] を開き、次のコマンドレットを入力して、このSQLログインを作成します。
    
   ```powershell
   Install-CsDatabase -Update
   ```

   - グループ内の各レプリカについて、前の 2 つの手順を繰り返します (グループをセカンダリ レプリカにフェールオーバーしてから使用  `Install-CsDatabase -Update` します)。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-uses-database-mirroring"></a>データベース ミラーリングを使用する既存のプールに Always On 可用性グループを展開する
<a name="BKMK_MirroredPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> AG にアップグレードするプールが組織のサーバーの全体管理ストアをホストしている場合は、このプールをアップグレードする前に、まず CMS を別のプールに移動する必要があります。 プールを移動するにはMove-CsManagementServerコマンドレットを使用します。 組織内に別のプールが含されていない場合は、プールを AG にアップグレードする前に、Standard Edition サーバーを一時的に展開し、CMS をこのサーバーに移動できます。 
  
1. ミラーからプリンシパル ノードに対してすべてのデータをフェールオーバーするには、Skype for Business Serverを開き、次のコマンドレットを入力します。
    
   ```powershell
   Invoke-CsDatabaseFailover -PoolFqdn <Pool FQDN> -DatabaseType <DatabaseType> -NewPrincipal "Primary"
   ```

    プール内のデータベースの種類ごとにこのコマンドレットを繰り返します。 次のコマンドレットを使用して、このプールに格納されているデータベースの種類を検索できます。
     
   ```powershell
   Get-CsPool -Identity <Pool FQDN>
   ```

2. トポロジ ビルダーを使用して、プールからデータベース ミラーリングを削除します。
    
   - トポロジ ビルダーを開きます。 トポロジで、[フロントエンド プール] Enterprise Edition **展開** し、プールの名前を右クリックし、[プロパティの編集]**をクリックします**。
    
   - プール内のストアSQLの種類ごとに、[ストア ミラーリングを有効にするSQL **チェック** ボックスをオフにします。
    
3. 変更されたトポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします。**
    
4. ミラー SQL Server Management Studio壊す場合は、次のコマンドを使用します。
    
   - [SQL Server Management Studioを開き、データベースに移動し、[タスク] を右クリック **し、[ミラー** ] を **クリックします**。 次に、[**ミラーリングの削除] をクリックし****、[OK] をクリックします**。
    
   - これを、AG に変換されるプール内のすべてのデータベースに対して繰り返します。
    
5. AG の一部になるすべてのデータベース サーバーでフェールオーバー クラスタリング機能を設定します。 各サーバーで、次の操作を行います。
    
   - サーバー マネージャーを開き、[役割と **機能の追加] をクリックします**。
    
   - [機能 **の選択]** ボックスに到達するまで、[ **次へ] をクリック** します。 ここでは、[フェールオーバー クラスタリング **] チェック ボックスを** オンにします。
    
   - [フェールオーバー **クラスタリングに必要な機能の追加]** ボックスで、[機能の追加] **をクリックします**。
    
   - **[インストール]** をクリックします。
    
6. クラスター構成を検証します。
    
   - サーバー マネージャーで、[ツール] メニュー **をクリック** し、[フェールオーバー クラスター マネージャー **] をクリックします**。
    
   - 画面 **の右側にある** [アクション] で、[構成の検証] **をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスターに追加するサーバーを選択し、[すべてのテストを実行] **をクリックします**。
    
   - [概要 **] ボックスで** 、ウィザードが報告するエラーを確認します。 次に、[ **完了] を** クリックして検証を完了します。
    
     ウィザードは、共有ストレージを使用していない場合は特に、いくつかの警告を報告する可能性があります。 共有ストレージを使用する必要はありません。 ただし、エラー メッセージが **表示された場合** は、続行する前にこれらの問題を修正する必要があります。
    
7. サーバー フェールオーバー クラスター Windows作成します。
    
   - フェールオーバー クラスター **の管理ウィザードで、[** フェールオーバークラスターの管理] を右クリックし、[クラスターの作成]**をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスター名と IP アドレスを追加します。 設定が検証された場合は、[次へ] を **クリックします**。
    
   - [確認] ページで、 **[次へ]** をクリックします。
    
   - クラスターを作成したら、[完了] を **クリックします**。
    
8. ファイル共有監視を使用するクラスター クォーラム設定を構成することをお勧めします。 これを行うには、次の手順を実行します。
    
   - クラスター名を右クリックし、[その他のアクション]**を** クリックし、[クラスター クォーラム の構成] をクリック **設定。**
    
   - [クォー **ラム構成オプションの選択] ページで** 、[クォーラム **監視の選択] をクリックします**。
    
   - [クォー **ラム監視の選択] ページ** で、[ファイル **共有監視の構成] をクリックします**。
    
   - [ファイル共有 **監視の構成** ] ページで、使用するファイル共有のパスを入力し、[次へ] を **クリックします**。
    
   - **[確認]** ページで、 **[次へ]** をクリックします。
    
9. クラスター内の各サーバーで、クラスター内の AG 機能を有効SQL Server 構成マネージャー。
    
   - SQL Server 構成マネージャーを開きます。 画面の左側のツリーで、[サービス] をクリック **SQL Server** し、サービスをダブルクリックSQL Serverします。 
    
   - [プロパティ **] ボックス** で **、[AlwaysOn 高可用性] タブを選択** します。 **[AlwaysOn 可用性グループを有効にする] チェック ボックス** をオンにします。 メッセージが表示されたらSQL Serverサービスを再起動します。
    
10. 可用性グループを作成します。
    
    - [SQL Server Management Studioを開き、インスタンスにSQL Serverします。
    
    - オブジェクト エクスプローラーで **、[Always On High Availability] フォルダーを展開** します。 [可用性グループ] フォルダー **を右クリックし** 、[新しい可用性 **グループ ウィザード] をクリックします**。
    
    - [概要] **ページが表示** されたら、[次へ] を **クリックします**。
    
    - [可用性グループ **名の指定] ページ** で、可用性グループの名前を入力し、[次へ] を **クリックします**。
    
    - [データベースの選択] ページで、AlwaysOn 可用性グループに含めるデータベースを選択します。 [**次へ**] をクリックします。
    
    このシナリオではサポートされていないので、AlwaysOn 可用性グループに **ReportServer** データベース **、ReportServerTempDB** データベース、または常設チャット データベースを含めずに使用します。 AlwaysOn 可用性グループには、Skype for Business Serverデータベースを含めできます。
    
    - [レプリカの **指定] ページで**、[レプリカ]**タブをクリック** します。次に、[**レプリカの追加**] ボタンをクリックし、SQL サーバー フェールオーバー クラスターのノードとして参加した他の Windowsインスタンスに接続します。
    
    - インスタンスごとに、[自動フェールオーバー]**オプションと [同期コミット****] オプションを選択** します。 [読み取り可能 **なセカンダリ] オプションを選択** しない。
    
    - [エンドポイント **] タブをクリック** し、[ポート番号] **が** 5022 に設定されています。
    
      - [リスナー **] タブを** クリックし、[可用性グループ リスナー **の作成] オプションを選択** します。 このオプションの下にリスナーの名前を入力し、 **ポート** を 1433 に設定します (他のポートは、このオプションではサポートされていません)。
    
    - [ **追加]** をクリックし **、[IPv4 アドレス** ] ボックスに希望の仮想 IP アドレスを指定し **、[OK] をクリックします**。
    
    - [初期データ同期 **の** 選択] ページで、[完全] を選択し、レプリカからアクセス可能なフォルダーを指定し、両方のレプリカで使用される SQL Server サービス アカウントに書き込みアクセス許可を付与します。 [**次へ**] をクリックします。
    
    このファイル共有は、データベースを初期化するときに一時的に使用されます。 大規模なデータベースを扱う場合は、ネットワーク帯域幅がデータベース バックアップのサイズに対応できない場合に備え、手動で初期化することをお勧めします。
    
    - [検証] ページで、すべての検証チェックが成功したと確認し、[次へ] を **クリックします**。
    
    - [概要] **ページで、** すべての設定を確認し、[完了] をクリックします。
    
11. AG リスナーを指定し、古いミラーのプリンシパルを AG のプライマリ ノードとして指定する新しいストアを作成します。
    
    - トポロジ ビルダーを開きます。 トポロジで、[共有コンポーネント]**を展開** し、[ストア] を **右** クリックSQL Serverし、[新しいコンポーネント ストア]**をSQL Serverします**。
    
    - [新 **しい** SQL ストアの定義] ページで、まず [高可用性 設定] チェック ボックスをオンにし、SQL AlwaysOn 可用性グループがドロップダウン ボックスに表示されます。
    
    - [可用性 **SQL Server FQDN]** ボックスに、可用性グループの作成時に作成したリスナーの FQDN を入力します。
    
    - **[FQDN SQL Server]** ボックスに、AG のプライマリ ノードの FQDN を入力し **、[OK] をクリックします**。 これは、このストアの古いミラーのプリンシパルである必要があります。
    
12. 新しい AG をフロントエンド プールに関連付ける。
    
    - トポロジ ビルダーで、AG に関連付けるプールを右クリックし、[プロパティの編集] **をクリックします**。
    
    - [**関連付け]** の **[SQL Server] ボックスで**、AG を選択します。 AG に移動するプール内の他のデータベースに同じグループを選択します。
    
    - 必要なすべてのデータベースが AG に設定されている場合は **、[OK] をクリックします**。
    
13. トポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします**。
    
14. 最後の手順を実行して、AlwaysOn 可用性グループSQLの各レプリカにログインを実行します。
    
    - [トポロジ ビルダー] を開き、[ **既存の** 展開からトポロジをダウンロードする] を選択し **、[OK] をクリックします**。
    
    - [Skype for Business Server] を展開し、トポロジを展開し、[ストア] **SQL Server展開します**。 新しい AG のSQLを右クリックし、[プロパティの編集]**をクリックします**。
    
    - ページの下部の **[FQDN]** ボックスSQL Server、AG のリスナーの FQDN に値を変更します。
    
    - トポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします**。 次に、新しいトポロジがレプリケートするまで数分待ちます。
    
    - [SQL Server Management Studio開き、AG に移動します。 セカンダリ レプリカにフェールオーバーします。
    
    - [Skype for Business Server管理シェル] を開き、次のコマンドレットを入力して、このSQLログインを作成します。
    
    ```powershell
    Install-CsDatabase -Update
    ```

    - グループ内の各レプリカについて、前の 2 つの手順を繰り返します (グループをセカンダリ レプリカにフェールオーバーしてから使用  `Install-CsDatabase -Update` します)。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-does-not-use-database-mirroring"></a>データベース ミラーリングを使用しない既存のプールに Always On Availability グループを展開する
<a name="BKMK_NoHAPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> AG にアップグレードするプールが組織のサーバーの全体管理ストアをホストしている場合は、このプールをアップグレードする前に、まず CMS を別のプールに移動する必要があります。 プールを移動するにはMove-CsManagementServerコマンドレットを使用します。 組織内に別のプールが含されていない場合は、プールを AG にアップグレードする前に、Standard Edition サーバーを一時的に展開し、CMS をこのサーバーに移動できます。 
  
1. AG の一部になるすべてのデータベース サーバーでフェールオーバー クラスタリング機能を設定します。 各サーバーで、次の操作を行います。
    
   - サーバー マネージャーを開き、[役割と **機能の追加] をクリックします**。
    
   - [機能 **の選択]** ボックスに到達するまで、[ **次へ] をクリック** します。 ここでは、[フェールオーバー クラスタリング **] チェック ボックスを** オンにします。
    
   - [フェールオーバー **クラスタリングに必要な機能の追加]** ボックスで、[機能の追加] **をクリックします**。
    
   - **[インストール]** をクリックします。
    
2. クラスター構成を検証します。
    
   - サーバー マネージャーで、[ツール] メニュー **をクリック** し、[フェールオーバー クラスター マネージャー **] をクリックします**。
    
   - 画面 **の右側にある** [アクション] で、[構成の検証] **をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスターに追加するサーバーを選択し、[すべてのテストを実行] **をクリックします**。
    
   - [概要 **] ボックスで** 、ウィザードが報告するエラーを確認します。 次に、[ **完了] を** クリックして検証を完了します。
    
     ウィザードは、共有ストレージを使用していない場合は特に、いくつかの警告を報告する可能性があります。 共有ストレージを使用する必要はありません。 ただし、エラー メッセージが **表示された場合** は、続行する前にこれらの問題を修正する必要があります。
    
3. サーバー フェールオーバー Windows (WSFC) を作成します。
    
   - フェールオーバー クラスター **の管理ウィザードで、[** フェールオーバークラスターの管理] を右クリックし、[クラスターの作成]**をクリックします**。
    
   - **[始める前に]** ページで、 **[次へ]** をクリックします。
    
   - クラスター名と IP アドレスを追加します。 設定が検証された場合は、[次へ] を **クリックします**。
    
   - [確認] ページで、 **[次へ]** をクリックします。
    
   - クラスターを作成したら、[完了] を **クリックします**。
    
4. ファイル共有監視を使用するクラスター クォーラム設定を構成することをお勧めします。 これを行うには、次の手順を実行します。
    
   - クラスター名を右クリックし、[その他のアクション]**を** クリックし、[クラスター クォーラム の構成] をクリック **設定。**
    
   - [クォー **ラム構成オプションの選択] ページで** 、[クォーラム **監視の選択] をクリックします**。
    
   - [クォー **ラム監視の選択] ページ** で、[ファイル **共有監視の構成] をクリックします**。
    
   - [ファイル共有 **監視の構成** ] ページで、使用するファイル共有のパスを入力し、[次へ] を **クリックします**。
    
   - **[確認]** ページで、 **[次へ]** をクリックします。
    
5. クラスター内の各サーバーで、クラスター内で AG をSQL Server 構成マネージャー。
    
   - SQL Server 構成マネージャーを開きます。 画面の左側のツリーで、[サービス] をクリック **SQL Server** し、サービスをダブルクリックSQL Serverします。 
    
   - [プロパティ **] ボックス** で **、[AlwaysOn 高可用性] タブを選択** します。 **[AlwaysOn 可用性グループを有効にする] チェック ボックス** をオンにします。 メッセージが表示されたらSQL Serverサービスを再起動します。
    
6. 可用性グループを作成します。
    
   - [SQL Server Management Studioを開き、インスタンスにSQL Serverします。
    
   - オブジェクト エクスプローラーで **、[Always On High Availability] フォルダーを展開** します。 [可用性グループ] フォルダー **を右クリックし** 、[新しい可用性 **グループ ウィザード] をクリックします**。
    
   - [概要] **ページが表示** されたら、[次へ] を **クリックします**。
    
   - [可用性グループ **名の指定] ページ** で、可用性グループの名前を入力し、[次へ] を **クリックします**。
    
   - [データベースの選択] ページで、AG に含めるデータベースを選択します。 [**次へ**] をクリックします。
    
     このシナリオでは **サポートされていないので、REPORTServer** データベース **、ReportServerTempDB** データベース、または常設チャット データベースを AG に含めない。 その他のすべてのデータベース データベースSkype for Business Server AG に含めできます。
    
   - [レプリカの **指定] ページで**、[レプリカ]**タブをクリック** します。次に、[**レプリカの追加]** ボタンをクリックし、WSFC SQLとして参加した他のインスタンスに接続します。
    
   - インスタンスごとに、[自動フェールオーバー]**オプションと [同期コミット****] オプションを選択** します。 [読み取り可能 **なセカンダリ] オプションを選択** しない。
    
   - [エンドポイント **] タブをクリック** し、[ポート番号] **が** 5022 に設定されています。
    
   - [リスナー **] タブを** クリックし、[可用性グループ リスナー **の作成] オプションを選択** します。 このオプションの下にリスナーの名前を入力し、 **ポート** を 1433 に設定します (他のポートは、このオプションではサポートされていません)。
    
   - [ **追加]** をクリックし **、[IPv4 アドレス** ] ボックスに希望の仮想 IP アドレスを指定し **、[OK] をクリックします**。
    
   - [初期データ同期 **の** 選択] ページで、[完全] を選択し、レプリカからアクセス可能なフォルダーを指定し、両方のレプリカで使用される SQL Server サービス アカウントに書き込みアクセス許可を付与します。 [**次へ**] をクリックします。
    
     このファイル共有は、データベースを初期化するときに一時的に使用されます。 大規模なデータベースを扱う場合は、ネットワーク帯域幅がデータベース バックアップのサイズに対応できない場合に備え、手動で初期化することをお勧めします。
    
     - [検証] ページで、すべての検証チェックが成功したと確認し、[次へ] を **クリックします**。
    
   - [概要] **ページで、** すべての設定を確認し、[完了] をクリックします。
    
7. AG リスナーを指定する新しいストアを作成します。
    
   - トポロジ ビルダーを開きます。 トポロジで、[共有コンポーネント]**を展開** し、[ストア] を **右** クリックSQL Serverし、[新しいコンポーネント ストア]**をSQL Serverします**。
    
   - [新 **しい** SQL ストアの定義] ページで、まず [高可用性 設定] チェック ボックスをオンにし、SQL AlwaysOn 可用性グループがドロップダウン ボックスに表示されます。
    
   - [可用性 **SQL Server FQDN]** ボックスに、可用性グループの作成時に作成したリスナーの FQDN を入力します。
    
   - **[FQDN SQL Server]** ボックスに、AG のプライマリ ノードの FQDN を入力し **、[OK] をクリックします**。
    
8. 新しい Always On 可用性グループをフロントエンド プールに関連付ける。
    
   - トポロジ ビルダーで、AG に関連付けるプールを右クリックし、[プロパティの編集] **をクリックします**。
    
   - [**関連付け]** の **[SQL Server] ボックスで**、AG を選択します。 AG に移動するプール内の他のデータベースに同じグループを選択します。
    
   - 必要なすべてのデータベースが AG に設定されている場合は **、[OK] をクリックします**。
    
9. トポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします**。
    
10. 最後の手順を実行して、SQLが AG の各レプリカ上にあるか確認します。
    
    - [トポロジ ビルダー] を開き、[ **既存の** 展開からトポロジをダウンロードする] を選択し **、[OK] をクリックします**。
    
    - [Skype for Business Server] を展開し、トポロジを展開し、[ストア] **SQL Server展開します**。 新しい AG のSQLを右クリックし、[プロパティの編集]**をクリックします**。
    
    - ページの下部の **[FQDN]** ボックスSQL Server、AG のリスナーの FQDN に値を変更します。
    
    - トポロジを公開します。 [操作] **メニューの [** トポロジ] **をクリックし** 、[発行] **をクリックします**。 次に、確認ページで [次へ] を **クリックします**。 次に、新しいトポロジがレプリケートするまで数分待ちます。
    
    - [SQL Server Management Studio開き、AG に移動します。 セカンダリ レプリカにフェールオーバーします。
    
    - [Skype for Business Server管理シェル] を開き、次のコマンドレットを入力して、このSQLログインを作成します。
    
      ```powershell
      Install-CsDatabase -Update
      ```

      - グループ内の各レプリカについて、前の 2 つの手順を繰り返します (グループをセカンダリ レプリカにフェールオーバーしてから使用  `Install-CsDatabase -Update` します)。
