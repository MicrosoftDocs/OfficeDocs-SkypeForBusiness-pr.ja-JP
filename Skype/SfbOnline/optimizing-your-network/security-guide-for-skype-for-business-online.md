---
title: Skype for Business Online セキュリティ ガイド
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.reviewer: ''
ms.date: 01/22/2018
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection: Adm_Skype4B_Online
audience: Admin
appliesto:
- Skype for Business
- Skype for Business Online
- Microsoft Teams
localization_priority: Normal
f1.keywords:
- NOCSH
ms.custom:
- Security
description: Skype for Business Online セキュリティ ガイド <add description>
ms.openlocfilehash: 268a9859439ca91b5ad7cd8d5e32edf707860cde
ms.sourcegitcommit: 19f534bfafbc74dbc2d381672b0650a3733cb982
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/03/2020
ms.locfileid: "41706812"
---
# <a name="security-and-skype-for-business-online"></a>セキュリティと Skype for Business Online

Skype for Business Online (SfBO) は、Office 365 サービスの一環として、多層防御によるサービス レベルのセキュリティ、サービス内の顧客管理、セキュリティ強化、運用のベスト プラクティスなど、すべてのセキュリティのベスト プラクティスおよび手順に従います。詳細については、Microsoft セキュリティ センター (https://microsoft.com/trustcenter) を参照してください。

## <a name="trustworthy-by-design"></a>設計による高い信頼性
Skype for Business Online は、 https://www.microsoft.com/en-us/sdl/default.aspx に記載されている、信頼できるコンピューティングのセキュリティ開発ライフサイクル (SDL) に準拠して設定および開発されています。より安全な統合コミュニケーション システムを作成する最初のステップは、脅威モデルを設計し、各機能の設計時にテストすることでした。複数のセキュリティ関連の改善点がコーディング プロセスとコーディング手法に組み込まれました。コードが最終的な製品にチェックインされる前に、ビルド時ツールにより、バッファー オーバーランおよびその他のセキュリティ脅威の可能性を検出します。もちろん、すべての未知のセキュリティ脅威を防ぐように設計することは不可能です。完全なセキュリティを保証できるシステムはありません。ただし、安全な設計の原則が、当初から製品開発に採用されているため、Skype for Business Online には、アーキテクチャの基本的な部分として業界の標準的なセキュリティ技術が組み込まれています。 

## <a name="trustworthy-by-default"></a>既定による高い信頼性
Skype for Business Online におけるネットワーク通信は、既定で暗号化されています。すべてのサーバーについて証明書の使用を必須にしていること、および OAuth、TLS、セキュア リアルタイム転送プロトコル (SRTP)、およびその他の業界標準暗号化技術 (256 ビットの Advanced Encryption Standard (AES) 暗号化など) を使用することにより、すべての Skype for Business Online データがネットワーク上で保護されます。

## <a name="how-sfbo-handles-common-security-threats"></a>SfBO の一般的なセキュリティ上の脅威に対する対処方法
このセクションでは、SfBO サービスのセキュリティに対するより一般的な脅威と、Microsoft がそれらの脅威の軽減に用いる方法を明らかにします。

### <a name="compromised-key-attack"></a>危害を受けたキーによる攻撃
キーとは、機密情報の暗号化、復号化、または検証に使用される秘密のコードまたは数値です。公開キー基盤 (PKI) で使用される、注意が必要な機密のキーは 2 つあります。1 つは各証明書所有者が持つ秘密キーで、もう 1 つは通信するパートナーによる識別とセッション キーの交換が成功した後で使用されるセッション キーです。侵害されたキーによる攻撃は、攻撃者が秘密キーまたはセッション キーを割り出した場合に発生します。攻撃者がキーを割り出すのに成功した場合、攻撃者はそのキーを使用して、データの送信者に関する知識がなくても、暗号化されているデータを復号化できます。

Skype for Business Online は、Windows Server オペレーティング システムで PKI の機能を使用して、トランスポート層セキュリティ (TLS) 接続の暗号化に使用されるキー データを保護します。メディアの暗号化に使用されるキーは、TLS 接続を介して交換されます。 

### <a name="network-denial-of-service-attack"></a>ネットワークのサービス拒否攻撃
サービス拒否攻撃は、有効なユーザーによるネットワークの正常な使用または機能が、攻撃者によって妨害された場合に発生します。サービス拒否攻撃により、攻撃者は以下のことを行うことができます。
- 攻撃対象のネットワークで実行されているアプリケーションまたはサービスに対して無効なデータを送信して、そのようなアプリケーションまたはサービスが正常に機能するのを妨害する。
- 大量のトラフィックを送信してシステムを過負荷状態にして、適正な要求に対するシステムの応答を停止または低速化する。
- 攻撃の証拠を隠蔽する。
- ユーザーがネットワーク リソースにアクセスできないようにする。

このような攻撃を緩和するため、SfBO は Azure DDOS ネットワーク保護を実行し、同じエンドポイント、サブネット、およびフェデレーション エンティティからのクライアント要求を調整します。

### <a name="eavesdropping"></a>盗聴
盗聴は、攻撃者が、ネットワークのデータ パスにアクセスし、トラフィックの監視と読み取りの機能を持っているときに起こる可能性があります。これは、スニッフィングまたはスヌーピングとも呼ばれます。トラフィックがプレーン テキストの場合、攻撃者は、ネットワークのパスにアクセスしたときにトラフィックを読み取ることができます。例としては、データ パス上のルーターを制御することによって実行される攻撃があります。 

SfBO は O365 内のサーバー通信に相互 TLS (MTLS) を、クライアントからサーバーには TLS を使用することです。これにより、ある会話が攻撃される可能性のある時間内にこの攻撃を達成することは非常に困難で、不可能に近くなります。TLS はすべての関係者を認証し、すべてのトラフィックを暗号化します。これで盗聴が防がれることはありませんが、攻撃者は暗号を破らない限りトラフィックを読み取れません。

TURN プロトコルは、リアルタイム メディアの目的に使用されます。TURN プロトコルでは、トラフィックの暗号化は必須ではなく、送信する情報は、メッセージの整合性によって保護されます。盗聴にさらされているにもかかわらず、パケットのソースと宛先のアドレスを見るだけで、送信する情報 (つまり、IP アドレスとポート) を直接抽出できます。SfBO サービスは、クリア テキストで送信されることのない TURN パスワードをはじめとするいくつかのアイテムから得られるキーを使用して、メッセージのメッセージ整合性を確認することにより、データが有効であることを確保します。SRTP はメディア トラフィックに使用され、暗号化されます。

### <a name="identity-spoofing-ip-address-spoofing"></a>ID のスプーフィング (IP アドレスのスプーフィング)
スプーフィングは、攻撃者が権限なしにネットワーク、コンピューター、またはネットワーク コンポーネントの IP アドレスを特定し、使用する場合に発生します。攻撃に成功した場合、攻撃者は、通常その IP アドレスで識別されるエンティティであるかのように振る舞うことができます。Microsoft Lync Server 2010 のコンテキスト内では、管理者が次の両方を行った場合にこのような状況になります。
- 伝送制御プロトコル (TCP) のみをサポートする接続を構成した (TCP 接続は暗号化されないため、推奨されません)。
- このような接続の IP アドレスを信頼されたホストとしてマークした。 

トランスポート層セキュリティ (TLS) 接続の場合、この問題は軽減されます。TLS では、すべての当事者が認証され、すべてのトラフィックが暗号化されるからです。TLS を使用することによって、攻撃者が特定の接続 (たとえば相互 TLS 接続) に対して IP アドレスのスプーフィングを実行するのを防ぐことができます。それでも、SfBO が使用する DNS サーバーのアドレスを攻撃者がスプーフィングする可能性は残ります。しかし、SfBO での認証には証明書が使用されるため、通信のどちらかの当事者をスプーフィングするために必要となる有効な証明書を攻撃者は持ちません。

### <a name="man-in-the-middle-attack"></a>中間者攻撃
man-in-the-middle 攻撃は、2 人のユーザー間の通信を、それらのユーザーに気付かれることなく攻撃者が自分のコンピューターを経由して再ルーティングする場合に発生します。攻撃者は、トラフィックを監視して読み取った後で、本来の受信者にトラフィックを送信します。通信を行っている各ユーザーは、指定ユーザーと通信しているつもりで、知らないうちに攻撃者との間でトラフィックを送受信します。このような状況が発生するのは、攻撃者が、Active Directory ドメイン サービスを書き換えて自分のサーバーを信頼されたサーバーとして追加するか、またはドメイン ネーム システム (DNS) を書き換えてクライアントからサーバーへの接続に攻撃者を仲介させることに成功した場合です。 

中間者攻撃は、TLS を使うセッション開始プロトコル (SIP) を使用してピア間でネゴシエートされた暗号キーを使用する SRTP で暗号化された SfBO Point-To-Point 音声、ビデオ、アプリケーション共有ストリームを除き、2 つのクライアント間のメディア トラフィックでも発生する可能性がありますします。 

### <a name="rtp-replay-attack"></a>RTP リプレイ アタック
再生攻撃は、2 者間の有効なメディア伝送が、不正な目的で傍受されて転送される場合に発生します。SfBO がセキュリティ保護されたシグナリング プロトコルでの併用で使用する SRTP は、受信側が、既に受信した RTP パケットのインデックスを保持して、インデックスに既にリストされているパケットと新しい各パケットを比較できるようにすることで、再生攻撃から伝送を守ります。

### <a name="spim"></a>SPIM
SPIM とは、一方的に送りつけられる営利目的のインスタント メッセージまたはプレゼンス サブスクリプション要求のことです。それ自体はネットワークを侵害するものではありませんが、少なくとも迷惑なものであり、リソースの可用性および生産性を低下させ、結果としてネットワークの侵害を招く可能性があります。SPIM の一例として、ユーザーが要求を送信することで相互に SPIM を送るケースがあります。ユーザーは相互にブロックしてこれを防ぐことができますが、フェデレーションの場合、調整された SPIM 攻撃が確立されると、パートナーのフェデレーションを無効にしない限り、対処が困難になるおそれがあります。

### <a name="viruses-and-worms"></a>ウイルスとワーム
ウイルスは、同種の追加コード単位の複製を目的としたコード単位です。ウイルスは、有効に機能するためにホスト (ファイル、電子メール、プログラムなど) を必要とします。ワームも、ウイルスと同様、同種の追加コード単位を複製するようにコーディングされたコード単位ですが、ウイルスとは違ってホストを必要としません。ウイルスとワームは、クライアント間でファイルを転送しているとき、または他のユーザーから URL が送信されたときに主に出現します。ウイルスがコンピューター上に存在する場合、そのウイルスは、たとえば、無断でユーザー ID を使用してインスタント メッセージを送信する可能性があります。ウイルスの定期的なスキャンなど、標準的なクライアント セキュリティのベスト プラクティスによって、この問題を軽減できます。 

## <a name="personally-identifiable-information"></a>個人を特定できる情報
SfBO では、個人に結び付けることのできる情報がパブリック ネットワーク上で公開される可能性があります。このような情報は、次の 2 つのカテゴリに分類できます。
- **拡張プレゼンス データ**&nbsp;&nbsp;&nbsp; 張プレゼンス データは、フェデレーション パートナーへのリンクで、または組織内の連絡先との間で、共有するかどうかをユーザーが選択できる情報です。このデータは、パブリック IM ネットワーク上のユーザーとは共有されません。クライアント ポリシーおよびその他のクライアント構成により、システム管理者は部分的な管理を行うことができます。 SfBO サービスでは、個別のユーザーに対して拡張プレゼンス プライバシー モードを構成でき、ユーザーの連絡先リストに含まれていない SfBO ユーザーがそのユーザーのプレゼンス情報を参照するのを防ぐことができます。 
- **必須のデータ**&nbsp;&nbsp;&nbsp;必須のデータは、サーバーまたはクライアントが適切に機能するために必要なデータです。これは、ルーティング、状態維持、およびシグナリングのためにサーバー レベルまたはネットワーク レベルで必要な情報です。次の表は SfBO が動作するのに必要なデータをリスト化しています。

***表 1 - 拡張プレゼンス データ***

<!--start table here -->


|                      |                                                                                            |   |
|:---------------------|:-------------------------------------------------------------------------------------------|:--|
| **データ**             | **指定可能な** **設定**                                                                  |   |
| 個人データ        | 名前、役職、会社、電子メール アドレス、タイム ゾーン                                             |   |
| 電話番号    | 勤務先、携帯、自宅                                                                         |   |
| 予定表情報 | 空き時間、出張の通知、ミーティングの詳細 (予定表にアクセスできるユーザーに公開されます) |   |
| [プレゼンス状態]      | 退席中、連絡可能、取り込み中、応答不可、オフライン                                             |   |
|                      |                                                                                            |   |

<!-- end of table -->

***表 2 - 必須データ***

<!--start table here -->


|              |                                                                 |   |
|:-------------|:----------------------------------------------------------------|:--|
| **カテゴリ** | **指定可能な設定**                                           |   |
| IP アドレス   | コンピューターの実際のアドレスまたは NAT で変換したアドレス                     |   |
| SIP URI      | <u>david.campbell@contoso.com</u>                               |   |
| 名前         | David Campbell (Active Directory Domain Services で定義されている名前) |   |
|              |                                                                 |   |

<!-- end of table -->

## <a name="security-framework-for-sfbo"></a>SfBO のセキュリティ フレームワーク
ここでは、Microsoft SfBO のセキュリティ フレームワークを形成する基本要素の概要を示します。これらの要素は次のとおりです。
- Azure Active Directory (AAD) は、ユーザー アカウント用の単一の信頼できるバックエンド リポジトリを提供します。 
- 公開キー基盤 (PKI) は、信頼された証明機関 (CA) によって発行された証明書を使用してサーバーを認証し、データの整合性を確保します。
- トランスポート層セキュリティ (TLS)、HTTPS over SSL (HTTPS)、相互 TLS (MTLS) を使用すると、エンドポイント認証と IM の暗号化ができます。ポイント間の音声、ビデオ、アプリケーション共有のストリームは、セキュア リアルタイム転送プロトコル (SRTP) で暗号化され、整合性を確認されます。
- ユーザーの認証には、業界標準のプロトコルができる限り使用されます。

このセクションのトピックでは、SfBO のセキュリティを高めるために、各基本要素が機能するしくみについて説明します。

### <a name="azure-active-directory"></a>Azure Active Directory
Azure Active Directory は、O365 のディレクトリ サービスとして機能します。すべてのユーザー ディレクトリ情報とポリシーの割り当てが保存されます。 

### <a name="public-key-infrastructure-for-sfbo"></a>SfBO の公開キー基盤
SfBO サービスは、サーバーの認証と、クライアントとサーバー間および異なるサーバー役割間の信頼チェーンの確立に証明書を使用します。Windows Server の公開キー基盤 (PKI) は、この信頼チェーンを確立および検証するためのインフラストラクチャを提供します。証明書とはデジタル ID です。証明書は、名前によってサーバーを識別し、そのプロパティを指定します。 証明書の情報が有効であることを確認するには、サーバーに接続するクライアントやその他のサーバーが信頼する証明機関 (CA) から証明書が発行されていることが必要です。 サーバーがプライベート ネットワーク上の他のクライアントおよびサーバーとのみ接続する場合は、CA はエンタープライズ CA で問題ありません。 サーバーがプライベート ネットワーク外のエンティティと対話する場合は、パブリック CA が必要な場合があります。

証明書の情報が有効であっても、証明書を提示しているサーバーが、実際に証明書によって提示されているサーバーであることを確認する手段が必要です。ここで Windows PKI が役立ちます。各証明書は、公開キーにリンクされています。証明書で名前が指定されているサーバーには、そのサーバーのみが知る、対応する秘密キーがあります。接続しようとしているクライアントまたはサーバーは、公開キーを使用して無作為な情報の断片を暗号化し、それをサーバーに送信します。 サーバーがその情報の暗号化を解除し、プレーン テキストに戻すと、接続しようとしているエンティティは、証明書の秘密キーをサーバーが保持していること、つまり、そのサーバーが証明書で指定されていることが確認できます。

#### <a name="crl-distribution-points"></a>CRL 配布ポイント
SfBO では、すべてのサーバー証明書に 1 つ以上の証明書失効リスト (CRL) 配布ポイントが含まれている必要があります。CRL 配布ポイント (CDP) とは、証明書の発行後にそれが失効していないこと、および証明書が有効期限内にあることを確認するために、CRL をダウンロードできる場所です。CRL 配布ポイントは、URL として証明書のプロパティに記述され、セキュア HTTP です。SfBO サービスはすべての証明書認証で CRL をチェックします。

#### <a name="enhanced-key-usage"></a>拡張キーの使用方法
SfBO サービスのすべてのコンポーネントでは、サーバー認証のために、拡張キー使用法 (EKU) をすべてのサーバー証明書がサポートする必要があります。サーバー認証用に EKU フィールドを構成することは、サーバーの認証に対して、その証明書が有効であることを意味します。この EKU は、MTLS には不可欠です。 

### <a name="tls-and-mtls-for-sfbo"></a>SfBO の TLS と MTLS
TLS プロトコルと MTLS プロトコルにより、インターネット上での通信の暗号化とエンドポイント認証機能が提供されます。 SfBO は、この 2 つのプロトコルを使用して、信頼されたサーバーのネットワークを形成し、このネットワーク上のすべての通信が暗号化されるようにします。サーバー間のすべての SIP 通信は MTLS により行われます。クライアントからサーバーへの SIP 通信は TLS により行われます。

TLS により、ユーザーはそのクライアント ソフトウェアを介して接続先の SfBO サーバーを認証することができます。TLS 接続では、クライアントはサーバーから有効な証明書を要求します。証明書が有効であると見なされるためには、証明書の発行元の CA がクライアントからも信頼されていること、およびサーバーの DNS 名が証明書の DNS 名に一致していることが必要です。証明書が有効な場合、クライアントは証明書内の公開キーを使用して、通信に使う対称暗号化キーを暗号化し、証明書の最初の所有者だけが、その秘密キーを使用して通信の内容を暗号化することができます。この接続は信頼済みと見なされ、それ以降は他の信頼されたサーバーやクライアントからチャレンジされません。このような意味合いで、Web サービスで使用される SSL (Secure Sockets Layer) は TLS ベースであるということができます。

サーバー間接続は、相互認証に相互 TLS (MTLS) に依存しています。 MTLS 接続では、メッセージを発信したサーバーとそれを受信したサーバーは、相互に信頼された CA から証明書を交換します。証明書は各サーバーの身元を他のサーバーに証明します。 SfBO サービスでは、この手順に従います。

TLS と MTLS は、盗聴および中間者 (man-in-the-middle) 攻撃の両方を防ぐのに役立ちます。中間者 (man-in-the-middle) 攻撃では、攻撃者は 2 つのネットワーク エンティティ間の通信を、双方に気付かれることなく、攻撃者のコンピューターを経由して再ルーティングします。TLS および SfBO の仕様による信頼されたサーバーでは、2 つのエンドポイントの間で公開キー暗号法に基づいて連携するエンドツーエンドの暗号化を使用することで、アプリケーション層での中間者 (man-in-the-middle) 攻撃のリスクが部分的に軽減され、攻撃者は有効で信頼された証明書 (対応する秘密キーがあり、クライアントが通信の暗号を解読するためにやり取りするサービスの名前に合わせて発行されたもの) を手に入れるしかなくなります。 

### <a name="encryption-for-sfbo"></a>SfBO の暗号化
SfBO はインスタント メッセージを暗号化するために TLS と MTLS を使います。トラフィックが内部ネットワークに限定されているか、内部ネットワークの境界を越えるかに関係なく、MTLS は、サーバー間のすべてのトラフィックに必要です。

次の表は、SfBO で使用するプロトコルをまとめたものです。

***表 3 - トラフィック保護***

<!--start table here with header -->


|||
|:-----|:-----|
|**トラフィックの種類**|**保護用プロトコル**|
|サーバー間|MTLS|
|クライアントからサーバー|TLS|
|インスタント メッセージングとプレゼンス|TLS (TLS 用に構成されている場合)|
|オーディオとビデオ、メディアのデスクトップ共有|SRTP|
|デスクトップ共有 (シグナリング)|TLS|
|Web 会議|TLS|
|会議コンテンツのダウンロード、アドレス帳のダウンロード、配布グループの拡張|HTTPS|
|||

<!-- end of table -->

#### <a name="media-encryption"></a>メディアの暗号化
メディア トラフィックは、RTP トラフィックに対する機密性、認証、およびリプレイ攻撃からの保護を提供する Secure RTP (SRTP)、リアルタイム転送プロトコル (RTP) のプロファイルを使用して暗号化されます。 SRTP は、安全な乱数ジェネレータを使用して生成され、シグナリング TLS チャネルを使用して交換されたセッション キーを使用します。さらに、仲介サーバーとその内部のネクスト ホップの間で双方向に流れるメディアも SRTP を使用して暗号化されます。 

SfBO は TURN を介したメディア リレーへの安全なアクセスのためのユーザー名/パスワードを生成します。メディア リレーは、TLS で保護された SIP チャネルを介してユーザ名/パスワードを交換します。

#### <a name="fips"></a>FIPS
SfBO は、暗号キーの交換に FIPS (Federal Information Processing Standard) に準拠したアルゴリズムを使用します。 

### <a name="user-and-client-authentication"></a>ユーザー認証とクライアント認証 
信頼されたユーザーとは、AAD in O365 によって資格情報が認証されたユーザーを指します。 

認証では、ユーザーの資格情報が信頼されたサーバーまたはサービスに渡されます。SfBO では、ユーザーの状態や場所に応じて、次の認証プロトコルを使用します。
- **先進認証**は、クライアントからサーバーへの通信用に OAuth 2.0をマイクロソフトが実装したものです。 O365 証明書ベースの認証、O365 多要素認証、O365 条件付きアクセスなどのセキュリティ機能を有効にします。 MA を使用するには、オンライン テナントとクライアントの両方で MA が有効になっている必要があります。 2017 年 5 月以降に作成された SfBO テナントは、規定で MA が有効になっています。この時間より前に作成されたテナントの場合は、ここの指示に従ってそれをオンにします。 Skype for Business 2015 または 2016 クライアント、Mac の Skype for Business、Lync 2013 クライアント、3PIP IP 電話、iOS、および Androidのすべてのクライアントが MA をサポートしています。 
- **Org ID** は、先進認証が有効ではない (または使用できない) 場合に使用されます。
- **ダイジェスト プロトコル**: いわゆる匿名ユーザーに対して使用されます。匿名ユーザーは、有効な Active Directory の資格情報は持たないが、社内会議に招待され、有効な会議キーを持つ外部ユーザーです。ダイジェスト認証は、他のクライアント操作には使用されません。

SfBO 認証は 以下の 2 つのフェーズで構成されます。
1. クライアントとサーバーの間に、セキュリティ アソシエーションが確立されます。
2. クライアントとサーバーは、既存のセキュリティ アソシエーションを使用して、送信するメッセージに署名し、受信するメッセージを検証します。サーバーで認証が有効になっている場合、クライアントからの認証されていないメッセージは受信されません。

ユーザーの信用情報は、ユーザー ID 自体ではなく、ユーザーから送信される各メッセージに添付されます。サーバーは、各メッセージについて、送信元ユーザーの資格情報が有効であるかどうか確認します。ユーザーの資格情報が有効な場合、そのメッセージを受け取る最初のサーバーだけでなく、SfBO に属する他のすべてのサーバーで、そのメッセージが受信できるようになります。

フェデレーション パートナーが発行した有効な資格情報を持つユーザーは信頼されますが、これらのユーザーに対しては、内部ユーザーに与えられる権限のうち一部の使用を、必要に応じて制限できます。

メディア認証には、ICE プロトコルおよび TURN プロトコルでも、IETF TURN RFC に記載されているとおり、ダイジェスト認証が使用されます。詳細については、「[Media Traversal](#external-user-av-traffic-traversal)」を参照してください。

クライアント証明書は、ユーザーが SfBO によって認証されるための代替方法を提供します。ユーザー名とパスワードを入力する代わりに、ユーザーは証明書と、暗号化の問題を解決するために必要な証明書に対応する秘密キーを持っています。 

### <a name="windows-powershell-and-sfbo-management-tools"></a>Windows PowerShell と SfBO 管理ツール
SfBO では、IT 管理者は O365 管理ポータルまたはテナント リモートPowerShell (TRPS) を使用してサービスを管理できます。テナント管理者は最新認証を使用して TRPS への認証を行います。

### <a name="configuring-access-to-sfbo-at-your-internet-boundary"></a>インターネット境界で SfBO へのアクセスを設定する
SfBO が正しく機能するために (ユーザーが会議に参加できるなど)、顧客は SfBO クラウド内のサービスへの発信 UDP および TCP トラフィックが許可されるようにインターネット アクセスを設定する必要があります。詳細については、 https://support.office.com/en-us/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2#bkmk_lyo をご覧ください。 

### <a name="udp-3478-3481-and-tcp-443"></a>UDP 3478 〜 3481 と TCP 443

クライアントは、UDP 3478 - 3481 と TCP 443 ポートを使用して、音声ビデオ エッジ サービスに対してサービスを要求します。クライアントは、これら 2 つのポートを使用して、接続先リモート パーティの UDP ポートと TCP ポートをそれぞれ割り当てます。音声ビデオ エッジ サービスにアクセスするには、クライアントは、まず認証済みの SIP シグナリング セッション SfBO 登録を確立して、音声ビデオ エッジ サービス認証資格情報を取得する必要があります。これらの値は、TLS で保護されたシグナリング チャネルを経由して送信されます。また、辞書攻撃を緩和するためにコンピューターによって生成されます。クライアントは、これらの資格情報を音声ビデオ エッジ サービスとのダイジェスト認証に使用して、メディア セッションで使用するポートを割り当てます。最初の割り当て要求はクライアントから送信され、音声ビデオ エッジ サービスは、その要求に対して 401 ナンス/チャレンジ メッセージを返します。クライアントは 2 番目の割り当て (ユーザー名と、ユーザー名とナンスから生成された HMAC (ハッシュ メッセージ認証コード) ハッシュを含む) を送信します。 

また、再生攻撃を防止するためにシーケンス番号メカニズムも用意されています。サーバーは、ユーザー名とパスワードについてサーバー側で所有する情報を基に HMAC を計算し、両方の HMAC 値が一致すると、割り当て手順が実行されます。両方の HMAC 値が一致しない場合は、パケットは削除されます。この HMAC メカニズムは、この通話セッションの後続のメッセージにも適用されます。このユーザー名/パスワード値の有効期間は最大 8 時間です。8 時間を経過すると、クライアントは、新しいユーザー名/パスワードを再取得して、それ以降の通話で使用します。

### <a name="udptcp-5000059999"></a>UDP/TCP 50,000～59,999
TCP 50,000 アウトバウンドは、SfBO でのアプリケーションとデスクトップの共有、ファイル送信などに使用されます。UDP/TCP 50,000 ～ 59,999 のポート範囲は、音声ビデオ エッジ サービスからの NAT/ファイアウォール トラバーサル サービスを必要とする Microsoft Office Communications Server 2007 パートナーとのメディア セッションに使用されます。音声ビデオ エッジ サービスはこれらのポートを使用する唯一のプロセスなので、ポート範囲のサイズは攻撃を受ける危険性と一致しません。セキュリティを強化するには、不要なネットワーク サービスの実行を避け、リッスン ポートの総数を常に最小限に抑えるのが適切です。ネットワーク サービスが実行されていなければ、リモートの攻撃者はネットワーク サービスを利用できないため、ホスト コンピューターが攻撃される可能性は低下します。ただし、単一のサービス内でポート数を減らしても同じ効果は得られません。音声ビデオ エッジ サービス ソフトウェアが攻撃される可能性は、10,000 個のポートを開いている場合も 10 個のポートを開いている場合も同じです。この範囲内でのポートの割り当てはランダムに実行され、現在割り当てられていないポートはパケットをリッスンしません。

### <a name="external-user-av-traffic-traversal"></a>外部ユーザーの音声ビデオ トラフィックのトラバース
外部ユーザーと内部ユーザーの間でメディアを交換できるようにするには、セッションのセットアップおよび切断に必要な SIP シグナリングを処理するアクセス エッジ サービスが必要です。また、音声ビデオ エッジ サービスをメディア転送用のリレー機能として使用する必要もあります。次の図に、呼び出しシーケンスを示します。


![会議参加のコール シーケンス](media/sfbo-call-sequence-security.png) 

1. ユーザーは、電子メールで SfBO 会議への招待を受け取ります。この電子メールには、電話会議キーおよび電話会議への HTTP ベースの URL リンクが含まれています。キーと URL は、この会議に固有のものです。<p>ユーザーは、メールの会議 URL をクリックして参加手続きを開始します。これにより、ユーザーのコンピューターでクライアント検出プロセスが開始されます。クライアントが検出されると、このクライアントが起動されます。それが検出されない場合、ユーザは Web クライアントにリダイレクトされます。<p/>
2. SfBO クライアントはユーザーの認証情報を含む SIP INVITE を送信します。フェデレーション ユーザーまたはリモート ユーザーは、企業の認証情報を使用して会議に参加します。フェデレーション ユーザーの場合、SIP INVITE は最初に自分のホーム サーバーに送信され、ホーム サーバーはユーザーを認証して INVITE を SfBO に転送します。匿名ユーザーはダイジェスト認証に合格する必要があります。<p>SfBO が、リモート ユーザーまたは匿名ユーザーを承認し、クライアントに通知します。ステップ 2. に記載したように、電話会議に参加するフェデレーション ユーザーは、そのユーザーのエンタープライズで認証されます。<p/>

3. クライアントは、音声ビデオ会議にユーザーを追加するために INFO リクエストを送信します。

    A/V 会議によって、A/V 会議エッジ サービスに提示するトークンおよびその他の情報を含むユーザーの追加応答が送信されます。

    [注意] 前の SIP トラフィックはすべて、アクセス エッジ サービスを介して送信されます。

    クライアントは A/V 会議サーバーに接続し、ここでトークンの検証と、内部 A/V 会議サーバーへの要求 (別の認証トークンを含む) のプロキシ処理が行われます。A/V 会議サーバーでは、認証トークン (もともとはその A/V 会議サーバーが SIP チャネルを使用して発行したもの) を検証し、電話会議に参加しようとしているのが有効なユーザーであることを確認します。

4. クライアントと A/V 会議サーバー間で、メディア接続のネゴシエーションを行うと、SRTP でセットアップされます。
5. ユーザーは、電子メールで SfBO 会議への招待を受け取ります。この電子メールには、電話会議キーおよび電話会議への HTTP ベースの URL リンクが含まれています。キーと URL は、この会議に固有のものです。

### <a name="federation-safeguards-for-sfbo"></a>SfBO のフェデレーション保護対策
フェデレーションは、組織に他の組織と通信して IM とプレゼンスを共有する機能を提供します。SfBO フェデレーションは、既定でオンになっています。ただし、テナント管理者は O365 管理ポータルを介してこれを制御することができます。詳細を表示。

## <a name="addressing-threats-to-sfbo-conferences"></a>SfBO 会議の脅威に対する取り組み

SfBO では、エンタープライズ ユーザーに対して、リアルタイム Web 会議を作成および参加する機能が提供されます。エンタープライズ ユーザーは、AAD/O365 アカウントを持たない外部ユーザーを会議に招待することもできます。セキュリティで保護された認証済み ID を持つフェデレーション パートナーに雇用されるユーザーも会議に参加でき、発表者に昇格することもできます。匿名ユーザーは会議を作成することも、発表者として会議に参加することもできませんが、会議に参加した後であれば、発表者に昇格できます。

外部ユーザーを SfBO 会議に参加できるようにすると、この機能の価値が大幅に高まりますが、同時に、セキュリティ上のリスクも伴います。SfBO では、これらのリスクに対して次のように対応します。
- 電話会議の制御特権を参加者の役割に応じて割り当てます。
- 参加者の種類別に特定の会議へのアクセスを制限できます。
- どの会議にどの種類の参加者が出席できるかは、定義されている会議の種類によって決まります。
- 会議をスケジュールできるのは、AAD アカウントと SfBO ライセンスを持つユーザーに限定されます。
- ダイヤルイン電話会議に参加する匿名ユーザー (未認証ユーザー) が、電話会議のアクセス番号の 1 つをダイヤルすると、電話会議 ID を入力するように指示されます。このとき、認証されていない匿名ユーザーは、名前も録音する必要があります。電話会議に出席中の認証されていないユーザーは、この録音された名前によって識別されます。主催者または認証済みユーザーが少なくとも 1 名参加するまで、匿名ユーザーは電話会議への参加が許可されません。また、匿名ユーザーには事前に定義された役割も割り当てられません。

### <a name="participant-roles"></a>参加者の役割
会議参加者は 3 つのグループに分類され、以下のようにそれぞれに独自の特権と制限があります。
- **開催者** &nbsp;&nbsp;会議を作成するユーザー (今すぐ開始する会議を作成することも、会議を予約することも可能)。開催者は、認証済みエンタープライズ ユーザーである必要があり、会議のエンド ユーザーのあらゆる面を制御できます。
- **発表者** &nbsp;&nbsp;サポートされている任意のメディアを使用して会議で発表することが承認されているユーザー。定義上、会議の開催者は発表者でもあり、別の発表者を指定します。発表者の指定は、会議の予約時に行うことも、会議中に行うこともできます。
- **参加者** &nbsp;&nbsp;会議に招待されているが、発表者になることは承認されていないユーザー。

発表者は、会議中に参加者を発表者に昇格することもできます。

### <a name="participant-types"></a>参加者の種類

会議の参加者は、場所と資格情報によって分類することもできます。これらの両方の特性を使用して、どのユーザーがどの会議にアクセスできるかを指定できます。ユーザーは、次のカテゴリに大きく分かれます。
1.  **テナントに属するユーザー** &nbsp;&nbsp;これらのユーザーは、テナントの Azure Active Directory に資格情報を持っています。<br/>a. *内部の企業ネットワーク* - これらのユーザは企業ネットワークの内部から参加しています。<br/>b. *リモート ユーザー* - これらのユーザーは、企業ネットワークの外部から参加しています。リモート ユーザーには、自宅や外出先で働く従業員や、利用規約に従ってエンタープライズ資格情報を付与された協力ベンダーの従業員などがいます。リモート ユーザーは電話会議を作成して参加し、発表者になることができます。
2.  **テナントに属するユーザー** &nbsp;&nbsp; これらのユーザーは、テナントのAzure Active Directoryに資格情報を持っています。<br/>a. *フェデレーション ユーザー* - フェデレーション ユーザーは、フェデレーション パートナーとの有効な資格情報を所有します。したがって、フェデレーション ユーザーは、SfBO によって認証されたユーザーとして扱われます。フェデレーション ユーザーは電話会議に参加し、会議への参加後に発表者に昇格できますが、フェデレーションされているエンタープライズで電話会議を作成することはできません。<br/>b. *匿名ユーザー* - 匿名ユーザーは、Active Directory ID を持たず、テナントとフェデレーションされません。 

顧客データは、多くの電話会議に外部ユーザーが関与していることを示しています。これらの顧客は、外部ユーザーに対して会議への参加を許可する前に、外部ユーザーの識別情報を再確認することを求めています。次のセクションで説明するように、SfBO では、会議へのアクセスは、明示的に許可されたユーザーの種類に制限され、すべてのユーザーの種類に対して、会議に入る前に適切な資格情報を提示するように求められます。

### <a name="participant-admittance"></a>参加者の許可
SfBO では、匿名ユーザーはロビーと呼ばれる待合室に移動されます。発表者は、これらのユーザーを会議に参加させるか拒否するかが選択できます。これらのユーザーはロビーに移動され、リーダーに通知され、リーダーがユーザーを承認または拒否するか接続がタイムアウトするまで待機します。ロビーにいる間、ユーザーは音楽を聞きます。 

既定の設定では、PSTN からダイヤルインする参加者は直接会議に入りますが、このオプションを変更してダイヤルイン参加者も強制的にロビーに転送することができます。  
会議の開催者は、ロビーで待たずに参加者が会議に参加できるかどうかを制御します。各会議は、次のいずれかの方法でアクセスできるように設定できます。
- **会議の開催者である自分のみ**&nbsp;&nbsp;開催者を除くすべての参加者は、許可されるまでロビーで待機する必要があります。
- **会社内から招待した人**&nbsp;&nbsp;社内の誰でも、たとえ招待されていない場合でも、直接会議に参加できます。
- **組織内のすべてのユーザー**&nbsp;&nbsp; O365 テナントのすべての SfBO ユーザー (配布リストに掲載されていないユーザーを含む) がロビーで待つことなく会議に参加できます。それ以外のユーザー (すべての外部ユーザーと匿名ユーザーを含む) は、許可されるまでロビーで待つ必要があります。
- **すべてのユーザー**&nbsp;&nbsp; 会議リンクにアクセスできるユーザー (制限はありません) は、会議に直接参加します。開催者のみ (ロック) 以外の方法を指定した場合、会議の開催者は、電話でダイヤル インする人がロビーを迂回するように指定することもできます。 

### <a name="presenter-capabilities"></a>発表者の機能
会議の開催者は、参加者が会議中に発表できるかどうかを制御します。会議ごとに、発表者を次のいずれかに制限できます。
- **開催者のみ**&nbsp;&nbsp; 会議の開催者のみが発表できます。
- **会社内の人**&nbsp;&nbsp; すべての内部ユーザーが発表できます。
- **会社外の人を含むすべての人**&nbsp;&nbsp; 会議に参加するすべての人がプレゼンターになれます (制限はありません)。
- **指定した人**&nbsp;&nbsp;会議の開催者がプレゼンターになることができるユーザーを指定します。

## <a name="related-topics"></a>関連トピック
[Microsoft Trust Center](https://microsoft.com/trustcenter)

