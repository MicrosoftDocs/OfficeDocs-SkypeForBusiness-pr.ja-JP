---
title: Microsoft Teams アプリのアクセス許可と考慮事項
author: rmw2890
ms.author: rowille
manager: serdars
ms.date: 06/27/2019
ms.topic: conceptual
audience: admin
ms.service: msteams
ms.collection:
- M365-voice
- M365-collaboration
search.appverid: MET150
ms.reviewer: rowille
description: 組織から要求されているデータおよびアクセス許可アプリについて説明します。
f1.keywords:
- NOCSH
localization_priority: Normal
appliesto:
- Microsoft Teams
ms.openlocfilehash: 5d7548d4d162310bc239c752e2bce38e725008f9
ms.sourcegitcommit: 8e2fa7b744d0a174b699ae7298d4688b971eeff3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/07/2020
ms.locfileid: "41845228"
---
# <a name="microsoft-teams-apps-permissions-and-considerations"></a>Microsoft Teams アプリのアクセス許可と考慮事項

Microsoft Teams アプリは、1つ以上の機能をインストール、アップグレード、アンインストールできる_アプリパッケージ_に集約するための手段です。 次のような機能があります。

- ボット
- メッセージングの拡張機能
- タブ
- コネクタ

アプリはユーザーによって各人され、ポリシーの観点から管理されます。 ただし、ほとんどの場合、アプリのアクセス許可とリスクプロファイルは、アプリに含まれる機能の権限とリスクのプロファイルによって定義されます。 したがって、この記事では、権限とその機能レベルに関する考慮事項について説明します。

RECEIVE_MESSAGE や REPLYTO_MESSAGE などの大文字で示されているアクセス許可は、 [Microsoft Teams の開発者向けドキュメント](https://aka.ms/teamsdevdocs)または[microsoft Graph のアクセス許可](https://developer.microsoft.com/graph/docs/concepts/permissions_reference)のいずれかには表示されません。 これらは、この記事の目的について簡単に説明しています。


|    |     |
|-----------|------------|
| ![判断ポイントを表すアイコン](media/audio_conferencing_image7.png) <br/>判断ポイント|<ul><li>次の表を参考にして、調査しているアプリで要求されているアクセス許可について理解してください。</li></ul> |
| ![次の手順を示すアイコン](media/audio_conferencing_image9.png)<br/>次の手順|<ul><li>アプリまたはサービス自体を調査して、組織内でのアクセスを許可するかどうかを決定します。 たとえば、ボットはユーザーからのメッセージを送受信します。また、エンタープライズ基幹業務用のボットを除いて、これらはコンプライアンスの境界外にあります。 そのため、bot を含むすべてのアプリには、これらのアクセス許可が必要であり、少なくともそのリスクのプロファイルが設定されています。 </li></ul>|

## <a name="global-app-permissions-and-considerations"></a>グローバルアプリのアクセス許可と考慮事項

### <a name="required-permissions"></a>必要なアクセス許可

なし

### <a name="optional-permissions"></a>オプションの権限

なし

### <a name="considerations"></a>考慮事項

アプリは、使用するデータと、利用規約およびプライバシーポリシーへのリンクでデータがどのように使用されているかを公開する必要があります。</td>

## <a name="bots-and-messaging-extensions"></a>ボットとメッセージングの拡張機能

### <a name="required-permissions"></a>必要なアクセス許可

- RECEIVE_MESSAGE、REPLYTO_MESSAGE。 ボットは、ユーザーからのメッセージを受信して返信することができます。<sup>1</sup>

- POST_MESSAGE_USER。 ユーザーがボットにメッセージを送信した後、ボットはユーザーのダイレクトメッセージ (*予防的なメッセージ*とも呼ばれます) をいつでも送信できます。

- GET_CHANNEL_LIST。 Teams に追加されたボットは、チーム内のチャネルの名前と Id の一覧を取得できます。

### <a name="optional-permissions"></a>オプションの権限

- 身分. チャネルで使用されている場合、アプリのボットは、チームメンバー (名、姓、ユーザープリンシパル名 [UPN]、メールアドレス) の基本的な id 情報にアクセスできます。個人またはグループチャットで使用されている場合、bot は、それらのユーザーに対して同じ情報にアクセスすることができます。

- POST_MESSAGE_TEAM。 ユーザーが以前に bot に話したことがない場合でも、アプリのボットが、任意の時点で任意のチームメンバーに対して直接 (予防的) メッセージを送信することを許可します。

- 次のようなアクセス許可は明示的ではありませんが、マニフェストで宣言された RECEIVE_MESSAGE と REPLYTO_MESSAGE と、ボットを使うことができるスコープによって暗黙的に指定されています。
 
    - RECEIVE_MESSAGE_PERSONAL、REPLYTO_MESSAGE_PERSONAL
    - RECEIVE_MESSAGE_GROUPCHAT、REPLYTO_MESSAGE_GROUPCHAT
    - RECEIVE_MESSAGE_TEAM、REPLYTO_MESSAGE_TEAM

- SEND_FILES、RECEIVE_FILES。<sup>2</sup> bot が個人的なチャットでファイルを送受信できるかどうかを制御します (グループチャットまたはチャネルではまだサポートされていません)。

### <a name="considerations"></a>考慮事項

- ボットは、それらが追加されたチーム、またはインストールしたユーザーにのみアクセスできます。

- ボットは、ユーザーによって明示的にメンションされたメッセージのみを受け取ります。 このデータは企業ネットワークから離れています。

- ボットは、メンションされた会話にのみ返信できます。

- ユーザーがボットを使用している場合、ボットにそのユーザーの ID が保存されている場合は、いつでもそのユーザーのダイレクトメッセージを送信できます。

- ボットメッセージには、フィッシングまたはマルウェアサイトへのリンクが含まれていても、ユーザー、テナント管理者、または Microsoft によってグローバルにブロックされている可能性があります。

- Bot は、アプリが追加されたチームメンバー、または個人またはグループチャットの個々のユーザーに対して、非常に基本的な id 情報を取得 (および保存する可能性があります) することができます。 これらのユーザーについての詳細情報を取得するには、ボットが Azure Active Directory にサインインする必要があります (Azure AD)

- Bot は、チーム内のチャネルの一覧を取得 (および保存する可能性があります) することができます。このデータは企業ネットワークから離れています。

- ボットにファイルが送信されると、ファイルは企業ネットワークから脱退します。 ファイルを送受信するには、各ファイルに対してユーザーの承認が必要です。 

- 既定では、bot はユーザーの代わりに操作することはできませんが、ユーザーにサインインを求めることができます。ユーザーがサインインするとすぐに、ボットには追加の項目を実行できるアクセストークンがあります。 このような追加事項は、ボットとユーザがサインインする場所によって異なります。ボットは、にhttps://apps.dev.microsoft.com/登録されている Azure AD アプリであり、独自の権限を設定できます。

- ユーザーがチームに追加または削除されるたびに、ボットに通知されます。

- ユーザーの IP アドレスまたはその他の参照情報は表示されません。 すべての情報は Microsoft から取得されます。 (例外は1つしかありません。ボットが独自のサインインエクスペリエンスを実装している場合、サインイン UI にユーザーの IP アドレスと参照元情報が表示されます)。

- メッセージングの内線番号には、ユーザーの IP アドレスと参照元情報が表示されます。

- アプリのガイドライン (およびその AppSource review プロセス) では、有効な目的のために、ユーザーに (POST_MESSAGE_TEAM アクセス許可を使用して) 個人のチャットメッセージを送信するための判断が必要です。 不正使用の場合は、ユーザーがボットをブロックできるため、テナント管理者はアプリをブロックすることができます。また、必要に応じて、ボットを一元的にブロックすることができます。

<sup>1</sup>一部のボットはメッセージのみを送信します (POST_MESSAGE_USER)。 "通知のみ" と呼ばれますが、ボットが許可されているものや、許可されていないものを指しているわけではないことを意味します。 このフィールドは、通常は有効になる UI の機能を無効にするために使用されます。このボットは、会話体験を公開しているボットと比較した場合に制限されていません。

<sup>2</sup>は、アプリの manifest.xml ファイルの bot オブジェクトの Supportsfiles ブールプロパティによって制御されます。

> [!NOTE]
> ボットに独自のサインインがある場合は、ユーザーが初めてサインインするときに、2つの方法があります。
>
>現時点では、Teams アプリ内のいずれかの機能に関連付けられた Azure AD 権限 (ボット、タブ、コネクタ、またはメッセージング拡張機能) は、ここに記載されている Teams の権限から完全に分離されます。

## <a name="tabs"></a>タブ

タブは、Teams 内で実行されている web サイトです。

### <a name="required-permissions"></a>必要なアクセス許可

SEND_AND_RECEIVE_WEB_DATA

### <a name="optional-permissions"></a>オプションの権限

なし (現在)

### <a name="considerations"></a>考慮事項

- タブのリスクプロファイルは、ブラウザータブで実行されている同じ web サイトとほぼ同じです。 

- また、タブには、現在のユーザーのサインイン名と UPN、現在のユーザーの Azure AD オブジェクト ID、その場所にある Office 365 グループの ID (チームの場合)、テナント ID が含まれているコンテキストが取得されます。を選び、ユーザーの現在のロケールを選びます。 ただし、これらの Id をユーザーの情報に対応付けるには、ユーザーが Azure AD にサインインする必要があります。

## <a name="connectors"></a>コネクタ

外部システムのイベントが発生すると、コネクタはチャネルにメッセージを投稿します。

### <a name="required-permissions"></a>必要なアクセス許可

POST_MESSAGE_CHANNEL

### <a name="optional-permissions"></a>オプションの権限

REPLYTO_CONNECTOR_MESSAGE。 一部のコネクタは、操作可能なメッセージをサポートします。これにより、ユーザーは GitHub の問題への応答の追加や、Trello カードへの日付の追加などを行うことができます。

### <a name="considerations"></a>考慮事項

- コネクタメッセージを投稿するシステムでは、メッセージの投稿先または受信者がわからない場合、受信者に関する情報は公開されません。 (Microsoft は、テナントではなく実際の受信者です。Microsoft はチャネルに実際に投稿します。)

- コネクタメッセージがチャネルに投稿されると、データは企業ネットワークから脱退します。

- 操作できるメッセージ (REPLYTO_CONNECTOR_MESSAGE アクセス許可) をサポートするコネクタにも、IP アドレスと参照情報は表示されません。この情報は、Microsoft に送信され、connector ポータルで Microsoft に以前登録されていた HTTP エンドポイントにルーティングされます。

- チャネル用にコネクタを構成するたびに、そのコネクタインスタンスの一意の URL が作成されます。 このコネクタインスタンスが削除されると、URL を使用できなくなります。

- コネクタメッセージに添付ファイルを含めることはできません。

- コネクタインスタンス URL は、秘密/機密として扱う必要があります。この URL は、メールアドレスなど、その URL を持つすべてのユーザーが投稿できます。 そのため、迷惑メールやフィッシングまたはマルウェアのサイトへのリンクについては、いくつかのリスクがあります。 この問題が発生した場合は、チーム所有者がコネクタインスタンスを削除することができます。

- コネクタメッセージを送信するサービスが侵害され、スパム/フィッシングまたはマルウェアリンクの送信を開始した場合、テナント管理者は、新しいコネクタインスタンスが作成されないようにして、Microsoft がそれらを中央でブロックすることができます。

> [!NOTE]
> 現在、操作できるメッセージ (REPLYTO_CONNECTOR_MESSAGE アクセス許可) をサポートしているコネクタを特定することはできません。

## <a name="outgoing-webhooks"></a>発信 web フック

*発信 web フック*は、チーム所有者またはチームメンバーごとに作成されます。 チームアプリの機能ではありません。この情報は、完全性のために含まれています。

### <a name="required-permissions"></a>必要なアクセス許可

RECEIVE_MESSAGE、REPLYTO_MESSAGE。 ユーザーからのメッセージを受信して返信することができます。

### <a name="optional-permissions"></a>オプションの権限

なし

### <a name="considerations"></a>考慮事項

- 発信 web フックはボットに似ていますが、権限が少なくなっています。 ボットと同じように、明示的にメンションする必要があります。

- 送信 webhook が登録されると、秘密が生成されます。これにより、送信の webhook は、悪意のある攻撃者とは異なり、送信者が Microsoft Teams であることを確認できます。 このシークレットは、秘密のままにしておく必要があります。このアプリにアクセスできるすべてのユーザーが、Microsoft Teams を偽装できます。 秘密が侵害された場合は、送信された webhook を削除して再作成することができます。これにより、新しいシークレットが生成されます。

- 機密情報を検証しない送信 webhook を作成することもできますが、それに対してはお勧めします。

- 送信 web フックでは、メッセージの受信と返信以外に、メッセージを事前に送信したり、ファイルを送受信したりすることはできません。また、ボットがメッセージの受信と返信以外の操作を実行することはできません。
