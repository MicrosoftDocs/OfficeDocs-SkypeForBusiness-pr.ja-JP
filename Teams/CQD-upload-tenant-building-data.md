---
title: 通話品質ダッシュボード (CQD) でテナントをアップロードし、データを構築する
author: CarolynRowe
ms.author: crowe
manager: serdars
ms.reviewer: mikedav, siunies, gageames
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
ms.collection:
- M365-voice
search.appverid: MET150
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
ms.localizationpriority: medium
f1.keywords:
- NOCSH
ms.custom:
- Reporting
- seo-marvel-apr2020
description: 通話品質ダッシュボード (CQD) でテナントをアップロードし、データを構築する方法について説明します。
ms.openlocfilehash: d9559490aa990f3df800e0e9438810c63d153d3c
ms.sourcegitcommit: 0dda332951df3b946097d90a4923eb191fd86b4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/14/2022
ms.locfileid: "66789642"
---
# <a name="upload-tenant-and-building-data-in-call-quality-dashboard-cqd"></a>通話品質ダッシュボード (CQD) でテナントをアップロードし、データを構築する


通話品質ダッシュボード (CQD) を最大限に活用するには、テナントをアップロードし、データを構築することをお勧めします。 テナント データ ファイルには、 [Building](#upload-building-data-file) と Endpoint の 2 種類 [があります](#endpoint-data-file)。

サンプル テナント データ テンプレート [は、ここで](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/locations-template.zip?raw=true)ダウンロードできます。 マッピングの構築に関するヘルプについては、「 [CQD のビルド マップを作成する」を参照](CQD-building-mapping.md)してください。

CQD サマリー レポート ダッシュボードで、CQD **の [設定]** メニュー (CQD の上部にある歯車アイコン) から **[テナント データのアップロード**] を選択します。 ここから、管理者は組織の建物とエンドポイントの情報 (IP アドレスと地理的情報のマッピング、各ワイヤレス アクセス ポイントとその MAC アドレスのマッピングなど) をアップロードできます。

1. CQD を開き (Teams 管理センターから、または Teams 管理センターで [https://cqd.teams.microsoft.com](https://cqd.teams.microsoft.com)) 開き、右上隅にある歯車アイコンを選択し、[**概要レポート**] ページで **[テナント データのアップロード**] を選択します。

   ![データのアップロード中に表示されるダイアログ ボックスのスクリーンショット。](media/qerguide-image-tenantdataupload.png)
    
2. また、初めて CQD にアクセスする場合は、建物データのアップロードを求められます。 [ **今すぐアップロード]** を選択すると、[ **テナント データのアップロード** ] ページにすばやく移動できます。

   ![建物データのアップロードをユーザーに通知するバナーのスクリーンショット。](media/qerguide-image-buildingdatauploadbanner.png)

3. [ **テナント データのアップロード** ] ページで、[ **参照** ] を選択してデータ ファイルを選択します。

4. データ ファイルを選択した後、 **開始日** を指定し、必要に応じて終了日を指定します。

5. **[開始日]** を選択した後、[**アップロード**] を選択して、ファイルを CQD にアップロードします。 <br><br>ファイルがアップロードされる前に、検証されます。 検証に失敗すると、ファイルの修正を要求するエラー メッセージが表示されます。 次の図は、データ ファイル内の列数が正しくない場合に発生するエラーを示しています。

   ![建物データのアップロード エラーを表示するダイアログ ボックスの例。](media/qerguide-image-buildingdatauploaderror.png)
 
6. 検証中にエラーが発生しなかった場合、ファイルのアップロードは成功します。 その後、[ **マイ アップロード** ] テーブルにアップロードされたデータ ファイルが表示され、そのページの下部に現在のテナントのアップロードされたすべてのファイルの完全な一覧が表示されます。

> [!NOTE]
> ビルド ファイルの処理が完了するまでに最大 4 時間かかる場合があります。 <br><br> ビルド ファイルを既にアップロードしていて、見落とされたか除外されている可能性があるサブネットを追加する必要がある場合は、新しいサブネットを追加して元のファイルを変更し、現在のファイルを削除し、新しく編集したファイルを再アップロードします。 CQD には、アクティブな建物データ ファイルを 1 つだけ使用できます。 


## <a name="upload-building-data-file"></a>建物データ ファイルをアップロードする

CQD のテナント データ ファイルの最初の種類は **、Building** データ ファイルです。 サブネット列は、Network + NetworkRange 列を展開し、呼び出しレコードの [最初のサブネット] または [2 番目のサブネット] 列に [サブネット] 列を結合して、建物、都市、国、または地域の情報を表示することで派生します。 アップロードするデータ ファイルの形式は、アップロード前に検証チェックに合格するには、次の条件を満たしている必要があります。
  
- ファイルは 、.tsv ファイル (列は TAB で区切られています) または.csv ファイルである必要があります (列はコンマで区切られます)。

- データ ファイルにテーブル ヘッダー行は含まれません。 データ ファイルの最初の行は、"Network" などのヘッダー ラベルではなく、実際のデータであると想定されます。

- ファイル内のデータ型は、文字列型、整数型、ブール型のみ可能です。 Integer データ型の場合、値は数値である必要があります。 ブール値は 0 または 1 にする必要があります。

- 列で String データ型を使用する場合、データ フィールドは空にできますが、タブまたはコンマで区切る必要があります。 空のデータ フィールドでは、空の文字列値が割り当てられます。

- テナント データ ファイルごとに 1,000,000 行の拡張行制限があります。

- 行ごとに 15 個の列が存在する必要があります。各列には適切なデータ型が必要であり、列は次の表に示す順序 (コンマまたはタブ区切り) である必要があります。

  **データ ファイル形式の構築**
  
  | 列名        | データの種類 | 例                   | ガイダンス              |
  |--------------------|-----------|---------------------------|-----------------------|
  | NetworkIP          | 文字列    | 192.168.1.0               | 必須              |
  | NetworkName        | 文字列    | USA/Seattle/SEATTLE-SEA-1 | 必須<sup>1</sup>  |
  | NetworkRange       | 数値    | 26                        | 必須              |
  | BuildingName       | 文字列    | SEATTLE-SEA-1             | 必須<sup>1</sup>  |
  | OwnershipType      | 文字列    | Contoso                   | 省略可能              |
  | BuildingType       | 文字列    | IT 終了            | 省略可能              |
  | BuildingOfficeType | 文字列    | 工学               | 省略可能              |
  | 市区町村               | 文字列    | 調布市調布ヶ丘                   | 推奨           |
  | ZipCode            | 文字列    | 98001                     | 推奨           |
  | 国            | 文字列    | 私たち                        | 推奨           |
  | 都道府県              | 文字列    | WA                        | 推奨           |
  | Region             | 文字列    | MSUS                      | 推奨           |
  | InsideCorp<sup>2</sup>         | ブール      | 1             | 必須              |
  | ExpressRoute<sup>3</sup>       | ブール      | 0             | 必須              |
  | VPN                | ブール      | 0                         | 省略可能              |

  <sup>1</sup> CQD では必須ではありませんが、建物とネットワーク名を表示するようにテンプレートが構成されます。

  <sup>2</sup> この設定は、サブネットが企業ネットワーク内にあるかどうかを反映するために使用できます。 その他の目的で使用をカスタマイズできます。

  <sup>3</sup> この設定は、ネットワークで Azure ExpressRoute を使用するかどうかを反映するために使用できます。 その他の目的で使用をカスタマイズできます。  

  **サンプル行:**

  `192.168.1.0,USA/Seattle/SEATTLE-SEA-1,26,SEATTLE-SEA-1,Contoso,IT Termination,Engineering,Seattle,98001,US,WA,MSUS,1,0,0`

> [!IMPORTANT]
> ネットワーク範囲は、スーパーネット (複数のサブネットと 1 つのルーティング プレフィックスの組み合わせ) を表すために使用できます。 新しい建物のアップロードはすべて、重複する範囲がないかチェックされます。 以前にビルド ファイルをアップロードした場合は、現在のファイルをダウンロードし、再アップロードして重複を特定し、問題を解決してから再度アップロードする必要があります。 以前にアップロードしたファイルで重複すると、レポート内の建物へのサブネットの誤ったマッピングが発生する可能性があります。 特定の VPN 実装では、サブネット情報が正確に報告されません。 
>
> VPN 列は省略可能で、既定値は 0 です。 VPN 列の値が 1 に設定されている場合、その行で表されるサブネットは、サブネット内のすべての IP アドレスと一致するように完全に拡張されます。 これらのサブネットを完全に拡張すると、データの構築に関連するクエリのクエリ時間に悪影響が生じるため、これは控えめに VPN サブネットでのみ使用してください。 サブネットの拡張によって拡張行の制限が 1,000,000 を超えた場合、ビルド ファイルは受け入れられません。


### <a name="supernetting"></a>スーパーネット

各サブネットを定義する代わりに、スーパーネット (一般的にクラスレス Inter-Domain ルーティング (CIDR) と呼ばれます) を使用できます。 *スーパーネット* は、1 つのルーティング プレフィックスを共有する複数のサブネットの組み合わせです。 サブネットごとにエントリを追加する代わりに、スーパーネット アドレスを使用できます。 スーパーネットはサポートされていますが、使用することはお勧めしません。

たとえば、Contoso のマーケティングビルは、次のサブネットで構成されています。

-   10.1.0.0/24 — 1 階
-   10.1.1.0/24 — 2 階
-   10.1.2.0/24 — 3 階
-   10.1.3.0/24 — 4 階

サブネットごとにエントリを追加する代わりに、スーパーネットアドレス (この例では 10.1.0.0/22) を使用できます。

-   ネットワーク = 10.1.0.0
-   ネットワーク範囲 = 22

スーパーネットを実装する前に、次の点について考慮する必要があります。

-   スーパーネットは、8 ビットから 28 ビット のマスクを持つサブネット マッピングでのみ使用できます。

-   スーパーネット化にかかる時間は前よりも短くなりますが、データの豊富さを減らすコストがかかります。 たとえば、サブネット 10.1.2.0 に関する品質上の問題があるとします。 スーパーネットを実装した場合、サブネットが配置されている建物の場所や、サブネットがどの種類のネットワーク (ラボなど) であるかはわかりません。 建物のすべてのサブネットを定義し、フロアの場所情報をアップロードした場合は、その違いを確認できます。

-   スーパーネットアドレスが正しく、不要なサブネットをキャッチしないようにすることが重要です。

-   データで 192.168.0.0 を見つけるのは非常に一般的です。 多くの組織では、これはユーザーが自宅に存在することを示しています。 他のユーザーの場合、これはサテライト オフィスの IP アドレススキームです。 組織にこの構成を使用するオフィスがある場合は、 [一般的なサブネット](quality-of-experience-review-guide.md#common-subnets)を使用して自宅ネットワークと内部ネットワークを区別するのが難しいため、建物ファイルに含めないでください。 

> [!IMPORTANT]
> ネットワーク範囲は、スーパーネットを表すために使用できます。 新しい建物データ ファイルのアップロードはすべて、重複する範囲がないかチェックされます。 以前にビルド ファイルをアップロードしたことがある場合は、現在のファイルをダウンロードし、もう一度アップロードして重複を特定し、問題を解決する必要があります。 以前にアップロードしたファイルで重複すると、レポート内の建物へのサブネットの誤ったマッピングが発生する可能性があります。

### <a name="vpn"></a>VPN

クライアントが Microsoft 365 またはOffice 365に送信するエクスペリエンス (QoE) データの品質には、CQD データのソースとなる VPN フラグが含まれます。 CQD では、これが最初の VPN と 2 番目の VPN ディメンションとして表示されます。 ただし、このフラグは、登録されている VPN ネットワーク アダプターがリモート アクセス アダプターであることを Windows に対する VPN ベンダーの報告に依存します。 すべての VPN ベンダーがリモート アクセス アダプターを適切に登録しているわけではありません。 このため、組み込みの VPN クエリ フィルターを使用できない可能性があります。 VPN サブネットを正確にマークして識別するには、上で説明した VPN 列を使用します。 また、レポートで簡単に識別できるように、VPN ネットワークにラベルを付けるのも良い方法です。 VPN サブネットにラベルを付ける方法の 2 つの例を次に示します。

- VPN サブネットのこのフィールドに「VPN」と入力して **、ネットワーク名** を定義します。

  ![ネットワーク名を使用した VPN を示す QCD レポートのスクリーンショット。](media/qerguide-image-vpnnetworkname.png)

- VPN サブネットのこのフィールドに「VPN」と入力して **、建物名** を定義します。

  ![ビル名を使用した VPN を示す QCD レポートのスクリーンショット。](media/qerguide-image-vpnbuildingname.png)

> [!NOTE]
> VPN 接続は、基になる接続がワイヤレスである場合に、ネットワーク接続の種類がワイヤード (有線) と誤って識別されていることがわかっています。 VPN 接続経由の品質を確認する場合、接続の種類が正確に識別されているとは考えられません。

## <a name="endpoint-data-file"></a>エンドポイント データ ファイル

もう 1 つの種類の CQD テナント データ ファイルは **、エンドポイント** データ ファイルです。 列の値は、呼び出しレコードの [最初のクライアント エンドポイント名] または [2 番目のクライアント エンドポイント名] 列で使用され、Endpoint Make、Model、または Type の情報が表示されます。 アップロードするデータ ファイルの形式は、アップロード前に検証チェックに合格するには、次の条件を満たしている必要があります。

- ファイルは 、.tsv ファイル (列は TAB で区切られています) または.csv ファイルである必要があります (列はコンマで区切られます)。

- データ ファイルの内容にはテーブル ヘッダーは含まれません。 データ ファイルの最初の行は、"EndpointName" のようなヘッダー ラベルではなく、実際のデータであると想定されます。

- 7 つの列はすべて、String データ型のみを使用します。 許可される最大長は 64 文字です。

- エントリでは大文字と小文字が区別されます。EndpointName **ABC123** は EndpointName **abc123** から一意として扱われます。

- データ フィールドは空にできますが、タブまたはコンマで区切る必要があります。 空のデータ フィールドでは、空の文字列値が割り当てられます。

- EndpointName は一意である必要があります。それ以外の場合、アップロードは失敗します。 同じ EndpointName を使用する重複する行または 2 つの行がある場合、競合により正しくない結合が発生します。

- EndpointLabel1、EndpointLabel2、EndpointLabel3 はカスタマイズ可能なラベルです。 空の文字列、または "IT 部門指定 2018 Laptop" や "Asset Tag 5678" などの値を指定できます。

- 行ごとに 7 つの列が必要であり、列は次の順序である必要があります。

  **フィールドの順序:**

  EndpointName、EndpointMake、EndpointModel、EndpointType、EndpointLabel1、EndpointLabel2、EndpointLabel3

  **サンプル行:**

  `1409W3534, Fabrikam, Model 123, Laptop, IT designated 2018 Laptop, Asset Tag 5678, Purchase 2018`

## <a name="update-a-building-file"></a>ビルド ファイルを更新する

建物とサブネットの情報を収集している間、管理者は多くの場合、時間の経過と共に複数のイテレーションで建物ファイルをアップロードし、使用可能になったときに新しいサブネットとその建物情報を追加します。 これが発生した場合は、建物ファイルを再アップロードする必要があります。 このプロセスは、前のセクションで説明した初期アップロードと似ていますが、次のセクションで説明したように、いくつかの例外があります。

> [!Important]
> 一度にアクティブにできるビルド ファイルは 1 つだけです。 複数のビルド ファイルは累積的ではありません。

## <a name="add-net-new-subnets"></a>正味新しいサブネットを追加する

ネットワーク トポロジの最初の一部ではなかった CQD に、正味の新しいサブネットを追加する必要がある場合があります。 正味新しいサブネットを追加するには、CQD の **[テナント データのアップロード** ] ページから次の操作を行います。

1.  最新のコピーがない場合は、元のファイルをダウンロードします。

1.  CQD 内の現在のファイルを削除します。

1.  元のビルド ファイルを編集し、ネットの新しいサブネットが取得される少なくとも 1 日前に発生する終了日を指定します。

1.  net 新しいサブネットを元のビルド ファイルに追加します。

1.  新しく変更されたビルド ファイルをアップロードし、前のビルド ファイルが終了した後の 1 日間の開始日を設定します。

## <a name="add-missing-subnets"></a>不足しているサブネットを追加する

マネージド ネットワークのビルド情報をアップロードした後、すべてのマネージド ネットワークに建物の関連付けが必要です。 ただし、これは常にそうであるとは限りません。通常、いくつかのサブネットは見落とされます。 これらの不足しているネットワークを見つけるには、CQD の [**Quality of Experience Reports**] ページの **[不足しているサブネット** レポート] を確認します。 これにより、すべてのサブネットに、建物データ ファイルで定義されておらず、外部としてマークされている 10 個以上のオーディオ ストリームが表示されます。 この一覧にマネージド ネットワークがないことを確認します。 サブネットが見つからない場合は、次の手順に従って元の建物データ ファイルを更新し、CQD に再アップロードします。

1. CQD の **[テナント データのアップロード** ] ページに移動します。

1. 最新のコピーがない場合は、元のファイルをダウンロードします。

1. CQD 内の現在のファイルを削除します。

1. 新しいサブネットを元のファイルに追加します。

1. ビルド ファイルをアップロードします。 CQD が履歴データを処理するように、開始日を少なくとも 8 か月前に設定してください。


> [!IMPORTANT]
> レポートをフィルター処理して組織のテナント データのみを表示するには、このレポートに **Second Tenant ID** のクエリ フィルターとしてテナント ID を追加する必要があります。 それ以外の場合は、フェデレーション サブネットがレポートに表示されます。

> [!NOTE] 
> [月の年] レポート フィルターは、必ず現在の月に調整してください。 [ **編集] を** 選択し、[ **月の年]** レポート フィルターを調整して、新しい既定の月を保存します。


## <a name="related-topics"></a>関連項目

[CQD の建物マップを作成する](CQD-building-mapping.md)

[Teams の通話品質の向上と監視](monitor-call-quality-qos.md)

[CQD とは](CQD-what-is-call-quality-dashboard.md)

[通話品質ダッシュボード (CQD) をセットアップする](turning-on-and-using-call-quality-dashboard.md)

[CQD のデータとレポート](CQD-data-and-reports.md)

[CQD を使用して通話と会議の品質を管理する](quality-of-experience-review-guide.md)

[CQD で利用できるディメンションとメジャー](dimensions-and-measures-available-in-call-quality-dashboard.md)

[CQD のストリーム分類](stream-classification-in-call-quality-dashboard.md)

[Power BI を使用して CQD データを分析する](CQD-Power-BI-query-templates.md)
