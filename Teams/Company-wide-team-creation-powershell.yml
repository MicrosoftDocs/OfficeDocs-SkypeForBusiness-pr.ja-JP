### YamlMime:Tutorial
title: PowerShell を使用して Microsoft Teams で会社全体のチームを作成する
metadata:
  title: PowerShell を使用して Microsoft Teams で会社全体のチームを作成する
  description: PowerShell を利用して会社全体のチームを作成する IT 管理者向け
  audience: IT Pro
  level: Intermediate
  displayType: one-column
  ms.author: ninadara
  manager: serdars
  ms.date: 02/07/2018
  ms.service: msteams
  ms.topic: tutorial
  localization_priority: Priority
  ms.collection: Strat_MT_TeamsAdmin
  ms.openlocfilehash: 3be4747d9dc776eab8e14308ae2bf6e3d06adc52
  ms.sourcegitcommit: 26d93a15c9d4704c08f3fabc5635839ce2456b2d
  ms.translationtype: MT
  ms.contentlocale: ja-JP
  ms.lasthandoff: 07/06/2018
  ms.locfileid: "20205026"
items:
- durationInMinutes: 3
  content: "\nこのトレーニングでは、Teams で会社全体にわたるパブリックなチームを作成する PowerShell スクリプトを提供します。 このスクリプトでは会社全体にわたるパブリックなチームを作成するために、MicrosoftTeams PowerShell モジュール (現在ベータ版) を使用します。 また、テナント内のユーザーのリストを取り込むために、AzureAD PowerShell モジュールも使用します。 \n\nこれは、いくつかの簡単な PowerShell コマンドを少し触れてこの強力なエンタープライズ ツールに慣れ親しもうという場合の手始めとして最適です。 PowerShell は、AzureAd グループのその他の側面の管理における主要コンポーネントで、Teams でチームを作成できるユーザーを管理する方法となるグループ作成の制御も含んでいます。 \n\n### <a href=\"https://docs.microsoft.com/MicrosoftTeams/scripts/powershell-script-sample-create-company-wide-team\" target=\"_blank\">下向き矢印: PowerShell スクリプトを取得する</a>\n\n> [!IMPORTANT]\n> この PowerShell スクリプトは、最初の 2500 人のメンバーのみをチームに追加します。 2500 が現時点でのチームの大きさの制限となります。 \n\n\nこのトレーニングは、チームの作成を自動化しようとしている IT 管理者または Teams ユーザーを対象としています。 学習内容:  \n- PowerShell での関連モジュールのインストール方法\n- スクリプトの使用方法 \n\n次の内容は取り上げません。\n1. PowerShell について深入りした説明。 PowerShell スクリプトを準備して実行できるようになるために必要な PowerShell の情報のみを含めています。 詳細については、「<a href=\"https://docs.microsoft.com/powershell/scripting/getting-started/getting-started-with-windows-powershell?view=powershell-5.1\" target=\"_blank\">Windows PowerShell ファースト ステップ ガイド</a>」をご覧ください。\n2. <a href=\"https://docs.microsoft.com/powershell/azure/active-directory/overview?view=azureadps-2.0\" target=\"_blank\">AzureAD</a> モジュールの機能性。 この PowerShell スクリプトは、テナント内のユーザーを取り込む 1 つのコマンドのために AzureAD モジュールを使用します。 \n3. <a href=\"https://github.com/MicrosoftDocs/office-docs-powershell/tree/master/teams/teams-ps/teams\" target=\"_blank\">MicrosoftTeams</a> モジュールのコマンドレット。 \n4. PowerShell スクリプトの行ごとの詳しい解説。 \n\n\nこのトレーニングに関する質問やフィードバックの送信方法:\n  - このチュートリアルの「[次のステップ](company-wide-team-creation-powershell.yml#step-7) 」ページの下部にあるコメント セクションから投稿してください\n  - 機能のリクエストなど、製品に関するフィードバックを提供する場合は、<a href=\"https://aka.ms/TeamsUserVoice\" target=\"_blank\">UserVoice</a> に移動してください。\n"
- title: 最小要件
  durationInMinutes: 2
  content: "\n### <a name=\"user-requirements\"></a>ユーザー要件\n\nお使いのコンピューターで、アプリケーションを管理者として実行できるように、管理者のアクセス許可がある必要があります。 \n\n### <a name=\"system-requirements\"></a>システム要件\nこのスクリプトで使用するモジュールは、次のいずれかのオペレーティング システムを必要とします。\n\n- Windows 10\n- Windows 8.1 Pro\n- Windows 8.1 Enterprise\n- Windows 7 SP1\n- Windows Server 2016\n- Windows Server 2012 R2\n- Windows Server 2008 R2 SP1\n\nこのモジュールでは、.NET Framework 4.5 以上も必要です。 <a href=\"https://msdn.microsoft.com/library/5a4x27ek.aspx\" target=\"_blank\">開発者向けの .NET Framework をインストールします</a>。\n"
- title: 開始する
  durationInMinutes: 10
  content: "\n\n開始するには、次が必要になります。\n1. <a href=\"https://products.office.com/business/office-365-enterprise-e3-business-software\" target=\"_blank\">Office 365 Enterprise E3</a> の試用版 実際のテナントでの作業を開始する前に、テスト用のテナントでテストを実施して学習することを推奨します。 スクリプトを試してみるために、何人かのテスト ユーザーをテナントに (最小 5 人) 追加します。 \n\n2. PowerShell を管理者特権で起動します。 Windows 10 での操作方法は次のとおりです。\n \n  a. [**スタート**] をクリックします。\n \n  b. **Windows PowerShell** と入力します。\n \n  c. 右クリックして [**管理者として​​実行​​**] を選びます。\n\n3. <a href=\"https://docs.microsoft.com/azure/active-directory/active-directory-accessmanagement-groups-settings-v2-cmdlets#install-the-azure-ad-powershell-module\" target=\"_blank\">AzureAD PowerShell モジュールをインストールします</a>。 \n  \n  > [!NOTE]\n  > これらの手順の実行中に、PowerShellGet によって NuGet プロバイダーを更新するよう求めるメッセージが表示される可能性があります。 プロンプトが表示された場合は、「Do you want PowerShellGet to install and import the NuGet provider now? (PowerShellGet に NuGet プロバイダーを今すぐインストールしてインポートするようにしますか?)」に対して[**Yes (はい)**] を選択します。 信頼されていないリポジトリについて「Are you sure you want to install the modules from 'PSGallery? (PSGallery からモジュールをインストールしてもよろしいですか?)」というメッセージが表示される可能性もあります。 ここでも [**Yes (はい)**] を選択します。 \n\n4. MicrosoftTeams PowerShell モジュールをインストールします。 AzureAD モジュールをインストールするすべての条件を満たしている場合は、MicrosoftTeams モジュールのインストールが速やかに進みます (同じセットの条件を共有しています)。 MicrosoftTeams モジュールをインストールするには、このコマンドを実行します。 \n\n          Install-Module MicrosoftTeams\n\n  > [!NOTE]\n  > 信頼されていないリポジトリについてのメッセージが再び表示される可能性があります。 \n\n5. <a href=\"https://docs.microsoft.com/MicrosoftTeams/scripts/PowerShell-script-sample-create-company-wide-team.md\" target=\"_blank\">PowerShell スクリプトを取得する</a>\n"
- title: パラメーターのガイダンス
  durationInMinutes: 2
  content: "\nすべてのパラメーターはオプションとして設定されますが、パラメーターが 1 つも設定されていない場合はスクリプトは実行されません。 パラメーターの組み合わせを使用して、会社全体のチームを作成および更新します。 自分のシナリオに基づいてスクリプトを実行するのに役立つサンプルを後のセクションで示します。 \n\n|パラメーター| 説明 |\n| ---  | ---  |\n|Owners | 少なくとも 2 人のユーザーを指定します (そのうち 1 人を自分にすることができますが、スクリプトでは最低 2 人が必要になります。) 特にテナント全体のチームの場合などでは、より多くの所有者を指定することを推奨します。 |\n|TeamName | 新しいチームを作成しようという場合にこれを指定します。 これが指定されない場合は、既存のチームの GroupId を指定する必要があります。 |\n|TeamDescription | これは作成している新しいチームの説明です。 既存のチームの説明は更新されません。 |\n|チャネル | 作成する対象のチャネルのリスト このスクリプトでは、少なくとも 2 つのチャネルが必要です (このパラメータを使用する場合)。 スクリプトが実行されるときに、各チャネルの説明が要求されます。 |\n|GroupId | 既存のチームに対してより多くのメンバーを追加して会社全体のチームにする場合は、これを指定します。 このパラメーターを指定すると、新しいチームは作成されません。 |\n|Members | 全員が追加されないようにする場合は、メンバーのリストを指定することができます。 リストのメンバーの最小数は 2 です。 |\n"
- title: スクリプトを実行する
  durationInMinutes: 5
  content: "\n提供されるスクリプトは署名なしスクリプトです。 詳細については、「<a href=\"https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-5.1&viewFallbackFrom=powershell-Microsoft.PowerShell.Core\" target=\"_blank\">実行ポリシーについて</a>」をご覧ください。 実行ポリシーを変更する前に、次のコマンドを実行して現在のポリシーを取り込みます。\n\n        Get-ExecutionPolicy\n\nこのポリシー レベルをメモに記録します。 このスクリプトを実行して会社全体のチームの作成を完了したら、このレベルに戻します。 ポリシーを RemoteSigned に変更するには、このコマンドを実行します。\n\n        Set-ExecutionPolicy -ExecutionPolicy RemoteSigned\n\nスクリプトを使用して実行できることは次のとおりです。 \n1. テナント内のすべてのメンバーを含んでいる新しいチームを作成します (最大 2500 人のメンバー)。\n\n          .\\CreateCompanyWideTeam.ps1 -Owners \"CBeane@Contoso.onmicrosoft.com\", \"PHampton@Contoso.onmicrosoft.com\" -TeamName \"Contoso Team\" -TeamDescription \"Tenant wide team to get everyone into one place. Use this team to share announcements, hold townhalls, or just encourage a more open work environment for everyone\" -Channels \"Announcements\", \"Townhalls\"\n\n2. テナント内のすべてのメンバーを既存のチームに追加します (最大 2500 人のメンバー)。\n    \n          .\\CreateCompanyWideTeam.ps1 -GroupID \"45f7b85e-149b-4ae4-bf43-9cedf9415e34\"\n\n3. 指定されたセットのメンバーを新規または既存のチームに追加します。\n    \n          .\\CreateCompanyWideTeam.ps1 -Owners \"CBeane@Contoso.onmicrosoft.com\", \"PHampton@Contoso.onmicrosoft.com\" -TeamName \"Project Scorpio\" -TeamDescription \"Wanted to reserve a cool project name, now we need a project\" -Channels \"Code Reviews\", \"Engineering Alerts\" -Members \"BMcMillan@Contoso.onmicrosoft.com\", \"DTodd@Contoso.onmicrosoft.com\", \"DMills@Contoso.onmicrosoft.com\"\n"
- title: 会社全体のチームの例
  durationInMinutes: 6
  content: "\n以下の表で、どのように販売会社のチームを設立できるかを示します。 おすすめのチャネル、タブ、コネクタ、ボットも記載されています。 少なくとも最初の時点では、2 つまたは 3 つのチャネルを作成することを推奨します。 これが多数のユーザーが含まれる初めてのチームである場合、この表を参照することで、どの種類のチャネルを作成したらよいかを理解しやすくなります。 これらの最初のチャネルのいくつかにデータを投入することにより、新規ユーザーが製品に慣れ親しんでその作業スタイルを理解しやすくなります。 現在のところ、PowerShell を使用してデータをチャネルに追加することはできませんので、この部分は手動で行う必要があります。 \n\n> [!Tip]\n> <a href=\"https://www.microsoft.com/download/confirmation.aspx?id=56505\" target=\"_blank\">Microsoft Teams スタートアップ キット</a>をダウンロードします。 このガイドには、「最初に Teams で行うべき 10 のこと」が含まれています。 マーケティング、営業、財務、人事、IT、エンジニアリング、プロジェクト管理などの組織のさまざまな機能において、Teams を最大限に活用するためのヒントを見つけることができます。\n\n#### <a name=\"trophy-best-practices\"></a>:トロフィー: ベスト プラクティス:\n- この段階では、単に作業を開始するだけで十分ですので、思い浮かんだチームをすべて作成しないようにしてください。 新しい領域が現れるごとにチャネルを作成することを継続します。\n- チャネルの名前を変更しないでください。前提となる SharePoint フォルダー構造は、そのチャネル名を反映し続けません。 \n\n \n  > [!NOTE]\n  > 削除されたチャネルを同じ名前で再作成することはできませんが、SharePoint ファイルを見つけることはできます。\n\n\n以下の表にチームの例と、それに対するおすすめのタブ、コネクター、ボットの概要を示します。 これはまったく完全なリストではありませんが、自分の会社においてどの種類のチャネルが役に立つかを判断するのに十分な情報を提供します。 \n|チャネル|タブとリソース|\n|-------|----------------|\n|全般|<ul><li>案内ガイド</li><li>役割の情報</li><li>トレーニング ビデオ</li></ul>|\n|アカウント プラン|<ul><li>戦略的アカウント用の OneNote</li><li>アカウント プラン用のフォルダー</li></ul>|\n|予測|<ul><li>Power BI ダッシュボード</li><li>基幹業務 (LOB) アプリ</li><li>カレンダーとタスクの確認</li></ul>|\n|必要なヘルプ|<ul><li>必要なヘルプについての会話</li><li>取引確認フォーム</li></ul>|\n|領域内マーケティング|<ul><li>マーケティング カレンダー</li><li>顧客ガイダンス</li></ul>|\n|製品の更新とフィードバック|<ul><li>価格ガイド</li><li>製品パンフレット</li><li>関連リンク</li></ul>|\nContoso でのチームワーク|<ul><li>Teams 用のツールキット (*開発中、後で再確認*)</li><li>操作方法の記事 (組織のクイック スタート ガイドなど)</li></ul>|\n|井戸端会議|<ul><li>チーム構築に関するトピック</li><li>ソーシャル メディアのイベント</li></ul>|\n\nビデオ「Tech Tip: Guidance for Setting Up Teams, Channels and Tabs (技術ヒント: チーム、チャネル、タブを設定するためのガイダンス)」(4 分間) を視聴して、最大の生産性を実現するために自分のチーム、チャネル、タブを設定する場合のベスト プラクティスについて学習してください。\n> [!VIDEO https://www.youtube.com/embed/hjJWtoaRJeE]\n"
- title: スクリプトの概要
  durationInMinutes: 2
  content: "\nこのスクリプトには次の 5 つのセクションがあります (上から下に順番に示しています)。\n1. **ドキュメンテーションと変数の定義**\n2. **関数 Create-Team**: 必要に応じてチームを作成します。 GroupID を指定しない場合、このセクションは指定された TeamName と TeamDescription を使用してチームを作成します。\n3. **関数 Add-Channels**: チャネルを指定した場合、ここでチャネルの説明が要求されて、チャネルが作成されます。 \n4. **関数 Add-Members**: メンバー管理のすべてを行います。 このセクションは AzureAD に接続して、ユーザーのセットを取り込み、メンバー リストが提供されていない場合にそれらのユーザーをチームに追加します。 既にチームに所属しているメンバーの追加ではなく、所有者とメンバーを追加するロジックを処理します。 \n5. **メイン プログラム**: これは関数が実行されるようにする命令です。 \n"
- title: 実施すべき内容
  durationInMinutes: 5
  content: "\n### <a name=\"next-steps\"></a>次のステップ\n\n1. この役割を果たすことができる既存のチームがない場合は、会社全体のチームを計画します。 名前、説明、必要な所有者、役に立つ初期のチャネルを決めます。 \n\n2. テスト テナント内でパラメーターを使用してスクリプトをテストします。 サンプルのコンテンツをいくつか追加して、外観に問題がないことを確認します。 \n\n3. テナント内にチームを作成するスクリプトを実行します。 または、Teams の UI を通して手動でチームを作成し、すべてのデータ (チャネル、ボット、アプリ、コネクタ) を投入してから、すべての所有者とメンバーを追加するためだけにスクリプトを利用することもできます。 作成したチームおよびそれらの groupID のリストを表示するには、次を使用します。\n\n        Connect-MicrosoftTeams\n        Get-Team\n\n    次に、この GroupID を使用して、追加の所有者を指定するスクリプトを実行します。\n\n        .\\CreateCompanyWideTeam.ps1 -GroupID \"45f7b85e-149b-4ae4-bf43-9cedf9415e34\" -Owners \"CBeane@Contoso.onmicrosoft.com\", \"PHampton@Contoso.onmicrosoft.com\"\n\n    これで、ユーザーはこのチームに入るときに、ピン留めしたり接続したりチャットで話したりできるものとして、他に何があるかを既に分かっている状態になります。 \n\n5.  フィードバックの送信\n    - このトレーニングについてのフィードバックや質問を、このページの下部にある [**コメント**] セクションからお寄せください\n    - Teams 製品のフィードバックまたは新しい機能のリクエストを送信するには、<a href=\"https://aka.ms/TeamsUserVoice\" target=\"_blank\">Teams UserVoice</a> に移動してください"
