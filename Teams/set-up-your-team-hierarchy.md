---
title: チームのターゲット階層を設定する
author: cichur
ms.author: v-cichur
manager: serdars
ms.topic: conceptual
ms.service: msteams
ms.reviewer: andfried
search.appverid: MET150
description: 組織でチーム階層を設定して、大規模なチーム セットにコンテンツを発行する方法について学習します。
audience: admin
localization_priority: Normal
MS.collection:
- Teams_ITAdmin_Help
- M365-collaboration
appliesto:
- Microsoft Teams
ms.openlocfilehash: 099ee82e5890e81b6fc89a5ffc1842d936e6ad1e
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "49806157"
---
# <a name="set-up-your-team-targeting-hierarchy"></a>チームのターゲット階層を設定する

> **現在、この機能はプライベート プレビューに表示されています。**

組織がコンテンツを多数のチームに発行するために使用できるチームの階層を作成するには、チームのターゲットスキーマを設定する必要があります。 スキーマは、階層内のすべてのチームが互いに関連付けられている方法と、チームをフィルター処理するために使用できる属性を定義します。 スキーマを作成した後、スキーマを Teams にアップロードすると、階層が組織全体に適用されます。 スキーマがアップロードされると、Teams クライアント内のアプリで使用できます。 

> [!IMPORTANT]
> チーム内のチームまたはチャネルを参照している場合、チームの階層は表示されません。 チームの階層を表示するには、それをサポートするアプリを使用する必要があります。 最初のリリースでは、タスク アプリだけが階層構造のチームをサポートしています。 この記事の残りの部分では、受信者チームにタスクを発行するコンテキストでチーム階層を設定する方法について説明します。 チームのターゲット階層を設定する前に、タスク発行の概要については [、「Teams](manage-tasks-app.md) で組織のタスク アプリを管理する」を参照してください。

Teams のタスク アプリで階層がどのように表されるのかの例を次に示します。 タスク リストを作成した後、発行チームのメンバーは、タスク リストを送信 (発行) する受信者チームを選択できます。 チームを選択すると、発行チームは階層、属性、または両方の組み合わせでフィルター処理できます。<br>

![タスクの発行のスクリーンショット](media/manage-tasks-app-publish.png)

## <a name="plan-your-hierarchy"></a>階層を計画する

階層を定義するスキーマを作成する前に、計画を立て、組織の形成方法を決定する必要があります。 これには、タスクを他のグループに発行する必要がある組織グループの決定が含まれます。 階層内の各ノードは、作業グループまたはグループのグループを表します。 階層の下部にあるノード (子のないノード) はタスクを受信できるチームで、他のノード (親) はタスクを下方に発行する権限を持つ組織グループです。 チームは階層内で 1 回だけ表現できます。

たとえば、次の階層では、リコール、リテールコミュニケーション、人事は、階層内のすべての下位ノード (チーム) にタスクを発行できるのに対し、ノース東ゾーンでは、タスクをニューヨークストアとボストン ストア チームにのみ発行できます。 この階層により、リコール、リテールコミュニケーション、人事グループは、福利厚生情報や CEO からのメッセージなど、会社全体に適用されるタスクを発行できます。 北米地域では、人事のスケジュール、天気情報などのタスクをニューヨーク ストアとボストン ストア チームにのみ発行できます。

![チームの階層構造の例](media/team-targeting-schema-example.png)

## <a name="create-your-hierarchy"></a>階層を作成する

階層を定義するスキーマは、コンマ区切り値 (CSV) ファイルに基づいて作成されます。 CSV ファイルの各行は、チームの階層内の 1 つのノードに対応します。 各行には、階層内のノードに名前を付け、必要に応じてチームにリンクする情報が含まれます。また、それをサポートするアプリでチームをフィルター処理するために使用できる属性も含まれます。

バケットを定義することもできます。これは、発行チームが受信者チームに送信されたコンテンツを整理して、関連するコンテンツの表示、並べ替え、集中を容易にするために使用できるカテゴリです。

### <a name="add-required-columns"></a>必須の列を追加する

CSV ファイルには、最初の列から始まる次の 3 つの列が次の順序で含まれている必要があります。 タスクを受信するには、ノードをチームにリンクする必要があります。 プライベート プレビューでは、2,000 ノードをサポートしています。 起動時には、既定で少なくとも 15,000 ノードがサポートされる予定です。 お客様と協力して、大規模な組織に対してこの制限を引き上げる予定です。

| 列名   | 必須 | 説明   |
----------------|----------|---------------|
| TargetName    | はい      | これはノードの名前です。 名前には最大 100 文字まで使用できます。A ~ Z、a ~ z、0 ~ 9 の文字のみを含めることができます。 ノード名は一意である必要があります。 |
| ParentName    | はい       | これは親ノードの名前です。 ここで指定する値は、親ノードの TargetName フィールドの値と正確に一致する必要があります。 複数の親ノードを追加する場合は、各親ノード名をセミコロン (;)。 最大 25 の親ノードを追加できます。各親ノード名は最大 2500 文字まで使用できます。 1 つのノードに複数の親ノードを含めできるのは、親ノードがルート ノードである場合のみです。   <br><br>**重要** 階層内の上位の親が階層の下位にある子ノードを参照するループを作成しないように注意してください。 これはサポートされていません。 |
| TeamId        | はい (チームがタスクを発行するか、親ノードからタスクを受け取った場合)       | これには、ノードをリンクするチームの ID が含されます。 ノードが階層の一番下にある場合、ユーザーがノードから発行できる場合、またはユーザーがノードとその下位ノードのレポートを表示する場合は、ノードをチームにリンクする必要があります。 たとえば、西部地域のマネージャーが、その地域Officeのノードのタスク完了レポートを表示する必要がある場合などです。<br><br>階層内の他のノードをグループ化する目的でのみノードを追加する場合は、そのノードをチームにリンクする必要はありません。また、このフィールドを空白のままにすることができます。 各ノードをリンクできるチームは 1 つのみです。<br>ノードをリンクするチームの ID を取得するには、次の PowerShell コマンドを実行します `Get-Team | Export-Csv TeamList.csv` 。 これにより、組織内のチームが一覧表示され、各チームの名前と ID が含まれます。 リンク先のチームの名前を見つけ、このフィールドに ID をコピーします。|

### <a name="add-attribute-columns"></a>属性列を追加する

3 つの必須列を追加した後は、オプションの属性列を追加できます。 これらの属性を使用してノードをフィルター処理し、タスクを発行するノードを簡単に選択できます。 属性を定義するには、その属性の値が互いに排他的かどうかに応じて、2 つの方法があります。

|属性を追加する方法|説明 |例  |
|---|---------|---------|
|属性の値が互いに排他的である場合、指定した列名が属性の名前になります。|各行には、その属性に 1 つの値を含め、各値には最大 100 文字まで使用できます。 属性列で指定した属性値のセットは、階層を使用する Teams アプリのその属性で使用可能なフィルター値として表示されます。 各属性列には、最大 50 の一意の値を含めることができます。 |ユーザーがレイアウトでストアをフィルター処理できる必要がある。 この属性の値は、1 つのストアに 1 つのレイアウトしか設定しないので、相互に排他的です。 <br><br>レイアウトでストアをフィルター処理する属性を追加するには、[ストア] レイアウトという名前の列を追加します。 この例では、Store レイアウト属性の値は Compact、Standard、Large です。
|属性に複数の値を指定する必要があるが、値が互いに排他的でない場合は、列名に **AttributeName:UniqueValue** 形式を使用します。 |コロンの前の文字列 (:)属性の名前になります。 コロンの前に同じ文字列を含むすべての列 (:)は、フィルター メニューのセクションにグループ化されます。 コロンの後の各文字列が、そのセクションの値になります。<br><br>各行には、その属性に 0 (ゼロ) または 1 の値を指定できます。 値 0 は、属性がノードに適用されません。値 1 は、そのノードに属性が適用されるという意味です。|ユーザーが部門別に店舗をフィルター処理できる必要がある。 店舗には複数の部署を含め、この属性の値は相互に排他的ではありません。<br><br>この例では、属性列として Departments:Clothing、Departments:Electronics、Departments:Foods、Departments:Home and Garden、Departments:Sporting goods を追加します。 部署は属性名になり、ユーザーは、ウェア、電子、食品、家庭と庭、スポーツ用品の各部門でフィルター処理できます。|

属性列を追加する場合は、次の注意が必要です。

- 指定した列名またはコロンの前に指定した列名 (:)属性の名前になります。 この値は、階層を使用する Teams アプリに表示されます。
- 列名には最大 100 文字まで使用できます。A ~ Z、a ~ z、0 ~ 9、およびスペースのみを含めることができます。 列名は一意である必要があります。
- 起動時には、50 列の属性列を許可する予定です。

### <a name="add-bucket-columns"></a>バケット列を追加する

バケット列を追加してバケットを作成できます。バケットは、タスクを整理できるグループです。 各バケットは、CSV ファイルに独自の列を取得します。 作成したバケットは、発行チームが利用できます。 発行チームは、これらのバケットを使用して、受信者チームのタスクを分類できます。 バケットがチームにまだ存在しない場合、タスクが発行されると、バケットはオンデマンドで作成されます。

作業を一度に 1 回分類することで、発行チームは、タスク リストを受け取る数十、数百、または数千の受信者チームのタスク リストを事前に整理できます。 受信者チームは、タスクをバケットで並べ替え、フィルター処理して、作業に最も関連のある領域に焦点を当てできます。

バケット列を追加する場合は、次の点に注意してください。

- 列名がバケットの名前になります。 指定した各バケットは、階層を使用する Teams アプリのバケットリストに表示されます。 バケット名には機密情報を含めすることをお勧めします。 現時点では、発行チームは作成後に発行を通じてバケットを削除することはできません。
- 列名の前にハッシュタグ (#) を付けなければならない。 最大 100 文字まで使用できます。A ~ Z、a ~ z、0 ~ 9 の文字のみを含めることができます。 たとえば、商品#Operations、#Frozenします。
- 起動時には、25 のバケット列がサポートされる可能性があります。 お客様と協力して、大規模な組織でこの制限を増やす予定です。

### <a name="example"></a>例

上の図に示す階層をサポートするために作成されるスキーマ CSV ファイルの例を次に示します。 このスキーマには、次の情報が含まれます。

- という名前の 3 つの `TargetName` 必須 `ParentName` 列、および `TeamId`
- 3 つの属性列 `Store layout` の名前 `Departments:Clothing` 、および `Departments:Foods`
- 3 つのバケット列 `Fresh Foods` の名前 `Frozen Foods` 、および `Womenswear`

属性 `Store layout` には、次の `Compact` 値が `Standard` 含まれます `Large` 。 属性 `Departments` 列は、値 `0` (0) または . `1` 上 `Store` の図 `Departments` では、レイアウトと属性は表示されません。 属性をノード エントリに追加する方法を示すのに役立つ情報がここに追加されます。 3 つのバケット列にも同じです。


| TargetName             | ParentName                      | TeamId                       | [ストア] レイアウト|Departments:Clothing|部署:食品|#Fresh食品|#Frozen食品|#Womenswear|
|------------------------|-------------------------|--------------------------------------|-------------|---|---|---|---|---|
| 取り消し                 |                         | db23e6ba-04a6-412a-95e8-49e5b01943ba |||||||
| コミュニケーション         |                         | 145399ce-a761-4843-a110-3077249037fc |||||||
| 人事                     |                         | b8f7db91-201c-4cf9-9f7e-90a4894ed8e4 |||||||
| 東部地域Office   |                         |                                      |||||||
| 西部地域Office   |                         |                                      |||||||
| 北東地域        | 東部地域Office    |                                      |||||||
| 東南地域        | 東部地域Office    |                                      |||||||
| ニューヨークストア         | 北東地域         | e2ba65f6-25e7-488b-b8f0-b8562d5de60a |大|1|1||||
| ボストン ストア           | 北東地域         | 0454f08a-0507-437c-969a-682eb2fae7fc |Standard|1|1||||
| フロリダストア            | 東南地域         | 619d6e4e-5f68-4b36-8e1f-16c98d7396c1 |コンパクト|0|1||||
| ニューオリエント ストア      | 東南地域         | 6be960b8-72af-4561-a343-9ac4711874eb |コンパクト|0|1||||
| シアトル ストア          | 西部地域Office    | 487c0d20-4e55-4dc2-8187-a24c826e0fee |Standard|1|1||||
| ロサンゼルス ストア      | 西部地域Office    | 204a1287-2efb-4a8a-88e0-56fbaf5a2389 |大|1|1||||

## <a name="apply-your-hierarchy"></a>階層を適用する

> [!IMPORTANT]
> この手順を実行するには、PowerShell ギャラリーから Teams PowerShell パブリック プレビュー モジュールをインストールして [使用する必要があります](https://www.powershellgallery.com/packages/MicrosoftTeams/)。 モジュールをインストールする手順については、「Teams PowerShell をインストールする [」を参照してください](teams-powershell-install.md)。

スキーマ CSV ファイルで階層を定義すると、それを Teams にアップロードする準備が整います。 これを行うには、次のコマンドを実行します。 この手順を実行するには、グローバル管理者または Teams サービス管理者である必要があります。

```powershell
Set-TeamTargetingHierarchy -FilePath "C:\ContosoTeamSchema.csv"
```

## <a name="remove-your-hierarchy"></a>階層を削除する

> [!IMPORTANT]
> この手順を実行するには、PowerShell ギャラリーから Teams PowerShell パブリック プレビュー モジュールをインストールして [使用する必要があります](https://www.powershellgallery.com/packages/MicrosoftTeams/)。 モジュールをインストールする手順については、「Teams PowerShell をインストールする [」を参照してください](teams-powershell-install.md)。

組織内のすべてのユーザーの [発行済みリスト] タブをすぐに無効にする場合は、階層を削除できます。 [発行済みリスト] タブ **やタブの** 機能にアクセスできない。 これには、新しいタスク リストを作成して、発行、下書きリストへのアクセス、発行、公開の取り消し、重複リストの表示、レポートの表示を行う機能が含まれます。 階層を削除しても、以前に発行されたタスクは発行されません。 これらのタスクは、受信者チームが引き続き実行できます。 

階層を削除するには、次のコマンドを実行します。 この手順を実行するには、管理者である必要があります。 

```powershell
Remove-TeamTargetingHierarchy
```

## <a name="troubleshooting"></a>トラブルシューティング

### <a name="you-receive-an-error-message-when-you-upload-your-schema-csv-file"></a>スキーマ CSV ファイルをアップロードすると、エラー メッセージが表示される

エラー メッセージには、スキーマをアップロードできなかった理由を示すトラブルシューティング情報が含まれる必要があります。 エラー メッセージの情報に基づいてスキーマ CSV ファイルを確認して編集し、もう一度やり直してください。

### <a name="you-receive-an-error-invalidteamid-error-message-when-you-upload-your-schema-csv-file"></a>スキーマ CSV ファイルをアップロードすると、"エラー: InvalidTeamId" というエラー メッセージが表示される

スキーマ CSV ファイルをアップロードしようとするときに、次のエラー メッセージが表示されます。

```console
Error: InvalidTeamId
Description: TeamID in row # doesn't match a valid Group ID. Please view our documentation to learn how to get the proper GroupID for each team.
```

スキーマ CSV ファイルでチームに正しい TeamId を使用していることを確認します。 TeamId は、チームをバックアップする Microsoft 365 グループのグループ ID と同じである必要があります。 Microsoft Teams 管理センターでチームのグループ ID を確認できます。 

1. Microsoft Teams 管理センターの左側のナビゲーション [で、[チーム](https://admin.teams.microsoft.com/)の管理]  >  **に移動します**。
2. テーブルに **[グループ ID]** 列が表示されない場合は、テーブルの右上隅にある [列の編集] を選び、[グループ **ID] をオンにします**。
3. 一覧からチームを見つけ、グループ ID を見つける。

スキーマ CSV ファイルの TeamId が、Microsoft Teams 管理センターに表示されるグループ ID と一致する必要があります。 

## <a name="related-topics"></a>関連項目

- [Teams で組織のタスク アプリを管理する](manage-tasks-app.md)
- [Teams での PowerShell の概要](teams-powershell-overview.md)
