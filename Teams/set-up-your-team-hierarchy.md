---
title: チームターゲット設定の階層を設定する
author: lanachin
ms.author: v-lanac
manager: serdars
ms.topic: conceptual
ms.service: msteams
ms.reviewer: andfried
search.appverid: MET150
description: 組織内のチーム階層を設定して、コンテンツを大規模なチームに公開する方法について説明します。
audience: admin
localization_priority: Normal
MS.collection:
- Teams_ITAdmin_Help
- M365-collaboration
appliesto:
- Microsoft Teams
ms.openlocfilehash: 26e4ee05b9f94fa0883aef5bbe98b691c9e0c46d
ms.sourcegitcommit: 5a88788bd0a0b2ccbc5b977b38dcfe4681cd5d10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/18/2020
ms.locfileid: "44278170"
---
# <a name="set-up-your-team-targeting-hierarchy"></a>チームターゲット設定の階層を設定する

> **現在、この機能はプライベートプレビューに含まれています。**

組織でコンテンツを大規模なチームに公開するために使用できるチームの階層を作成するには、チームのターゲット設定スキーマを設定する必要があります。 スキーマでは、階層内のすべてのチームが互いにどのように関連しているかを定義し、チームをフィルター処理するために使用できる属性を定義します。 スキーマを作成したら、チームにアップロードします。階層は組織全体に適用されます。 スキーマがアップロードされると、Teams クライアント内のアプリでスキーマを使用できるようになります。 

> [!IMPORTANT]
> チームまたはチャネル内のチャネルを参照している場合、teams の階層は表示されません。 チームの階層を表示するには、それをサポートしているアプリを使用する必要があります。 最初のリリースでは、タスクアプリだけが階層チームをサポートしています。 この記事の残りの部分では、受信者チームへのタスクの発行のコンテキストでのチーム階層のセットアップについて説明します。 チームターゲット階層を設定する前に、「[チームのタスクアプリを管理](manage-tasks-app.md)して、タスクの発行の概要を確認する」を参照してください。

次の例は、Teams の Tasks アプリで階層がどのように表されるかを示しています。 タスクリストが作成された後、発行チームのメンバーは、タスクリストを送信 (公開) する受信者チームを選択することができます。 チームを選択すると、発行チームは階層、属性、または両方の組み合わせを使用してフィルターを適用できます。<br>

![タスクの発行のスクリーンショット](media/manage-tasks-app-publish.png)

## <a name="plan-your-hierarchy"></a>階層を計画する

階層を定義するスキーマを作成する前に、組織の形成方法を計画し、決定する必要があります。 これには、タスクを他のグループに発行するために必要な組織グループを決定することが含まれます。 階層内の各ノードは、作業グループまたはグループのグループを表します。 階層の最下部にあるノード (子がない場合) は、タスクを受け取ることができる teams であり、他のノード (親) は、タスクの下位公開の権限を持つ組織グループです。 チームは、階層内で1回のみ表示できます。

たとえば、次の階層では、取り消し、小売の通信、および人事は、階層内のすべての下位ノード (チーム) にタスクを発行できますが、北米は、ニューヨークの店舗とボストンのストアチームにのみタスクを公開できます。 この階層により、取り消し、小売通信、人事グループは、福利厚生情報や CEO からのメッセージなど、会社全体に適用されるタスクを公開することができます。 ノース East ゾーンでは、社員のスケジュール、天気予報などのタスクを、ニューヨークストアとボストンストアチームにのみ公開できます。

![チーム階層の例](media/team-targeting-schema-example.png)

## <a name="create-your-hierarchy"></a>階層を作成する

階層を定義するスキーマは、コンマ区切り値 (CSV) ファイルに基づいています。 CSV ファイルの各行は、teams の階層内の1つのノードに対応しています。 各行には、階層内にノードの名前を指定し、必要に応じてチームにリンクを追加するための情報が含まれており、それをサポートしているアプリでチームをフィルター処理するために使うことができる属性が含まれています。

また、ユーザーが関連性の高いコンテンツを表示、並べ替え、フォーカスするのを容易にするために、発行チームが送信するコンテンツの整理に使用できるバケットとして、バケットを定義することもできます。

### <a name="add-required-columns"></a>必要な列を追加する

CSV ファイルには、次の3つの列を、最初の列から順に入力する必要があります。 タスクを受け取るには、ノードがチームにリンクされている必要があります。 プライベートプレビューの際に、500ノードをサポートしています。 起動時には、少なくとも2000ノードが既定でサポートされることを想定しています。 お客様と協力して、大規模な組織でこの制限を引き上げることを計画しています。

| 列名   | 必須 | 説明   |
----------------|----------|---------------|
| Storyboard.targetname    | はい      | これはノードの名前です。 名前は、最大100文字で、A-z、a-z、0-9 の文字だけを含むことができます。 ノード名は一意である必要があります。 |
| ParentName    | はい       | これは、親ノードの名前です。 ここで指定する値は、親ノードの TargetName フィールドの値と正確に一致する必要があります。 複数の親ノードを追加する場合は、各親ノード名をセミコロン (;)) で区切ります。 最大25個の親ノードを追加できます。各親ノード名は、最大2500文字まで指定できます。 ノードには、親ノードがルートノードの場合にのみ、複数の親ノードを含めることができます。   <br><br>**重要**階層の上位の親が、階層の下位の子ノードを参照するループを作成しないように注意してください。 これはサポートされていません。 |
| TeamId        | ○ (チームが親ノードからタスクを発行するか、タスクを受け取る場合)       | これには、ノードをリンクさせるチームの ID が含まれます。 ノードが階層の一番下にある場合は、そのノードからユーザーを公開できるようにする必要がある場合、またはユーザーがそのノードとその子孫のレポートを表示できるようにする場合は、そのノードがチームにリンクされている必要があります。 たとえば、西部地域の Office のマネージャーで、その地域に属するノードのタスク完了レポートを表示するとします。<br><br>階層内の他のノードをグループ化する目的でのみノードを追加する場合は、そのノードをチームにリンクする必要はありません。このフィールドは空白のままにすることができます。 各ノードをリンクできるチームは1つだけです。<br>ノードをリンクさせるチームの ID を取得するには、次の PowerShell コマンドを実行し `Get-Team | Export-Csv TeamList.csv` ます。 組織内のチームの一覧が表示され、各チームの名前と ID が含まれます。 リンク先のチームの名前を見つけ、その ID をこのフィールドにコピーします。|

### <a name="add-attribute-columns"></a>属性列を追加する

必要な3つの列を追加した後で、省略可能な属性列を追加できます。 これらの属性は、ノードをフィルター処理するために使用できます。これにより、タスクの発行先を簡単に選ぶことができます。 属性を定義するには、2つの方法があります。その属性の値が相互排他的であるかどうかによって異なります。

|属性を追加する方法|説明 |例  |
|---|---------|---------|
|属性の値が相互に排他的な場合、指定した列名が属性の名前になります。|各行には、その属性の値を1つ含めることができます。各値は、最大100文字まで指定できます。 属性列で指定した属性値のセットは、階層を使用する Teams アプリ内のその属性に使用可能なフィルター値として表示されます。 各属性列は、最大50の一意の値を持つことができます。 |ユーザーがレイアウトに基づいてストアにフィルターを適用できるようにする場合。 この属性の値は、ストアは1つのレイアウトしか持つことができないため、相互に排他的です。 <br><br>属性を追加して、ストアのレイアウトをフィルター処理するには、[ストアレイアウト] という名前の列を追加します。 この例では、ストアのレイアウト属性の値がコンパクト、標準、大です。
|属性に複数の値を指定する必要があり、その値が相互に排他的でない場合は、列名に**AttributeName: UniqueValue**形式を使用します。 |コロンの前にあるテキスト文字列 (:)は、属性の名前になります。 コロンの前に同じテキスト文字列を含むすべての列 (:)は、[フィルター] メニューのセクションにグループ化されています。 コロンの後の各文字列は、そのセクションの値になります。<br><br>各行の値は、その属性に対して 0 (ゼロ) または1にすることができます。 値0は、属性がノードに適用されないことを意味し、値1は属性がそのノードに適用されることを意味します。|ユーザーが部門ごとにストアにフィルターを適用できるようにする場合。 ストアは複数の部署を持つことができるため、この属性の値は相互に排他的ではありません。<br><br>この例では、部門を追加しています。衣類、部署: エレクトロニクス、部署: 食品、部署: ホームと庭園、部門: スポーツ商品を属性列として追加します。 部門は属性名になり、ユーザーは衣類、エレクトロニクス、食品、家庭、庭園、スポーツ用品の各部門によるフィルター処理を行うことができます。|

属性列を追加する場合は、次の点に注意してください。

- 指定した列名、またはコロンの前に指定した列名 (:)は、属性の名前になります。 この値は、階層を使用する Teams アプリに表示されます。
- 列名は、最大100文字で、文字 A-z、a-z、0-9、およびスペースのみを含めることができます。 列名は一意である必要があります。
- 起動時に、50の属性列を許可する予定です。

### <a name="add-bucket-columns"></a>バケット列を追加する

バケット列を追加して、バケットを作成することができます。これは、どのタスクを整理できるかというグループ化です。 各バケットは、CSV ファイルで独自の列を取得します。 作成したバケットは、発行チームに対して利用可能になります。 公開チームは、これらのバケットを使用して、受信者チームのタスクを分類できます。 バケットがチームにまだ存在しない場合は、タスクが公開されるときにバケットがオンデマンドで作成されます。

作業を1か所で分類することにより、発行チームは、タスクリストを受信する、数十、数百、または数千の受信者チームのタスクリストを事前に整理できます。 受信者のチームは、バケットごとにタスクを並べ替え、フィルター処理して、作業に最も関連性の高い領域にフォーカスを移動することができます。

バケット列を追加する場合は、次の点に注意してください。

- 列名は、バケットの名前になります。 指定した各バケットは、階層を使用する Teams アプリのバケットリストに表示されます。 バケット名には機密情報を含めないことをお勧めします。 現時点では、発行チームは、作成後に発行を通じてバケットを削除することはできません。
- 列名の前にハッシュタグ (#) を付ける必要があります。 長さは最大100文字で、A-z、a-z、0-9 の文字だけが含まれます。 たとえば、商品の #Operations や #Frozen ができます。
- 起動時に25個のバケット列がサポートされることを想定しています。 大規模な組織では、お客様と協力してこの制限を拡大する予定です。

### <a name="example"></a>例

上の画像で示されている階層をサポートするために作成されるスキーマ CSV ファイルの例を次に示します。 このスキーマには、次の要素が含まれます。

- " `TargetName` And" という名前の3つの必須列 `ParentName``TeamId`
- " `Store layout` And" という名前の3つの属性列 `Departments:Clothing``Departments:Foods`
- " `Fresh Foods` And" という名前の3つのバケット列 `Frozen Foods``Womenswear`

`Store layout`属性には、、、、などの値が含まれ `Compact` `Standard` `Large` ます。 `Departments`属性列は、の値 `0` (ゼロ) またはに設定でき `1` ます。 `Store`レイアウトと `Departments` 属性は上の画像には表示されません。 これらは、属性をノードエントリに追加する方法を示すために追加されています。 3つのバケット列にも同じことが当てはまります。


| Storyboard.targetname             | ParentName                      | TeamId                       | ストアレイアウト|部門: 衣類|部署: 食品|#Fresh 食品|#Frozen 食品|#Womenswear|
|------------------------|-------------------------|--------------------------------------|-------------|---|---|---|---|---|
| 呼び出す                 |                         | db23e6ba-04a6-412a-95e8-49e5b01943ba |||||||
| コミュニケーション         |                         | 145399 cea11030 77 24 倍速、146 8-30 77 797fc |||||||
| 人事                     |                         | b8f7db91-201c-4cf9-9f7e-90a4894ed8e4 |||||||
| East Office   |                         |                                      |||||||
| 西部支社   |                         |                                      |||||||
| ノース東部領域        | East Office    |                                      |||||||
| 南部の東部領域        | East Office    |                                      |||||||
| ニューヨーク店舗         | ノース東部領域         | e2ba65f6-25e7-488b-b8f0-b8562d5de60a |大|1|1||||
| ボストンストア           | ノース東部領域         | 0454f08a-0507-437c-969a-682eb2fae7fc |Standard|1|1||||
| Miami ストア            | 南部の東部領域         | 619d6e4e-5f68-4b36-8e1f-16c98d7396c1 |送付|0|1||||
| 新しいニューオーリンズストア      | 南部の東部領域         | 6be960b8-72af-4561-a343-9ac4711874eb |送付|0|1||||
| シアトル店舗          | 西部支社    | 487c0d20-4e55-4dc2-8187-a24c826e0fee |Standard|1|1||||
| ロサンゼルス店舗      | 西部支社    | 204a12874-efb44 5 a8a2-88 e2389 |大|1|1||||

## <a name="apply-your-hierarchy"></a>階層を適用する

> [!IMPORTANT]
> この手順を実行するには、PowerShell テストギャラリーから最新バージョンの Teams PowerShell モジュールをインストールして使用する必要があります。 この方法については、「 [Powershell テストギャラリーから最新の Teams powershell モジュールをインストール](#install-the-latest-teams-powershell-module-from-the-powershell-test-gallery)する」を参照してください。

スキーマ CSV ファイルで階層を定義したら、それを Teams にアップロードできます。 これを行うには、次のコマンドを実行します。 この手順を実行するには、グローバル管理者または Teams サービス管理者である必要があります。

```powershell
Set-TeamTargetingHierarchy -FilePath "C:\ContosoTeamSchema.csv"
```

## <a name="remove-your-hierarchy"></a>階層を削除する

> [!IMPORTANT]
> この手順を実行するには、PowerShell テストギャラリーから最新バージョンの Teams PowerShell モジュールをインストールして使用する必要があります。 この方法については、「 [Powershell テストギャラリーから最新の Teams powershell モジュールをインストール](#install-the-latest-teams-powershell-module-from-the-powershell-test-gallery)する」を参照してください。

組織内のすべてのユーザーに対して [**発行済みのリスト**] タブをすぐに無効にする場合は、階層を削除できます。 ユーザーは、[**発行済みリスト**] タブまたはタブのいずれかの機能にアクセスできません。 これには、発行するための新しいタスクリストを作成したり、下書きリストにアクセスしたり、リストにアクセスしたり、リストを公開したり、レポートを表示したりする機能が含まれます。 階層を削除しても、以前に公開されたタスクは発行されません。 これらのタスクは、受信者のチームが完了するまで、引き続き利用できます。 

階層を削除するには、次のコマンドを実行します。 この手順を実行するには、管理者である必要があります。 

```powershell
Remove-TeamTargetingHierarchy
```

### <a name="teams-powershell-module"></a>Teams Powershell モジュール

#### <a name="install-the-latest-teams-powershell-module-from-the-powershell-test-gallery"></a>PowerShell テストギャラリーから最新の Teams PowerShell モジュールをインストールする

最新の一般公開バージョンの Teams PowerShell モジュール (現在[1.0.5](https://www.powershellgallery.com/packages/MicrosoftTeams/1.0.5)) では、チーム階層の管理はサポートされていません。 次の手順を使用して、PowerShell テストギャラリーから、team hierarchy サポートを含む最新バージョンの Teams PowerShell モジュールをインストールします。

> [!NOTE]
> PowerShell テストギャラリーから、パブリック PowerShell ギャラリーのバージョンのモジュールと共に Teams PowerShell モジュールをインストールしないでください。 次の手順に従って、最初にパブリック PowerShell ギャラリーから Teams PowerShell モジュールをアンインストールしてから、PowerShell テストギャラリーから最新バージョンのモジュールをインストールします。

1. 既存のすべての PowerShell セッションを終了します。
2. Windows PowerShell モジュールの新しいインスタンスを開始します。
3. パブリック PowerShell ギャラリーから Teams PowerShell モジュールをアンインストールするには、次の操作を実行します。

    ```PowerShell
    Uninstall-Module -Name MicrosoftTeams
    ```

4. 既存のすべての PowerShell セッションを終了します。
5. もう一度 Windows PowerShell モジュールを起動し、次の操作を実行して、PowerShell テストギャラリーを信頼できるソースとして登録します。

    ```PowerShell
    Register-PSRepository -Name PSGalleryInt -SourceLocation https://www.poshtestgallery.com/ -InstallationPolicy Trusted
    ```

6. 次の操作を実行して、PowerShell テストギャラリーから最新の Teams PowerShell モジュールをインストールします。

    ```PowerShell
    Install-Module -Name MicrosoftTeams -Repository PSGalleryInt -Force
    ```

7. 次の操作を実行して、PowerShell テストギャラリーの最新バージョンの Teams PowerShell モジュールが正常にインストールされていることを確認します。

    ```PowerShell
    Get-Module -Name MicrosoftTeams
    ```

#### <a name="update-to-the-latest-version-of-the-teams-powershell-module-from-the-powershell-test-gallery"></a>PowerShell テストギャラリーから最新バージョンの Teams PowerShell モジュールに更新する

PowerShell テストギャラリーから既に Teams PowerShell モジュールをインストールしている場合は、次の手順を使用して最新バージョンに更新します。

1. 既存のすべての PowerShell セッションを終了します。
2. Windows PowerShell モジュールの新しいインスタンスを開始します。
3. 次の操作を実行して、PowerShell テストギャラリーから現在インストールされている Teams PowerShell モジュールのバージョンを更新します。

    ```PowerShell
    Update-Module -Name MicrosoftTeams -Force
    ```

4. 次の操作を実行して、PowerShell テストギャラリーの最新バージョンの Teams PowerShell モジュールが正常にインストールされていることを確認します。

    ```PowerShell
    Get-Module -Name MicrosoftTeams
    ```

## <a name="troubleshooting"></a>トラブルシューティング

### <a name="you-receive-an-error-message-when-you-upload-your-schema-file"></a>スキーマファイルをアップロードすると、エラーメッセージが表示される

エラーメッセージには、スキーマをアップロードできない理由を示すためのトラブルシューティング情報が含まれていることに注意してください。 エラーメッセージに記載されている情報に基づいて、スキーマ CSV ファイルを確認して編集してから、もう一度やり直してください。

## <a name="related-topics"></a>関連項目

- [Teams で組織のタスクアプリを管理する](manage-tasks-app.md)
