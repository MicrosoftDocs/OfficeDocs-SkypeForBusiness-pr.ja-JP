---
title: ダイヤル プランについて
author: CarolynRowe
ms.author: crowe
manager: serdars
ms.reviewer: mikedav, roykuntz
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
search.appverid: MET150
ms.collection:
- M365-voice
- m365initiative-voice
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- ms.teamsadmincenter.voice.dialplans.overview
- Calling Plans
description: 'Teams で利用できるダイヤル通話プラン (PSTN 通話ダイヤル プラン) の種類と、組織に応じて選択する方法について説明します。  '
ms.openlocfilehash: adb5f46296423b6339c62029d27111345c2fd646
ms.sourcegitcommit: d62e6cefceebe481eb207c59872f1aa67f0fc528
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/05/2021
ms.locfileid: "50460817"
---
# <a name="what-are-dial-plans"></a>ダイヤル プランについて

[] ダイヤル プランは、個別のユーザーによってダイヤルされた電話番号を、通話承認と通話ルーティングの目的で別の形式 (通常は E.164) に変換する、正規化ルールの名前付きのセットです。

ダイヤル プランは、さまざまな形式で表される電話番号が別の 1 つの形式にどのように変換されるかを定義する 1 つ以上の正規化ルールで構成されます。 同じダイヤル文字列が、ダイヤル プランによって異なる形で解釈、変換される可能性があるため、指定されたユーザーに割り当てられているダイヤル プランに応じて、同じダイヤル番号が異なる形で変換、ルーティングされることがあります。 テナント ダイヤル プランの最大数は 1,000 です。

テナントのダイヤル プランを作成および管理する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

## <a name="tenant-dial-plan-scope"></a>テナント ダイヤル プランのスコープ

ダイヤル プランのスコープによって、ダイヤル プランを適用できる階層レベルが決まります。 クライアントは、ユーザーが Teams にサインインするときに自動的に提供されるプロビジョニング設定を通じて適切なダイヤル プランを取得します。 管理者は、Microsoft Teams 管理センターまたはリモート PowerShell を使用して、ダイヤル プランのスコープ レベルを管理および割り当てできます。

Teams には、サービスを対象範囲にしたダイヤル プランとテナントスコープ (組織向け) の 2 種類のダイヤル プランがあります。 サービスを対象範囲にしたダイヤル プランは、電話システムが利用可能な国または地域ごとに定義されます。 各ユーザーには、ユーザーに割り当てられた使用場所に一致するサービス国のダイヤル プランが自動的に割り当てられます。 サービス国のダイヤル プランを変更できませんが、テナントを対象範囲にしたダイヤル プランを作成して、サービス国のダイヤル プランを拡張することができます。 クライアントがプロビジョニングされるに応じて、サービス国のダイヤル プランと適切にスコープが設定されたテナント ダイヤル プランの組み合わせである"有効なダイヤル プラン" が取得されます。 そのため、テナント ダイヤル プラン内のすべての正規化ルールは、サービス国のダイヤル プランに既に存在する可能性があるため、定義する必要はありません。

テナント ダイヤル プランは、さらに 2 つのスコープ (テナントスコープまたはユーザースコープ) に分割できます。 テナントがユーザースコープのダイヤル プランを定義して割り当てる場合、そのユーザーは、ユーザーのサービス国のダイヤル プランと割り当てられたユーザー ダイヤル プランの有効なダイヤル プランでプロビジョニングされます。 テナントがテナントスコープのダイヤル プランを定義しているが、ユーザースコープのダイヤル プランを割り当てない場合、そのユーザーはユーザーのサービス国のダイヤル プランとテナント ダイヤル プランの有効なダイヤル プランでプロビジョニングされます。

Teams のダイヤル プランの継承モデルは次のとおりです。

![Teams でのダイヤル プランの継承方法](media/b2744f33-ebbd-4c23-bfba-1747312ab178.png)

次に、考えられる有効なダイヤル プランを示します。

 **サービス国** テナント スコープのダイヤル プランが定義されていない場合、テナント ユーザースコープのダイヤル プランがプロビジョニングされたユーザーに割り当てられていない場合、ユーザーは、使用場所に関連付けられているサービス国にマップされた有効なダイヤル プランを受け取る必要があります。

 **テナント グローバル - サービス国** テナント ユーザー ダイヤル プランが定義されているがユーザーに割り当てられていない場合、プロビジョニングされたユーザーは、マージされたテナント ダイヤル プランと、その使用場所に関連付けられているサービス国のダイヤル プランで構成される有効なダイヤル プランを受け取る。

 **テナント ユーザー - サービスの国** テナント ユーザー ダイヤル プランが定義され、ユーザーに割り当てられている場合、プロビジョニングされたユーザーは、結合されたテナント ユーザー ダイヤル プランと、その使用場所に関連付けられているサービス国のダイヤル プランで構成される有効なダイヤル プランを受け取る。

テナントのダイヤル プランを作成する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

> [!NOTE]
> ダイヤル プランの正規化ルールがダイヤル番号に適用されないシナリオでは、ダイヤルされた文字列は、ダイヤルユーザーの使用場所の国コードである "+CC" の先頭に引き続き正規化されます。 これは、通話プラン、ダイレクト ルーティング、PSTN 電話会議のダイヤルアウトシナリオに適用されます。

## <a name="planning-for-tenant-dial-plans"></a>テナント ダイヤル プランの計画

カスタム ダイヤル プランを計画するには、次の手順を実行します。

- **手順 1** ユーザーのダイヤル エクスペリエンスを高めるためにカスタム ダイヤル プランが必要かどうかを決定します。通常は、内線または省略された国内ダイヤルなど、E.164 以外のダイヤルに対応する場合に必要となります。

- **手順 2** テナント グローバルまたはテナント ユーザー スコープのダイヤル プランのどちらが必要か、または両方とも必要であるかを決定します。ユーザーに複数のローカル ダイヤル要件がある場合は、ユーザー スコープのダイヤル プランが必要となります。

- **手順 3** 各必須ダイヤル プランに対応する有効な番号バターンを特定します。サービス レベル国のダイヤル プランで定義されていない番号パターンのみが必要となります。

- **手順 4** ダイヤル プランの名前付けについて組織全体のスキームを策定します。標準的な名前付けスキームを採用することにより、組織全体にわたり一貫した方針を実現でき、メンテナンスや更新作業が簡素化されます。


## <a name="creating-your-new-dial-plan"></a>新しいダイヤル プランの作成

ダイヤル プランを新規作成する場合、必要な情報を把握しておく必要があります。

### <a name="name-and-simple-name"></a>名前と簡易名

ユーザー ダイヤル プランの場合は、ダイヤル プランを割り当てるユーザーを識別するわかりやすい名前を指定する必要があります。 ダイヤル プランの簡易名には、ダイヤル プラン名から派生する文字列が事前に入力されています。 [単純名] フィールドは編集可能で、ダイヤル プラン用のより説明的な名前付け規則を作成することができます。 [単純名] の値は空にすることはできず、一意でなければなりません。 最適な方法は、組織全体の名前付け規則を作成してから、その規則の一貫性をすべてのサイトとユーザーに使用することです。

### <a name="description"></a>説明

地理的な場所または対応するダイヤル プランが適用されるユーザーのグループに関する一般的で認識可能な名前を入力することをお勧めします。

### <a name="external-access-prefix"></a>外部アクセス プレフィックス
<a name="bkexternalprefix"> </a>

ユーザーが外線につなぐために 1 つ以上の追加の先頭数字 (9 など) をダイヤルする必要がある場合は、最大 4 文字 (#、*、0～9) の外部アクセス プレフィックスを指定できます。

> [!NOTE]
> 外部アクセス プレフィックスを指定する場合、プレフィックスを適応させるための正規化ルールを追加で作成する必要はありません。

テナントのダイヤル プランを作成する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

## <a name="normalization-rules"></a>正規化ルール
<a name="bknormalizationrule"> </a>

正規化ルールによって、さまざまな形式で表される電話番号をどのように変換するかが定義されます。ダイヤル元のロケールに応じて、同じ番号文字列が異なる方法で解釈および変換される場合があります。正規化ルールは、ユーザーが省略された内線または外線番号をダイヤルできるようにする必要がある場合に、必須となることがあります。

1 つ以上の正規化ルールをダイヤル プランに割り当てる必要があります。 正規化ルールは上から下の順に照合されるため、テナント ダイヤル プランにおける順序が重要になります。 たとえば、テナント ダイヤル プランに 10 個の正規化ルールがある場合、ダイヤルされた番号の一致ロジックは 1 番目のルールから試行され、一致がみられない場合は 2 番目、というように順次実行されます。 一致がみられた場合、そのルールが使用され、定義済みのそれ以外のルールとの照合は実行されません。 特定のテナント ダイヤル プランには、最大 50 の正規化ルールを設定できます。

### <a name="determining-the-required-normalization-rules"></a>必要な正規化ルールの指定

テナント ダイヤル プランは、特定のユーザーのサービス国ダイヤル プランと効果的に結合されるので、必要なテナント ダイヤル プランの正規化ルールを決定するには、サービス国のダイヤル プランの正規化ルールを評価する必要がある可能性があります。 この目的で **Get-CsEffectiveTenantDialPlan** コマンドレットを使用できます。 コマンドレットは入力パラメータとしてユーザー ID を必要とし、ユーザーに適用可能なすべての正規化ルールを返します。

### <a name="creating-normalization-rules"></a>正規化ルールの作成
<a name="createrule"> </a>

正規化ルールでは、.NET Frameworkを使用して、サーバーがダイヤル文字列を E.164 形式に変換するために使用する数値の一致パターンを指定します。 正規化ルールは、一致に対する正規表現と、一致が見つかったときに行う変換を指定することで作成できます。 作業が完了したら、テスト番号を入力して、正規化ルールが正常に機能することを確認できます。

.NET Framework の正規表現を使用する場合の詳細については、「[.NET Framework の正規表現](https://go.microsoft.com/fwlink/p/?linkId=140927)」を参照してください。

テナントのダイヤル プランの正規化ルールを作成および管理する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

> [!NOTE]
> 最初のトークンが省略可能な正規化ルールは、現在、3pip デバイス (Polycom VVX 601 モデルなど) ではサポートされていません。 3pip デバイスにオプションの正規化ルールを適用する場合は、1 つではなく 2 つの正規化ルールを作成する必要があります。 たとえば、ルール ^0?(999)$ は、(999)$ (Translation:$1) と ^0(999)$ (Translation:$1) の 2 つのルールに置き換える必要があります。


### <a name="sample-normalization-rules"></a>正規化ルールのサンプル

次の表に, .NET Framework の正規表現として記述される正規化ルールのサンプルを示します。これらのサンプルは例示するためのもので、独自の正規化ルールを作成する際の規定リファレンスとして提示するものではありません。

<a name="regularexpression"></a> 
 **正規表現を使用した正規化.NET Frameworkルール**

| ルール名<br/> | 説明<br/> | 番号のパターン<br/> | 変換<br/> | 例<br/> |
|:-----|:-----|:-----|:-----|:-----|
|4digitExtension  <br/> |4 桁の内線番号を変換します。  <br/> |^(\\d{4})$  <br/> |+1425555$1  <br/> |0100 は +14255550100 に変換されます  <br/> |
|5digitExtension  <br/> |5 桁の内線番号を変換します。  <br/> |^5(\\d{4})$  <br/> |+1425555$1  <br/> |50100 は +14255550100 に変換されます  <br/> |
|7digitcallingRedmond  <br/> |7 桁の番号をレドモンドの電話番号に変換します。  <br/> |^(\\d{7})$  <br/> |+1425$1  <br/> |5550100 は +14255550100 に変換されます  <br/>|
|RedmondOperator  <br/> |0 をレドモンドのオペレーター呼び出し番号に変換します。  <br/> |^0$  <br/> |+14255550100  <br/> |0 は +14255550100 に変換されます  <br/> |
|RedmondSitePrefix  <br/> |オンネット プレフィックス (6) およびレドモンドのサイト コード (222) 付きの番号を変換します。  <br/> |^6222(\\d{4})$  <br/> |+1425555$1  <br/> |62220100 は +14255550100 に変換されます  <br/> |
|5digitRange  <br/> |3 から 7 を含むその範囲で始まる 5 桁の内線番号を変換します。  <br/> |^([3-7]\\d{4})$  <br/> |+142555$1 <br/> |54567 は +14255554567 に変換されます  <br/> |
|PrefixAdded  <br/> |1 桁目と 3 桁目に制限を付けて、9 桁の番号の前に国番号を追加します。  <br/> |^([2-9]\\d\\d[2-9]\\d{6})$  <br/> |1$1  <br/> |4255554567 は 14255554567 に変換されます  <br/> |
|NoTranslation  <br/> |5 桁と一致しますが、変換は行いません。  <br/> |^(\\d{5})$  <br/> |$1  <br/> |34567 は 34567 に変換されます  <br/> |

 **上に示す正規化ルールに基づくレドモンドのダイヤル プラン**

 次の表に、前の表に示される正規化ルールに基づく、レドモンド、ワシントン、米国のサンプル ダイヤル プランを示します。

| レドモンドのダイヤル プラン<br/> |
|:-----------------------|                                                                                                                      
| 5digitExtension <br/> |                                                                                                                                    
| 7digitcallingRedmond <br/> |
| RedmondSitePrefix <br/> |
| RedmondOperator <br/> |

> [!NOTE]
> 前の表に示す正規化ルール名にはスペースは含めることはできませんが、これは選択の必要があります。 たとえば、表に最初に示されている名前は、「5 digit extension」と「5-digit Extension」のどちらの形式で記述しても有効になります。

## <a name="related-topics"></a>関連トピック

[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)

[通話プランで使用されるさまざまな種類の電話番号](different-kinds-of-phone-numbers-used-for-calling-plans.md)

[組織の電話番号を管理する](manage-phone-numbers-for-your-organization/manage-phone-numbers-for-your-organization.md)

[緊急通話の利用条件](emergency-calling-terms-and-conditions.md)

[緊急通話の免責事項ラベル](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/emergency-calling/emergency-calling-label-(en-us)-(v.1.0).zip?raw=true)
