---
title: ダイヤル プランについて
author: CarolynRowe
ms.author: crowe
manager: serdars
ms.reviewer: mikedav, roykuntz
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
search.appverid: MET150
ms.collection:
- M365-voice
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
localization_priority: Normal
f1keywords: ms.teamsadmincenter.voice.dialplans.overview
ms.custom:
- Calling Plans
description: 'Teams で利用できるダイヤル通話プランの種類 (PSTN 通話ダイヤルプラン) と、組織に合わせて選ぶ方法について説明します。  '
ms.openlocfilehash: f23dd2797f70b41a4bed8fd3ddc4bf467dd459db
ms.sourcegitcommit: 0dba0ad1f8f00415c6437cadabed0548ce3281b1
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2019
ms.locfileid: "39919290"
---
# <a name="what-are-dial-plans"></a>ダイヤル プランについて

[] ダイヤル プランは、個別のユーザーによってダイヤルされた電話番号を、通話承認と通話ルーティングの目的で別の形式 (通常は E.164) に変換する、正規化ルールの名前付きのセットです。

ダイヤル プランは、さまざまな形式で表される電話番号が別の 1 つの形式にどのように変換されるかを定義する 1 つ以上の正規化ルールで構成されます。同じダイヤル文字列が、ダイヤル プランによって異なる形で解釈、変換される可能性があるため、指定されたユーザーに割り当てられているダイヤル プランに応じて、同じダイヤル番号が異なる形で変換、ルーティングされることがあります。

テナントのダイヤル プランを作成および管理する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

## <a name="tenant-dial-plan-scope"></a>テナント ダイヤル プランのスコープ

ダイヤル プランのスコープによって、ダイヤル プランを適用できる階層レベルが決まります。 クライアントは、ユーザーが Teams にサインインしたときに自動的に提供されるプロビジョニング設定を通じて、適切なダイヤルプランを取得します。 管理者は、Microsoft Teams 管理センターまたはリモート PowerShell を使用して、ダイヤルプランのスコープレベルを管理して割り当てることができます。

Teams では、サービス範囲とテナント範囲 (組織向け) という2種類のダイヤルプランがあります。 電話システムを利用できる国または地域ごとに、サービス範囲のダイヤルプランが定義されます。 各ユーザーには、ユーザーに割り当てられている使用場所と一致するサービス国のダイヤルプランが自動的に割り当てられます。 サービス国のダイヤルプランを変更することはできませんが、テナントのスコープを設定したダイヤルプランを作成することができます。これにより、サービス国のダイヤルプランが拡張されます。 お客様は、お客様がプロビジョニングされた「有効なダイヤルプラン」を取得します。これは、サービス国のダイヤルプランと適切にスコープ指定されたテナントダイヤルプランの組み合わせです。 したがって、テナントダイヤルプランでは、サービス国のダイヤルプランに既に存在する可能性があるため、すべての正規化ルールを定義する必要はありません。

テナントのダイヤルプランは、さらに2つのスコープ (テナントスコープまたはユーザースコープ) に分けることができます。 テナントがユーザー範囲のダイヤルプランを定義して割り当てる場合、そのユーザーは、ユーザーのサービス国ダイヤルプランと割り当てられたユーザーダイヤルプランの有効なダイヤルプランでプロビジョニングされます。 テナントがテナント範囲のダイヤルプランを定義していても、ユーザーを対象範囲としたダイヤルプランが割り当てられていない場合、そのユーザーは、ユーザーのサービス国ダイヤルプランとテナントダイヤルプランの有効なダイヤルプランでプロビジョニングされます。

Teams のダイヤルプランの継承モデルを次に示します。

![チームでのダイヤルプランの継承方法](media/b2744f33-ebbd-4c23-bfba-1747312ab178.png)

次に、考えられる有効なダイヤル プランを示します。

 **サービス国**テナントを対象としたダイヤルプランが定義されておらず、テナントのユーザーを対象範囲としたダイヤルプランがプロビジョニングされたユーザーに割り当てられていない場合、ユーザーは使用場所に関連付けられたサービス国にマッピングされた有効なダイヤルプランを受け取ります。

 **テナントのグローバルサービス国**テナントのユーザーダイヤルプランが定義されていても、ユーザーに割り当てられていない場合、プロビジョニングされたユーザーには、結合されたテナントダイヤルプランと、その使用場所に関連付けられたサービス国のダイヤルプランで構成される有効なダイヤルプランが適用されます。

 **テナントのユーザーサービス国**テナントのユーザーダイヤルプランが定義され、ユーザーに割り当てられている場合、プロビジョニングされたユーザーには、結合されたテナントのユーザーダイヤルプランと、その使用場所に関連付けられたサービス国のダイヤルプランで構成される有効なダイヤルプランが取得されます。

テナントのダイヤル プランを作成する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

## <a name="planning-for-tenant-dial-plans"></a>テナント ダイヤル プランの計画

カスタム ダイヤル プランを計画するには、次の手順を実行します。

- **手順 1** ユーザーのダイヤル エクスペリエンスを高めるためにカスタム ダイヤル プランが必要かどうかを決定します。通常は、内線または省略された国内ダイヤルなど、E.164 以外のダイヤルに対応する場合に必要となります。

- **手順 2** テナント グローバルまたはテナント ユーザー スコープのダイヤル プランのどちらが必要か、または両方とも必要であるかを決定します。ユーザーに複数のローカル ダイヤル要件がある場合は、ユーザー スコープのダイヤル プランが必要となります。

- **手順 3** 各必須ダイヤル プランに対応する有効な番号バターンを特定します。サービス レベル国のダイヤル プランで定義されていない番号パターンのみが必要となります。

- **手順 4** ダイヤル プランの名前付けについて組織全体のスキームを策定します。標準的な名前付けスキームを採用することにより、組織全体にわたり一貫した方針を実現でき、メンテナンスや更新作業が簡素化されます。

[FastTrack](https://fasttrack.microsoft.com/microsoft365/capabilities?view=voice) は、さらなるリソースとパートナーで、テナント ダイヤル プランの実装をサポートします。

## <a name="creating-your-new-tenant-dial-plan"></a>テナント ダイヤル プランの新規作成

ダイヤル プランを新規作成する場合、必要な情報を把握しておく必要があります。

### <a name="name-and-simple-name"></a>名前と簡易名

ユーザー ダイヤル プランでは、ダイヤル プランが割り当てられるユーザーを識別する説明的な名前を指定する必要があります。 ダイヤルプランの簡易名には、ダイヤルプラン名から派生した文字列が事前に入力されています。 [単純名] フィールドは編集可能で、ダイヤル プラン用のより説明的な名前付け規則を作成することができます。 [単純名] の値は空にすることはできず、一意でなければなりません。 最適な方法は、組織全体の名前付け規則を作成してから、その規則の一貫性をすべてのサイトとユーザーに使用することです。

### <a name="description"></a>説明

地理的な場所または対応するダイヤル プランが適用されるユーザーのグループに関する一般的で認識可能な名前を入力することをお勧めします。

### <a name="external-access-prefix"></a>外部アクセス プレフィックス
<a name="bkexternalprefix"> </a>

ユーザーが外線につなぐために 1 つ以上の追加の先頭数字 (9 など) をダイヤルする必要がある場合は、最大 4 文字 (#、*、0～9) の外部アクセス プレフィックスを指定できます。

> [!NOTE]
> 外部アクセス プレフィックスを指定する場合、プレフィックスを適応させるための正規化ルールを追加で作成する必要はありません。

テナントのダイヤル プランを作成する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

## <a name="normalization-rules"></a>正規化ルール
<a name="bknormalizationrule"> </a>

正規化ルールによって、さまざまな形式で表される電話番号をどのように変換するかが定義されます。ダイヤル元のロケールに応じて、同じ番号文字列が異なる方法で解釈および変換される場合があります。正規化ルールは、ユーザーが省略された内線または外線番号をダイヤルできるようにする必要がある場合に、必須となることがあります。

1 つ以上の正規化ルールをダイヤル プランに割り当てる必要があります。正規化ルールは上から下の順に照合されるため、テナント ダイヤル プランにおける順序が重要になります。たとえば、テナント ダイヤル プランに 10 個の正規化ルールがある場合、ダイヤルされた番号の一致ロジックは 1 番目のルールから試行され、一致がみられない場合は 2 番目、というように順次実行されます。一致がみられた場合、そのルールが使用され、定義済みのそれ以外のルールとの照合は実行されません。指定されたテナント ダイヤル プランには、最大で 25 個の正規化ルールを設定できます。

### <a name="determining-the-required-normalization-rules"></a>必要な正規化ルールの指定

すべてのテナント ダイヤル プランは指定されたユーザーのサービス国のダイヤル プランと有効に結合されるため、サービス国のダイヤル プランの正規化ルールが、必要となるテナント ダイヤル プランの正規化ルールを特定するために評価される必要があります。この目的で **Get-CsEffectiveTenantDialPlan** コマンドレットを使用できます。コマンドレットは入力パラメータとしてユーザー ID を必要とし、ユーザーに適用可能なすべての正規化ルールを返します。

### <a name="creating-normalization-rules"></a>正規化ルールの作成
<a name="createrule"> </a> <a name="regularexpression"> </a>

正規化ルールでは、リバース番号検索でダイヤル文字列を E.164 形式に変換するためにサーバーによって使用される番号一致パターンを指定するために, .NET Framework の正規表現が使用されます。正規化ルールは、一致に対する正規表現と、一致が見つかったときに行う変換を指定することで作成できます。作業が完了したら、テスト番号を入力して、正規化ルールが正常に機能することを確認できます。

.NET Framework の正規表現を使用する場合の詳細については、「[.NET Framework の正規表現](https://go.microsoft.com/fwlink/p/?linkId=140927)」を参照してください。

テナントのダイヤル プランの正規化ルールを作成および管理する場合は「[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)」をご覧ください。

### <a name="sample-normalization-rules"></a>正規化ルールのサンプル

次の表に, .NET Framework の正規表現として記述される正規化ルールのサンプルを示します。これらのサンプルは例示するためのもので、独自の正規化ルールを作成する際の規定リファレンスとして提示するものではありません。

 **.NET Framework の正規表現を使用した正規化ルール**<a name="#regularexpression"> </a>

||||||
|:-----|:-----|:-----|:-----|:-----|
|**ルール名** <br/> |**説明** <br/> |**番号パターン** <br/> |**変換** <br/> |**例** <br/> |
|4digitExtension  <br/> |4 桁の内線番号を変換します。  <br/> |^(\\d{4})$  <br/> |+1425555$1  <br/> |0100 は +14255550100 に変換されます  <br/> |
|5digitExtension  <br/> |5 桁の内線番号を変換します。  <br/> |^5(\\d{4})$  <br/> |+1425555$1  <br/> |50100 は +14255550100 に変換されます  <br/> |
|7digitcallingRedmond  <br/> |7 桁の番号をレドモンドの電話番号に変換します。  <br/> |^(\\d{7})$  <br/> |+1425$1  <br/> |5550100 は +14255550100 に変換されます  <br/>|
|RedmondOperator  <br/> |0 をレドモンドのオペレーター呼び出し番号に変換します。  <br/> |^0$  <br/> |+14255550100  <br/> |0 は +14255550100 に変換されます  <br/> |
|RedmondSitePrefix  <br/> |オンネット プレフィックス (6) およびレドモンドのサイト コード (222) 付きの番号を変換します。  <br/> |^6222(\\d{4})$  <br/> |+1425555$1  <br/> |62220100 は +14255550100 に変換されます  <br/> |
|5digitRange  <br/> |3 から 7 を含むその範囲で始まる 5 桁の内線番号を変換します。  <br/> |^([3-7]\\d{4})$  <br/> |+ 142555 $ 1 <br/> |54567 は +14255554567 に変換されます  <br/> |
|PrefixAdded  <br/> |1 桁目と 3 桁目に制限を付けて、9 桁の番号の前に国番号を追加します。  <br/> |^([2-9]\\d\\d[2-9]\\d{6})$  <br/> |1$1  <br/> |4255554567 は 14255554567 に変換されます  <br/> |
|NoTranslation  <br/> |5 桁と一致しますが、変換は行いません。  <br/> |^(\\d{5})$  <br/> |$1  <br/> |34567 は 34567 に変換されます  <br/> |

 **上に示す正規化ルールに基づくレドモンドのダイヤル プラン**

 次の表に、前の表に示される正規化ルールに基づく、レドモンド、ワシントン、米国のサンプル ダイヤル プランを示します。

| |
|:---------------------------------------------------------------------------------------------------------------------------------------------------------|
| **レドモンドのダイヤル プラン** <br/>                                                                                                                              |
| 5digitExtension <br/>                                                                                                                                    |
| 7digitcallingRedmond <br/>                                                                                                                               |
| RedmondSitePrefix <br/>                                                                                                                                  |
| RedmondOperator <br/>                                                                                                                                    |

> [!NOTE]
> 上の表に示した正規化ルール名にスペースは含まれていませんが、これは選択肢の1つです。 たとえば、表に最初に示されている名前は、「5 digit extension」と「5-digit Extension」のどちらの形式で記述しても有効になります。

## <a name="related-topics"></a>関連項目

[ダイヤル プランを作成および管理する](create-and-manage-dial-plans.md)

[通話プランで使用されるさまざまな種類の電話番号](different-kinds-of-phone-numbers-used-for-calling-plans.md)

[組織の電話番号を管理する](manage-phone-numbers-for-your-organization/manage-phone-numbers-for-your-organization.md)

[緊急通話の利用条件](emergency-calling-terms-and-conditions.md)

[緊急通話の免責事項ラベル](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/emergency-calling/emergency-calling-label-(en-us)-(v.1.0).zip?raw=true)
