---
title: CQD クエリ テンプレートPower BI使用するためのコネクタのインストール
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.reviewer: siunies
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
ms.collection:
- M365-voice
search.appverid: MET150
audience: Admin
appliesto:
- Microsoft Teams
ms.localizationpriority: medium
description: 通話品質ダッシュボード (CQD) クエリ テンプレートを使用するPower BI コネクタをインストールする
ms.openlocfilehash: 474edeca9e694e38e1503074fc45c8bcdaca3483
ms.sourcegitcommit: f0eaaf67b4fdce87d5c01b456c506c1435714ced
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/16/2022
ms.locfileid: "62852500"
---
# <a name="install-microsoft-call-quality-connector-for-power-bi-to-use-call-quality-dashboard-query-templates"></a>通話品質ダッシュボード クエリ テンプレートを使用するPower BI用の Microsoft 通話品質コネクタをインストールする

Microsoft Teams通話品質ダッシュボード (CQD) にPower BIクエリ テンプレート (PBIX ファイル) を使用するには、[ダウンロード](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/CQD-Power-BI-query-templates.zip?raw=true)に含まれている *MicrosoftCallQuality.ppfx* ファイルを使用して、Power BI用の Microsoft Call Quality コネクタをインストールする必要があります。

これらのテンプレートの詳細については、「[Power BIを使用してTeamsの CQD データを分析](CQD-Power-BI-query-templates.md)する」を参照してください。

Power BI レポートにアクセスするための適切な [CQD アクセス ロール](./turning-on-and-using-call-quality-dashboard.md#assign-admin-roles-for-access-to-cqd)があることを確認します。

> [!NOTE]
> Microsoft 通話品質コネクタでは、Power BIの DirectQuery のみがサポートされます。インポート モードはサポートされていません。 

## <a name="installation"></a>インストール

カスタム コネクタをインストールし、コネクタを使用できるようにセキュリティを調整するプロセスについては、[Power BI のドキュメント](/power-bi/desktop-connector-extensibility)で詳しく説明されています。 わかりやすくするために、簡単な説明を次に示します。

1. コンピューターにドキュメント *Power BI Desktop\\ Custom Connectors フォルダーが既\[\]\\* にあるかどうかを確認します。 そうでない場合は、このフォルダーを作成します。<sup>1</sup>

2. コネクタ ファイル ( *\*.mez* または *\*.ppfx* ファイル) をダウンロードし、 *カスタム コネクタ* ディレクトリに配置します。

3. **コネクタ ファイルが *.mez ファイルの\** 場合は、**[カスタム コネクタセットアップのドキュメント](/power-bi/desktop-connector-extensibility#data-extension-security)で説明されているように、セキュリティ設定も調整する必要があります。

新しいバージョンの Microsoft Call Quality コネクタがリリースされた場合は、 *Custom Connectors* ディレクトリ内の古いコネクタ ファイルを新しいファイルに置き換えます。

## <a name="setup"></a>セットアップ

レポートを作成してクエリを実行するには、まず CQD データ ソースに接続する必要があります。 接続するには、次の手順に従います。

1. Power BI Desktopの [ホーム] タブで、[*データの取得*] をクリックします。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector1-resize.png)

2. この時点で、[ *データの取得* ] ウィンドウが表示されます。 *Online Services* に移動し、*Microsoft 通話品質 (ベータ)* を選択し *、Connect* をクリックします。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector2-resize.png)

3. 次にサインインするように求められます。 通話品質ダッシュボードで使用するのと同じ資格情報を使用します。<sup>2</sup>

4. 次のプロンプトでは、2 つの *データ接続モード* 間のオプションが表示されます。 *DirectQuery* を選択し、[*OK]* をクリックします。

5. 最後に、通話品質ダッシュボードのデータ モデル全体を示す最後のプロンプトが表示されます。 この時点ではデータは表示されず、CQD のデータ モデルのみが表示されます。 [ *読み込み* ] を選択してセットアップ プロセスを完了します。

6. この時点で、Power BIはウィンドウの右側にデータ モデルを読み込みます。 それ以外の場合、ページは空白のままになり、既定ではクエリは読み込まれません。 クエリを **作成** してデータを返すには、以下のクエリの作成に進みます。

このセットアップ プロセス中の手順のいずれかが明確でない場合は、「[クイック スタート: Power BI DesktopのデータにConnectする」で](/power-bi/desktop-quickstart-connect-to-data)、プロセスの詳細な説明を参照してください。

## <a name="building-queries"></a>クエリの作成

セットアップが完了すると、[ *フィールド]* ウィンドウに数百のディメンションとメジャーの読み込みの名前が表示されます。 ここから実際のクエリを作成するのは簡単です。クエリに必要なディメンションとメジャーを選択し、ページにドラッグ アンド ドロップするだけです。 簡単な例を使用して、より詳細な説明を次に示します。

1. [視覚化] ウィンドウから使用する *視覚化* を選択します。 その視覚化の空のバージョンがページに表示されます。 この例では、 *テーブル* の視覚化を使用します。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector3-resize.png)

2. クエリに使用するディメンションとメジャー (集計記号の名前で示される) を決定し、手動で選択して黒い視覚化にドラッグします。 または、視覚化オプションの下にある *[値]* フィールドにドラッグします。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector4-resize2.png)

    > [!IMPORTANT]
    > 通話品質ダッシュボードには、クエリを実行するためのメジャーが必要です。 クエリにメジャーを追加しないと、そのクエリは失敗します。

3. 次に、フィルターを適用するディメンションを選択 *し、[* フィルター] ウィンドウの *[このビジュアルのフィルター*] フィールドにドラッグします。 Microsoft 通話品質コネクタは現在、 *基本的なフィルター処理* (可能なディメンション値の一覧から値を選択)、 *高度なフィルター処理* (通話品質ダッシュボードと同様に、フィルターを適用する値とオペランドを手動で指定)、 *相対日付フィルター処理* ( *終了時刻* ディメンションと *開始時刻* ディメンションでのみ使用できます) をサポートしています。 *上位 N* に従ったフィルター処理は、通話品質ダッシュボードではサポートされていません。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector5-resize.png)

    > [!IMPORTANT]
    > フィルターは、ディメンションに適用された場合にのみサポートされます。 測定の値に対するフィルター処理は、通話品質ダッシュボードではサポートされていません。

4. 最後に、[視覚化] ウィンドウで [ *書式* ] タブを選択し、クエリ *の* スタイルと書式設定を行います。

    > [!NOTE]
    > 品質ダッシュボードの呼び出しクエリを実行するには、少なくとも 1 つのメジャーが必要です。 クエリが読み込まれない場合は、クエリにメジャーが含まれていることを確認します。

## <a name="creating-a-drillthrough-report"></a>ドリルスルー レポートの作成

[Power BIのドリルスルー](/power-bi/desktop-drillthrough)を使用すると、他のレポートの値をコンテキストとして使用してすばやくフィルター処理できる、フォーカスのあるレポートを作成できます。 Microsoft 通話品質コネクタを使用して最初のクエリを作成する方法がわかったら、ドリルスルーの作成がさらに簡単になります。

1. フォーカスされたレポートの別のページを作成し、そのページにクエリを追加します。

2. ドリルスルー フィルターとして使用するディメンションを選択し、[*視覚化*] ウィンドウの [*ドリルスルー*] フィールドにドラッグします。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector6-resize.png)

3. **それです\!** そのディメンションを使用する別のページ上の他のクエリでも、そのページにドリルスルーできるようになり、ドリルスルー ディメンションの値がフィルターとして自動的に適用されます。

    ![スクリーンショット: Power BI コネクタ。](media/CQD-power-bi-connector7-resize.png)

通話品質ダッシュボードとは異なり、Power BIでは、連続しないドリルスルーがサポートされています。 クエリに必要なディメンションが含まれている場合は、他のページにドリルスルーできます。

### <a name="best-practice"></a>ベスト プラクティス

Microsoft 通話品質コネクタ のクエリは、ドリルスルー機能を念頭に置いて設計する必要があります。 すべてのデータを一度に読み込んでからフィルターでスライスする代わりに、より広範でカーディナリティの低いクエリから始めて、カーディナリティの高いクエリにドリルダウンします。 たとえば、品質の問題に最も影響を与えるサブネットを診断する場合は、まず問題の影響を受けるリージョンと国を特定してから、そのリージョンまたは国のサブネットにドリルダウンすると便利です。 通話品質コネクタ テンプレートは、例として機能するようにこの方法で設計されています。

## <a name="limitations"></a>制限事項

Power BIを利用しているにもかかわらず、通話品質ダッシュボードのデータ モデルまたは DirectQuery コネクタ全般の制限の結果として、Microsoft 通話品質コネクタですべてのPower BI機能がサポートされているわけではありません。 次の一覧では、コネクタのより注目すべき制限事項の一部を示しますが、この一覧は網羅的とは見なすべきではありません。

1. **計算列 –** DirectQuery コネクタは一般に、Power BIの計算列のサポートが限られています。 一部の計算列はコネクタで動作する場合があります。これらの列は例外です。 一般に、計算列は機能しません。

2. **集計 –** 通話品質ダッシュボード のデータ モデルはキューブ モデル上に構築されています。つまり、集計はメジャーの形式で既にサポートされています。 異なるディメンションに集計を手動で追加しようとしたり、メジャーの集計の種類を変更したりしても、コネクタでは機能せず、通常はエラーが発生します。

3. **カスタム ビジュアル –** Microsoft Call Quality コネクタは、さまざまなカスタム ビジュアルで動作しますが、すべてのカスタム ビジュアルとの互換性を保証することはできません。 多くのカスタム ビジュアルは、計算列またはインポートされたデータの使用に依存していますが、どちらも DirectQuery コネクタではサポートされていません。

4. **キャッシュされたデータの参照 –** Power BI現在、DirectQuery コネクタからのキャッシュされたデータの参照はサポートされていません。 クエリの結果を参照しようとすると、新しいクエリが生成されます。

5. **相対データ フィルター処理 –** Microsoft 通話品質コネクタでサポートされていますが、 *開始時刻* と *終了時刻* のディメンションでのみサポートされます。 *日付* ディメンションは相対的な日付フィルター処理の明らかな選択肢ですが、*Date* は日付時刻オブジェクトとして格納されないため、Power BIでの相対日付フィルター処理はサポートされません。

6. **測定のみのクエリ -** 現時点では、Microsoft 通話品質コネクタではサポートされていません。 3 つ以上の測定値を持ち、ディメンションのない視覚化を作成する場合、列データは入れ替えられます。 これを回避するには、視覚化に少なくとも 1 つのディメンション (例: Month Year) を常に含めます。 これは、Power BI向けの Microsoft 通話品質コネクタの今後のリリースで解決される予定です。

7. **Government Community Cloud (GCC) サポート –** GCC環境のお客様の場合、Microsoft 通話品質コネクタは、Power BI Desktopのみを使用する場合に機能します。 Microsoft 通話品質コネクタは、現在、GCCのお客様のPower BI サービスと互換性がありません。

これらの問題のほとんどは、Power BIでの DirectQuery コネクタの設計に対する制限か、CQD データ モデルの設計の基本です。

## <a name="troubleshooting"></a>トラブルシューティング

### <a name="im-trying-to-use-the-date-column-as-a-date-slicer-as-soon-as-i-convert-the-data-type-of-this-column-to-date-i-get-this-error"></a>Date 列を Date スライサーとして使用しようとしています。 この列のデータ型を Date に変換するとすぐに、このエラーが発生します

> **このビジュアルのデータを読み込めませんでした**:OLE DB または ODBC エラー: [Expression.Error] 式をデータ ソースに折りたたむことができませんでした。 より単純な式を試してください。

日付スライサーは、Microsoft 通話品質コネクタではサポートされていません。 日付範囲を指定するには、レポートに 2 つのフィルターを適用し、日付より小さいと大きい値を指定します。

または、表示する日付が最近である場合は、相対日付フィルターを適用して、過去 N 日間/週/月のデータのみを表示します。


### <a name="when-i-add-certain-dimensions-to-my-reports-the-visual-immediately-returns-couldnt-load-the-data-for-this-visual-removing-the-dimension-fixes-the-visual----what-is-happening"></a>レポートに特定のディメンションを追加すると、ビジュアルは直ちに **"このビジュアルのデータを読み込めませんでした" を** 返します。 ディメンションを削除すると、ビジュアルが修正されます。何が起こっていますか?

これは、Microsoft 通話品質コネクタの既知の問題です。整数として公開されるすべてのディメンションは、Power BIに "集計" 列として表示されます。ここで、Power BIは既定の集計アクション (通常は 'Sum') を試行します。 2 番目の WiFi チャネルのようなディメンションの 'sum' は意味がないため、結果が役に立たない場合でも、この動作は値の合計に成功する場合があります。 それ以外の場合、この集計アクションは失敗し、ビジュアルにエラーが発生します。

この問題を回避するには、まずビジュアルからディメンションを削除します。 [フィールド] ボックスの一覧からディメンションを選択し、リボンの [列ツール] タブを参照し、[集計] ドロップダウン メニューをクリックして、[ **集計しない**] を選択します。 ディメンションをビジュアルに再度追加できるようになりました。


## <a name="error-codes"></a>エラー コード

Power BI用の Microsoft 通話品質コネクタは、構築できるクエリの種類の点でブラウザー アプリよりも制限が小さいため、クエリの構築中に多くのエラーが発生する場合があります。 "CQDError" 型のエラー メッセージが表示された場合。 RunQuery – クエリ実行エラー": クエリで発生する可能性のある問題のトラブルシューティングを行うために、次の一覧と ErrorType 番号を参照してください。 CQD Power BI コネクタで発生する可能性がある最も一般的なエラーの種類コードを次に示します。

- **ErrorType 1 - クエリ構造エラー:** クエリ構造エラーは、通常、コネクタが適切な形式のクエリを作成できなかったことが原因で発生します。 これは、上記の制限事項で指定されているように、サポートされていない機能を使用している場合に最も頻繁に発生します。 そのクエリに対して計算列またはカスタム ビジュアルを使用していないかどうかを確認します。

  - **ErrorType 2 - クエリ作成エラー:** クエリ作成エラーは、Microsoft Call Quality コネクタがビルドしようとしているクエリを適切に解析できないことが原因で発生します。 これは、上記の制限事項で指定されているように、サポートされていない機能を使用している場合に最も頻繁に発生します。 そのクエリに対して計算列またはカスタム ビジュアルを使用していないかどうかを確認します。

  - **ErrorType 5 - 実行タイムアウト:** クエリがタイムアウトする前に、可能な限り最大のランタイムに達しました。スコープを制限するには、クエリにさらにフィルターを追加してみてください。 多くの場合、これを実現する最も効果的な方法は、データ範囲を絞り込む方法です。

  - **ErrorType 7 - 測定エラーなし:** 品質ダッシュボードクエリを呼び出すには、機能するためにメジャーが必要です。 クエリにメジャーが含まれていることを確認します。 Microsoft 通話品質コネクタのメジャーは、名前の前に集計 (合計) 記号で表されます。

この範囲外で追加のエラーが発生した場合は、問題のトラブルシューティングとドキュメントの更新に役立つよう、通話品質ダッシュボード チームに通知してください。

## <a name="footnotes"></a>脚注

**<sup>1</sup>** 特定のプロセスとアプリ (OneDriveなど) を使用すると、Documents ルート フォルダーが変更される可能性があります。*Power BI Desktop\\ Custom Connectors* ディレクトリが現在のルート フォルダードキュメント フォルダー内に配置されていることを確認します。

**<sup>2</sup>** 通話品質ダッシュボードに使用するログイン資格情報は、Power BI Desktop アプリ自体にログインするために使用するのと同じ資格情報である必要 *はありません*。

## <a name="frequently-asked-questions"></a>よく寄せられる質問

### <a name="when-will-the-power-bi-connector-be-updated-from-beta-status"></a>Power BI コネクタは、いつ "ベータ" 状態から更新されますか?

ベータ タグにもかかわらず、Power BI用の Microsoft Call Quality (Beta) コネクタは、コネクタの最初の "リリース" バージョンであり、これを反映するためにPower BI チームによって正式にセキュリティ署名されています。 コネクタの初期リリース時に、Power BI チームはサポートと広範な認定を提供できませんでしたが、Microsoft 通話品質コネクタのセキュリティ、信頼性、および一般的な機能を証明する準備が整いました。 今後は、近い将来、Power BI向けの Microsoft 通話品質コネクタに投資する予定です。

### <a name="why-does-the-connector-seem-slower-compared-to-call-quality-dashboard-in-the-browser-what-can-i-do-to-improve-performance"></a>ブラウザーの通話品質ダッシュボードに比べてコネクタの速度が低下するのはなぜですか? パフォーマンスを向上させるにはどうすればよいですか?

さまざまなテンプレートのクエリパフォーマンスは、実際にはブラウザーとコネクタの両方で同じです。  他のスタンドアロン アプリと同様に、Power BIは認証とレンダリング時間をパフォーマンスに追加します。 さらに、同時に実行されるクエリの数にも違いがあります。 ブラウザー内バージョンの通話品質ダッシュボードは、あまりよく開発されておらず、情報密度の高い視覚化オプションが含まれていたため、ほとんどのレポートは一度に 2 ~ 3 個のクエリを読み込むという制限がありました。 一方、コネクタ テンプレートには、多くの場合、20 以上の同時クエリが表示されます。 以前のクエリと同じくらい応答性の高いレポートを作成する場合は、タブあたり 2 ~ 3 個のクエリを使用せずにレポートを作成してみてください。

詳細については、次の記事を参照してください。

- [Power BIの最適化ガイド](/power-bi/guidance/power-bi-optimization)
- [DirectQuery モデルのガイダンス](/power-bi/guidance/directquery-model-guidance)

### <a name="i-find-that-i-routinely-run-into-the-10000-row-limit-when-running-queries-how-can-i-get-the-connector-to-return-more-than-10000-rows"></a>クエリを実行するときに、定期的に 10,000 行の制限に達していることがわかります。 コネクタが 10,000 行を超える行を返すようにするにはどうすればよいですか?

10,000 行の制限は実際には API エンドで指定されており、パフォーマンスを大幅に向上させ、メモリ不足の状態に起因するクエリ実行エラーのリスクを軽減するために設計されています。

結果行数を増やそうとするのではなく、コネクタのベスト プラクティスに従ってレポートを再構築することをお勧めします。 含まれているテンプレートは、これらのベスト プラクティスを示すために設計されています。 可能であれば、まず、月、年、日付、地域、国など、より広範でカーディナリティの低いディメンションを使用して KPI を確認します。そこから、カーディナリティの高いディメンションをドリルダウンできます。 ヘルプデスクレポートとLocation-Enhancedレポートはどちらも、このドリルダウン ワークフローの優れた例を提供します。



## <a name="related-topics"></a>関連項目

[Power BIを使用してTeamsの CQD データを分析する](CQD-Power-BI-query-templates.md)
