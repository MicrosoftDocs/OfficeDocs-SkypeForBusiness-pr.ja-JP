---
title: CQD Power BIテンプレートを使用するためにコネクタをインストールする
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.reviewer: siunies
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
ms.collection:
- M365-voice
search.appverid: MET150
audience: Admin
appliesto:
- Microsoft Teams
localization_priority: Normal
description: 通話品質Power BI (CQD) クエリ テンプレートを使用するためにコネクタをインストールする
ms.openlocfilehash: 15e02ed85720cf96babc470e021df1a960d4b608
ms.sourcegitcommit: 4e1f5d99c1d0612dc5b50f850280983867ff53d8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2021
ms.locfileid: "51874483"
---
# <a name="install-power-bi-connector-to-use-cqd-query-templates"></a>CQD Power BIテンプレートを使用するためにコネクタをインストールする

Microsoft Teams 通話品質ダッシュボード (CQD) に Power BI クエリ テンプレート (PBIX ファイル) を使用するには、ダウンロード に含まれる *MicrosoftCallQuality.p Power BI* Connector for Microsoft CQD をインストールする [](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/CQD-Power-BI-query-templates.zip?raw=true)必要があります。

これらの[テンプレートについては、「Power BIを使用して CQD データを分析する」Teams](CQD-Power-BI-query-templates.md)を参照してください。

レポートにアクセスする適切な[CQD](./turning-on-and-using-call-quality-dashboard.md#assign-admin-roles-for-access-to-cqd)アクセス ロールPower BIします。

> [!NOTE]
> CQD Power BI コネクタでは、DirectQuery がサポートPower BI。インポート モードはサポートされていません。 

## <a name="installation"></a>インストール

カスタム コネクタをインストールし、コネクタの使用を有効にするようにセキュリティを調整するプロセスについては、次のドキュメント[Power BIされています](/power-bi/desktop-connector-extensibility)。 わかりやすくするために、簡単な説明を次に示します。

1. コンピューターに Custom Connectors フォルダーのドキュメントが *\[ \] \\ 既Power BI Desktop \\ 確認* します。 ない場合は、このフォルダーを作成します。<sup>1</sup>

2. コネクタ ファイル *\* (.mez* または *\* .p込* みファイル) をダウンロードし *、Custom Connectors ディレクトリに配置* します。

3. **コネクタ ファイルが *\* .mez*** ファイルの場合は、カスタム コネクタのセットアップ に関するドキュメントの説明に従って、セキュリティ設定 [を調整する必要があります](/power-bi/desktop-connector-extensibility#data-extension-security)。

この Power BI Connector for Microsoft Teams の新しいバージョンがリリースされた場合は *、Custom Connectors* ディレクトリ内の古いコネクタ ファイルを新しいファイルに置き換えるだけで済みです。

## <a name="setup"></a>セットアップ

レポートを作成してクエリを実行するには、まず CQD データ ソースに接続する必要があります。 接続するには、次の手順に従います。

1. [ホーム] タブの [Power BI Desktop データの取得]*をクリックします*。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector1-resize.png)

2. この *時点で [データ* の取得] ウィンドウが表示されます。 [オンライン サービス *] に移動し**、[Microsoft 通話品質 (ベータ版)* ] を選択し、[] をクリック *Connect。*

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector2-resize.png)

3. 次にサインインするように求めるメッセージが表示されます。 CQD に使用するのと同じ資格情報を使用します。<sup>2</sup>

4. 次のプロンプトでは、2 つのデータ接続モード間 *のオプションが表示されます*。 *[DirectQuery] を選択し**、[OK] をクリックします*。

5. 最後に、CQD のデータ モデル全体を示す最終的なプロンプトが表示されます。 この時点ではデータは表示されません。CQD のデータ モデルだけが表示されます。 [読 *み込み* ] を選択してセットアップ プロセスを完了します。

6. この時点で、Power BIウィンドウの右側にデータ モデルが読み込まれる必要があります。 それ以外の場合、ページは空白のままであり、既定ではクエリは読み込まれません。 クエリを作成 **してデータを返** す場合は、以下の「クエリの作成」に進みます。

このセットアップ プロセス中の手順が完全に明確ではない場合は、「クイック スタート: Connect to data in Power BI Desktop 」でプロセスの詳細な説明[を参照してください](/power-bi/desktop-quickstart-connect-to-data)。

## <a name="building-queries"></a>クエリの作成

セットアップが完了すると、[フィールド] ウィンドウに数百のディメンションとメジャーの負荷の名前が *表示* されます。 ここから実際のクエリを作成するのも簡単です。クエリに必要なディメンションとメジャーを選択し、ページにドラッグ アンド ドロップします。 簡単な例を使用して、より詳細な説明を次に示します。

1. [視覚化] ウィンドウから、使用する *視覚エフェクトを選択* します。 その視覚エフェクトの空のバージョンがページに表示されます。 この例では、テーブルの視覚エフェクトを *使用* します。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector3-resize.png)

2. クエリに使用するディメンションとメジャー (集計記号で名前で表される) を決定し、手動で選択し、黒い視覚エフェクトにドラッグします。 または、視覚化オプションの下にある *[値* ] フィールドにドラッグします。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector4-resize2.png)

    > [!IMPORTANT]
    > 通話品質ダッシュボードでは、クエリを実行するためのメジャーが必要です。 クエリにメジャーを追加しない場合、そのクエリは失敗します。

3. 次に、フィルター処理するディメンションを選択し、[フィルター] ウィンドウの [このビジュアル フィールドのフィルター] に *ドラッグ* します。 現在、CQD Power BI コネクタでは、基本的なフィルター処理 (使用可能なディメンション値の一覧から値を選択)、高度な *フィルター処理*(Advanced CQD と同様に、フィルター処理する値とオペランドを手動で指定)、相対日付フィルタリング *(終了* 時刻と開始時刻のディメンションでのみ使用できます) がサポートされています。  上位 N に従 *ったフィルター処理* は、CQD ではサポートされていません。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector5-resize.png)

4. 最後に、[視覚化] *ウィンドウの* [書式] タブ *を選択* して、クエリのスタイルと書式を設定します。

    > [!NOTE]
    > CQD クエリを実行するには、少なくとも 1 つのメジャーが必要です。 クエリが読み込まれていない場合は、クエリにメジャーが含まれているか確認します。

## <a name="creating-a-drillthrough-report"></a>ドリルスルー レポートの作成

[[ドリルスルー] Power BI、](/power-bi/desktop-drillthrough)コンテキストとして他のレポートの値を使用してすばやくフィルター処理できる、フォーカスされたレポートを作成できます。 CQD コネクタを使用して最初のクエリを作成する方法がわかっている場合、ドリルスルーの作成はさらに簡単です。

1. フォーカスされたレポート用に別のページを作成し、そのページにクエリを追加します。

2. ドリルスルー フィルターとして使用するディメンションを選択し、[視覚化] ウィンドウの [ *ドリル* スルー] *フィールドにドラッグ* します。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector6-resize.png)

3. **それです\!** そのディメンションを使用する別のページの他のクエリで、そのページにドリルスルーを実行し、ドリルスルー ディメンションの値をフィルターとして自動的に適用できます。

    ![スクリーンショット: Power BI コネクタ](media/CQD-power-bi-connector7-resize.png)

Advanced CQD とは異なり、Power BIは非シーケンシャルドリルスルーをサポートします。 クエリに必要なディメンションが含まれる限り、他のページにドリルスルーできます。

### <a name="best-practice"></a>ベスト プラクティス

通話品質コネクタ クエリは、ドリルスルー機能を念頭に置いて設計する必要があります。 すべてのデータを一度に読み込み、フィルターでスライスダウンするのではなく、より広範な低カーディナリティ クエリから始め、高カーディナリティ クエリにドリルダウンします。 たとえば、品質の問題に最も寄与するサブネットを診断する場合、最初に問題の原因であるリージョンと国を特定してから、そのリージョンまたは国のサブネットにドリルダウンすると便利です。 通話品質コネクタ テンプレートは、例として機能するように、この方法で設計されています。

## <a name="limitations"></a>制限事項

Power BI を使用しているにもかかわらず、CQD データ モデルまたは DirectQuery コネクタ全般に対する制限の結果として、すべての Power BI 機能が CQD コネクタでサポートされているという保証はありません。 以下の一覧は、コネクタのより注目すべき制限事項の一部を示していますが、この一覧は網羅的であると見なす必要はありません。

1. **計算列 –** 一般に、DirectQuery コネクタでは、計算列のサポートが制限Power BI。 一部の計算列はコネクタで動作する場合があります。ただし、これらは例外と見なす必要があります。 一般的なルールとして、計算列は機能しません。

2. **集計 –** CQD データ モデルはキューブ モデル上に構築されています。つまり、集計はメジャーの形式で既にサポートされています。 異なるディメンションに集計を手動で追加しようとしたり、メジャーの集計の種類を変更したりしようとすると、コネクタでは機能しません。通常、エラーが発生します。

3. **カスタム ビジュアル –** CQD コネクタはさまざまなカスタム ビジュアルで動作しますが、すべてのカスタム ビジュアルとの互換性を保証できません。 多くのカスタム ビジュアルは、計算列またはインポートされたデータの使用に依存します。DirectQuery コネクタではサポートされていません。

4. **キャッシュ されたデータの** 参照 – Power BI現在、DirectQuery コネクタからのキャッシュされたデータの参照はサポートされていません。 クエリの結果を参照しようとすると、新しいクエリが作成されます。

5. **相対データ のフィルター処理 –** CQD コネクタではサポートされますが、開始時刻と終了 *時刻* のディメンション *でのみサポート* されます。 Date ディメンション *は* 相対的な日付のフィルター処理に対して明らかな選択肢ですが *、Date* は日付時刻オブジェクトとして保存されないので、日付の相対的なフィルター処理はサポートPower BI。

6. **Government Community Cloud (GCC) のサポート –** GCC 環境のお客様の場合、CQD Power BI コネクタは、アプリケーションを使用するときに機能Power BI Desktop。 CQD Power BIコネクタは、現在、お客様の Power BI サービスGCCされません。

これらの問題の大部分は、CQD データ モデルの設計に関する Power BI DirectQuery コネクタの設計に対する制限か、または基本的な問題です。

## <a name="troubleshooting"></a>トラブルシューティング

### <a name="im-trying-to-use-the-date-column-as-a-date-slicer-as-soon-as-i-convert-the-data-type-of-this-column-to-date-i-get-this-error"></a>Date 列を Date スライサーとして使用します。 この列のデータ型を Date に変換するとすぐに、このエラーが表示されます。

> **このビジュアルのデータ** を読み込めなかった: OLE DB または ODBC エラー: [Expression.Error] 式をデータ ソースにフォールドできなかった。 より簡単な式を試してください。

日付スライサーは、Power BI コネクタではサポートされていません。 日付範囲を指定するには、2 つのフィルターをレポートに適用し、日付より小さいフィルターと日付より大きいフィルターを指定します。

または、表示する日付が最新の日付の場合は、相対日付フィルターを適用して、最後の N 日/週/月のデータのみを表示します。

## <a name="error-codes"></a>エラー コード

CQD Power BI Connector は、作成できるクエリの種類に関してブラウザー アプリよりも制限が少ないので、クエリの作成中にエラーが発生することがあります。 "CQDError" という種類のエラー メッセージが表示された場合。 RunQuery – クエリ実行エラー" を参照して、クエリに関して発生する可能性のある問題をトラブルシューティングするために、ErrorType 番号を指定して以下の一覧を参照します。 CQD コネクタで発生する可能性がある最も一般的なエラーの種類Power BIします。

- **ErrorType 1 - クエリ構造エラー:** クエリ構造のエラーは、通常、コネクタが適切な形式のクエリを作成できなかった場合に発生します。 これは、上記の制限事項で指定されている、サポートされていない機能を使用する場合に最も頻繁に発生します。 そのクエリに集計列やカスタム ビジュアルが使用されていないか、ダブルチェックします。

  - **ErrorType 2 - クエリ作成エラー:** クエリの構築エラーは、CQD コネクタがビルドするクエリを正しく解析できない場合に発生します。 これは、上記の制限事項で指定されている、サポートされていない機能を使用する場合に最も頻繁に発生します。 そのクエリに集計列やカスタム ビジュアルが使用されていないか、ダブルチェックします。

  - **ErrorType 5 - 実行タイムアウト:** クエリは、切り取り前に可能な最大ランタイムに達しました。スコープを制限するために、クエリにさらにフィルターを追加してみてください。 多くの場合、データ範囲を絞り込むのが最も効果的な方法です。

  - **ErrorType 7 - 測定なしエラー:** CQD クエリを機能するには、メジャーが必要です。 クエリにメジャーが含まれるか、ダブルチェックします。 CQD コネクタのメジャーは、名前の前に集計 (合計) 記号で示されます。

このスコープ外で追加のエラーが発生した場合は、問題のトラブルシューティングと必要に応じてドキュメントの更新を支援できるよう、CQD チームに通知してください。

## <a name="footnotes"></a>脚注

**<sup>1</sup>** 特定のプロセスとアプリ (OneDrive など) により、ドキュメントのルート フォルダーが変更される可能性があります。Custom Connectors ディレクトリPower BI Desktop現在のルート フォルダー *\\ Documents* フォルダーの内部に配置します。

**<sup>2</sup>** CQD に使用するログイン資格情報は、アプリ自体のログインに使用するのと同じ資格情報Power BI Desktop必要はありません。

## <a name="frequently-asked-questions"></a>よく寄せられる質問

### <a name="when-will-the-power-bi-connector-be-updated-from-beta-status"></a>Power BI コネクタが "Beta" 状態から更新されるのは、いつですか

ベータ タグにもかかわらず、Power BI の通話品質コネクタはコネクタのリリース バージョンであり、これを反映するために Power BI チームによって正式にセキュリティが署名されています。 そのベータ タグを削除する認定プロセスは広範なプロセスであり、コネクタに直接サポートを提供するために、Power BI チームからのコミットメントが必要です。 時間の制約により、Power BI チームは現在、そのサポートと広範なサーティティを提供できませんが、Microsoft 通話品質コネクタのセキュリティ、信頼性、および一般的な機能を証明する準備は行っています。

### <a name="why-does-the-connector-seem-slower-compared-to-advanced-cqd-in-the-browser-what-can-i-do-to-improve-performance"></a>ブラウザーの Advanced CQD に比べてコネクタの速度が遅いように見える理由 パフォーマンスを向上させるために実行できる操作

さまざまなテンプレートのクエリパフォーマンスは、ブラウザーとコネクタの両方で実際には同じです。  他のスタンドアロン アプリと同様に、Power BIのパフォーマンスに認証とレンダリング時間が追加されます。 さらに、この違いは、同時実行クエリの数によって異なっています。 ブラウザー内バージョンの CQD には、あまり開発されていない情報密度の高い視覚化オプションがあったため、ほとんどのレポートは一度に 2 ~ 3 のクエリを読み込むのに制限されています。 一方、コネクタ テンプレートには多くの場合、20 以上の同時クエリが表示されます。 以前のレポートと同じ応答性の高いレポートを作成する場合は、タブあたり 2 ~ 3 クエリ以下のレポートを作成してみてください。

詳細については、次の記事を参照してください。

- [Power BI の最適化ガイド](/power-bi/guidance/power-bi-optimization)
- [DirectQuery モデルのガイダンス](/power-bi/guidance/directquery-model-guidance)

### <a name="i-find-that-i-routinely-run-into-the-10000-row-limit-when-running-queries-how-can-i-get-the-connector-to-return-more-than-10000-rows"></a>クエリを実行すると、10,000 行の制限に日常的に達する場合があります。 10,000 行を超える行を返すコネクタを取得する方法

10,000 行の制限は、実際には API エンドで指定され、パフォーマンスを大幅に向上し、メモリの状態が少ないクエリ実行エラーのリスクを軽減するように設計されています。

結果の行数を増やす代わりに、コネクタのベスト プラクティスに従ってレポートを再構築します。 含まれているテンプレートは、これらのベスト プラクティスを示す目的で設計されています。 可能であれば、まず、月、年、日付、地域、国などのより広いカーディナリティディメンションを使用して KPI を確認します。そこから、より高いカーディナリティ ディメンションにドリルダウンできます。 ヘルプデスクレポートとLocation-Enhancedレポートはどちらも、このドリルダウン ワークフローの優れた例を提供します。



## <a name="related-topics"></a>関連トピック

[CQD Power BIデータを分析するには、次のコマンドを使用Teams](CQD-Power-BI-query-templates.md)
